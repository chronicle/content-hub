<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet"/>
    <title>Recommendation</title>
    <style>
        :root {
            --widget-bg: rgb(33, 44, 68);
            --widget-font-family: 'Source Sans Pro', sans-serif;
            --widget-text-color: rgb(255, 255, 255);
        }

        html, body {
            font-family: var(--widget-font-family), serif;
            color:  rgb(255, 255, 255)! important;
            background-color: var(--widget-bg) !important;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }

    </style>
</head>
<body>
    <div class="container" id="main-container">

        <div id="google.compute.Instance">
            <h2>Google Compute Instance</h2>
            <ul>
                <li>Check for any unauthorized access or modifications to compute instances.</li>
                <li>Ensure instances are configured with the latest security patches and updates.</li>
                <li>If unauthorized access is detected, investigate the source and take appropriate action.</li>
            </ul>

        </div>
        <div id="google.iam.ServiceAccount">
            <h2>Google IAM Service Account</h2>
            <ul>
                <li>Review the permissions of the service account.</li>
                <li>If the service account is no longer needed or has excessive permissions, disable or delete it.</li>
                <li>Implement logging for all service account changes and access attempts.</li>
                <li>Monitor logs for any unauthorized changes or suspicious activity.</li>
            </ul>
        </div>
        <div id="google.iam.ServiceAccountKey">

            <h2>Google IAM Service Account Key</h2>
            <ul>
                <li>Check for any unauthorized use of the service account key.</li>
                <li>If the key is compromised or no longer needed, revoke it immediately.</li>
                <li>Regularly rotate service account keys to minimize the risk of key compromise.</li>
                <li>Implement logging for all key changes and access attempts.</li>
            </ul>
        </div>
        <div id="google.cloud.storage.Bucket ">

            <h2>Google Cloud Storage Bucket</h2>
            <ul>
                <li>Check for any unauthorized access or modifications to the storage bucket.</li>
                <li>Review and update bucket-level IAM policies to restrict access to sensitive data.</li>
                <li>Enable logging for all access and modification events.</li>
            </ul>
        </div>

        <div id="google.compute.Firewall">
            <h2>Google Compute Firewall</h2>
            <ul>
                <li>Review recent changes to firewall rules.</li>
                <li>Ensure that firewall rules follow the principle of least privilege.</li>
                <li>If unauthorized changes are detected, revert them and investigate the source.</li>
            </ul>
        </div>
        <div id="google.container.Cluster">
            <h2>Google Container Cluster</h2>
            <ul>
                <li>Check for any unauthorized access or modifications to container clusters.</li>
                <li>Ensure clusters are configured with the latest security patches and updates.</li>
            </ul>
        </div>
        <div id="google.cloud.resourcemanager.Project">
            <h2>Google Cloud Resource Manager Project</h2>
            <ul>
                <li>Review recent changes to the project configuration and IAM policies.</li>
                <li>Ensure that only authorized personnel have access to manage projects.</li>
            </ul>
        </div>

        <div id="google.compute.BackendService">

            <h2>Google Compute Backend Service</h2>
            <ul>
                <li>Review the configuration of backend services for any unauthorized changes.</li>
                <li>Ensure backend services are configured with appropriate security policies.</li>
                <li>Use HTTPS for secure communication between clients and backend services.</li>
            </ul>
        </div>
        <div id="google.compute.Network ">
            <h2>Google Compute Network</h2>
            <ul>
                <li>Review recent changes to network configurations.</li>
                <li>Ensure that network configurations follow best security practices.</li>
            </ul>
        </div>

        <div id="google.compute.Project">

            <h2>Google Compute Project</h2>
            <ul>
                <li>Review recent changes to the compute project configuration and IAM policies.</li>
                <li>Ensure that only authorized personnel have access to manage compute projects.</li>
            </ul>
        </div>
        <div id="google.compute.SecurityPolicy ">
            <h2>Google Compute Security Policy</h2>
            <ul>
                <li>Review recent changes to security policies.</li>
                <li>Ensure that security policies follow best practices.</li>
            </ul>
        </div>
        <div id="google.compute.Subnetwork ">
            <h2>Google Compute Subnetwork</h2>
            <ul>
                <li>Check for any unauthorized access or modifications to subnetworks.</li>
                <li>Ensure subnetworks are configured with appropriate security policies.</li>
            </ul>
        </div>
        <div id="google.compute.TargetHttpProxy">
            <h2>Google Compute Target HTTP Proxy</h2>
            <ul>
                <li>Review the configuration of target HTTP proxies for any unauthorized changes.</li>
                <li>Ensure target HTTP proxies are configured with appropriate security policies.</li>
                <li>Use HTTPS for secure communication between clients and proxies.</li>
            </ul>
        </div>
    </div>

    <div id="dynamic-content" style="display: none;">
        <div id="recommendation-content" style="display: none;">
            <h2>Recommendation</h2>
            <p id="recommendation-content">[Alert.SCC_RECOMMENDATION]</p>
        </div>
        <div id="remediation-content" style="display: none">
            <h2>Remediation</h2>
            <p>[Alert.SCC_REMEDIATION]</p>
        </div>
    </div>
</body>
<script>
    onmessage = evt => {
        for (const [key, value] of Object.entries(evt.data)) {
            document.body.style[key] = value;
        }
    }
    var resourceType = '[Alert.SCC_MISCONFIGURATION_RESOURCE_TYPE]'
    var remediation = '[Alert.SCC_REMEDIATION]'
    var recommendation = '[Alert.SCC_RECOMMENDATION]'


    function showOnlyResource(resourceType) {
        var allDivs = document.querySelectorAll(".container > div");
        var found = false;

        allDivs.forEach(div => {
            if (div.id === resourceType) {
                div.style.display = "block";
                found = true;
            } else {
                div.style.display = "none";
            }
        });

        if (!found) {
            allDivs.forEach(div => div.style.display = "block");
        }
    }

    function showContent(resourceType, remediation, recommendation) {
        var mainContainer = document.getElementById("main-container");
        var dynamicContent = document.getElementById("dynamic-content");
        var recommendationElement = document.getElementById("recommendation-content");
        var remediationElement = document.getElementById("remediation-content");



        if ((remediation!== "" && !remediation.startsWith("[Alert.SCC_REMEDIATION")) || (recommendation!=="" && !recommendation.startsWith("[Alert.SCC_RECOMMENDATION"))) {
            mainContainer.style.display = "none";
            dynamicContent.style.display ="block"
            if (remediation!== "" && !remediation.startsWith("[Alert.SCC_REMEDIATION")) { remediationElement.style.display = "block" }

            if (recommendation!=="" && !recommendation.startsWith("[Alert.SCC_RECOMMENDATION")) { recommendationElement.style.display = "block" }
        }
        else {
            mainContainer.style.display = "block";
            dynamicContent.style.display = "none";
            showOnlyResource(resourceType);
        }
    }

    showContent(resourceType, remediation, recommendation);


</script>

</html>