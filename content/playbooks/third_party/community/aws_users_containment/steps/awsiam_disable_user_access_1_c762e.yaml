name: AWSIAM_Disable User Access
description: Disable User Access in AWS by adding an explicit deny inline policy.
  Action works with SOAR User entity type.
identifier: c762e18a-ff1b-4ca0-8006-7c246c139501
original_step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
parent_step_ids:
- 6165f56b-1322-43d7-aff6-b43680bee607
parent_step_id: 6165f56b-1322-43d7-aff6-b43680bee607
instance_name: AWSIAM_Disable User Access_1
is_automatic: true
is_skippable: false
action_provider: Scripts
start_loop_step_id: null
parameters:
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: AssignedUsers
  value: null
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: AsyncActionTimeout
  value: '86400'
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: AsyncPollingInterval
  value: '3600'
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: DynamicInjectionInstancePlaceholder
  value: ''
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: FallbackIntegrationInstance
  value: null
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: FetchInstanceByName
  value: 'false'
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: HasApprovalLink
  value: null
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: IntegrationInstance
  value: AutomaticEnvironment
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: MessageToAssignee
  value: null
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: PendingActionTimeout
  value: null
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: ScriptName
  value: AWSIAM_Disable User Access
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: ScriptParametersEntityFields
  value: '{}'
- step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  name: SelectedScopeName
  value: AWS User Filter.SelectedEntities
action_name: AWSIAM_Disable User Access
parallel_actions: [ ]
integration: AWSIAM
parent_container_id: null
is_touched_by_ai: false
is_debug_mock_data: false
step_debug_data:
  step_id: c762e18a-ff1b-4ca0-8006-7c246c139501
  playbook_id: 1c413688-dc98-42a3-a294-607314ec4ef0
  creation_time: 0
  modification_time: 0
  result_value: 'true'
  result_json: '[{"Entity":"username","EntityResult":"Successfully added to the
        user the deny policy \"DisableUserAccessPolicy\"."},{"Entity":"arn:aws:iam::123456789012:user/division_abc/subdivision_xyz/Username","EntityResult":"Successfully
        added to the user the deny policy \"DisableUserAccessPolicy\"."},{"Entity":"NoARealUserName","EntityResult":"Failed
        to add the user to the deny policy \"DisableUserAccessPolicy\"."}]'
  scope_entities_enrichment_data: [ ]
auto_skip_on_failure: false
previous_result_condition: "{\n  \"6165f56b-1322-43d7-aff6-b43680bee607\": \"1\"\n\
    }"
type: action
