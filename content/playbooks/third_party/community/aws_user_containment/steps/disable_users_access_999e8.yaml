name: AWSIAM_Disable User Access
description: Disable User Access in AWS by adding an explicit deny inline policy.
    Action works with SOAR User entity type.
identifier: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
original_step_id: 0890396f-e149-49b0-86f7-f7a99d143ceb
playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
parent_step_ids:
- 2938972c-7a0a-44d2-b9ed-fd586aa909b8
parent_step_id: 2938972c-7a0a-44d2-b9ed-fd586aa909b8
instance_name: Disable Users Access
is_automatic: false
is_skippable: false
action_provider: Scripts
start_loop_step_id: null
parameters:
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: AssignedUsers
    value: null
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: AsyncActionTimeout
    value: '86400'
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: AsyncPollingInterval
    value: '3600'
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: DynamicInjectionInstancePlaceholder
    value: ''
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: FallbackIntegrationInstance
    value: null
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: FetchInstanceByName
    value: 'false'
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: HasApprovalLink
    value: null
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: IntegrationInstance
    value: AutomaticEnvironment
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: MessageToAssignee
    value: Disable User Access?
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: PendingActionTimeout
    value: null
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: RetryConfiguration
    value: '{"Enabled":false,"IntervalInSeconds":30,"NumberOfRetries":1}'
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: ScriptName
    value: AWSIAM_Disable User Access
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: ScriptParametersEntityFields
    value: '{}'
-   step_id: 999e8ec5-e521-4306-85e2-7d4ecfe6d01c
    playbook_id: 4b4706c3-365c-4465-b8cd-8fbd0d87020f
    name: SelectedScopeName
    value: AWS User Filter.SelectedEntities
action_name: AWSIAM_Disable User Access
parallel_actions: []
integration: AWSIAM
parent_container_id: null
is_touched_by_ai: false
is_debug_mock_data: false
step_debug_data:
    step_id: 0890396f-e149-49b0-86f7-f7a99d143ceb
    playbook_id: e2474915-1440-471d-91b2-b31c9feec467
    creation_time: 0
    modification_time: 0
    result_value: 'true'
    result_json: '[{"Entity":"username","EntityResult":"Successfully added to the
        user the deny policy \"DisableUserAccessPolicy\"."},{"Entity":"arn:aws:iam::123456789012:user/division_abc/subdivision_xyz/Username","EntityResult":"Successfully
        added to the user the deny policy \"DisableUserAccessPolicy\"."},{"Entity":"NoARealUserName","EntityResult":"Failed
        to add the user to the deny policy \"DisableUserAccessPolicy\"."}]'
    scope_entities_enrichment_data: []
auto_skip_on_failure: false
previous_result_condition: "{\n  \"2938972c-7a0a-44d2-b9ed-fd586aa909b8\": \"1\"\n\
    }"
type: action
