name: GoogleChronicle_Get Detection Details
description: Fetch information about a detection in Google Chronicle.
identifier: 0c2127fc-7bd0-4477-a44b-dcefd5612825
original_step_id: ff701f2b-c2b2-4fe0-92de-ccae7e7ebb97
playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
parent_step_ids:
- c6494dd3-3720-4334-b3ca-7bd0d9d96d43
parent_step_id: c6494dd3-3720-4334-b3ca-7bd0d9d96d43
instance_name: SIEM Get Detection Details
is_automatic: true
is_skippable: false
action_provider: Scripts
start_loop_step_id: null
parameters:
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: AssignedUsers
    value: null
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: AsyncActionTimeout
    value: '86400'
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: AsyncPollingInterval
    value: '3600'
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: DynamicInjectionInstancePlaceholder
    value: ''
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: FallbackIntegrationInstance
    value: null
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: FetchInstanceByName
    value: 'false'
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: HasApprovalLink
    value: null
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: IntegrationInstance
    value: AutomaticEnvironment
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: MessageToAssignee
    value: null
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: PendingActionTimeout
    value: null
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: ScriptName
    value: GoogleChronicle_Get Detection Details
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: ScriptParametersEntityFields
    value: '{"Rule ID":"[Event.detection_1_ruleId]","Detection ID":"[Event.id]"}'
-   step_id: 0c2127fc-7bd0-4477-a44b-dcefd5612825
    playbook_id: 458d1ba8-4947-4a06-86ca-45d39f59d6ae
    name: SelectedScopeName
    value: All entities
action_name: GoogleChronicle_Get Detection Details
parallel_actions: []
integration: GoogleChronicle
parent_container_id: null
is_touched_by_ai: false
is_debug_mock_data: false
step_debug_data:
    step_id: ff701f2b-c2b2-4fe0-92de-ccae7e7ebb97
    playbook_id: 4f33002e-9ea7-48ea-9c89-0754f80dfe2f
    creation_time: 0
    modification_time: 0
    result_value: 'true'
    result_json: "{\n  \"type\": \"GCTI_FINDING\",\n  \"detection\": [\n    {\n  \
        \    \"ruleName\": \"SCC: Execution: Cryptocurrency Mining YARA Rule\",\n\
        \      \"summary\": \"Rule Detection\",\n      \"description\": \"Alert detecting\
        \ Cryptocurrency miners on GCE instances\",\n      \"severity\": \"HIGH\"\
        ,\n      \"urlBackToProduct\": \"https://gglwl.backstory.chronicle.security/alert?alertId=de_535d32b0-334b-37b7-dc97-0f1e5559c6d7\"\
        ,\n      \"ruleId\": \"ur_e6ad17dd-38ce-4854-aaed-1f3d16818718\",\n      \"\
        alertState\": \"ALERTING\",\n      \"ruleType\": \"SINGLE_EVENT\",\n     \
        \ \"detectionFields\": [\n        {\n          \"key\": \"resource_name\"\
        ,\n          \"value\": \"//compute.googleapis.com/projects/nexus-lab-401713/zones/europe-west2-a/instances/8892788647741401780\"\
        ,\n          \"source\": \"udm.target.resource.name\"\n        }\n      ],\n\
        \      \"ruleLabels\": [\n        {\n          \"key\": \"reference\",\n \
        \         \"value\": \"https://cloud.google.com/security-command-center/docs/how-to-investigate-threats\"\
        \n        },\n        {\n          \"key\": \"rule_name\",\n          \"value\"\
        : \"SCC: Execution: Cryptocurrency Mining YARA Rule\"\n        }\n      ],\n\
        \      \"outcomes\": [\n        {\n          \"key\": \"risk_score\",\n  \
        \        \"value\": \"85\"\n        },\n        {\n          \"key\": \"event_count\"\
        ,\n          \"value\": \"2\"\n        },\n        {\n          \"key\": \"\
        vendor_name\",\n          \"value\": \"Google\"\n        },\n        {\n \
        \         \"key\": \"product_name\",\n          \"value\": \"Security Command\
        \ Center\"\n        },\n        {\n          \"key\": \"yara_rules_fired\"\
        ,\n          \"value\": \"YARA_RULE9\"\n        },\n        {\n          \"\
        key\": \"num_distinct_yara_rules_fired\",\n          \"value\": \"1\"\n  \
        \      },\n        {\n          \"key\": \"cloud_projects\",\n          \"\
        value\": \"nexus-lab-401713, \"\n        }\n      ],\n      \"ruleSet\": \"\
        bdaffc97-50cb-b329-97b3-c3664abdc0f2\",\n      \"ruleSetDisplayName\": \"\
        CDIR SCC Enhanced Execution Alerts\",\n      \"riskScore\": 85\n    }\n  ],\n\
        \  \"createdTime\": \"2024-03-12T13:25:50.907239Z\",\n  \"lastUpdatedTime\"\
        : \"2024-03-12T13:25:50.907239Z\",\n  \"id\": \"de_535d32b0-334b-37b7-dc97-0f1e5559c6d7\"\
        ,\n  \"timeWindow\": {\n    \"startTime\": \"2024-03-12T12:02:00Z\",\n   \
        \ \"endTime\": \"2024-03-12T12:12:00Z\"\n  },\n  \"collectionElements\": [\n\
        \    {\n      \"references\": [\n        {\n          \"event\": {\n     \
        \       \"metadata\": {\n              \"productLogId\": \"84fbcc62079e1a58f1ea5d7c8c200782\"\
        ,\n              \"eventTimestamp\": \"2024-03-12T12:11:55.129610471Z\",\n\
        \              \"eventType\": \"GENERIC_EVENT\",\n              \"vendorName\"\
        : \"Google\",\n              \"productName\": \"Security Command Center\"\
        ,\n              \"productEventType\": \"Execution: Cryptocurrency Mining\
        \ YARA Rule\",\n              \"description\": \"Virtual Machine Threat Detection\"\
        ,\n              \"ingestedTimestamp\": \"2024-03-12T12:17:13.721618Z\",\n\
        \              \"id\": \"AAAAABl8DCpkHyJGZb0jZ/asxZ8AAAAAFAAAAAAAAAA=\",\n\
        \              \"logType\": \"GCP_SECURITYCENTER_THREAT\",\n             \
        \ \"baseLabels\": {\n                \"logTypes\": [\n                  \"\
        GCP_SECURITYCENTER_THREAT\"\n                ],\n                \"allowScopedAccess\"\
        : true\n              }\n            },\n            \"principal\": {\n  \
        \            \"asset\": {\n                \"productObjectId\": \"8892788647741401780\"\
        ,\n                \"location\": {\n                  \"name\": \"europe-west2\"\
        \n                },\n                \"attribute\": {\n                 \
        \ \"cloud\": {\n                    \"availabilityZone\": \"europe-west2-a\"\
        \n                  },\n                  \"labels\": [\n                \
        \    {\n                      \"key\": \"project_name\",\n               \
        \       \"value\": \"nexus-lab-401713\"\n                    }\n         \
        \         ]\n                }\n              }\n            },\n        \
        \    \"target\": {\n              \"resource\": {\n                \"name\"\
        : \"//compute.googleapis.com/projects/nexus-lab-401713/zones/europe-west2-a/instances/8892788647741401780\"\
        ,\n                \"attribute\": {\n                  \"labels\": [\n   \
        \                 {\n                      \"key\": \"finding_id\",\n    \
        \                  \"value\": \"84fbcc62079e1a58f1ea5d7c8c200782\"\n     \
        \               },\n                    {\n                      \"key\":\
        \ \"source_id\",\n                      \"value\": \"6731089865139895350\"\
        \n                    }\n                  ]\n                },\n       \
        \         \"productObjectId\": \"6731089865139895350\"\n              },\n\
        \              \"resourceAncestors\": [\n                {\n             \
        \     \"name\": \"organizations/971363459032/sources/6731089865139895350\"\
        \n                },\n                {\n                  \"name\": \"nexus-lab-401713\"\
        ,\n                  \"resourceType\": \"CLOUD_PROJECT\"\n               \
        \ }\n              ]\n            },\n            \"securityResult\": [\n\
        \              {\n                \"about\": {\n                  \"user\"\
        : {\n                    \"emailAddresses\": [\n                      \"admin@olivierba.altostrat.com\"\
        \n                    ],\n                    \"attribute\": {\n         \
        \             \"roles\": [\n                        {\n                  \
        \        \"name\": \"Security\"\n                        }\n             \
        \         ]\n                    }\n                  }\n                }\n\
        \              },\n              {\n                \"categoryDetails\": [\n\
        \                  \"THREAT\"\n                ],\n                \"severity\"\
        : \"LOW\",\n                \"urlBackToProduct\": \"https://console.cloud.google.com/security/command-center/findingsv2;name=organizations%2F971363459032%2Fsources%2F6731089865139895350%2Ffindings%2F84fbcc62079e1a58f1ea5d7c8c200782\"\
        ,\n                \"alertState\": \"ALERTING\",\n                \"detectionFields\"\
        : [\n                  {\n                    \"key\": \"mute\",\n       \
        \             \"value\": \"UNDEFINED\"\n                  },\n           \
        \       {\n                    \"key\": \"primary_tactic\",\n            \
        \        \"value\": \"EXECUTION\"\n                  },\n                \
        \  {\n                    \"key\": \"mitreAttack_version\",\n            \
        \        \"value\": \"9\"\n                  },\n                  {\n   \
        \                 \"key\": \"indicator_signatures_yaraRuleSignature_yararule\"\
        ,\n                    \"value\": \"YARA_RULE9\"\n                  },\n \
        \                 {\n                    \"key\": \"indicator_signatures_yaraRuleSignature_yararule\"\
        ,\n                    \"value\": \"YARA_RULE10\"\n                  },\n\
        \                  {\n                    \"key\": \"indicator_signatures_yaraRuleSignature_yararule\"\
        ,\n                    \"value\": \"YARA_RULE25\"\n                  },\n\
        \                  {\n                    \"key\": \"securityMarks_name\"\
        ,\n                    \"value\": \"organizations/971363459032/sources/6731089865139895350/findings/84fbcc62079e1a58f1ea5d7c8c200782/securityMarks\"\
        \n                  },\n                  {\n                    \"key\":\
        \ \"createTime\",\n                    \"value\": \"2024-03-12T00:17:02.367Z\"\
        \n                  },\n                  {\n                    \"key\":\
        \ \"state\",\n                    \"value\": \"ACTIVE\"\n                \
        \  }\n                ]\n              }\n            ],\n            \"extracted\"\
        : {\n              \"indicator.signatures[0].signatureType\": \"SIGNATURE_TYPE_PROCESS\"\
        ,\n              \"resourceName\": \"//compute.googleapis.com/projects/nexus-lab-401713/zones/europe-west2-a/instances/8892788647741401780\"\
        ,\n              \"canonicalName\": \"projects/429213313266/sources/6731089865139895350/findings/84fbcc62079e1a58f1ea5d7c8c200782\"\
        ,\n              \"name\": \"organizations/971363459032/sources/6731089865139895350/findings/84fbcc62079e1a58f1ea5d7c8c200782\"\
        ,\n              \"parentDisplayName\": \"Virtual Machine Threat Detection\"\
        ,\n              \"indicator.signatures[1].yaraRuleSignature.yaraRule\": \"\
        YARA_RULE10\",\n              \"category\": \"Execution: Cryptocurrency Mining\
        \ YARA Rule\",\n              \"mitreAttack.version\": \"9\",\n          \
        \    \"state\": \"ACTIVE\",\n              \"mitreAttack.primaryTactic\":\
        \ \"EXECUTION\",\n              \"indicator.signatures[2].yaraRuleSignature.yaraRule\"\
        : \"YARA_RULE25\",\n              \"securityMarks.name\": \"organizations/971363459032/sources/6731089865139895350/findings/84fbcc62079e1a58f1ea5d7c8c200782/securityMarks\"\
        ,\n              \"eventTime\": \"2024-03-12T12:11:55.129610471Z\",\n    \
        \          \"indicator.signatures[1].signatureType\": \"SIGNATURE_TYPE_PROCESS\"\
        ,\n              \"contacts.security.contacts[0].email\": \"admin@olivierba.altostrat.com\"\
        ,\n              \"indicator.signatures[0].yaraRuleSignature.yaraRule\": \"\
        YARA_RULE9\",\n              \"mute\": \"UNDEFINED\",\n              \"indicator.signatures[2].signatureType\"\
        : \"SIGNATURE_TYPE_PROCESS\",\n              \"findingClass\": \"THREAT\"\
        ,\n              \"parent\": \"organizations/971363459032/sources/6731089865139895350\"\
        ,\n              \"severity\": \"LOW\",\n              \"createTime\": \"\
        2024-03-12T00:17:02.367Z\"\n            }\n          }\n        }\n      ],\n\
        \      \"label\": \"e\"\n    }\n  ],\n  \"detectionTime\": \"2024-03-12T12:12:00Z\"\
        ,\n  \"tags\": [\n    \"TA0040\",\n    \"T1496\"\n  ]\n}"
    scope_entities_enrichment_data: []
auto_skip_on_failure: true
previous_result_condition: '{}'
type: action
