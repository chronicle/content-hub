{
  "CategoryName": "Blocks Common",
  "OverviewTemplatesDetails": [],
  "WidgetTemplates": [],
  "Definition": {
    "Identifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
    "IsEnable": true,
    "Version": 0.0,
    "IsArchived": false,
    "IsAutomatic": true,
    "Name": "MITRE Enrichment",
    "Category": 5,
    "Description": "An embedded workflow that can receive inputs and return an output.",
    "Priority": 2,
    "Creator": "e22b1df1-d620-4af5-ba42-d29e1b73bfe9",
    "VersionCreator": null,
    "VersionComment": null,
    "OriginalWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
    "TemplateName": null,
    "PlaybookType": 1,
    "IsDebugMode": false,
    "DebugBaseAlertIdentifier": null,
    "DebugAlertIdentifier": null,
    "SimulationClone": false,
    "DefaultAccessLevel": 2,
    "CreationSource": 1,
    "Steps": [
      {
        "Identifier": "24174aa0-315d-4707-af91-63dfec3dc449",
        "OriginalStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
        "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
        "ParentStepIdentifiers": [],
        "ParentStepIdentifier": "",
        "PreviousResultCondition": null,
        "InstanceName": "Mitre Techniques Details",
        "IsAutomatic": true,
        "Name": "MitreAttck_Get Techniques Details",
        "IsSkippable": false,
        "Description": "Retrieve detailed information about MITRE attack techniques.",
        "ActionProvider": "Scripts",
        "ActionName": "MitreAttck_Get Techniques Details",
        "Type": 0,
        "Integration": "MitreAttck",
        "Parameters": [
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "AsyncActionTimeout",
            "Value": "86400"
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "AsyncPollingInterval",
            "Value": "3600"
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "FetchInstanceByName",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "ScriptName",
            "Value": "MitreAttck_Get Techniques Details"
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "ScriptParametersEntityFields",
            "Value": "{\"Technique Identifier\":\"[Entity.Identifier]\",\"Identifier Type\":\"External ID\"}"
          },
          {
            "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "SelectedScopeName",
            "Value": "All threat signatures entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": true,
        "StepDebugData": {
          "CreationTimeUnixTimeInMs": 0,
          "ModificationTimeUnixTimeInMs": 0,
          "OriginalWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
          "OriginalStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
          "ResultValue": "true",
          "ResultJson": "[\n  {\n    \"Entity\": \"course-of-action--4f170666-7edb-4489-85c2-9affa28a72e0\",\n    \"EntityResult\": {\n      \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\",\n      \"external_references\": [\n        {\n          \"url\": \"https://attack.mitre.org/techniques/T1022\",\n          \"external_id\": \"T1022\",\n          \"source_name\": \"mitre-attack\"\n        },\n        {\n          \"url\": \"http://www.netsec.colostate.edu/~zhang/DetectingEncryptedBotnetTraffic.pdf\",\n          \"source_name\": \"Zhang 2013\",\n          \"description\": \"Zhang, H., Papadopoulos, C., & Massey, D. (2013, April). Detecting encrypted botnet traffic. Retrieved August 19, 2015.\"\n        },\n        {\n          \"url\": \"https://en.wikipedia.org/wiki/List_of_file_signatures\",\n          \"source_name\": \"Wikipedia File Header Signatures\",\n          \"description\": \"Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016.\"\n        }\n      ],\n      \"created\": \"2017-05-31T21:30:30.26Z\",\n      \"x_mitre_platforms\": [\n        \"Linux\",\n        \"macOS\",\n        \"Windows\"\n      ],\n      \"type\": \"attack-pattern\",\n      \"description\": \"Data is encrypted before being exfiltrated in order to hide the information that is being exfiltrated from detection or to make the exfiltration less conspicuous upon inspection by a defender. The encryption is performed by a utility, programming library, or custom algorithm on the data itself and is considered separate from any encryption performed by the command and control or file transfer protocol. Common file archive formats that can encrypt files are RAR and zip.\\n\\nOther exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over Command and Control Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)\",\n      \"kill_chain_phases\": [\n        {\n          \"phase_name\": \"exfiltration\",\n          \"kill_chain_name\": \"mitre-attack\"\n        }\n      ],\n      \"modified\": \"2018-10-17T00:14:20.652Z\",\n      \"id\": \"attack-pattern--d54416bd-0803-41ca-870a-ce1af7c05638\",\n      \"object_marking_refs\": [\n        \"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"\n      ],\n      \"x_mitre_network_requirements\": false,\n      \"x_mitre_version\": \"1.0\",\n      \"x_mitre_data_sources\": [\n        \"File monitoring\",\n        \"Process monitoring\",\n        \"Process command-line parameters\",\n        \"Binary file metadata\"\n      ],\n      \"x_mitre_detection\": \"Encryption software and encrypted files can be detected in many ways. Common utilities that may be present on the system or brought in by an adversary may be detectable through process monitoring and monitoring for command-line arguments for known encryption utilities. This may yield a significant amount of benign events, depending on how systems in the environment are typically used. Often the encryption key is stated within command-line invocation of the software. \\n\\nA process that loads the Windows DLL crypt32.dll may be used to perform encryption, decryption, or verification of file signatures. \\n\\nNetwork traffic may also be analyzed for entropy to determine if encrypted data is being transmitted. (Citation: Zhang 2013) If the communications channel is unencrypted, encrypted files of known file types can be detected in transit during exfiltration with a network intrusion detection or data loss prevention system analyzing file headers. (Citation: Wikipedia File Header Signatures)\",\n      \"name\": \"Data Encrypted\"\n    }\n  }\n]",
          "ScopeEntitiesEnrichmentData": [],
          "ScopeEntitiesEnrichmentDataJson": "[]"
        },
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "842c9390-5c3f-46de-ba7c-9ae183cc8a9f",
        "OriginalStepIdentifier": "842c9390-5c3f-46de-ba7c-9ae183cc8a9f",
        "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
        "ParentStepIdentifiers": [
          "c51a16ab-3776-4131-b6cf-9bce494448da"
        ],
        "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
        "PreviousResultCondition": "{}",
        "InstanceName": "Output_1",
        "IsAutomatic": true,
        "Name": "Output",
        "IsSkippable": false,
        "Description": "",
        "ActionProvider": "Flow",
        "ActionName": "OutputAction",
        "Type": 6,
        "Integration": "Flow",
        "Parameters": [
          {
            "ParentStepIdentifier": "842c9390-5c3f-46de-ba7c-9ae183cc8a9f",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "NestedWorkflowOutput",
            "Value": null
          }
        ],
        "AutoSkipOnFailure": false,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
        "OriginalStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
        "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
        "ParentStepIdentifiers": [
          "24174aa0-315d-4707-af91-63dfec3dc449"
        ],
        "ParentStepIdentifier": "24174aa0-315d-4707-af91-63dfec3dc449",
        "PreviousResultCondition": "{}",
        "InstanceName": "Mitre Techniques Mitigations",
        "IsAutomatic": true,
        "Name": "MitreAttck_Get Techniques Mitigations",
        "IsSkippable": false,
        "Description": "Retrieve information about mitigations that are associated with MITRE attack techniques.",
        "ActionProvider": "Scripts",
        "ActionName": "MitreAttck_Get Techniques Mitigations",
        "Type": 0,
        "Integration": "MitreAttck",
        "Parameters": [
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "AsyncActionTimeout",
            "Value": "86400"
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "AsyncPollingInterval",
            "Value": "3600"
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "FetchInstanceByName",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "ScriptName",
            "Value": "MitreAttck_Get Techniques Mitigations"
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "ScriptParametersEntityFields",
            "Value": "{\"Technique ID\":\"[Entity.Identifier]\",\"Identifier Type\":\"External Attack ID\",\"Max Mitigations to Return\":\"20\"}"
          },
          {
            "ParentStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
            "ParentWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
            "Name": "SelectedScopeName",
            "Value": "All threat signatures entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": true,
        "StepDebugData": {
          "CreationTimeUnixTimeInMs": 0,
          "ModificationTimeUnixTimeInMs": 0,
          "OriginalWorkflowIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
          "OriginalStepIdentifier": "c51a16ab-3776-4131-b6cf-9bce494448da",
          "ResultValue": "true",
          "ResultJson": "[\n  {\n    \"Entity\": \"course-of-action--4f170666-7edb-4489-85c2-9affa28a72e0\",\n    \"EntityResult\": {\n      \"mitigations\": [\n        {\n          \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\",\n          \"description\": \"Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to encrypt files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\",\n          \"created\": \"2018-10-17T00:14:20.652Z\",\n          \"x_mitre_deprecated\": true,\n          \"modified\": \"2019-07-24T14:26:14.411Z\",\n          \"object_marking_refs\": [\n            \"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"\n          ],\n          \"external_references\": [\n            {\n              \"url\": \"https://attack.mitre.org/mitigations/T1022\",\n              \"source_name\": \"mitre-attack\",\n              \"external_id\": \"T1022\"\n            },\n            {\n              \"url\": \"http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599\",\n              \"source_name\": \"Beechey 2010\",\n              \"description\": \"Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.\"\n            },\n            {\n              \"url\": \"http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html\",\n              \"source_name\": \"Windows Commands JPCERT\",\n              \"description\": \"Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.\"\n            },\n            {\n              \"url\": \"https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm\",\n              \"source_name\": \"NSA MS AppLocker\",\n              \"description\": \"NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.\"\n            },\n            {\n              \"url\": \"http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx\",\n              \"source_name\": \"Corio 2008\",\n              \"description\": \"Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.\"\n            },\n            {\n              \"url\": \"https://technet.microsoft.com/en-us/library/ee791851.aspx\",\n              \"source_name\": \"TechNet Applocker vs SRP\",\n              \"description\": \"Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.\"\n            }\n          ],\n          \"x_mitre_version\": \"1.0\",\n          \"type\": \"course-of-action\",\n          \"id\": \"course-of-action--2a8de25c-f743-4348-b101-3ee33ab5871b\",\n          \"name\": \"Data Encrypted Mitigation\"\n        }\n      ]\n    }\n  }\n]",
          "ScopeEntitiesEnrichmentData": [],
          "ScopeEntitiesEnrichmentDataJson": "[]"
        },
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      }
    ],
    "Triggers": [
      {
        "Identifier": "4dd425a3-d3e4-4cd6-8721-9681f18f3572",
        "IsEnabled": true,
        "DefinitionIdentifier": "2b2fa1d7-155f-4d48-bc63-86829ec432f9",
        "Type": 11,
        "WorkflowName": null,
        "LogicalOperator": 0,
        "Conditions": [],
        "Environments": [
          "*"
        ]
      }
    ],
    "OverviewTemplates": [],
    "Permissions": [],
    "Environments": [
      "*"
    ]
  }
}