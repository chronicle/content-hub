Entity Insight:
  ai_description: "This action transforms a provided JSON object into human-readable\
    \ Entity Insights using Jinja2 templates. It allows for dynamic data presentation\
    \ within the Google SecOps platform by mapping external data to specific entities.\
    \ The action supports custom Jinja filters for advanced data manipulation, such\
    \ as date formatting, priority mapping, and JSON-to-HTML table conversion.\n\n\
    ### Parameters\n| Parameter | Type | Mandatory | Description |\n| :--- | :---\
    \ | :--- | :--- |\n| JSON Object | JSON | Yes | The raw JSON object containing\
    \ the data to be rendered. It must follow the EntityResult format where data is\
    \ keyed by entity identifiers. |\n| Template | String | Yes | The Jinja2 template\
    \ used to render the insight. This can include HTML and logic for data display.\
    \ |\n| Triggered By | String | Yes | The name of the integration or process that\
    \ triggered this insight (e.g., 'VirusTotal', 'Active Directory'). |\n| Remove\
    \ BRs | Boolean | No | If enabled (true), all `<br>` tags will be stripped from\
    \ the rendered template output. Default is false. |\n| Create Insight | Boolean\
    \ | No | If enabled (true), the action will create a formal Entity Insight in\
    \ the SOAR case. Default is true. |\n\n### Flow Description\n1. **Initialization**:\
    \ The action extracts input parameters and initializes a Jinja2 environment, loading\
    \ both standard and custom filters (e.g., `json2tbl`, `filter_datetime`).\n2.\
    \ **Entity Pre-processing**: It iterates through the target entities in the current\
    \ context, excluding any entities identified as type 'ALERT' via their additional\
    \ properties.\n3. **Data Mapping**: For each valid entity, the action searches\
    \ the input `JSON Object` for a matching entry based on the entity's identifier.\n\
    4. **Template Rendering**: If a match is found, the action combines the entity's\
    \ properties with the result data and renders the provided Jinja2 template.\n\
    5. **Internal Mutation**: \n    - The rendered content is attached to the entity\
    \ as a JSON result.\n    - If `Create Insight` is enabled, the action calls the\
    \ SOAR API to generate a visible Entity Insight using the rendered text and the\
    \ specified 'Triggered By' identifier.\n6. **Completion**: The action returns\
    \ a summary of the rendered templates and completes the execution."
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates entity insights and attaches JSON results to entities within the Google
      SecOps case based on the rendered Jinja2 template.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Verifies the connectivity between Google SecOps and the TemplateEngine integration.
    This action serves as a health check to ensure that the integration is correctly
    configured and that the SOAR platform can successfully execute actions within
    this integration context.


    ### Parameters Description

    There are no parameters for this action.


    ### Flow Description

    1. **Initialization**: The action initializes the SiemplifyAction module to interface
    with the Google SecOps environment.

    2. **Connectivity Confirmation**: The action immediately terminates with a success
    status and a message confirming that 'Siemplify is connected'.


    ### Additional Notes

    This is a standard diagnostic action. It does not interact with any external APIs,
    process any entities, or modify any data within the case.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Render Template:
  ai_description: >-
    ### General Description

    The **Render Template** action is a utility designed to generate formatted text
    or HTML by applying a Jinja2 template to a set of data. It allows users to transform
    raw JSON data into human-readable formats, which is particularly useful for creating
    custom email notifications, reports, or case wall summaries within a playbook
    flow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **JSON Object** | JSON Object | No | The raw JSON data used as the primary context
    for the template. This data is accessible within the Jinja template via the `input_json`
    variable. Defaults to `{}`. |

    | **Jinja** | Code | No | The Jinja2 template code to be rendered. If provided,
    this value takes precedence over the 'Template' parameter. |

    | **Include Case Data** | Boolean | No | When enabled, the action automatically
    injects the current alert's security events and target entities into the template
    context under the keys `SiemplifyEvents` and `SiemplifyEntities` respectively.
    |

    | **Template** | Email Content | No | An alternative way to provide the Jinja2
    template, typically used to select pre-defined HTML templates from the environment's
    global settings. |


    ### Flow Description

    1. **Data Collection**: The action retrieves all security events and target entities
    associated with the current alert context.

    2. **Parameter Extraction**: It extracts the input JSON, the template code (either
    from the 'Jinja' or 'Template' parameter), and the case data inclusion flag.

    3. **Environment Initialization**: A Jinja2 environment is initialized with specific
    extensions (`do`, `loopcontrols`) and a comprehensive suite of custom filters
    (e.g., `json2tbl`, `regex_match`, `filter_datetime`, `to_nice_json`) to facilitate
    complex data manipulation.

    4. **Context Preparation**: If 'Include Case Data' is set to true, the collected
    events and entities are merged into the input data context.

    5. **Template Rendering**: The Jinja2 engine renders the template using the prepared
    data context. If the input JSON is a list, the action iterates through the list
    and appends the rendered results.

    6. **Output Generation**: The final rendered string is returned as a JSON result
    under the key `html_output` and set as the action's result value.


    ### Additional Notes

    - **Template Priority**: The 'Jinja' parameter (raw code) always overrides the
    'Template' parameter (environment template).

    - **Data Discrepancy**: Note that while the configuration metadata sets the default
    for 'Include Case Data' to `false`, the underlying script logic defaults it to
    `true` if not explicitly provided.

    - **Custom Filters**: The action supports a wide range of filters for formatting
    dates, converting JSON to HTML tables, and performing regex operations, which
    are defined in the `JinjaFilters` module.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Render Template from Array:
  ai_description: >-
    ### General Description

    This utility action transforms a list of data objects into a single formatted
    string (such as HTML, Markdown, or plain text) by applying a Jinja2 template to
    each item in the list. It is part of the TemplateEngine integration and is designed
    to facilitate the generation of reports, tables, or formatted logs from structured
    JSON arrays produced by previous playbook steps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Array input** | Content | No | A JSON string representing an array of objects
    to be processed. If a single object is provided, it will be treated as a list
    with one item. Defaults to an empty list. |

    | **Jinja** | Code | No | The Jinja2 template code used to render each item. The
    current item is accessible within the template as `row` or via its keys directly.
    |

    | **join** | String | No | The character or string used to join the rendered output
    of each list item (e.g., a comma, newline, or HTML break). |

    | **prefix** | String | No | A string to be prepended to the final concatenated
    result. |

    | **suffix** | String | No | A string to be appended to the final concatenated
    result. |


    ### Additional Notes

    - The action includes a robust set of custom Jinja filters including `json2tbl`
    (converts JSON to HTML tables), `regex_match`, `filter_datetime`, and `to_nice_json`.

    - It supports the use of `|safe` in the Jinja template to prevent HTML escaping
    of the output.

    - If the `Array input` is not a valid JSON list, the action will attempt to wrap
    the input in a list before processing.


    ### Flow Description

    1. **Initialization**: Extracts the input parameters and initializes the Jinja2
    environment.

    2. **Filter Loading**: Loads a comprehensive suite of built-in filters (e.g.,
    date formatting, regex, JSON transformation) and attempts to load optional custom
    filters.

    3. **Data Parsing**: Parses the `Array input` JSON string into a Python list.

    4. **Template Rendering**: Iterates through each item in the list, applying the
    provided Jinja template to each item individually.

    5. **Aggregation**: Concatenates the rendered strings using the specified `join`
    character and applies the `prefix` and `suffix` strings.

    6. **Output**: Returns the final rendered string as the action result and provides
    it in a JSON object under the key `html_output`.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
