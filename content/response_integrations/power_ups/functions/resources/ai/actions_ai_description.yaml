Calculate Timestamp:
  ai_description: >-
    The **Calculate Timestamp** action allows users to derive new timestamps by adding
    or subtracting specific time intervals (deltas) from a designated baseline time.
    It supports multiple starting points including the current system time, the creation
    time of the active alert or case, or a manually provided custom timestamp.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Input Type** | DDL | No | Defines the baseline time. Options: `Current Time`,
    `Alert Creation Time`, `Case Creation Time`, `Custom Timestamp`. Defaults to `Current
    Time`. |

    | **Custom Timestamp** | String | No | The baseline value to use if `Input Type`
    is set to `Custom Timestamp`. Supports ISO formats, epoch (seconds), and epoch
    milliseconds (13 digits). |

    | **Custom Timestamp Format** | String | No | The format used to parse the `Custom
    Timestamp`. If empty, the action attempts to auto-detect the format or treats
    it as epoch. |

    | **Timestamp Delta** | String | No | A comma-separated list of offsets (e.g.,
    `+30M`, `-1H`, `+1d`). Supported units: `m` (months), `d` (days), `H` (hours),
    `M` (minutes), `S` (seconds). |

    | **Output Timestamp Format** | String | No | The format for the result. Use `epoch`
    for Unix time or a standard format string (e.g., `%Y-%m-%d`). Defaults to `epoch`.
    |


    ### Additional Notes

    - If `Input Type` is set to `Custom Timestamp`, the **Custom Timestamp** parameter
    must be populated.

    - Multiple deltas can be processed simultaneously, and each result will be returned
    in the JSON output under a unique key corresponding to the delta.


    ### Flow Description

    1.  **Extraction**: Retrieve user inputs for baseline type, custom values, formats,
    and time offsets.

    2.  **Baseline Determination**: Fetch the starting timestamp based on the `Input
    Type`. If using Alert or Case creation times, the action retrieves these from
    the Google SecOps context.

    3.  **Parsing & Validation**: Parse the `Timestamp Delta` string into individual
    operations and validate the syntax (operator, value, and unit).

    4.  **Calculation**: Use the `arrow` library to shift the baseline timestamp by
    the specified deltas.

    5.  **Formatting**: Convert the resulting timestamps into the requested output
    format (either epoch integers or formatted strings).

    6.  **Output**: Provide a JSON object containing the `original_timestamp` and
    a dictionary of `calculated_timestamps`.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Convert Time Format:
  ai_description: "### General Description\nThe **Convert Time Format** action is\
    \ a utility function designed to transform datetime values from one format to\
    \ another. It supports parsing various string representations, including standard\
    \ datetime formats and Unix timestamps (epoch). Additionally, the action allows\
    \ for time shifting (adding or subtracting seconds) and timezone conversion to\
    \ ensure the output matches the required format for downstream processes.\n\n\
    ### Parameters Description\n| Name | Type | Mandatory | Description |\n| :---\
    \ | :--- | :--- | :--- |\n| **Input** | string | True | The input datetime value\
    \ to be converted. If left empty, the action defaults to the current system time.\
    \ Supports strings and epoch timestamps (10 or 13 digits). |\n| **From Format**\
    \ | string | True | The [strftime](https://strftime.org/) format that matches\
    \ the input string. This is used to correctly parse the source data. |\n| **To\
    \ Format** | string | True | The desired [Arrow](https://arrow.readthedocs.io/en/stable/#supported-tokens)\
    \ format for the output value. |\n| **Time Delta In Seconds** | string | True\
    \ | A shift parameter (integer) to adjust the time. Use positive values for the\
    \ future and negative values for the past. Default is \"0\". |\n| **Timezone**\
    \ | string | False | The target timezone for the output (e.g., 'UTC', 'Europe/London',\
    \ 'US/Eastern'). |\n\n### Additional Notes\n- If the **Input** is a numeric string\
    \ of 10 or 13 digits, the action automatically treats it as a Unix timestamp (seconds\
    \ or milliseconds respectively) regardless of the provided **From Format**.\n\
    - The action includes logic to handle specific UTC/GMT offset suffixes if they\
    \ are specified in the **From Format**.\n\n### Flow Description\n1.  **Extraction**:\
    \ The action retrieves the input string, source format, target format, time shift,\
    \ and timezone parameters.\n2.  **Offset Handling**: It checks if the source format\
    \ includes UTC or GMT indicators and adjusts the internal time delta accordingly.\n\
    3.  **Parsing**: The logic attempts to parse the input string into a datetime\
    \ object using the provided `From Format`. If the input is numeric, it is handled\
    \ as an epoch timestamp. If no input is provided, it uses the current time.\n\
    4.  **Transformation**: \n    - Applies the specified **Time Delta In Seconds**\
    \ to shift the time.\n    - Converts the datetime object to the specified **Timezone**\
    \ if one is provided.\n5.  **Output**: The datetime is formatted using the **To\
    \ Format** and returned as the action result."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Thumbnail:
  ai_description: "### General Description\nThis action creates a Base64-encoded thumbnail\
    \ of an image provided as a Base64 string. It is a utility function designed to\
    \ resize images for better visualization within the Google SecOps platform or\
    \ for more efficient data handling in playbooks. The action can process a single\
    \ image provided directly or multiple images contained within a JSON object.\n\
    \n### Parameters Description\n| Parameter | Type | Mandatory | Description |\n\
    | :--- | :--- | :--- | :--- |\n| Base64 Image | String | No | The Base64 string\
    \ of the image to be resized. Used if 'Input JSON' is not provided. |\n| Thumbnail\
    \ Size | String | Yes | Comma-separated pixel values (X, Y) for the output thumbnail\
    \ (e.g., \"250,250\"). |\n| Input JSON | String | No | A JSON array containing\
    \ image data. If used, the action iterates through the JSON items to process multiple\
    \ images. |\n| Image Key Path | String | No | If using 'Input JSON', this provides\
    \ the dot-notated path to the specific field containing the Base64 image string.\
    \ |\n\n### Additional Notes\n- Either the 'Base64 Image' parameter or the 'Input\
    \ JSON' parameter must be populated for the action to have data to process.\n\
    - The output is formatted as a PNG image, regardless of the input format.\n\n\
    ### Flow Description\n1. **Initialization**: The action parses the 'Thumbnail\
    \ Size' parameter to determine the target dimensions.\n2. **Data Extraction**:\
    \ \n    - If 'Input JSON' is provided, the action parses the JSON and uses the\
    \ 'Image Key Path' to recursively locate the Base64 image data for each entry.\n\
    \    - If 'Input JSON' is not provided, the action uses the 'Base64 Image' parameter\
    \ directly.\n3. **Image Processing**: The action decodes the Base64 string into\
    \ raw image data, uses the Python Imaging Library (PIL) to resize the image to\
    \ the specified dimensions, and then re-encodes the new image into a Base64 PNG\
    \ string.\n4. **Output**: The result is added to the Action's JSON results, mapping\
    \ entity identifiers to their corresponding thumbnails if processed via JSON,\
    \ or providing a single thumbnail data object if processed via the direct parameter."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Defang Text:
  ai_description: >-
    ### General Description

    This utility action defangs input text by sanitizing potentially malicious or
    clickable strings such as URLs, IPv4 addresses, and email addresses. It is commonly
    used in security workflows to ensure that indicators can be safely shared or documented
    without triggering security filters or accidental clicks.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Input | String | No | The raw text string that needs to be defanged. If left
    empty, the action will return an empty result. |


    ### Additional Notes

    - This action is a purely local transformation and does not interact with any
    external APIs or modify the internal state of the SOAR (e.g., entities or insights).

    - It specifically targets standard IPv4 patterns, HTTP/HTTPS URLs, and common
    email address formats.


    ### Flow Description

    1. **Extract Parameters**: The action retrieves the `Input` string provided by
    the user.

    2. **URL Defanging**: Uses regular expressions to identify URLs, replacing `http`
    with `hxxp` and substituting dots in the domain with `[.]`.

    3. **IP Defanging**: Identifies IPv4 addresses and replaces dots with `[.]` (e.g.,
    `1.1.1.1` becomes `1[.]1[.]1[.]1`).

    4. **Email Defanging**: Identifies email addresses, replacing the `@` symbol with
    `[at]` and substituting dots in the domain part with `[.]`.

    5. **Results Output**: Returns the converted text in a JSON result field named
    `converted_text`.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Detect Hash Type:
  ai_description: "### General Description\nThis action identifies the cryptographic\
    \ hash algorithm (e.g., MD5, SHA-1, SHA-256, SHA-512) for provided hash strings\
    \ and FileHash entities. It uses the `hashid` library to perform local identification,\
    \ making it a fast utility for normalizing data before sending it to threat intelligence\
    \ or sandbox services. \n\n### Parameters\n| Parameter | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| Hashes | string | No | A comma-separated\
    \ list of hash strings to be identified. If provided, these will be processed\
    \ alongside any entities in the scope. |\n\n### Flow Description\n1. **Input Parsing**:\
    \ The action retrieves the `Hashes` parameter and splits it into a list if it\
    \ is not empty.\n2. **Manual Hash Identification**: For each string in the input\
    \ list, the action attempts to identify the hash type using the `hashid` library.\
    \ It filters results to ensure they match one of the supported types (SHA-256,\
    \ MD5, SHA-1, SHA-512).\n3. **Entity Processing**: The action iterates through\
    \ all `FILEHASH` entities in the current scope.\n4. **Internal Enrichment**: For\
    \ each `FILEHASH` entity, the action identifies its hash type and updates the\
    \ entity's `additional_properties` with the result (e.g., setting `HashType` to\
    \ 'MD5').\n5. **Completion**: The action updates the entities in Google SecOps,\
    \ creates a JSON result for all identified hashes, and outputs a summary message.\n\
    \n### Additional Notes\n- If a hash cannot be identified as one of the supported\
    \ types, it is labeled as `UNDETECTED`.\n- The action requires at least one input\
    \ (either via the `Hashes` parameter or via entities in the scope) to produce\
    \ meaningful results."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Updates the 'additional_properties' attribute of FILEHASH entities with the
      identified hash type.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
    - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Detect IP Type:
  ai_description: >-
    Detects whether an IP address follows the IPv4 or IPv6 protocol format using internal
    regular expression logic. This action processes both manually provided IP strings
    and IP Address entities within the case, enriching the entities with their detected
    type.


    ### Parameters description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | IP Addresses | String | No | A comma-separated list of IP addresses to be analyzed.
    These values are processed independently of case entities and included in the
    final results. |


    ### Additional notes

    - If no 'IP Addresses' parameter is provided and no 'ADDRESS' entities exist in
    the case scope, the action will finish successfully with an empty result set.

    - This action performs logic locally and does not interact with external reputation
    services.


    ### Flow description

    1. **Input Parsing**: Retrieves the 'IP Addresses' string from parameters and
    splits it into a list.

    2. **Manual IP Processing**: Evaluates each manually provided IP against IPv4
    and IPv6 regex patterns.

    3. **Entity Processing**: Scans the case for entities of type 'ADDRESS'.

    4. **Type Detection**: Matches each entity's identifier against regex patterns
    to determine if it is IPv4, IPv6, or UNDETECTED.

    5. **Internal Enrichment**: Updates the 'additional_properties' of each 'ADDRESS'
    entity with the 'IPType' key.

    6. **Result Generation**: Updates the entities within Google SecOps and returns
    a structured JSON object containing all detected types.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Updates the 'additional_properties' attribute of IP Address entities with a
      detected IPType field.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Extract IOCs:
  ai_description: >-
    ### General Description

    This action parses a provided text string to automatically extract common Indicators
    of Compromise (IOCs), including IPv4 and IPv6 addresses, URLs, Domains, and Email
    addresses. It uses a combination of regular expressions and specialized Python
    libraries (like `urlextract` and `tld`) to identify, clean, and validate the extracted
    data.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Input String | String | Yes | The source text content that the action will scan
    to find and extract IOCs. |


    ### Flow Description

    1. **Input Retrieval:** The action extracts the `Input String` from the user-provided
    parameters.

    2. **URL Discovery:** It utilizes the `URLExtract` library to find potential URLs,
    excluding those that are simply IP addresses or lack a valid structure.

    3. **Domain Extraction:** For every valid URL found, the action determines the
    First Level Domain (FLD) using the `tld` library.

    4. **IP Address Identification:** The action scans the input for IPv4 and IPv6
    patterns using regular expressions and validates them via the `ipaddress` module.
    It filters out generic '::' IPv6 addresses but includes other internal/private
    IPs by default.

    5. **Email Extraction:** It applies a comprehensive regular expression to identify
    and extract email addresses from the text.

    6. **Result Formatting:** All extracted indicators are grouped by type into a
    structured JSON object and a summary message is generated for the action output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
IP to Integer:
  ai_description: >-
    ### General Description

    Converts a single IPv4 address or a comma-separated list of IPv4 addresses into
    their equivalent 32-bit integer (long) format. This utility is primarily used
    for technical data transformation, enabling subnet calculations, IP range comparisons,
    or interfacing with systems that require numerical IP representations.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | IP Addresses | string | Yes | A comma-separated list of IPv4 addresses to be
    converted. The action will strip whitespace and ignore empty entries. |


    ### Flow Description

    1. **Extraction**: The action retrieves the input string from the `IP Addresses`
    parameter.

    2. **Parsing**: The string is split by commas and cleaned to create a list of
    individual IP address strings.

    3. **Conversion**: The script iterates through the list, using the `socket.inet_aton`
    method to pack the IP address into binary format and the `struct.unpack` method
    to convert that binary data into a 32-bit unsigned long.

    4. **Result Generation**: The converted values are compiled into a JSON object
    (mapping the original IP string to the integer result) and a comma-separated string
    for easy use in subsequent playbook steps.

    5. **Completion**: The action finishes by outputting the summary message and the
    converted result values to the Google SecOps platform.


    ### Additional Notes

    This action is a local utility function. It does not perform network requests
    or interact with any external threat intelligence services. It does not use or
    filter existing case entities; it relies entirely on the provided input parameter.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Math Arithmetic:
  ai_description: >-
    ### General Description

    The **Math Arithmetic** action provides a set of built-in mathematical operators
    to perform calculations on two numerical arguments. It is part of the 'Functions'
    integration and is primarily used within playbooks to handle dynamic data manipulation,
    such as calculating thresholds, time offsets, or count adjustments without needing
    external services.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Function** | ddl | Yes | The arithmetic operation to perform. Options include:
    **Plus** (addition), **Sub** (subtraction), **Multi** (multiplication), **Div**
    (division), and **Mod** (modulo). |

    | **Arg 1** | string | Yes | The first numerical argument for the operation. Supports
    integers and floating-point numbers. |

    | **Arg 2** | string | Yes | The second numerical argument for the operation.
    Supports integers and floating-point numbers. |


    ### Flow Description

    1. **Input Parsing:** The action retrieves the two input strings (`Arg 1` and
    `Arg 2`) and attempts to convert them into integers or floats.

    2. **Logic Execution:** Based on the selected **Function** parameter, the code
    performs the specific math operation:
        * **Plus**: Adds `Arg 1` and `Arg 2`.
        * **Sub**: Subtracts `Arg 2` from `Arg 1`.
        * **Multi**: Multiplies `Arg 1` by `Arg 2`.
        * **Div**: Divides `Arg 1` by `Arg 2`.
        * **Mod**: Returns the remainder of `Arg 1` divided by `Arg 2`.
    3. **Completion:** The action returns the calculated result as the script result
    value and provides a descriptive message of the operation (e.g., '10 + 5 = 15')
    to the case.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Math Functions:
  ai_description: >-
    ### General Description

    This action performs mathematical operations on a list of numbers provided as
    a comma-separated string. It serves as a utility tool within a playbook to manipulate
    numerical data, calculate aggregates, or format values for subsequent steps without
    interacting with external APIs.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Function | DDL | Yes | The mathematical operation to apply. Options include:
    Max, Min, Round, Sort, Sum, Float, Hex, Int, Abs, and Display (adds comma separators).
    |

    | Numbers | String | Yes | A comma-separated list of numerical values (e.g., '10,
    20.5, -5') to be processed. |


    ### Additional Notes

    - The action does not process entities; it operates solely on the input parameters.

    - For the 'Hex' function, inputs are parsed specifically as integers.


    ### Flow Description

    1. **Parse Input:** The action splits the 'Numbers' string by commas and attempts
    to convert each element into a float or integer.

    2. **Execute Operation:** Based on the selected 'Function', the logic applies
    the corresponding Python built-in (e.g., `sum()`, `max()`, `abs()`) or formatting
    logic.

    3. **Format Output:** The results are prepared as a list and converted to a JSON
    string.

    4. **Finalize:** The action returns the processed data to the SOAR platform via
    `add_result_json` and ends the execution state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The Ping action is a diagnostic utility designed to verify the connectivity and
    functional status of the 'Functions' integration within Google SecOps. It serves
    as a simple health check to ensure that the environment is correctly configured
    and that the platform can successfully execute scripts.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    This action does not interact with any external APIs, nor does it process or modify
    any entities within the case. It is intended strictly for verification purposes.


    ### Flow Description

    1. The action initializes the Siemplify SDK.

    2. The action immediately terminates, returning a hardcoded success message 'Siemplify
    is connected' to indicate a successful execution environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Run JSONPath Query:
  ai_description: >-
    ### General Description

    The **Run JSONPath Query** action is a utility designed to execute JSONPath expressions
    against a provided JSON string. It extracts specific values matching the expression,
    allowing users to parse and filter complex data structures within a playbook flow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Json** | Code/String | Yes | The raw JSON string that you want to query. |

    | **JSONPath Expression** | String | Yes | The JSONPath syntax used to locate
    and extract data from the input JSON (e.g., `$.items[*].id`). |


    ### Additional Notes

    * This action is a transformation utility and does not require a connection to
    any external service or API.

    * It does not utilize or process SOAR entities (such as IPs or Hostnames) directly;
    it operates solely on the input parameters provided.

    * Results are returned as a list of matches in the action's JSON output.


    ### Flow Description

    1. **Extract Parameters**: The action retrieves the input JSON string and the
    JSONPath expression from the user configuration.

    2. **Deserialize JSON**: It converts the input string into a structured data format.

    3. **Parse Expression**: The JSONPath expression is parsed using the `jsonpath-ng`
    library.

    4. **Execute Query**: The action searches the JSON data for matches based on the
    expression.

    5. **Return Results**: All matching values are collected and returned as a JSON
    result object containing a list of matches.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
SanitizeHTML:
  ai_description: >-
    ### General Description

    Cleans and sanitizes HTML fragments using the HTML5 parsing algorithm via the
    `bleach` library. This action is designed to prevent Cross-Site Scripting (XSS)
    by stripping or escaping disallowed tags, attributes, and styles from a provided
    string. It also handles common structural issues like unclosed or misnested tags.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Input HTML | String | Yes | The HTML fragment that will be sanitized. |

    | Tags | String | No | A comma-separated list of allowed HTML tags. Tags not in
    this list will be escaped or stripped. Defaults to a standard set including `p`,
    `div`, `a`, etc. |

    | Attributes | String | No | A comma-separated list of allowed attributes for
    the tags. |

    | Styles | String | No | A comma-separated list of allowed CSS properties if the
    `style` attribute is permitted. |

    | Allow All Attributes | Boolean | No | If set to `True`, all attributes will
    be allowed for all permitted tags. |


    ### Additional Notes

    - The action uses the `bleach` library for robust HTML5-compliant sanitization.

    - While the code references `Allow All Tags` and `Allow All Styles`, these are
    not present in the current configuration metadata and will default to `False`.

    - If no specific tags or attributes are provided, the action uses a default safe
    set or the library's defaults.


    ### Flow Description

    1. **Extraction**: The action retrieves the mandatory `Input HTML` and optional
    configuration parameters (Tags, Attributes, Styles, and Flags).

    2. **Parsing**: Comma-separated strings for tags, attributes, and styles are split
    and cleaned into list formats.

    3. **Configuration**: A `CSSSanitizer` is initialized if specific styles are provided.
    The action then evaluates the flags (like `Allow All Attributes`) to determine
    the exact cleaning policy.

    4. **Sanitization**: The `bleach.clean` method is invoked with the configured
    filters on the input string.

    5. **Completion**: The resulting sanitized HTML is returned as the script output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
String Functions:
  ai_description: >-
    ### General Description

    This utility action provides a comprehensive set of Pythonic string manipulation
    functions for processing text data within Google SecOps playbooks. It allows users
    to transform, analyze, and format strings using various methods, including case
    conversion, searching, regex-based replacement, and encoding/decoding operations.
    This is particularly useful for normalizing data extracted from alerts before
    passing it to subsequent playbook steps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Input | string | Yes | The source text string that the selected function will
    operate on. |

    | Function | ddl | Yes | The specific string operation to perform. Options include:
    `Lower`, `Upper`, `Count`, `Find`, `IsAlpha`, `IsDigit`, `Replace`, `Strip`, `Title`,
    `Regex Replace`, `JSON Serialize`, `Regex`, `Split`, `DecodeBase64`, `EncodeBase64`,
    `RemoveNewLines`. |

    | Param 1 | string | No | The first argument required by some functions. For example,
    the search string for `Find`, the pattern for `Regex`, or the replacement target
    for `Replace`. |

    | Param 2 | string | No | The second argument required by some functions. For
    example, the replacement value for `Replace` or `Regex Replace`, or the separator
    for the `Regex` join operation. |


    ### Flow Description

    1. **Initialization:** The action retrieves the `Input` string, the desired `Function`,
    and any auxiliary parameters (`Param 1`, `Param 2`) from the environment configuration.

    2. **Placeholder Handling:** For functions like `Replace` and `Regex Replace`,
    the action automatically converts the placeholder string `_SPACE_` into an actual
    space character in both `Param 1` and `Param 2` to allow for operations involving
    whitespace via the UI.

    3. **Execution:** The action evaluates the selected `Function` and executes the
    corresponding Python logic:
        * **Case/Formatting:** `Lower`, `Upper`, `Title`, `Strip`, `RemoveNewLines`
    apply standard transformations.
        * **Search/Analysis:** `Count` and `Find` locate substrings; `IsAlpha` and
    `IsDigit` validate content types.
        * **Transformation:** `Replace` and `Regex Replace` modify the string; `Regex`
    extracts matches and joins them into a single string.
        * **Serialization/Encoding:** `JSON Serialize` converts the string to JSON
    format; `EncodeBase64` and `DecodeBase64` handle Base64 operations using the encoding
    specified in `Param 1` (defaulting to UTF-8).
        * **Splitting:** `Split` breaks the string into a list based on a delimiter
    and attaches the result as a JSON object to the action's execution context.
    4. **Finalization:** The processed string is returned as the main action result,
    accompanied by a status message describing the success of the operation.


    ### Additional Notes

    - For `Split`, the results are returned as a string representation in the main
    result but are also provided as a structured JSON array for downstream processing.

    - Base64 operations default to UTF-8 if an invalid or no encoding is provided
    in `Param 1`.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Time Duration Calculator:
  ai_description: "### General Description\nThe Time Duration Calculator is a utility\
    \ action designed to compute the elapsed time or difference between two specific\
    \ date-time points. It allows users to provide timestamps in various formats or\
    \ use the keyword \"now\" to represent the current UTC time. The action output\
    \ provides the duration broken down into multiple units (years, days, hours, minutes,\
    \ and seconds) and a human-readable summary string.\n\n### Parameters Description\n\
    \n| Parameter Name | Type | Mandatory | Description |\n| :--- | :--- | :--- |\
    \ :--- |\n| Input DateTime 1 | string | Yes | The first datetime value. Supports\
    \ standard date-time strings or the keyword \"now\" for the current UTC time.\
    \ |\n| Input DateTime 1 Format | string | Yes | The strftime format matching the\
    \ structure of Input DateTime 1 (e.g., %Y-%m-%dT%H:%M:%S%z). |\n| Input DateTime\
    \ 2 | string | Yes | The second datetime value. Supports standard date-time strings\
    \ or the keyword \"now\" for the current UTC time. |\n| Input DateTime 2 Format\
    \ | string | Yes | The strftime format matching the structure of Input DateTime\
    \ 2 (e.g., %Y-%m-%dT%H:%M:%S%z). |\n\n### Flow Description\n1.  **Extraction**:\
    \ The action retrieves the two input timestamps and their corresponding strftime\
    \ format strings.\n2.  **Parsing**: It converts the input strings into Python\
    \ datetime objects. If \"now\" is provided, it captures the current UTC timestamp.\
    \ \n3.  **Normalization**: The action checks if the resulting datetime objects\
    \ are timezone-aware. If they are naive (no timezone info), it automatically localizes\
    \ them to UTC to ensure accurate calculation.\n4.  **Calculation**: It calculates\
    \ the difference between the two dates. \n5.  **Formatting**: The duration is\
    \ converted into specific integer counts for years, days, hours, minutes, and\
    \ seconds, as well as a combined human-readable string.\n6.  **Completion**: The\
    \ results are stored in the action's JSON output, and the total difference in\
    \ seconds is set as the primary result value."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
XMLtoJson:
  ai_description: >-
    ### General Description

    Converts XML-formatted string data into a JSON object. This utility action is
    designed to facilitate data manipulation within playbooks by transforming XML
    data into a format that is more easily consumed by subsequent actions or used
    for logic branching.


    ### Parameters Description

    | Parameter Name | Description | Type | Mandatory | Expected Value |

    | :--- | :--- | :--- | :--- | :--- |

    | **xml** | The XML formatted string that needs to be converted to JSON. | String
    | Yes | A valid XML string (e.g., `<e><a>text</a><a>text</a></e>`). |


    ### Additional Notes

    This action is a local utility function and does not communicate with any external
    APIs or services. If the provided XML is malformed, the action will fail and return
    an error message.


    ### Flow Description

    1. **Extract Input:** Retrieves the raw XML string from the action parameter named
    'xml'.

    2. **Parse XML:** Uses the `xmltodict` library to parse the XML string into a
    structured dictionary (JSON-compatible object).

    3. **Output Result:** Adds the resulting JSON structure to the action's result
    JSON and sets the execution status to completed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
