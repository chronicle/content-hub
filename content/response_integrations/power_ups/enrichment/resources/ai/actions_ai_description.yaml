Enrich Entities from List with Field:
  ai_description: >-
    ### General Description

    This action enriches specific entities within a Google SecOps case by adding a
    custom field and value to their 'additional_properties'. It is designed to perform
    bulk updates on entities identified by a provided list of identifiers, provided
    they match a specific entity type.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | List of Entities | String | Yes | A delimited list of entity identifiers (e.g.,
    IP addresses, hostnames) to be enriched. |

    | Entity Type | String | Yes | The specific type of entity to target (e.g., ADDRESS,
    HOSTNAME). Only entities of this type will be updated. |

    | Entity Delimiter | String | Yes | The character used to separate identifiers
    in the 'List of Entities' parameter (default is often a comma). |

    | Enrichment Field | String | Yes | The name of the key/field to be added or updated
    in the entity's additional properties. |

    | Enrichment Value | String | Yes | The value to be assigned to the specified
    'Enrichment Field'. |


    ### Flow Description

    1. **Parse Input:** The action splits the 'List of Entities' string into individual
    identifiers using the provided 'Entity Delimiter'.

    2. **Retrieve Case Entities:** It gathers all entities associated with all alerts
    in the current case.

    3. **Matching Logic:** It iterates through the parsed identifiers and searches
    for matching entities in the case. A match requires both a case-insensitive identifier
    match and a match with the specified 'Entity Type'.

    4. **Data Mutation:** For every matching entity found, it adds or updates the
    'Enrichment Field' in the entity's `additional_properties` with the 'Enrichment
    Value'.

    5. **Update:** The action performs a bulk update to save the modified entities
    back to the Google SecOps platform.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      The action updates the 'additional_properties' attribute of entities within
      the Google SecOps case with user-provided fields and values.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Entity From Event Field:
  ai_description: "### General Description\nThis action enriches entities within a\
    \ Google SecOps case by extracting specific field values from the alert's security\
    \ events and mapping them directly to the entities' additional properties. This\
    \ is primarily used to promote event-level metadata\u2014such as department names,\
    \ device owners, or custom tags\u2014onto the entity objects, making that data\
    \ easily accessible for filtering, grouping, or use in subsequent playbook steps.\n\
    \n### Parameters Description\n| Parameter | Description | Type | Mandatory |\n\
    | :--- | :--- | :--- | :--- |\n| Fields to enrich | A comma-separated list of\
    \ field names (e.g., 'department, owner_email') found within the security event's\
    \ additional properties that should be copied to the entities. | String | Yes\
    \ |\n\n### Additional Notes\n- The action specifically targets the **first** security\
    \ event (`security_events[0]`) associated with the current alert. If an alert\
    \ contains multiple events with varying data, only the data from the primary/first\
    \ event will be used for enrichment.\n- Field matching is case-insensitive; however,\
    \ the fields are stored in the entity's additional properties using lowercase\
    \ keys.\n\n### Flow Description\n1. **Initialization**: The action starts by initializing\
    \ the SOAR SDK and retrieving the 'Fields to enrich' parameter.\n2. **Event Access**:\
    \ It retrieves the first security event from the current alert context.\n3. **Entity\
    \ Iteration**: The script iterates through all `target_entities` currently in\
    \ scope for the action.\n4. **Field Mapping**: For each entity, it checks if the\
    \ requested fields exist in the event's `additional_properties`. If a match is\
    \ found, the value is added to the entity's own `additional_properties` dictionary.\n\
    5. **Internal Update**: If any entities were modified, the action calls `update_entities`\
    \ to persist these changes within Google SecOps.\n6. **Result Reporting**: The\
    \ action concludes by providing a JSON summary of the enriched data and a status\
    \ message indicating how many entities were successfully updated."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates the 'additional_properties' attribute of entities within
      the Google SecOps case using data retrieved from the alert's security events.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Entity From JSON:
  ai_description: >-
    ### General Description

    This action enriches entities within Google SecOps by mapping data from a provided
    JSON string directly to the entities' additional properties. It is designed to
    take external JSON data (for example, results from a previous playbook step or
    a manual input) and attach relevant fields to entities in the current scope without
    making additional external API calls.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Enrichment JSON | String | Yes | A JSON-formatted string representing a list
    of objects containing the enrichment data. |

    | Identifier KeyPath | String | Yes | A newline-separated list of paths (e.g.,
    'metadata.id') used to locate the identifying key within the JSON objects. |

    | Separator | String | Yes | The character used to separate nested keys in the
    Identifier KeyPath (default is '.'). |

    | PrefixForEnrichment | String | No | An optional string to prepend to the keys
    of the data added to the entity's additional properties. |

    | Enrichment JSONPath | String | No | An optional JSONPath expression to select
    a specific subset of the JSON object for enrichment instead of using the entire
    object. |


    ### Additional Notes

    - The action flattens nested JSON structures into a single-level dictionary of
    key-value pairs before attaching them to the entity.

    - If multiple paths are provided in the `Identifier KeyPath` (separated by newlines),
    the action will attempt to find a valid identifier using each path sequentially.

    - Note: The current implementation enriches the entity if the specified key path
    exists in the JSON object; it does not explicitly validate that the value at that
    path matches the entity's identifier.


    ### Flow Description

    1. **Initialization**: The action retrieves the input JSON data and configuration
    parameters.

    2. **Data Parsing**: It parses the `Enrichment JSON` string into a list of Python
    dictionaries.

    3. **Entity Iteration**: The action iterates through all target entities in the
    current scope.

    4. **Key Matching**: For each entity, it searches the list of JSON objects to
    find one that contains the keys specified in the `Identifier KeyPath`.

    5. **Data Extraction**: If a match is found, it extracts the data. If an `Enrichment
    JSONPath` is provided, it filters the object; otherwise, it uses the full object.

    6. **Flattening and Prefixing**: The extracted data is flattened into a simple
    key-value structure, and an optional prefix is applied to the keys.

    7. **Internal Update**: The entity's `additional_properties` are updated with
    the new data.

    8. **Commit**: The action calls the internal SDK to update the entities in the
    Google SecOps environment and returns the total count of enriched entities.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Updates the 'additional_properties' field of entities within Google SecOps to
      include the data extracted from the provided JSON.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Entity With Field:
  ai_description: >-
    ### General Description

    The **Enrich Entity With Field** action allows users to manually append custom
    metadata to entities within a Google SecOps case. It takes a list of key-value
    pairs provided as a JSON string and adds them to the `additional_properties` of
    all entities currently in scope. This action is primarily used for tagging entities
    with static information or data derived from previous playbook steps that isn't
    automatically mapped by standard integrations.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Fields to enrich** | String | Yes | A JSON-formatted list of objects. Each
    object must contain `entity_field_name` (the key) and `entity_field_value` (the
    value). Example: `[{"entity_field_name": "Department", "entity_field_value": "Finance"}]`.
    |


    ### Additional Notes

    - This action does not communicate with external APIs; it purely manipulates internal
    entity data based on the provided input.

    - The input must be a valid JSON array of objects. If the JSON is malformed, the
    action will fail during the parsing stage.

    - The action applies the same set of fields to every entity in the current target
    scope.


    ### Flow Description

    1. **Parameter Parsing**: The action retrieves the `Fields to enrich` parameter
    and parses the JSON string into a Python list of dictionaries.

    2. **Entity Iteration**: It iterates through all entities in the `target_entities`
    list provided by the SOAR context.

    3. **Property Assignment**: For each entity, it loops through the provided key-value
    pairs and assigns them to the entity's `additional_properties` dictionary using
    the `entity_field_name` as the key.

    4. **Internal Update**: The action calls `siemplify.update_entities` to commit
    the changes to the Google SecOps platform.

    5. **Result Reporting**: It adds a JSON result for each entity containing the
    applied fields and ends the execution with a summary message indicating the number
    of enriched entities.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Updates the 'additional_properties' attribute of entities within the Google
      SecOps case based on user-provided parameters.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Entity from Explorer Attributes:
  ai_description: >-
    ### General Description

    This action enriches entities within Google SecOps by retrieving historical attribute
    data from the Entity Explorer. It allows analysts to synchronize current entities
    with previously discovered or stored metadata, ensuring that the most up-to-date
    context is available for investigation. The action specifically avoids overwriting
    core system fields to maintain data integrity.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Field Name | string | No | A comma-separated list of specific field names to
    be retrieved from the Entity Explorer. If left empty, all available fields will
    be processed based on the whitelist/denylist logic. |

    | Use Field Name as Whitelist | boolean | No | Determines the logic for the 'Field
    Name' parameter. If set to `true` (default), only the specified fields are enriched.
    If set to `false`, the specified fields are excluded (denylist), and all other
    available fields are enriched. |


    ### Additional Notes

    - The action automatically filters out 'SYSTEM_FIELDS' (such as `Type`, `Environment`,
    `IsSuspicious`, etc.) to prevent accidental modification of core entity properties.

    - If a field exists as a standard attribute on the entity object, it is updated
    directly; otherwise, it is added to the entity's `additional_properties` dictionary.


    ### Flow Description

    1. **Initialization**: The action extracts the user-provided parameters for field
    filtering and whitelist logic.

    2. **Data Retrieval**: For each target entity in the current scope, the action
    calls the internal SOAR API (`get_entity_data`) to fetch historical records from
    the Entity Explorer.

    3. **Field Filtering**: The retrieved fields are compared against the provided
    'Field Name' list and the internal 'SYSTEM_FIELDS' list. Only permitted fields
    are selected for enrichment.

    4. **Entity Update**: The action iterates through the filtered fields and updates
    the entity object's attributes or populates its `additional_properties`.

    5. **Commitment**: The updated entities are saved back to the Google SecOps platform,
    and a summary of changes is provided in the action output and JSON results.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes and additional properties with data retrieved from
      the internal Entity Explorer database.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich FileName Entity with Path:
  ai_description: >-
    ### General Description

    The **Enrich FileName Entity with Path** action is a utility designed to extract
    structured information from file path strings stored in entity identifiers. It
    identifies the directory path, the full filename, and the file extension, then
    enriches the entity by adding these details to its metadata. This is particularly
    useful for normalizing file-related data across different operating systems (Windows
    and Unix-like) and providing granular context for downstream analysis.


    ### Parameters Description

    This action does not require any input parameters. It operates directly on the
    identifiers of the entities provided in the current execution context.


    ### Additional Notes

    - The action uses regex to distinguish between Windows-style paths (e.g., paths
    starting with a drive letter like `C:\`) and Unix-style paths.

    - Entities whose identifiers do not contain a directory path (i.e., just a standalone
    filename) will not be enriched.

    - The enrichment results are stored in the entity's `additional_properties` under
    the keys `file_name`, `file_path`, and `file_extension`.


    ### Flow Description

    1. **Entity Iteration**: The action retrieves all target entities in the current
    scope.

    2. **Path Parsing**: For each entity, the script analyzes the identifier string
    using regex to determine the path format (Windows vs. Unix).

    3. **Component Extraction**: It splits the string into a directory path and a
    full filename using appropriate libraries (`ntpath` for Windows, `os.path` for
    others) and further extracts the file extension.

    4. **Internal Enrichment**: If a valid path is found, the extracted details are
    added to the entity's `additional_properties` dictionary.

    5. **Update and Output**: The action updates the entities within Google SecOps
    to reflect the new metadata and returns a JSON summary of the parsed details.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Source and Destinations:
  ai_description: >-
    ### General Description

    This action enriches entities within a Google SecOps alert by identifying and
    tagging them as either a 'source' or a 'destination' based on the alert's metadata.
    It helps analysts quickly understand the role of each entity (such as IP addresses
    or hostnames) in the context of the observed security event.


    ### Parameters Description

    There are no parameters required for this action.


    ### Additional Notes

    This action relies on the internal investigator data provided by the Google SecOps
    API to determine the relationship between entities. It specifically modifies the
    `additional_properties` of entities within the SOAR case.


    ### Flow Description

    1. **Fetch Alert Data**: The action calls the internal investigator API to retrieve
    the full context of the current alert.

    2. **Parse Identifiers**: It extracts lists of source and destination identifiers
    from the alert's security event cards or field groups.

    3. **Entity Matching**: The action iterates through all entities associated with
    the current alert and compares their identifiers (case-insensitive) against the
    extracted source and destination lists.

    4. **Internal Mutation**: For every match found, it updates the entity's `additional_properties`
    by setting `isSource` to `"true"` or `isDest` to `"true"`.

    5. **Update Entities**: Finally, it pushes these updates back to the Google SecOps
    platform to ensure the entity information is reflected in the case UI.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates the 'additional_properties' attribute of entities within
      the SOAR case to include 'isSource' or 'isDest' flags.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Mark Entity as Suspicious:
  ai_description: >-
    ### General Description

    This action is designed to programmatically mark all entities within the current
    scope of a Google SecOps case as suspicious. It is a utility action used to flag
    entities for further investigation or to trigger automated workflows that respond
    to suspicious indicators.


    ### Parameters Description

    There are no parameters for this action. It automatically processes all entities
    currently associated with the action's scope.


    ### Additional Notes

    This action does not interact with any external APIs or services. It strictly
    modifies the internal state of entities within the Google SecOps platform.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify API context.

    2. **Entity Iteration**: The script iterates through every entity provided in
    the `target_entities` list.

    3. **Flag Modification**: For each entity, the `is_suspicious` attribute is set
    to `True`.

    4. **Internal Update**: The action calls the `update_entities` method to persist
    these changes within the Google SecOps case.

    5. **Completion**: The action concludes by reporting the total number of entities
    successfully marked as suspicious.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      The action modifies the 'is_suspicious' flag of entities within the Google SecOps
      case environment.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify the connectivity
    and operational status of the Enrichment integration within Google SecOps. Its
    primary purpose is to confirm that the integration environment is correctly configured
    and that the SOAR platform can successfully execute scripts associated with this
    integration.


    ### Parameters Description

    This action does not require any input parameters.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify SDK to establish a
    context for the execution.

    2. **Connectivity Verification**: The script performs a basic execution check
    without interacting with external APIs or processing any entity data.

    3. **Finalization**: The action terminates immediately, returning a success status
    and the message "Siemplify is connected" to the case wall or action output.


    ### Additional Notes

    This action is strictly for health-check purposes. It does not fetch data, modify
    external systems, or enrich entities. It is typically used during the initial
    setup of the integration or for troubleshooting communication issues.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Whois:
  ai_description: "### General Description\nQueries WHOIS servers and GeoIP services\
    \ to retrieve registration and location information for various entity types.\
    \ This action supports IP Addresses, Domains, URLs, and Email addresses. It enriches\
    \ entities with detailed WHOIS data (such as registrar, creation date, and domain\
    \ age) and geographic data for IPs. Additionally, it can automatically create\
    \ and link new DOMAIN entities from URL or Email inputs and mark entities as suspicious\
    \ if their domain age falls below a specified threshold.\n\n### Parameters Description\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | Create Entities | boolean | No | If set to `true`, the action will create new\
    \ DOMAIN entities and link them to the original URL or Email/User entities. Default\
    \ is `true`. |\n| Domain Age Threshold | string | No | A numerical value representing\
    \ days. Domains with an age (since creation) less than this threshold will be\
    \ marked as suspicious in Google SecOps. |\n\n### Additional Notes\n- The action\
    \ uses the `ipwhois` library for IP RDAP lookups and `whois_alt` for domain lookups.\n\
    - IP enrichment includes a geographic lookup via the `db-ip.com` API.\n- Domain\
    \ age is calculated based on the `creation_date` field returned by WHOIS. If multiple\
    \ creation dates are returned, the first one is used.\n- The `Domain Age Threshold`\
    \ parameter is treated as an integer in the logic; if set to 0, the suspicious\
    \ marking logic is bypassed.\n\n### Flow Description\n1. **Initialization**: Extracts\
    \ the `Create Entities` and `Domain Age Threshold` parameters.\n2. **Entity Iteration**:\
    \ Iterates through all target entities in the current context.\n3. **IP Processing**:\
    \ For `ADDRESS` entities, it performs an RDAP lookup and a geographic location\
    \ lookup (City, Region, Country, Lat/Long).\n4. **Domain/URL/Email Processing**:\
    \ For other entity types, it extracts the registered domain using `tldextract`\
    \ and performs a WHOIS lookup.\n5. **Entity Creation**: If `Create Entities` is\
    \ enabled and the input was a URL or Email, a new `DOMAIN` entity is created and\
    \ linked to the source entity.\n6. **Age Calculation**: Calculates the age of\
    \ the domain in days based on its creation date.\n7. **Internal Mutation**: \n\
    \    - Updates the `additional_properties` of the entities with WHOIS/GeoIP data\
    \ (prefixed with `WHOIS`).\n    - Sets `is_enriched` to `true`.\n    - If the\
    \ domain age is below the `Domain Age Threshold`, sets `is_suspicious` to `true`.\n\
    8. **Completion**: Updates all modified entities in the Google SecOps case and\
    \ returns the raw JSON results."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates entity attributes including 'additional_properties', 'is_suspicious',
      and 'is_enriched'. It also creates new DOMAIN entities within the case and establishes
      relationships between them and existing entities.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
