AnalyzeEmlHeaders:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Analyzes email headers provided as a Base64-encoded EML string or
      a JSON-formatted list. The action extracts routing information from 'Received'
      headers to identify source domains and IP addresses. It performs a variety of
      security checks, including validating consistency between the 'Return-Path',
      'From', 'Reply-To', and 'X-Original-Sender' fields to detect potential spoofing.
      It also identifies suspicious headers such as 'X-Distribution', 'Bcc', and 'X-UIDL',
      and flags anomalies or missing values in the 'Message-ID' header. The output
      includes a structured JSON of all extracted headers and an HTML-formatted analysis
      report with matched rules and risk scores.
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
AnalyzeHeaders:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Analyzes email headers provided in JSON format to evaluate authenticity
      and delivery paths. The action validates email authentication protocols including
      SPF, DMARC, ARC, and DKIM. It performs detailed hop analysis by parsing 'Received'
      headers, checking relay server IPs and domains against multiple Real-time Blackhole
      Lists (RBLs), and enriching the findings with geographic location and WHOIS/RDAP
      registration data. The results are returned as a structured JSON object for
      use in playbooks.
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: true
ParseBase64Email:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Parses EML and MSG email files provided as a Base64 encoded string.
      This utility action extracts comprehensive metadata including headers (To, From,
      Subject, CC, Date), body content in both plain text and HTML formats, and detailed
      attachment information including file names, sizes, extensions, and cryptographic
      hashes (MD5, SHA1, SHA256, SHA512). It automatically identifies and extracts
      indicators such as URLs, domains, email addresses, and IP addresses from the
      email body and transport headers. The action supports recursive parsing of nested
      email attachments and provides granular control over header extraction through
      configurable blacklists or whitelists and transport header termination points.
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
ParseCaseWallEmail:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    description: Parses EML and MSG email files attached to the case wall to extract
      headers, body content, and attachments. The action retrieves attachment data
      from the case, identifies nested emails, and parses metadata including 'To',
      'From', 'Subject', and 'Date'. Depending on configuration, it creates various
      entities (User, Email Subject, URL, IP, and File Hash) from the email content
      and headers. It supports entity fanging/defanging and custom regex parsing.
      Extracted email attachments can be saved back to the case wall as new evidence,
      and existing Filename entities are updated with the new attachment identifiers.
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: Creates new entities (Users, Email Subjects,
      URLs, IPs, Hashes) in the SOAR case, adds extracted email attachments to the
      case wall, and updates Filename entities with attachment metadata.
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
ParseEmlBase64Blob:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Decodes and parses a base64-encoded EML file string. This action
      extracts comprehensive email metadata including sender, recipient lists (To,
      CC, BCC), subject, date, and both plain text and HTML body content. It also
      supports recursive parsing of nested EML attachments, outputting all extracted
      information as a structured JSON result for further processing in the SOAR platform.
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
Ping:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Verifies the connectivity and operational status of the Email Utilities
      integration. This action performs a basic heart-beat check within the Google
      SecOps environment to ensure that the integration script can be successfully
      initialized and executed. It does not perform any external network requests,
      does not interact with email services, and does not process or modify any case
      entities.
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
