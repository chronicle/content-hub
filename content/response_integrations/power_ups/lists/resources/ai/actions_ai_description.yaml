Add String to Custom List:
  ai_description: >-
    ### General Description

    This action adds a specific string to a designated internal custom list within
    Google SecOps. It is primarily used for administrative tasks such as dynamically
    updating allowlists, blocklists, or watchlists used in other automated playbooks.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **ListItem** | string | Yes | The specific string value you want to add to the
    custom list. |

    | **Category** | string | Yes | The name of the custom list category where the
    string will be stored. |


    ### Additional Notes

    - This action does not process or iterate over entities associated with the case;
    it operates strictly on the provided input parameters.

    - The action interacts with internal Google SecOps storage rather than external
    third-party services.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the `Category` and `ListItem`
    strings from the user input.

    2. **Object Creation**: It wraps the input string into a `CustomList` object,
    associating it with the current environment.

    3. **Internal Update**: The action calls the `add_entities_to_custom_list` SDK
    method to save the entry into the SOAR platform's custom list repository.

    4. **Completion**: The action returns a success message confirming the addition
    of the string to the specified category.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Adds a string entry to the internal Google SecOps Custom List repository.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Is String In Custom List:
  ai_description: >-
    ### General Description

    This action checks if a specific string or a list of strings exists within a Google
    SecOps Custom List for a given category. It is primarily used to verify if identifiers
    (like IPs, domains, or user names) are present in predefined internal lists such
    as whitelists, blacklists, or watchlists.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **IdentifierList** | String | Yes | A comma-separated string or a JSON-formatted
    list of strings to search for within the custom list. |

    | **Category** | String | Yes | The name of the custom list category to perform
    the search against (e.g., 'WhiteList', 'Suspected_IOCs'). |


    ### Additional Notes

    - The action automatically detects if the `IdentifierList` is a JSON array or
    a comma-separated string.

    - It checks lists relative to the current environment assigned to the action execution.

    - The result value returns the total count of strings found in the list.


    ### Flow Description

    1. **Parse Input**: The action retrieves the `Category` and the `IdentifierList`
    from the input parameters.

    2. **Format Identifiers**: It attempts to parse the `IdentifierList` as JSON;
    if that fails, it splits the string by commas and strips whitespace from each
    element.

    3. **Query Custom Lists**: For each identifier in the list, the action utilizes
    the `any_entity_in_custom_list` SDK method to check if the string exists in the
    specified category within the current SOAR environment.

    4. **Aggregate Results**: It builds a JSON object mapping each identifier to a
    boolean value (`true` if found, `false` otherwise) and increments a counter for
    every match.

    5. **Output**: The action attaches the JSON result to the case, provides a summary
    message with the total number of found items, and returns the match count as the
    final result value.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    This action provides a connectivity test for the Lists integration. It is used
    to verify that the Google SecOps (Chronicle) environment can successfully communicate
    with the integration's underlying logic. It does not perform any data retrieval
    or modifications.


    ### Parameters description

    There are no parameters for this action.


    ### Additional notes

    This is a standard utility action used for troubleshooting and initial setup verification.


    ### Flow description

    1. **Initialize**: The action initializes the Siemplify SDK.

    2. **Verify and End**: The action immediately terminates with a success message
    'Siemplify is connected', confirming the script execution environment is functional.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove String from Custom List:
  ai_description: >-
    ### General description

    Removes a specified string value from a designated custom list within the Google
    SecOps platform. This action is typically used to manage exclusion lists, whitelists,
    or watchlists by dynamically removing entries that are no longer relevant or required.


    ### Parameters description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Category | string | Yes | The name of the custom list category (e.g., 'WhiteList')
    from which the item should be removed. |

    | ListItem | string | Yes | The specific string value to search for and remove
    from the list. |


    ### Additional notes

    Note that while the metadata description for the 'ListItem' parameter mentions
    adding a string, the action's logic and SDK call specifically perform a removal
    operation. This action does not interact with entity objects directly but operates
    on raw strings provided via parameters.


    ### Flow description

    1. **Parameter Extraction**: The action retrieves the 'Category' and 'ListItem'
    values from the user-provided inputs.

    2. **Object Creation**: It constructs a internal `CustomList` object representing
    the item to be targeted for removal.

    3. **SDK Interaction**: The action calls the `remove_entities_from_custom_list`
    method via the SOAR SDK to update the internal database.

    4. **Completion**: The action returns a success message indicating the item has
    been removed or a failure status if an error occurs.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Removes a specific string entry from a Custom List stored within the Google
      SecOps SOAR platform.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Custom Lists:
  ai_description: "### General Description\nThis action searches for specific records\
    \ within Google SecOps Custom Lists based on a provided search string and/or category\
    \ filters. It is primarily used to retrieve existing threat intelligence or organizational\
    \ data stored within the platform's internal custom lists. If no search criteria\
    \ are provided, the action can retrieve all records from the accessible custom\
    \ lists.\n\n### Parameters Description\n| Parameter | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| String to Search | string | No | The specific\
    \ text to look for within the `entityIdentifier` field of the custom list records.\
    \ If left empty, no string filtering is applied. |\n| Categories | string | No\
    \ | A comma-separated list of custom list categories to filter the search. If\
    \ left empty, the action searches across all categories. |\n\n### Additional Notes\n\
    - If both `String to Search` and `Categories` are empty, the action will return\
    \ all available records from the custom lists.\n- The search performed on the\
    \ `String to Search` parameter is a substring match (case-sensitive as per standard\
    \ Python string inclusion).\n\n### Flow Description\n1. **Extraction**: The action\
    \ extracts the `Categories` and `String to Search` parameters from the input.\n\
    2. **Fetch Records**: It calls the internal API to retrieve records from the SOAR\
    \ custom lists, optionally filtering by the provided categories at the API level.\n\
    3. **Filtering**: \n    - If specific categories were provided, it ensures only\
    \ records belonging to those categories are processed.\n    - If a search string\
    \ was provided, it iterates through the relevant records and keeps only those\
    \ where the string exists within the `entityIdentifier` attribute.\n4. **Completion**:\
    \ The action calculates the number of matches, adds the resulting records to the\
    \ action's JSON results, and updates the execution status based on whether any\
    \ records were found."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Environment Custom Lists:
  ai_description: >-
    ### General Description

    Searches for specific strings within the environment's custom lists in Google
    SecOps. This action allows users to query and filter records stored in custom
    lists based on categories and specific string matches in the identifier field.
    It is useful for verifying if indicators or specific values exist within predefined
    local threat intelligence or whitelist/blacklist repositories managed within the
    platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | String to Search | string | No | The specific substring to search for within
    the `entityIdentifier` of the custom list records. If omitted, the action returns
    all records in the specified categories. |

    | Categories | string | No | A comma-separated list of custom list categories
    to narrow the search. If omitted, the search spans all available custom lists.
    |


    ### Additional Notes

    If neither `String to Search` nor `Categories` is provided, the action will attempt
    to return all custom list records available in the environment.


    ### Flow Description

    1. **Extraction**: The action extracts the `String to Search` and `Categories`
    parameters from the user input.

    2. **Data Retrieval**: It calls the internal SOAR API (`get_traking_list_records_filtered`)
    to fetch custom list records from the Google SecOps environment.

    3. **Category Filtering**: If categories were provided, the action filters the
    records to include only those belonging to the specified categories.

    4. **String Matching**: If a search string was provided, it performs a substring
    search against the `entityIdentifier` field of the remaining records.

    5. **Output**: The matching records are aggregated and attached to the action
    results as a JSON object. If no matches are found, the action completes with a
    'False' result value.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
