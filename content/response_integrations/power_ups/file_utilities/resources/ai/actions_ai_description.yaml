AddAttachment:
  ai_description: >-
    ### General Description

    The **Add Attachment** action allows users to programmatically upload and attach
    files to the case wall of a Google SecOps case. It takes file content in Base64
    format, along with metadata such as file name, type, and description, and adds
    it as an evidence item (Case Wall Attachment). This is particularly useful for
    automated workflows that generate reports, extract files from emails, or collect
    evidence from external systems and need to centralize them within the case for
    investigation.


    ### Parameters Description

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Name | string | True | The name of the attachment as it will appear on the case
    wall. |

    | IsFavorite | boolean | False | If set to `true`, the attachment will be marked
    as a favorite/important item in the case wall. Default is `false`. |

    | Base64 Blob | string | True | The actual content of the file encoded in Base64
    string format. |

    | Type | string | True | The file extension or type (e.g., `.txt`, `.pdf`, `.png`).
    |

    | Description | string | True | A brief description explaining the context or
    content of the attachment. |


    ### Flow Description

    1. **Parameter Retrieval:** The action extracts the attachment metadata (name,
    type, description, favorite status) and the Base64 content from the input parameters.

    2. **Context Identification:** It retrieves the current case identifier from the
    Siemplify context.

    3. **Data Modeling:** The action packages the information into a `CaseWallAttachment`
    data model.

    4. **API Interaction:** It calls the internal SOAR API (`save_attachment_to_case_wall`)
    to upload the Base64 blob and associate it with the current case.

    5. **Result Processing:** Upon success, the action parses the response, maps it
    to a structured JSON result containing attachment IDs and timestamps, and updates
    the action result.


    ### Additional Notes

    - The action interacts exclusively with the internal Google SecOps case management
    system.

    - Ensure the Base64 string is correctly formatted to prevent corruption of the
    uploaded file.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Adds a new file attachment/evidence item to the case wall of the current case
      within Google SecOps.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
AddEntityToFile:
  ai_description: >-
    ### General Description

    This action adds the identifier of target entities to a local text file residing
    on the execution runner. It is designed to maintain a persistent list of entities
    (e.g., for allowlisting, blocklisting, or deduplication across different playbook
    runs) within the `/tmp/` directory. The action ensures that each entity identifier
    is unique within the file; if an identifier is already present, it will not be
    added again, and the action will report a 'False' result to indicate a duplicate
    was encountered.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Filename | String | Yes | The name of the file (e.g., `indicators.txt`) where
    the entity identifiers will be stored. This file is automatically placed in the
    `/tmp/` directory of the SOAR agent/runner. |


    ### Additional Notes

    - The action utilizes a file-locking mechanism to prevent data corruption or race
    conditions if multiple playbooks or actions attempt to write to the same file
    simultaneously.

    - The action returns a `False` result value if at least one of the entities processed
    was already present in the file.

    - All identifiers are stored as plain text, one per line.


    ### Flow Description

    1. **Initialization**: The action retrieves the `Filename` parameter and constructs
    the full path (prefixing `/tmp/`).

    2. **File Access**: It initializes a file lock and reads the existing entity identifiers
    from the specified file into memory. If the file does not exist, it starts with
    an empty list.

    3. **Entity Processing**: The action iterates through all target entities in the
    current scope.

    4. **Deduplication Check**: For each entity, it checks if the `identifier` already
    exists in the loaded list.

    5. **Mutation**: If the identifier is new, it is added to the list. If it already
    exists, the action logs the occurrence and prepares to return a 'False' result.

    6. **Persistence**: The updated list of identifiers is written back to the local
    file, and the file lock is released.

    7. **Completion**: The action terminates, providing a summary message of added
    entities and the final success/failure status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action writes and modifies local files on the runner's filesystem (within
      the /tmp/ directory), which is external to the Google SecOps core platform data.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - ADDRESS
      - ALERT
      - APPLICATION
      - CHILDHASH
      - CHILDPROCESS
      - CLUSTER
      - CONTAINER
      - CREDITCARD
      - CVE
      - CVEID
      - DATABASE
      - DEPLOYMENT
      - DESTINATIONDOMAIN
      - DOMAIN
      - EMAILSUBJECT
      - EVENT
      - FILEHASH
      - FILENAME
      - GENERICENTITY
      - HOSTNAME
      - IPSET
      - MacAddress
      - PARENTHASH
      - PARENTPROCESS
      - PHONENUMBER
      - POD
      - PROCESS
      - SERVICE
      - SOURCEDOMAIN
      - THREATACTOR
      - THREATCAMPAIGN
      - THREATSIGNATURE
      - DestinationURL
      - USB
      - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
CountFiles:
  ai_description: "### General Description\nThe **Count Files** action is a utility\
    \ designed to scan a specific directory on the local filesystem and return the\
    \ total count of files that match a provided file extension pattern. This action\
    \ is particularly useful for monitoring directory growth, verifying the presence\
    \ of specific logs, or checking for file accumulation in temporary folders.\n\n\
    ### Parameters Description\n| Parameter | Type | Mandatory | Description |\n|\
    \ :--- | :--- | :--- | :--- |\n| Folder | String | Yes | The absolute or relative\
    \ path to the directory that will be scanned for files. |\n| File Extension |\
    \ String | No | A glob pattern used to filter files (e.g., `*.txt` or `*.log`).\
    \ If not provided, it defaults to `*.*` in the logic, counting all files. |\n\
    | Is Recursive | Boolean | No | If set to `True`, the action will scan the specified\
    \ folder and all its subfolders. If `False`, only the top-level directory is scanned.\
    \ |\n\n### Additional Notes\n- This action operates directly on the filesystem\
    \ accessible by the Google SecOps agent/runner executing the script. \n- It does\
    \ not require or interact with specific SOAR entities like IP addresses or Hostnames;\
    \ it relies entirely on the provided input parameters.\n\n### Flow Description\n\
    1. **Parameter Extraction**: The action retrieves the `Folder`, `File Extension`,\
    \ and `Is Recursive` flag from the user input.\n2. **Path Construction**: If the\
    \ `File Extension` is empty, it defaults to `*.*`. The action then joins the folder\
    \ path and the extension pattern into a single search string.\n3. **Filesystem\
    \ Scanning**: Using the Python `glob` library, the action searches the specified\
    \ path. If `Is Recursive` is enabled, it performs a deep search across all subdirectories.\n\
    4. **Counting and Reporting**: The action calculates the length of the list of\
    \ files found and returns this integer as the final result of the execution."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
CreateArchive:
  ai_description: "Creates a compressed archive file (zip, tar, gztar, bztar, or xztar)\
    \ from a specified list of files or a directory located on the SOAR server. This\
    \ utility action is primarily used for organizing and compressing files for storage\
    \ or export during an investigation. \n\n### Parameters\n| Parameter | Type |\
    \ Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| Archive Type | ddl\
    \ | Yes | The format of the archive to create. Supported values: zip, tar, gztar,\
    \ bztar, xztar. |\n| Archive Base Name | string | Yes | The name of the resulting\
    \ archive file (excluding the file extension). |\n| Archive Input | string | Yes\
    \ | A comma-separated list of absolute file paths or a single directory path to\
    \ be archived. |\n\n### Flow Description\n1. **Input Extraction:** The action\
    \ retrieves the archive type, base name, and input paths from the action parameters.\n\
    2. **Directory Setup:** It ensures the destination directory (`/opt/siemplify/siemplify_server/Scripting/FileUtilities/Archives`)\
    \ exists on the filesystem, creating it if necessary.\n3. **Archive Generation:**\
    \ \n    * If the input is a single directory, it archives the entire directory.\n\
    \    * If the input is a list of files, it copies them to a temporary directory\
    \ first and then archives that directory.\n4. **Result Reporting:** The action\
    \ returns the full path of the newly created archive file and sets the execution\
    \ status to success or failure based on the filesystem operations."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
CreateHashFromBase64:
  ai_description: >-
    ### General Description

    This action converts one or more Base64-encoded strings into cryptographic hashes
    using a specified algorithm. It is a utility action used for data transformation
    and verification, often used to calculate file hashes from encoded content without
    requiring the actual file to be present on the system. It can process multiple
    inputs simultaneously and optionally associate them with filenames or identifiers.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Base64 | Content | Yes | One or more Base64 encoded strings to be hashed. If
    providing multiple, they must be separated by the value in 'Base64 Separator'.
    |

    | Hash Algorythm | Dropdown | Yes | The hashing algorithm to use (e.g., sha256,
    md5, sha1). Supported algorithms include standard hashlib types. |

    | Names | String | No | A list of names (e.g., filenames) corresponding to the
    Base64 strings for identification in the output. |

    | Names Separator | String | Yes | The character used to split the 'Names' input.
    Default is a comma (,). |

    | Include Base64 | Boolean | No | If true, the original Base64 input strings are
    included in the JSON result output. Default is true. |

    | Base64 Separator | String | Yes | The character used to split the 'Base64' input
    strings. Default is a comma (,). |


    ### Additional Notes

    - If the 'Names' parameter is provided, the number of names must match the number
    of Base64 strings provided; otherwise, the action uses a zip-based iteration which
    may result in truncated output if counts differ.

    - This action does not interact with external APIs or the case entities; it strictly
    processes the provided input parameters.


    ### Flow Description

    1. **Input Parsing**: The action retrieves the Base64 strings and optional names,
    splitting them into lists based on the provided separators.

    2. **Algorithm Selection**: It identifies the requested hashing algorithm from
    the `hashlib` library.

    3. **Transformation Loop**: For each Base64 string, the action:
        - Decodes the Base64 content into bytes.
        - Calculates the hex digest of the hash using the selected algorithm.
        - Constructs a dictionary containing the hash, the algorithm used, the associated
    name (if provided), and optionally the original Base64 string.
    4. **Result Generation**: The collected results are added to the action's JSON
    results and the script output for use in subsequent playbook steps.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
DecodeBase64:
  ai_description: >-
    ### General Description

    The **Decode Base64** action is a utility designed to decode a provided Base64-encoded
    string back into its original text format. It allows users to specify the character
    encoding (UTF-8 or ASCII) for the resulting string. This action is primarily used
    to process encoded data often found in logs, email headers, or API responses.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Base64 Input | string | Yes | The Base64 encoded string that needs to be decoded.
    |

    | Encoding | ddl | Yes | The character encoding to apply to the decoded content.
    Options are **UTF-8** (default) or **ASCII**. |


    ### Additional Notes

    - This action does not interact with entities within the case. It operates strictly
    on the provided input parameter string.

    - The decoded result is returned as a JSON object containing the field `decoded_content`.


    ### Flow Description

    1. **Initialization**: The action retrieves the `Base64 Input` and the selected
    `Encoding` from the action parameters.

    2. **Decoding**: It attempts to decode the Base64 string using the standard Python
    `base64` library.

    3. **String Conversion**: The resulting bytes are converted to a string using
    the encoding specified (e.g., UTF-8).

    4. **Result Packaging**: The decoded string is placed into a JSON structure: `{"decoded_content":
    "<value>"}`.

    5. **Completion**: The action reports success and provides the JSON result to
    the SOAR platform for use in downstream tasks.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
ExtractArchive:
  ai_description: >-
    ### General Description Extracts archive files (ZIP, TAR, GZTAR, BZTAR, XTAR)
    located on the SOAR server filesystem to a specific extraction directory. This
    utility is used to unpack compressed data for further analysis or processing within
    the Google SecOps environment. ### Parameters Description | Parameter | Type |
    Mandatory | Description | | :--- | :--- | :--- | :--- | | Archive | String | Yes
    | A comma-delimited list of absolute paths to the archive files on the server
    (e.g., /path/to/file.zip). | ### Flow Description 1. **Input Parsing:** The action
    receives a list of file paths from the Archive parameter and splits them by comma.
    2. **Directory Preparation:** For each specified archive, it identifies or creates
    a unique subdirectory within the server extract path (/opt/siemplify/siemplify_server/Scripting/FileUtilities/Extract)
    based on the archive's filename. 3. **Extraction:** It uses the Python shutil
    library to unpack the archive contents into the designated subdirectory. 4. **Structure
    Analysis:** The action recursively maps the resulting folder structure into a
    dictionary format, identifying file names, types (file vs directory), and extensions.
    5. **Output:** It returns a comprehensive JSON result containing the extraction
    status for each archive and the full list of extracted files with their paths.
    ### Additional Notes This action performs direct filesystem operations on the
    SOAR server. It does not interact with external APIs or Google SecOps entities
    like IPs or Hostnames. It is purely a system utility for file management.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      The action creates directories and writes extracted files onto the local filesystem
      of the Google SecOps SOAR server at /opt/siemplify/siemplify_server/Scripting/FileUtilities/Extract.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
ExtractZipFiles:
  ai_description: >-
    ### General Description

    Extracts files from a ZIP archive associated with a **FILENAME** entity. This
    utility action is designed to handle both standard and password-protected archives,
    offering the ability to use a provided list of passwords or attempt a brute-force
    recovery. It performs deep analysis on the extracted contents, calculating multiple
    hash types (MD5, SHA1, SHA256, SHA512) and identifying MIME types.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Include Data In JSON Result | boolean | False | If enabled, the base64 encoded
    content of the extracted files will be included in the action's raw JSON result.
    |

    | Create Entities | boolean | False | If enabled, the action will create new **FILENAME**
    and **FILEHASH** entities for each extracted file within the case. |

    | Zip File Password | string | False | A password or a list of passwords used
    to decrypt protected ZIP files. Multiple passwords should be separated by the
    defined delimiter. |

    | BruteForce Password | boolean | False | If enabled, the action attempts to brute-force
    the ZIP password using a built-in wordlist if the provided passwords fail. |

    | Add to Case Wall | boolean | False | If enabled, the extracted files are uploaded
    as individual attachments to the Case Wall. |

    | Zip Password List Delimiter | string | True | The character used to separate
    multiple entries in the 'Zip File Password' parameter (e.g., a comma or semicolon).
    |


    ### Additional Notes

    * This action requires the **FILENAME** entity to have an `attachment_id` attribute
    in its `additional_properties` to retrieve the file from the SOAR storage.

    * If 'Create Entities' is enabled, the action establishes parent-child relationships
    between the archive and the extracted files.


    ### Flow Description

    1. **Identify Target Entities:** Filters the input entities to find **FILENAME**
    entities that contain an `attachment_id` in their metadata.

    2. **Download Archive:** Retrieves the ZIP file bytes from the SOAR attachment
    store using the identified ID.

    3. **Extraction Process:** Attempts to extract the archive. If encrypted, it tries
    the passwords provided in the 'Zip File Password' parameter. If those fail and
    'BruteForce Password' is true, it attempts a brute-force attack.

    4. **Content Analysis:** For every successfully extracted file, it generates MD5,
    SHA1, SHA256, and SHA512 hashes and determines the MIME type and file size.

    5. **Wall Integration:** If 'Add to Case Wall' is true, it uploads the extracted
    files back to the case as new attachments.

    6. **Entity Management:** If 'Create Entities' is true, it creates new **FILENAME**
    and **FILEHASH** entities. It also updates these entities with the calculated
    metadata (hashes, mime types, and parent-child links).
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates new FILENAME and FILEHASH entities within the case, updates entity properties
      with file metadata (hashes, MIME types), and uploads extracted files as new
      attachments to the Case Wall.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - FILENAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
GetAttachment:
  ai_description: >-
    ### General Description


    The **Get Attachment** action retrieves file attachments stored on the Google
    SecOps case wall. It identifies files associated with the current case or a specific
    alert, extracts their binary content, and converts them into Base64-encoded strings.
    This is primarily used to prepare file data for downstream analysis, such as sending
    a file to a sandbox or calculating its hash in a utility script.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Attachment Scope** | DDL | Yes | Determines the scope of the search. If set
    to `Alert`, only attachments linked to the current alert are retrieved. If set
    to `Case`, all attachments within the entire case wall are retrieved. |


    ### Flow Description


    1. **Fetch Metadata**: The action calls the internal SOAR API to retrieve metadata
    for all items on the case wall.

    2. **Filter Attachments**: It filters the wall items to find those of type 'Attachment'
    (Type 4).

    3. **Scope Validation**: If the user selected the `Alert` scope, the script further
    filters the list to include only those attachments whose `alertIdentifier` matches
    the ID of the alert currently being processed.

    4. **Content Retrieval**: For every matching attachment found, the action uses
    the `evidenceId` to fetch the raw binary data of the file.

    5. **Encoding**: The raw binary data is encoded into a Base64 string and added
    to the attachment's metadata dictionary.

    6. **Final Output**: The script outputs a JSON-formatted list of attachment objects
    containing metadata and the Base64 blobs.


    ### Additional Notes


    - The action returns a JSON array of attachments. If no attachments are found,
    an empty list is returned.

    - This action does not modify the case wall or the entities within the case; it
    is purely a data retrieval utility.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
GetFilesAsBase64:
  ai_description: >-
    ### General Description

    The **Get Files as Base64** action reads files from the local filesystem and converts
    their contents into Base64-encoded strings. This utility action is typically used
    to prepare file data for transmission to external systems (such as sandboxes or
    threat intelligence platforms) or for further processing within a playbook where
    raw binary data cannot be handled directly.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Paths | String | Yes | A comma-delimited list of absolute or relative file
    paths to be processed (e.g., `/tmp/malware.exe, /downloads/report.pdf`). |


    ### Flow Description

    1. **Input Parsing**: The action retrieves the `File Paths` string from the configuration
    and splits it into individual paths, stripping whitespace.

    2. **Path Verification**: The script iterates through the provided paths. It includes
    a specific logic handler to check if the file exists on the disk, accounting for
    potential commas within filenames by attempting to join path segments if a file
    is not immediately found.

    3. **Binary Extraction**: For every verified file path, the action opens the file
    in binary read mode (`rb`).

    4. **Base64 Encoding**: The file content is read and encoded into a Base64 string
    using the `base64` library. The result is then decoded into a UTF-8 string format
    for JSON compatibility.

    5. **Metadata Collection**: The action captures metadata for each file, including
    the directory path, the filename, and the file extension.

    6. **Final Output**: All processed file data and metadata are aggregated into
    a JSON result and returned to the SOAR platform. The action identifies the specific
    filenames processed in the final execution message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify the connectivity
    between Google SecOps and the **File Utilities** integration. It serves as a heartbeat
    check to ensure that the integration is properly installed and the execution environment
    is functional.


    ### Parameters

    There are no parameters for this action.


    ### Flow Description

    1. **Initialization**: The action initializes the `SiemplifyAction` context to
    establish a connection with the Google SecOps platform.

    2. **Connection Verification**: The script immediately confirms the connection.

    3. **Conclusion**: The action terminates with a success message, "Siemplify is
    connected", indicating that the integration is active and reachable.


    ### Additional Notes

    This action does not interact with external APIs, files, or case data; it strictly
    validates the internal communication path between the SOAR platform and the integration
    script.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
RemoveEntityFromFile:
  ai_description: "### General Description\nThe **Remove Entity from File** action\
    \ is a utility designed to manage local state or custom lists by removing specific\
    \ entity identifiers from a text file stored on the local filesystem (specifically\
    \ within the `/tmp/` directory). This is typically used to manage exclusion lists,\
    \ allowlists, or to track the completion of processes across different playbooks.\n\
    \n### Parameters\n| Parameter | Type | Mandatory | Description |\n| :--- | :---\
    \ | :--- | :--- |\n| Filename | string | Yes | The name of the file (located in\
    \ `/tmp/`) from which the entity identifiers should be removed. Defaults to `<filename.out>`.\
    \ |\n\n### Flow Description\n1. **Initialization**: The action identifies the\
    \ target file path by appending the provided `Filename` to the `/tmp/` directory.\n\
    2. **File Locking**: It employs a file-locking mechanism (`EntityFileManager`)\
    \ to ensure that no other concurrent actions modify the file while the removal\
    \ process is active.\n3. **Data Retrieval**: It reads the existing contents of\
    \ the file, which are expected to be a list of identifiers.\n4. **Identification\
    \ and Removal**: It iterates through all entities in the current scope. If an\
    \ entity's identifier exists within the file, it is removed from the internal\
    \ list. \n5. **State Update**: The action tracks if all target entities were successfully\
    \ found and removed. If any entity provided in the scope is missing from the file,\
    \ the final result value is set to `False`.\n6. **Persistence**: The updated list\
    \ (minus the removed entities) is written back to the file, and the file lock\
    \ is released.\n\n### Additional Notes\n- This action does not perform any network\
    \ calls to external APIs; it operates entirely on the local filesystem of the\
    \ execution environment.\n- The result of the action will be `True` only if every\
    \ target entity processed was successfully located and removed from the file."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes lines containing entity identifiers from a local text file stored in
      the /tmp directory of the SOAR execution environment.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - ADDRESS
      - DOMAIN
      - FILENAME
      - FILEHASH
      - HOSTNAME
      - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
SaveBase64ToFile:
  ai_description: "### General Description\nThis action converts Base64 encoded strings\
    \ into physical files and saves them to the local filesystem of the Google SecOps\
    \ runner or agent. It is primarily used to handle binary data retrieved from other\
    \ systems\u2014such as email attachments or API responses\u2014by making it available\
    \ as local files for subsequent analysis or storage.\n\n### Parameters Description\n\
    \n| Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :---\
    \ |\n| **Base64 Input** | String | Yes | A comma-separated list of Base64 encoded\
    \ strings that need to be converted into files. |\n| **Filename** | String | Yes\
    \ | A comma-separated list of filenames corresponding to the provided Base64 inputs.\
    \ |\n| **File Extension** | String | No | An optional comma-separated list of\
    \ file extensions to append to the filenames. If fewer extensions are provided\
    \ than filenames, the last provided extension is reused for the remaining files.\
    \ |\n\n### Additional Notes\n- The action automatically sanitizes filenames by\
    \ replacing spaces with underscores and removing invalid characters.\n- Files\
    \ are stored in a `downloads` directory within the execution environment's run\
    \ folder.\n- This action processes multiple inputs in parallel using zip-based\
    \ iteration over the provided lists.\n\n### Flow Description\n1. **Data Parsing**:\
    \ The action extracts the Base64 strings, filenames, and extensions from the input\
    \ parameters, splitting them by commas into lists.\n2. **Environment Configuration**:\
    \ It determines the target storage path (either the local run folder or the agent's\
    \ downloads folder) and ensures the directory exists.\n3. **File Creation**: For\
    \ each entry in the input list, the script sanitizes the filename, appends the\
    \ extension (if provided), decodes the Base64 content into binary, and writes\
    \ it to the disk.\n4. **Result Compilation**: It gathers the full file paths and\
    \ metadata for all successfully saved files.\n5. **Completion**: The action outputs\
    \ a JSON summary of the created files and ends with a message indicating the final\
    \ storage locations."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      The action creates and saves files to the local disk of the SOAR environment/agent
      in a directory named 'downloads'.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
