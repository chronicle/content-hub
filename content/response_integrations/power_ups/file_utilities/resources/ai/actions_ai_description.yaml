Add Attachment:
  ai_description: >-
    ### General Description

    Adds a file attachment to the case wall of a Google SecOps case. This action allows
    users to upload content (provided as a Base64 string) as evidence or documentation
    directly to the case timeline, similar to the 'attach evidence' functionality.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Name | String | Yes | The name of the attachment file. |

    | IsFavorite | Boolean | No | If true, the attachment is marked as a favorite
    in the case wall. |

    | Base64 Blob | String | Yes | The attachment's content encoded in Base64. |

    | Type | String | Yes | The file extension or type (e.g., .txt, .pdf). |

    | Description | String | Yes | A description for the attachment to be displayed
    on the case wall. |


    ### Flow Description

    1. **Initialization:** Retrieves input parameters including file content, name,
    type, and description.

    2. **Context Gathering:** Obtains the current Case Identifier from the SOAR environment.

    3. **Model Preparation:** Constructs a `CaseWallAttachment` object containing
    the provided metadata and Base64 content.

    4. **Execution:** Calls the internal Google SecOps API (`save_attachment_to_case_wall`)
    to upload the file to the case wall.

    5. **Completion:** Processes the API response to generate a JSON result containing
    the attachment's metadata (ID, timestamps, file info) and finishes the execution.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Adds a new file attachment to the internal case wall/evidence section of the
      Google SecOps case.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add Entity to File:
  ai_description: >-
    ### General Description

    The **Add Entity to File** action allows users to persist entity identifiers from
    a SOAR case into a local text file located on the execution environment's disk.
    This is primarily used for maintaining local blocklists, allowlists, or state
    tracking across different playbook executions without relying on external databases.
    The action ensures that each entity identifier is unique within the file, preventing
    duplicate entries.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Filename** | String | Yes | The name of the file (e.g., `blacklist.txt`) to
    which the entity identifiers will be written. The file is stored in the `/tmp/`
    directory of the runner. |


    ### Additional Notes

    - The action utilizes a file locking mechanism (`py-filelock`) with a 200-second
    timeout to prevent race conditions when multiple actions attempt to write to the
    same file simultaneously.

    - The action returns `True` only if all processed entities were newly added to
    the file. If at least one entity already existed in the file, the result value
    will be `False`.


    ### Flow Description

    1. **Initialization**: The action extracts the `Filename` parameter and prepends
    the local `/tmp/` path to determine the full target filepath.

    2. **File Locking**: It initiates a thread-safe/process-safe lock on the target
    file to ensure exclusive access.

    3. **Duplicate Check**: The action reads the existing content of the file and
    compares it against the identifiers of all target entities in the current scope.

    4. **Data Append**: For every entity identifier not already present in the file,
    it appends the identifier to its internal list.

    5. **State Update**: Once all entities are processed, the action writes the updated
    list back to the file and releases the lock.

    6. **Completion**: It returns a summary message indicating which entities were
    added and whether any were already present.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action writes and modifies data in a local file on the runner's filesystem,
      which exists outside the Google SecOps platform's primary database.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Count Files:
  ai_description: >-
    ### General Description

    This action counts files within a specified local directory based on a file extension
    pattern. It is useful for monitoring file system activity, verifying file delivery,
    or cleaning up temporary directories within an automated workflow. The action
    provides the total number of matched files as a result.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Folder | string | Yes | The absolute folder path from which you want to count
    files (e.g., `/var/log`). |

    | File Extension | string | No | The glob pattern or specific file extension to
    filter by (e.g., `*.log`, `data_*.csv`). If not provided, the action defaults
    to `*.*` (all files). |

    | Is Recursive | boolean | No | If set to `true`, the action will search for matching
    files in the specified folder and all its subdirectories. Defaults to `false`.
    |


    ### Flow Description

    1. **Initialization**: The action initializes the SOAR SDK and retrieves the input
    parameters: `Folder`, `File Extension`, and `Is Recursive`.

    2. **Path Construction**: If no `File Extension` is provided, the script defaults
    to `*.*`. It then joins the `Folder` path with the `File Extension` pattern to
    create a full glob path.

    3. **File Discovery**: The action uses the Python `glob` library to search for
    all files matching the constructed path. If `Is Recursive` is enabled, the search
    includes nested directories.

    4. **Counting and Reporting**: The action calculates the length of the list of
    discovered files and returns this integer as the final script result and result
    value.


    ### Additional Notes

    - This action does not interact with SOAR entities (IPs, Hostnames, etc.) and
    operates solely on the provided path string.

    - Ensure the service account running the SOAR agent has appropriate read permissions
    for the target folder path.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Archive:
  ai_description: "### General Description\nThe **Create Archive** action allows users\
    \ to bundle one or multiple files or an entire directory into a compressed archive\
    \ file (e.g., .zip, .tar.gz). This utility is primarily used for organizing data,\
    \ preparing logs for export, or consolidating evidence for investigations within\
    \ the Google SecOps environment. The resulting archive is stored on the local\
    \ filesystem of the SecOps runner.\n\n### Parameters Description\n\n| Parameter\
    \ | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| **Archive\
    \ Type** | Dropdown (ddl) | Yes | Specifies the compression format. Supported\
    \ types: `zip`, `tar` (uncompressed), `gztar` (gzip), `bztar` (bzip2), and `xztar`\
    \ (xz). |\n| **Archive Base Name** | String | Yes | The name of the resulting\
    \ archive file (excluding the extension). |\n| **Archive Input** | String | Yes\
    \ | A comma-separated list of file paths or a single directory path to be archived.\
    \ |\n\n### Additional Notes\n- This action performs local filesystem operations.\
    \ The archives are stored in the directory: `/opt/siemplify/siemplify_server/Scripting/FileUtilities/Archives`.\
    \ If this directory does not exist, the action will attempt to create it.\n- If\
    \ a list of files is provided, the action creates a temporary directory to stage\
    \ the files before archiving and deletes it afterward.\n\n### Flow Description\n\
    1. **Extraction**: The action retrieves the archive type, base name, and input\
    \ paths from the user-provided parameters.\n2. **Directory Verification**: It\
    \ checks if the destination storage directory exists on the local filesystem and\
    \ creates it if necessary.\n3. **Input Processing**: \n    - If the input is a\
    \ **directory**, the action directly archives the folder.\n    - If the input\
    \ is a **list of files**, it copies them into a temporary folder for staging.\n\
    4. **Compression**: Utilizing the `shutil` library, it creates the archive in\
    \ the specified format and saves it to the destination path.\n5. **Completion**:\
    \ The action returns the full file path of the created archive as the result and\
    \ adds a JSON summary to the action results."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates a directory and saves the generated archive file to the local filesystem
      of the Google SecOps runner at /opt/siemplify/siemplify_server/Scripting/FileUtilities/Archives.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Hash From Base64:
  ai_description: >-
    ### General Description

    The **Create Hash From Base64** action is a utility designed to convert Base64
    encoded strings into cryptographic hashes. It allows users to provide one or multiple
    Base64 strings and compute their hashes using a variety of supported algorithms
    (such as MD5, SHA1, SHA256, etc.). This is particularly useful for identifying
    file contents or payloads extracted from security events without needing to write
    custom scripts for local computation.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base64** | Content | Yes | One or more base64 encoded strings to be hashed.
    If providing multiple strings, they must be separated by the character defined
    in the 'Base64 Separator' parameter. |

    | **Hash Algorythm** | DDL | Yes | The hashing algorithm to apply. Supports: blake2b,
    blake2s, md5, sha1, sha224, sha256, sha384, sha3_224, sha3_256, sha3_384, sha3_512,
    sha512. |

    | **Names** | String | No | A list of names (e.g., filenames) associated with
    the base64 strings. The number of names must match the number of base64 strings
    provided. |

    | **Names Separator** | String | Yes | The character used to separate the values
    in the 'Names' parameter. Default is a comma (`,`). |

    | **Include Base64** | Boolean | No | If set to `true`, the original base64 input
    strings will be included in the output JSON result. Default is `true`. |

    | **Base64 Separator** | String | Yes | The character used to separate multiple
    base64 strings in the 'Base64' input field. Default is a comma (`,`). |


    ### Additional Notes

    - This action does not run on entities and instead operates directly on the data
    provided in the parameters.

    - If the 'Names' parameter is provided, it must contain exactly the same number
    of items as the 'Base64' parameter to ensure correct mapping.


    ### Flow Description

    1. **Input Parsing:** The action splits the provided 'Base64' input and optional
    'Names' input into lists based on the specified separators.

    2. **Validation:** It verifies the requested hashing algorithm is supported by
    the `hashlib` library.

    3. **Processing Loop:** For each Base64 string:
        - It decodes the Base64 string into raw bytes.
        - It computes the hex digest of the bytes using the selected 'Hash Algorythm'.
        - It constructs a result dictionary containing the hash, algorithm, and optionally
    the original Base64 and Name.
    4. **Result Aggregation:** The collected hashes are formatted into a JSON array.

    5. **Output:** The action returns the JSON data and a success message to the SOAR
    platform.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Decode Base64:
  ai_description: >-
    ### General Description

    The **Decode Base64** action decodes a provided Base64-encoded string into its
    original text format. This is a utility action used to translate encoded data
    frequently encountered in security logs, forensic artifacts, or network traffic
    into a human-readable format.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base64 Input** | string | Yes | The Base64 encoded string that requires decoding.
    |

    | **Encoding** | ddl | Yes | The character encoding to apply to the decoded bytes.
    Options include **UTF-8** and **ASCII**. Default is **UTF-8**. |


    ### Flow Description

    1. **Parameter Retrieval**: The action extracts the `Base64 Input` and the specified
    `Encoding` (UTF-8 or ASCII) from the user configuration.

    2. **Decoding Process**: It utilizes the Python `base64` library to decode the
    input string into a byte stream.

    3. **String Conversion**: The decoded bytes are converted into a string using
    the selected encoding method.

    4. **Result Generation**: The final string is packaged into a JSON object and
    returned as the action result, with the execution status marked as successful
    if no errors occur.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Extract Archive:
  ai_description: >-
    ### General Description

    This action extracts archive files to a specific directory on the Google SecOps
    server. It supports multiple archive formats including ZIP, TAR, GZTAR, BZTAR,
    and XTAR. The action is designed to handle multiple archives provided as a comma-separated
    list, creating dedicated subdirectories for each extraction and returning a structured
    JSON summary of the extracted file hierarchy.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Archive | A comma-delimited list of full paths to the archive files to be extracted
    (e.g., `/path/to/file1.zip, /path/to/file2.tar`). | String | Yes |


    ### Additional Notes

    - The extraction destination is hardcoded to `/opt/siemplify/siemplify_server/Scripting/FileUtilities/Extract`
    within the script.

    - For each archive, a new folder is created using the archive's stem name (filename
    without extension).

    - The action requires appropriate filesystem permissions on the SOAR worker to
    create directories and write files.

    - It does not process entities from the case; it relies purely on the provided
    file paths.


    ### Flow Description

    1. **Input Parsing:** The action retrieves the `Archive` parameter and splits
    it into a list of individual file paths.

    2. **Directory Preparation:** For each archive, it determines the target extraction
    path and attempts to create the directory (including parents) if it does not already
    exist.

    3. **Extraction:** It uses the `shutil.unpack_archive` utility to extract the
    contents of the archive into the designated folder.

    4. **Result Compilation:** It recursively scans the extraction folder to build
    a dictionary representing the file/directory structure and collects a list of
    full file paths.

    5. **Output:** The action aggregates the status for all processed archives, adds
    a detailed JSON result to the action output, and concludes with a success or failure
    status based on whether all files were processed correctly.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Extract Zip Files:
  ai_description: >-
    ### General Description

    This action extracts files from ZIP archives that are attached to a case. It targets
    `FILENAME` entities that possess an `attachment_id` attribute. The action can
    handle password-protected ZIP files through provided credentials or brute-force
    attempts. Extracted files can be added back to the Case Wall as new attachments
    and converted into new `FILENAME` and `FILEHASH` entities.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Include Data In JSON Result | boolean | No | If true, the base64-encoded raw
    content of the extracted files is included in the action's JSON output. |

    | Create Entities | boolean | No | If true, the action creates new `FILENAME`
    and `FILEHASH` entities for each extracted file and links them to the parent ZIP
    file. |

    | Zip File Password | string | No | A single password or a list of passwords (separated
    by the delimiter) used to attempt extraction of protected archives. |

    | BruteForce Password | boolean | No | If true, the action attempts to brute-force
    the ZIP password using a built-in wordlist. |

    | Add to Case Wall | boolean | No | If true, extracted files are uploaded as new
    attachments to the Case Wall. |

    | Zip Password List Delimiter | string | Yes | The character used to separate
    multiple entries in the 'Zip File Password' parameter. |


    ### Additional Notes

    - For this action to function, the `FILENAME` entity must have the `attachment_id`
    property, which is typically populated when a file is uploaded to the Case Wall.

    - Brute-forcing is computationally intensive and relies on a predefined wordlist
    within the integration's environment.


    ### Flow Description

    1.  **Entity Filtering:** The action identifies all `FILENAME` entities in the
    current scope that contain an `attachment_id` in their additional properties.

    2.  **Download:** For each valid entity, it retrieves the binary content of the
    attachment from the Google SecOps platform.

    3.  **Extraction Logic:** It attempts to open the file as a ZIP. If protected,
    it tries the provided passwords and/or brute-force (if enabled).

    4.  **Metadata Generation:** For every file found inside the ZIP, the action calculates
    hashes (MD5, SHA1, SHA256, SHA512) and identifies the MIME type.

    5.  **Internal Updates:** Based on configuration, it uploads the extracted files
    to the Case Wall, creates new linked entities, and updates the original entity
    with the results.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Adds extracted files as new attachments to the Case Wall and creates new entities
      (FILENAME and FILEHASH) within the case context.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
    - FILENAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Attachment:
  ai_description: >-
    ### General Description

    This action retrieves file attachments from the Google SecOps (Chronicle) Case
    Wall or Alert Wall. It is designed to extract files and provide them as Base64-encoded
    strings, allowing subsequent playbook steps to process the file content (e.g.,
    for sandboxing, hashing, or further analysis). Users can scope the retrieval to
    either the entire Case or just the specific Alert currently being processed.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Attachment Scope | ddl | Yes | Determines the context for retrieval. If set
    to **Case**, the action fetches all attachments found on the Case Wall. If set
    to **Alert**, it only retrieves attachments associated with the current alert
    identifier. |


    ### Flow Description

    1. **Metadata Retrieval**: The action calls the internal API to fetch metadata
    for all items on the case wall.

    2. **Filtering**: It identifies items of type 'Attachment' (type 4) and filters
    them based on the user-selected **Attachment Scope** (Case or Alert).

    3. **Content Fetching**: For each filtered attachment, the script retrieves the
    raw binary content using the unique evidence identifier.

    4. **Encoding**: The binary data is Base64 encoded and appended to the metadata
    record as a `base64_blob`.

    5. **Output**: The action produces a JSON array of all found attachments with
    their metadata and encoded content, and summarizes the count in the action result
    message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Files as Base64:
  ai_description: >-
    ### General Description

    This utility action converts local files from the system where the Google SecOps
    agent or runner is located into Base64-encoded strings. It is designed to facilitate
    the transport of file content into the SOAR environment for downstream processing,
    such as analysis or attachment to a case. The action identifies files based on
    provided paths, reads their binary content, and produces a structured JSON output
    containing the Base64 data alongside file metadata.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **File Paths** | String | Yes | A comma-delimited list of absolute file paths
    to be processed. The action includes specific logic to handle filenames that may
    contain commas by recursively verifying the path's existence on the disk. |


    ### Flow Description

    1. **Input Parsing**: The action retrieves the comma-separated string of file
    paths from the parameters.

    2. **Path Validation**: It executes a verification routine (`get_filenames`) that
    checks for the existence of each file on the local file system, accounting for
    possible commas within filenames.

    3. **Content Retrieval**: For each valid file identified, the action opens the
    file in binary read mode.

    4. **Base64 Encoding**: The binary content is encoded into a Base64 string.

    5. **Metadata Extraction**: It extracts file metadata including the filename,
    parent path, and file extension.

    6. **Result Compilation**: All processed data is aggregated into a JSON object
    and returned as the action result.


    ### Additional Notes

    - This is a utility-focused action and does not interact with or process specific
    entities (e.g., IP, Hostname) from the alert or case.

    - The action relies on local file system permissions accessible to the execution
    environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Verifies the connectivity and readiness of the File Utilities integration within
    the Google SecOps environment. This action serves as a basic health check to confirm
    that the integration's execution environment is correctly configured and that
    the Google SecOps platform can successfully communicate with the integration logic.


    ### Parameters

    There are no parameters for this action.


    ### Flow Description

    1. **Initialization**: The action initializes the SiemplifyAction module to establish
    the context for the execution.

    2. **Connectivity Check**: The script executes a minimal logic path that does
    not depend on external APIs or local file systems.

    3. **Termination**: The action concludes by calling the end method with the message
    "Siemplify is connected", signifying a successful connection and operational state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Entity from File:
  ai_description: >-
    ### General Description

    The **Remove Entity from File** action is a utility designed to manage local data
    by removing specific entity identifiers from a text file. This is useful for maintaining
    local allowlists, denylists, or state files directly on the Google SecOps runner.
    The action ensures thread safety by using a file-locking mechanism to prevent
    data corruption during concurrent operations.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Filename** | string | Yes | The name of the file located in the `/tmp/` directory
    from which entities should be removed. |


    ### Flow Description

    1. **Initialization**: The action retrieves the target filename from the parameters
    and constructs the full path (prefixed with `/tmp/`).

    2. **File Locking**: It establishes a file lock (`.lock`) to ensure exclusive
    access while processing.

    3. **Read Operation**: The manager reads the current contents of the file into
    memory as a list of identifiers.

    4. **Entity Processing**: It iterates through all entities in the current scope.
    For each entity:
        * If the entity's identifier exists in the file, it is removed from the internal
    list.
        * If the entity's identifier is not found, the action notes this and will
    ultimately return a 'False' result value to indicate not all entities were successfully
    removed.
    5. **Write and Release**: The updated list of identifiers is written back to the
    file, and the file lock is released.

    6. **Final Output**: The action returns a summary message listing which entities
    were removed or not found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action modifies a local file on the system's filesystem by removing lines
      that correspond to entity identifiers.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
    - GENERICENTITY
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Save Base64 to File:
  ai_description: >-
    ### General Description

    The **Save Base64 to File** action converts Base64-encoded strings into physical
    files and saves them to a local directory on the Google SecOps platform or a remote
    agent. This utility is designed to help analysts reconstruct file artifacts (such
    as images, documents, or executables) that have been extracted and encoded during
    the execution of a playbook or script.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base64 Input** | String | Yes | A comma-separated list of Base64 encoded strings
    to be converted into files. Each string corresponds to one file. |

    | **Filename** | String | Yes | A comma-separated list of filenames to be used
    for the saved files. The order should match the Base64 input list. |

    | **File Extension** | String | No | An optional comma-separated list of file
    extensions (e.g., 'txt', '.png') to append to the filenames. If a single extension
    is provided, it will be applied to all files. If multiple are provided but fewer
    than the number of files, the last extension in the list will be used for the
    remaining files. |


    ### Additional Notes

    - Filenames are automatically sanitized to remove invalid characters and spaces
    are replaced with underscores to ensure file system compatibility.

    - Files are stored in a `downloads` folder within the execution environment's
    temporary run folder or the agent's specific download directory.


    ### Flow Description

    1. **Input Parsing**: The action extracts and splits the `Base64 Input`, `Filename`,
    and `File Extension` parameters into lists, handling comma-separated values.

    2. **Path Configuration**: It identifies the target directory (`downloads`) based
    on whether the action is running locally on the platform or via a remote agent.

    3. **Directory Creation**: The action ensures the target directory exists on the
    disk, creating it if necessary.

    4. **Extension Logic**: It matches file extensions to filenames, duplicating the
    last extension if the extension list is shorter than the file list.

    5. **Decoding and Writing**: For each provided input, it cleans the filename,
    decodes the Base64 content into binary data, and writes it to the local file system.

    6. **Finalization**: It compiles a JSON result containing the path, name, and
    extension for every saved file and provides a summary message of the saved locations.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates and writes files to the local file system of the Google SecOps platform
      or the remote agent environment.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
