Create Entity Insight From Enrichment:
  ai_description: >-
    ### General Description

    This action creates dynamic entity insights within Google SecOps by parsing a
    template message and populating it with data from an entity's existing enrichment
    properties. It is primarily used to summarize or highlight specific findings from
    previous enrichment steps in a human-readable format on the entity's insight panel.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Message | String | Yes | A template string that supports placeholders corresponding
    to keys in the entity's `additional_properties`. For example: `User {AD_DisplayName}
    is part of {AD_Department}`. |

    | Triggered By | String | No | The name of the integration or source to be associated
    with the created insight. Defaults to 'Siemplify'. |


    ### Additional Notes

    - The action relies on the `additional_properties` attribute of an entity, which
    is typically populated by preceding enrichment actions in a playbook.

    - If the placeholders in the `Message` cannot be resolved or result in an empty
    string, no insight will be created for that specific entity.


    ### Flow Description

    1. **Initialization**: The action retrieves the template `Message` and the `Triggered
    By` source from the input parameters.

    2. **Entity Iteration**: It iterates through all entities currently in the action's
    scope (`target_entities`).

    3. **Placeholder Parsing**: For each entity, it uses a utility function to map
    placeholders in the template (e.g., `{key}`) to values found in the entity's `additional_properties`
    dictionary.

    4. **Insight Creation**: If the parsing logic successfully generates a non-empty
    message, the action calls the SOAR API to add an entity insight with the resolved
    text.

    5. **Completion**: The action concludes by listing all entities for which insights
    were successfully generated.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates new entity insights within the Google SecOps case based on provided
      templates and existing enrichment data.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Entity Insight From JSON:
  ai_description: >-
    ### General Description

    The **Create Entity Insight From JSON** action allows users to generate custom
    entity insights within Google SecOps by processing a provided JSON dataset. It
    acts as a data-to-insight mapper, where information from an external source (passed
    as a JSON string parameter) is matched against entities in the current case and
    formatted into human-readable insights using a template.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **JSON** | String | Yes | A JSON-formatted string (expected to be a list of
    objects) containing the data to be used for generating insights. |

    | **Identifier KeyPath** | String | Yes | The dot-notation path (e.g., `user.email`
    or `id`) within the JSON objects that contains the value to match against the
    SOAR entity's identifier. |

    | **Message** | String | Yes | A template string for the insight. Placeholders
    like `{key_name}` or `{key|pipe_func()}` are replaced with values from the matching
    JSON object. |

    | **Triggered By** | String | No | The name of the integration or source to be
    associated with the created insight. Defaults to "Siemplify". |


    ### Flow Description

    1. **Data Parsing**: The action parses the input `JSON` string into a Python list
    of dictionaries.

    2. **Entity Iteration**: It iterates through all `target_entities` available in
    the current scope of the action.

    3. **Matching**: For each entity, it searches the JSON list for a record where
    the value at the specified `Identifier KeyPath` matches the entity's identifier
    (case-insensitive).

    4. **Message Formatting**: If a match is found, it processes the `Message` template.
    It replaces placeholders with corresponding values from the JSON record and applies
    any specified pipe functions (such as `count`, `join`, `to_str`, or `default`).

    5. **Insight Creation**: The final formatted message is added as an insight to
    the specific entity within the Google SecOps case.


    ### Additional Notes

    - This action is highly flexible for "bringing your own data" into the case wall
    from previous playbook steps.

    - Supported pipe functions in placeholders include `default(val)`, `str()`, `count()`,
    `to_str()`, and `join(delimiter)`.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates entity insights within the Google SecOps case based on the provided
      JSON data and template.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
"Create Entity Insight From Multiple JSONs":
  ai_description: >-
    ### General Description

    This action generates entity insights by parsing up to five separate JSON strings
    provided as input parameters. It allows users to extract specific data points
    from complex JSON structures using path-based logic and present them as formatted
    HTML tables within the entity's insight section in Google SecOps. This is particularly
    useful for consolidating data from multiple previous playbook steps into a single,
    readable insight for analysts.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | JSON1 - JSON5 | String | No | The raw JSON string to be parsed. The code expects
    a specific format where the JSON contains an 'Entity' identifier and an 'EntityResult'
    object. |

    | Fields1 - Fields5 | String | No | A string defining which fields to extract
    from the JSON. Format: `DisplayName:path.to.key`. Multiple fields are separated
    by the 'Placeholder Separator'. |

    | Title1 - Title5 | String | No | The title used for the specific section of the
    entity insight. |

    | Placeholder Separator | String | No | The character used to separate multiple
    field definitions in the 'Fields' parameters. Defaults to a comma (`,`). |


    ### Additional Notes

    * The action iterates through all entities in the current scope and attempts to
    find matching data in the provided JSON strings based on the entity identifier.

    * If a field definition does not include a colon (`:`), the value is treated as
    a raw string to be appended to the insight rather than a table row.

    * The action uses a custom parsing logic (`parse_raw_message`) that supports advanced
    path navigation and basic functions like `count` or `to_str` within the field
    definitions.


    ### Flow Description

    1. **Initialization**: The action retrieves the five sets of JSON, Fields, and
    Title parameters, along with the separator character.

    2. **Parsing**: It parses the field extraction strings into structured objects
    containing display names and key paths.

    3. **Entity Iteration**: The action loops through every entity currently associated
    with the alert/case.

    4. **Data Matching**: For each entity, it searches the provided JSON arrays for
    an entry where the `Entity` field matches the entity's identifier.

    5. **Extraction**: If a match is found, it extracts the values for the defined
    paths from the `EntityResult` portion of the JSON.

    6. **Formatting**: The extracted values are formatted into an HTML table (or raw
    text if no display name was provided).

    7. **Insight Creation**: The action calls `add_entity_insight` to attach the formatted
    data to the entity, using the provided `Title` as the trigger/header.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      The action creates entity insights within Google SecOps based on the provided
      JSON input parameters.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool designed to verify the connectivity and
    operational status of the Insights integration within the Google SecOps (Chronicle)
    SOAR environment. It serves as a basic health check to ensure that the integration
    is correctly configured and that the script execution environment is functional.


    ### Parameters Description

    There are no parameters configured for this action.


    ### Additional Notes

    This action does not interact with any external APIs or modify any data. It is
    strictly used to confirm that the SOAR platform can successfully initialize and
    execute a script associated with the Insights integration.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify API context to establish
    a connection with the SOAR platform.

    2. **Connectivity Confirmation**: The action immediately terminates with a success
    message ('Siemplify is connected'), indicating that the integration environment
    is reachable and responsive.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
