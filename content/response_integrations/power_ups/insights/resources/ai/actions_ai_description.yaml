CreateEntityInsightFromEnrichment:
  ai_description: >-
    ### General Description

    Creates custom entity insights by parsing and formatting enrichment data stored
    in entity properties. This action allows users to define a dynamic message template
    that automatically pulls values from previous enrichment steps (stored in `additional_properties`)
    to generate human-readable insights for analysts.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Message | string | True | A formatted string containing placeholders (e.g.,
    `{AD_name}`) that match keys in the entity's enrichment data. It supports complex
    paths and basic formatting functions like `count`, `join`, and `default`. |

    | Triggered By | string | False | The name of the integration to be associated
    with the created insight. Defaults to 'Siemplify' if not provided. |


    ### Additional Notes

    - This action does not fetch new data from external sources; it processes data
    already present on the entities within Google SecOps.

    - The placeholder syntax supports piping and nested keys (e.g., `{user.details|to_str}`).

    - Insights are only created for entities where the message template can be successfully
    populated with data.


    ### Flow Description

    1. **Initialization**: Retrieves the template message and the 'Triggered By' source
    from the action parameters.

    2. **Entity Processing**: Iterates through all entities currently targeted by
    the action in the scope of the alert/case.

    3. **Template Parsing**: For each entity, it attempts to resolve placeholders
    in the `Message` string using the key-value pairs found in the entity's `additional_properties`
    attribute.

    4. **Insight Generation**: If the parsing is successful and results in a non-empty
    message, the action calls the SDK to add a new insight to that specific entity.

    5. **Completion**: Updates the action results with a list of all entities that
    received an insight and marks the action as completed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates and attaches new entity insights to the current case based on the provided
      template and entity enrichment data.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - GENERICENTITY
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
CreateEntityInsightFromJson:
  ai_description: >-
    ### General Description

    The **Create Entity Insight From JSON** action allows users to dynamically generate
    entity insights by processing a provided JSON string and a message template. This
    action is particularly useful for taking raw data (e.g., from a previous step's
    output) and formatting it into human-readable insights attached to specific entities
    within Google SecOps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **JSON** | string | Yes | The JSON string (object or list) containing the data
    to be used for the Entity Insight. |

    | **Identifier KeyPath** | string | Yes | A dot-separated path (e.g., `user.email`)
    specifying where to find the identifier in the JSON that matches the entity identifier
    in the case. |

    | **Message** | string | Yes | A template string for the insight. Placeholders
    like `{key}` or `{path.to.key}` are replaced with values from the JSON. Supports
    pipe functions like `| count()`, `| to_str()`, and `| default()`. |

    | **Triggered By** | string | No | The name of the integration to be associated
    with the created insight. Defaults to "Siemplify". |


    ### Flow Description

    1. **Initialization:** The action parses the provided JSON string and splits the
    `Identifier KeyPath` by dots to navigate the JSON structure.

    2. **Entity Matching:** It iterates through all target entities in the current
    context.

    3. **Data Retrieval:** For each entity, it searches the JSON data for a matching
    identifier based on the `Identifier KeyPath`.

    4. **Message Formatting:** If a match is found, the action parses the `Message`
    template, replacing placeholders with the corresponding values from the matched
    JSON object. It processes any pipe functions (like `count` or `join`) specified
    in the template.

    5. **Insight Creation:** The action creates an entity insight with the formatted
    message and attributes it to the specified integration.

    6. **Finalization:** The action concludes by reporting which entities received
    insights.


    ### Additional Notes

    - The action expects the JSON to be a list of objects if it needs to search for
    specific entities.

    - The template engine supports advanced formatting, such as converting lists to
    strings or providing default values if a key is missing.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Creates new Entity Insights within the Google SecOps case based on the provided
      JSON data.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - GENERICENTITY
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
CreateEntityInsightFromMultipleJsons:
  ai_description: >-
    ### General Description

    This action creates entity insights by processing up to five sets of JSON data
    and formatting specific fields into HTML tables. It is designed as a utility to
    transform raw JSON output (typically from previous playbook steps) into readable
    insights attached to entities within Google SecOps. The action matches entities
    by their identifiers against the provided JSON arrays and uses a custom path-based
    extraction logic to retrieve data points.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **JSON1 - JSON5** | String | No | JSON arrays containing data for enrichment.
    Each element must contain an `Entity` key (matching the entity identifier) and
    an `EntityResult` key (the actual data). |

    | **Fields1 - Fields5** | String | No | Formatting strings that define which fields
    to extract. Uses the format `Display Name:{path.to.key}`. If no colon is used,
    the field is added as a text block above the table. |

    | **Title1 - Title5** | String | No | The title/trigger name for the insight section
    generated from the corresponding JSON slot. |

    | **Placeholder Separator** | String | No | The character used to separate multiple
    field definitions in the `Fields` parameters. Defaults to a comma (`,`). |


    ### Additional Notes

    - The input JSON strings must be formatted as a list of objects, where each object
    has the structure: `{"Entity": "identifier", "EntityResult": {...}}`.

    - The `Fields` parameter supports advanced data manipulation through "pipes" within
    the curly braces (e.g., `{path|count}` or `{path|to_str}`).

    - Either `JSON1`, `JSON2`, `JSON3`, `JSON4`, or `JSON5` must be populated for
    the action to have an effect.


    ### Flow Description

    1. **Initialization**: The action retrieves up to five sets of parameters (Title,
    Fields, JSON) and the placeholder separator.

    2. **Parsing**: It validates the JSON strings and parses the field extraction
    logic (mapping display names to JSON paths).

    3. **Entity Matching**: For every entity in the current scope, the action scans
    the provided JSON arrays to find a match where the `Entity` field equals the entity's
    identifier.

    4. **Data Extraction**: If a match is found, it traverses the `EntityResult` object
    using the defined paths in the `Fields` parameter, handling complex structures
    like lists and nested dictionaries.

    5. **Insight Generation**: Extracted data is formatted into an HTML table. If
    a field was defined without a display name (no colon), it is added as a separate
    text line.

    6. **Finalization**: The formatted HTML content is attached as an Entity Insight
    to the matching entity in Google SecOps.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Adds entity insights to the specific entities within the Google SecOps case.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - GENERICENTITY
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool designed to verify the connectivity and
    operational status of the **Insights** integration within Google SecOps. Its primary
    purpose is to ensure that the environment can successfully execute scripts and
    communicate with the SOAR platform.


    ### Parameters Description

    This action does not require any input parameters.


    ### Flow Description

    1.  **Initialization**: The script initializes the `SiemplifyAction` module to
    establish a context within the Google SecOps environment.

    2.  **Connectivity Verification**: The action executes a simple logic flow that
    requires no external API calls.

    3.  **Completion**: The script terminates by sending a success signal and a static
    message ("Siemplify is connected") to the platform, confirming the integration
    is responsive.


    ### Additional Notes

    This action is typically used for troubleshooting or initial setup verification.
    It has no side effects on external systems or internal case data.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
