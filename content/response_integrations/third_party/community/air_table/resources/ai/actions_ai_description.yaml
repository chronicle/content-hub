AddOrUpdate:
  ai_description: >-
    ### General Description

    This action facilitates the synchronization of data between Google SecOps and
    AirTable by performing an 'upsert' (Update or Insert) operation. It allows users
    to provide a list of records in JSON format and specify a unique field to check
    for existence. If a record with a matching field value exists in the target AirTable
    table, it is updated; otherwise, a new record is created.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Base id | string | Yes | The unique identifier for the AirTable base where the
    table resides. |

    | Table name | string | Yes | The name of the specific table within the AirTable
    base to modify. |

    | Field name | string | Yes | The name of the field (column) used to identify
    existing records. The action searches for this field's value to decide between
    an update or an insert. |

    | Json fields | string | Yes | A JSON-formatted string representing a list of
    objects. Each object contains the data for a single record to be added or updated.
    |


    ### Additional Notes

    - The `Json fields` parameter must be a valid JSON array of objects (e.g., `[{"Email":
    "user@example.com", "Status": "Active"}]`).

    - The `Field name` provided must exist as a key within the objects provided in
    the `Json fields` parameter.


    ### Flow Description

    1. **Initialization**: The action retrieves the AirTable API key from the integration
    configuration and extracts the Base ID, Table Name, Field Name, and JSON data
    from the parameters.

    2. **Data Parsing**: The `Json fields` string is parsed into a list of dictionaries.

    3. **Search and Decision**: For each record in the list, the action queries the
    AirTable API to find existing records where the specified `Field name` matches
    the value in the input data.

    4. **Update Logic**: If the search returns existing records, the action iterates
    through them and updates each one with the provided JSON data.

    5. **Insert Logic**: If no matching records are found, the action creates a new
    record in the AirTable table.

    6. **Completion**: The action returns a summary message indicating the total number
    of records inserted and updated.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action performs 'update' and 'insert' operations on the specified AirTable
      table, modifying existing records or creating new ones based on the provided
      input.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create:
  ai_description: >-
    ### General Description

    The **Create** action allows users to programmatically insert one or more new
    records into a specific table within an AirTable base. This action is designed
    to facilitate data synchronization and logging by pushing structured data from
    Google SecOps into AirTable. It is particularly useful for tracking incident response
    progress, logging specific alert details for long-term storage, or updating shared
    team databases.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base id** | String | Yes | The unique identifier for the AirTable base (database).
    This ID can be found in the URL of the AirTable API documentation page for that
    specific base. |

    | **Table name** | String | Yes | The name of the table within the specified base
    where the new records will be inserted. |

    | **Json fields** | Content | Yes | A JSON-formatted array of objects. Each object
    represents a single record (row) to be created. The keys in the object must match
    the field (column) names in the AirTable table. |


    ### Flow Description

    1. **Initialization**: The action initializes the AirTable client using the API
    key provided in the integration configuration.

    2. **Parameter Extraction**: It retrieves the Base ID, Table Name, and the JSON
    string containing the record data from the action parameters.

    3. **Data Parsing**: The `Json fields` string is parsed into a list of Python
    dictionaries.

    4. **Record Insertion**: The action iterates through each dictionary in the list
    and performs an `insert` operation into the specified AirTable table.

    5. **Result Collection**: For each successful insertion, the action captures the
    unique record ID and the field data returned by AirTable.

    6. **Finalization**: The action outputs a JSON object containing the details of
    all created records and provides a summary message indicating the total number
    of records added.


    ### Additional Notes

    - This action supports bulk creation; you can provide multiple record objects
    within the `Json fields` array to create multiple rows in a single execution.

    - Ensure that the JSON keys exactly match the column names in AirTable, including
    case sensitivity and spacing.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates new records (rows) in a specified AirTable table within a base.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Delete:
  ai_description: >-
    ### General Description

    This action deletes specific records from an Airtable table based on a provided
    field name and value. It is used to programmatically remove data from an external
    Airtable base when certain criteria are met, such as cleaning up logs or removing
    processed entries.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Base id | string | Yes | The unique identifier for the Airtable base (found
    in the API URL). |

    | Table name | string | Yes | The name of the specific table within the base where
    records will be deleted. |

    | Field name | string | Yes | The name of the column (field) to search for matching
    records. |

    | Field value | string | Yes | The specific value to look for in the 'Field name'
    column. Records with this value will be deleted. |

    | Max records | string | Yes | The maximum number of records that will be affected
    by the deletion process. Default is 100. |


    ### Additional Notes

    This action does not run on entities. It uses the provided parameters to perform
    a search and then executes a delete operation on every record returned by that
    search, up to the specified limit.


    ### Flow Description

    1. **Initialization**: The action retrieves the Airtable API key from the integration
    configuration and the base, table, and search criteria from the action parameters.

    2. **Search**: It performs a search in the specified Airtable table for records
    where the 'Field name' matches the 'Field value', limited by the 'Max records'
    parameter.

    3. **Deletion**: The action iterates through the list of matching records and
    sends a delete request for each record ID found.

    4. **Completion**: It calculates the total number of successfully deleted records
    and returns a summary message to the Google SecOps platform.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action deletes records from a specified Airtable table based on search criteria
      provided in the parameters.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Delete All Records:
  ai_description: >-
    ### General Description

    The **Delete All Records** action is a destructive utility designed to purge all
    data from a specific table within an Airtable base. It is primarily used for environment
    cleanup or resetting data states within Airtable.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base Id** | String | Yes | The unique identifier for the Airtable base (database).
    This can be found in the Airtable API documentation URL for the specific base.
    |

    | **Table name** | String | Yes | The exact name of the table within the specified
    base where all records should be deleted. |


    ### Additional Notes

    - This action **does not** interact with Google SecOps entities (IPs, Hostnames,
    etc.). It operates globally on the specified Airtable table.

    - **Warning**: This operation is irreversible. All records in the target table
    will be permanently removed.


    ### Flow Description

    1. **Initialization**: The action retrieves the Airtable API key from the integration
    configuration and the Base ID and Table Name from the action parameters.

    2. **Record Discovery**: It calls the Airtable API to retrieve all existing records
    currently stored in the specified table.

    3. **ID Collection**: The script parses the API response to extract the unique
    record IDs for every entry found in the table.

    4. **Batch Deletion**: It utilizes the Airtable batch deletion capability to remove
    all identified records in a single efficient process.

    5. **Completion**: The action concludes by providing a summary message indicating
    the total number of records successfully deleted.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action performs a batch delete operation on the Airtable API, permanently
      removing all records from the specified table.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Entities From Table:
  ai_description: >-
    ### General Description

    Enriches entities by searching for matching records within a specific Airtable
    table. This action allows users to map Google SecOps entities to rows in an Airtable
    base, retrieving structured data and attaching it directly to the entity's properties
    for enhanced context during investigations.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base id** | string | Yes | The unique identifier for the Airtable base (database)
    containing the data. Found in the Airtable API documentation URL. |

    | **Table name** | string | Yes | The name of the specific table within the base
    to search. |

    | **Field name** | string | Yes | The name of the column in Airtable to search
    against (e.g., 'Email', 'IP', 'Username'). |

    | **Enrichment Prefix** | string | No | A prefix added to the keys of the retrieved
    data before they are added to the entity (default: 'AT_'). |

    | **Max records** | string | No | The maximum number of records to consider during
    the search (default: '100'). Note: The action currently processes the first match
    found. |

    | **Entity Field** | string | No | The specific entity property to use as the
    search value. If left blank, the action uses the entity's main Identifier. |


    ### Additional Notes

    - If **Entity Field** is provided, the action will look for that key within the
    entity's `additional_properties`. If the key is missing for a specific entity,
    that entity will fail enrichment.

    - The search is performed twice: first with the exact value provided, and a second
    time with a lowercase version of the value if the first search yields no results.


    ### Flow Description

    1. **Configuration Retrieval:** Extracts the Airtable API key from the integration
    configuration and parameters from the action input.

    2. **Entity Iteration:** Iterates through all entities associated with the current
    alert/case.

    3. **Search Value Determination:** For each entity, determines the search term
    using either the entity's identifier or a specified property from `additional_properties`.

    4. **Airtable Query:** Executes a search in the specified Airtable base and table,
    looking for records where the **Field name** matches the search value.

    5. **Data Processing:** If a match is found, the action flattens the Airtable
    record (handling nested dictionaries and lists) and applies the configured **Enrichment
    Prefix** to the keys.

    6. **Internal Update:** Updates the entity's `additional_properties` in Google
    SecOps with the retrieved and formatted data.

    7. **Finalization:** Reports the number of successfully enriched entities and
    provides detailed error logs for any entities that could not be processed.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity additional properties with data retrieved from Airtable records.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get All Records:
  ai_description: >-
    ### General Description

    The **Get All Records** action retrieves a list of records from a specific table
    within an AirTable base. It allows users to define the scope of the retrieval
    by specifying the base, table, and a maximum number of records to fetch. Additionally,
    it supports sorting the results based on a specific column in either ascending
    or descending order.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base Id** | String | Yes | The unique identifier for the AirTable base (database).
    Found in the API documentation URL for the base. |

    | **Table name** | String | Yes | The name of the table within the specified base
    from which to fetch records. |

    | **Max Records** | String | Yes | The maximum number of rows/records to be retrieved
    by the action. |

    | **Sort by** | String | No | The name of the column to use for sorting the retrieved
    records. |

    | **Sort Direction** | DDL | Yes | The order of sorting: **Ascending** or **Descending**.
    |


    ### Additional Notes

    - This action does not operate on SOAR entities; it is a data-retrieval utility.

    - If **Sort by** is left empty, the records are returned in the default order
    provided by the AirTable API.


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the AirTable API key from the integration
    settings.

    2. **Parameter Parsing**: Collects the Base ID, Table Name, record limit, and
    sorting preferences from the action input.

    3. **API Interaction**: Connects to the AirTable API using the provided credentials
    and parameters to fetch the records.

    4. **Data Processing**: Counts the retrieved records and prepares the JSON output.

    5. **Result Reporting**: Adds the raw record data to the action results and provides
    a summary message indicating the number of records successfully fetched.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify the connectivity
    between Google SecOps and the **AirTable** platform. Its primary purpose is to
    ensure that the integration's configuration parameters, such as the API Key, Base
    ID, and Table Name, are correct and that the service is reachable.


    ### Parameters Description

    This action does not have any action-specific parameters. It utilizes the global
    integration configuration:

    * **Api key**: The authentication token used to access the AirTable API.

    * **Base id**: The unique identifier for the specific AirTable base being accessed.

    * **Table name**: The name of the table within the base used to perform the connectivity
    test.


    ### Additional Notes

    This action is a read-only operation and does not interact with or process any
    entities within a case. It is typically used during the initial setup or troubleshooting
    of the AirTable integration.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the API Key, Base ID, and Table
    Name from the integration's configuration settings.

    2. **Client Initialization**: It initializes the AirTable client using the provided
    credentials.

    3. **Connectivity Check**: The action attempts to fetch a single record from the
    specified table (using `maxRecords=1`) to verify that the connection is active
    and the credentials have read permissions.

    4. **Completion**: If the request succeeds, the action ends with a success message
    indicating that AirTable is connected.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search:
  ai_description: >-
    ### General Description

    The **Search** action enables users to query an Airtable table for specific records
    that match a provided field name and value. This action is designed to retrieve
    structured data from Airtable bases for use in automation workflows, allowing
    for dynamic data lookups based on custom criteria.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Base id** | string | Yes | The unique identifier for the Airtable base, typically
    found in the API documentation URL for that base. |

    | **Table name** | string | Yes | The name of the specific table within the base
    where the search will be performed. |

    | **Field name** | string | Yes | The name of the column (field) to be searched.
    |

    | **Field value** | string | Yes | The specific value to search for within the
    designated field. |

    | **Max records** | string | No | The maximum number of records to return. Defaults
    to 100 if not specified or if an invalid integer is provided. |


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the Airtable API key from
    the integration's configuration settings.

    2. **Parameter Retrieval**: It extracts the Base ID, Table Name, Field Name, Field
    Value, and Max Records from the user-provided parameters.

    3. **Client Initialization**: An Airtable client is initialized using the provided
    Base ID, Table Name, and API Key.

    4. **Search Execution**: The action performs a search query against the Airtable
    API, filtering records where the specified field matches the provided value.

    5. **Result Processing**: The matching records are counted and the full result
    set is attached to the action's output as a JSON object for use in subsequent
    playbook steps.


    ### Additional Notes

    - This action does not interact with or iterate over Google SecOps entities; it
    operates solely based on the provided input parameters.

    - The search is performed using the `airtable-python-wrapper` logic, which handles
    the API request to Airtable.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update:
  ai_description: >-
    ### General Description

    Updates specific fields in an Airtable table for records that match a search criterion.
    This action allows for bulk updates of records based on a field-value match, enabling
    automated data management within Airtable bases.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Base id | string | Yes | The unique identifier for the Airtable base. |

    | Table name | string | Yes | The name of the table within the base to update.
    |

    | Field name | string | Yes | The name of the field used to search for records.
    |

    | Field value | string | Yes | The value to look for in the search field. |

    | Json fields | content | Yes | A JSON object containing the field names and values
    to be updated (e.g., `{"Field_Name_1":"Value1"}`). |

    | Max records | string | Yes | The maximum number of records to be updated by
    the action. |


    ### Additional Notes

    - The `Json fields` parameter must be a valid JSON string representing the columns
    and values to be modified.

    - The action performs an exact match search based on the `Field name` and `Field
    value` provided.


    ### Flow Description

    1. **Initialization**: Retrieves the API key from the integration configuration
    and extracts the base ID, table name, and search criteria from the action parameters.

    2. **Search**: Executes a search in the specified Airtable table to find records
    where the `Field name` matches the `Field value`, limited by the `Max records`
    parameter.

    3. **Update**: Iterates through the search results and updates each record's fields
    using the key-value pairs provided in the `Json fields` parameter.

    4. **Completion**: Returns the total count of records successfully updated and
    finishes the action.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates existing records in the specified Airtable table with new field values
      provided in the JSON input.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
