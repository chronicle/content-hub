Create Content:
  ai_description: >-
    ### General Description

    This action inserts text content into a specific Google Document using the Google
    Docs API. It allows for bulk text insertion at specified indices within the document
    body by processing a JSON-formatted list of items.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Document Id | The unique identifier of the Google Document, typically found
    in the URL (e.g., https://docs.google.com/document/d/{YourDocumentId}/). | string
    | True |

    | Json | A JSON-formatted string containing an array of items. Each item must
    specify an `index` (the character offset where the text should be inserted) and
    the `text` to be inserted. | code | True |


    ### Additional Notes

    - This action uses the `batchUpdate` method of the Google Docs API, allowing multiple
    insertions in a single request.

    - The `index` refers to the character offset in the document. Incorrect indices
    may result in API errors if they fall outside document bounds or within specific
    structural elements.


    ### Flow Description

    1. **Extract Configuration:** Retrieves the service account credentials from the
    integration settings.

    2. **Extract Parameters:** Collects the target `Document Id` and the `Json` payload
    from the action input.

    3. **Parse Content:** Deserializes the JSON string and iterates through the provided
    items to construct a list of `insertText` requests.

    4. **Execute Request:** Initializes the Google Docs Manager and sends a `batchUpdate`
    request to the Google Docs API with the constructed insertion logic.

    5. **Output Results:** Returns the JSON response from the API and completes the
    action with a success status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Inserts new text content into an existing Google Document at specified character
      indices.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Document:
  ai_description: >-
    ### General Description

    This action creates a new document in Google Docs and manages sharing permissions
    for specific users. It allows security analysts to automate the creation of investigation
    reports or shared documentation during an incident response process.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Title | string | True | The document title of the document you would like to
    create. |

    | Role | ddl | True | The permission level to grant. Options are: **owner** (full
    control), **writer** (can comment/edit), or **reader** (view only). |

    | Emails | string | True | A semicolon-separated list of email addresses (e.g.,
    `user1@gmail.com;user2@gmail.com`) to which the specified role will be assigned.
    |


    ### Flow Description

    1. **Configuration Extraction:** The action retrieves service account credentials
    and input parameters (Title, Role, and Emails) from the Google SecOps environment.

    2. **Document Creation:** It interacts with the Google Docs API to create a new,
    empty document with the provided title.

    3. **Permission Management:** The action parses the semicolon-separated list of
    emails and uses the Google Drive API to assign the selected role to each user
    for the newly created document.

    4. **Metadata Retrieval:** It fetches the full metadata of the created file from
    Google Drive to provide a comprehensive response.

    5. **Completion:** The action returns the document's unique ID and metadata as
    the JSON result and concludes the execution.


    ### Additional Notes

    - Ensure the service account associated with the 'Credentials Json' has the necessary
    Google Drive and Google Docs API scopes enabled.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action creates a new document in Google Docs and modifies file permissions
      within Google Drive for the specified email addresses.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Verifies the connectivity between Google SecOps and the Google Docs and Google
    Drive APIs. This action is used to ensure that the provided service account credentials
    are valid and that the integration can successfully communicate with Google services.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | None | N/A | No | This action does not take any input parameters. It uses the
    integration's global configuration (Credentials Json) for authentication. |


    ### Additional Notes

    This action requires the 'Credentials Json' parameter to be correctly configured
    in the integration settings to function.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify SDK and extracts the
    service account credentials from the integration configuration.

    2. **Authentication**: It initializes a connection to both Google Docs (v1) and
    Google Drive (v3) using the service account credentials.

    3. **Connectivity Test**: It performs a test API call to the Google Drive service
    to list files. This verifies that the API key is active and has the necessary
    permissions.

    4. **Result Reporting**: The action concludes with a success message if the API
    call is successful, or an error if the connection fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Content:
  ai_description: >-
    ### General Description

    Removes specific content from a Google Document by specifying the document ID
    and the character offset ranges to be deleted. This action is useful for automated
    document redaction or content cleanup within Google SecOps workflows.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Document Id** | The unique identifier of the Google Document, found in the
    document's URL (e.g., `https://docs.google.com/document/d/{DocumentId}/`). | string
    | Yes |

    | **Json** | A JSON-formatted string containing a list of items with `start_index`
    and `end_index`. These indices represent the character offsets in the document
    body to be removed. | code | Yes |


    ### Flow Description

    1.  **Extract Configuration:** Retrieves the service account credentials from
    the integration settings.

    2.  **Extract Parameters:** Gathers the target `Document Id` and the `Json` payload
    defining the removal ranges.

    3.  **Parse Request:** Iterates through the provided JSON items to construct a
    list of `deleteContentRange` requests formatted for the Google Docs API.

    4.  **Execute Mutation:** Uses the `GoogleDocsManager` to send a `batchUpdate`
    request to the Google Docs API to perform the deletions.

    5.  **Output Results:** Returns the API response as a JSON result and completes
    the action with a success message.


    ### Additional Notes

    - Most elements in a Google Doc body have a `startIndex` and `endIndex`. Users
    must ensure the indices are valid for the specific document version to avoid API
    errors.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes text and content ranges from an external Google Document via the Google
      Docs API batchUpdate method.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Replace Content:
  ai_description: >-
    ### General Description

    Replaces specific text content within a Google Document. This action interacts
    with the Google Docs API to perform bulk 'search and replace' operations based
    on a provided JSON configuration. It is useful for automating document updates,
    such as template filling or correcting specific terms across files.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Document Id | string | Yes | The unique identifier for the Google Document,
    typically found in the URL between '/d/' and '/edit/'. |

    | Json | code | Yes | A JSON-formatted string containing an 'items' array. Each
    item must include `text_to_search`, `text_to_replace`, and `match_case` (boolean
    string) keys. |


    ### Flow Description

    1.  **Extraction**: Retrieves the service account credentials from the integration
    configuration and the Document ID and replacement JSON from the action parameters.

    2.  **Parsing**: Deserializes the input JSON string and iterates through the 'items'
    list to construct a batch of `replaceAllText` request objects for the Google Docs
    API.

    3.  **Authentication**: Initializes the Google Docs service using the provided
    service account credentials.

    4.  **Execution**: Sends a `batchUpdate` request to the Google Docs API for the
    specified document ID, applying all search-and-replace operations in a single
    call.

    5.  **Output**: Returns the API response as JSON and provides a success message
    indicating the content was replaced.


    ### Additional Notes

    - This action does not operate on SOAR entities; it requires a direct Document
    ID as input.

    - The 'Json' parameter must strictly follow the expected schema (an 'items' array)
    to avoid parsing errors.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the text content of a Google Document by performing search-and-replace
      operations via the Google Docs batchUpdate API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
