Get Authentication Logs for User:
  ai_description: >-
    ### General Description

    Enriches investigations by retrieving Duo user data and authentication logs for
    a specific username. It specifically identifies frequently used authentication
    sources (IPs, states, devices) by comparing their occurrence counts against a
    user-defined threshold. This is useful for distinguishing between established
    user patterns and anomalous authentication attempts.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Authentication Threshold | string | True | The minimum number of successful
    authentications required for an authentication source to be considered 'known/safe'
    in the filtered results. |

    | Number Days Back | string | True | The lookback period in days from the current
    time to retrieve logs. |

    | Username | string | False | The specific Duo username to query. If left empty,
    the action will terminate with a message indicating no username was provided.
    |


    ### Additional Notes

    While the 'Username' parameter is marked as not mandatory in the configuration,
    the action logic requires it to successfully resolve a Duo user ID and fetch logs.
    This action does not process SOAR entities but operates on the provided string
    parameter.


    ### Flow Description

    1. **Authentication**: Connects to the Duo Admin API using the Hostname, Secret
    Key, and Integration Key from the integration configuration.

    2. **User Identification**: Calls the Duo API to find the internal `user_id` corresponding
    to the provided `Username` string.

    3. **Log Retrieval**: Fetches authentication logs for that user ID covering the
    number of days specified in the `Number Days Back` parameter.

    4. **Aggregation and Analysis**: Parses the logs to calculate the frequency of
    specific access attributes, including IP addresses, geographic states, operating
    systems, and authentication devices.

    5. **Threshold Filtering**: Compares the frequency of these attributes against
    the `Authentication Threshold`. Only attributes meeting the threshold are retained
    in the simplified aggregation lists.

    6. **Final Output**: Produces a JSON result containing the raw user data, full
    logs, and the filtered frequency counts for further analysis.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Trust Monitor Events:
  ai_description: >-
    ### General Description

    Retrieves Trust Monitor events from Duo Security for a specified time range. This
    action allows security teams to pull historical security events and suspicious
    activity logs detected by Duo's Trust Monitor directly into the SOAR platform
    for analysis and reporting.


    ### Parameters Description

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Number Days Back | Number/String | Yes | The duration (in days) to look back
    from the current time to retrieve events. Defaults to 1. |


    ### Flow Description

    1. **Authentication**: The action retrieves the Duo Admin API credentials (API
    Hostname, Admin Secret Key, and Admin Integration Key) from the integration configuration.

    2. **Time Range Calculation**: It calculates a millisecond timestamp for the current
    time and a starting timestamp based on the user-provided 'Number Days Back' parameter.

    3. **API Query**: Using the Duo Python SDK, it executes a request to the Duo Admin
    API's Trust Monitor endpoint to fetch events within the calculated time window.

    4. **Data Output**: The retrieved event data is packaged into a JSON result and
    attached to the action execution summary.


    ### Additional Notes

    This action operates independently of case entities and is designed for broad
    data retrieval or log collection tasks.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Users by Name:
  ai_description: >-
    ### General Description

    This action queries the DUO Admin API to retrieve detailed information for a specified
    username. It provides insights into user attributes, authentication history, and
    registered devices from the DUO MFA service.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Username | String | Yes | The DUO username to query. This value is used to filter
    results in the DUO Admin API. |


    ### Flow Description

    1. **Authentication:** Retrieves the API Hostname, Admin Secret Key, and Admin
    Integration Key from the DUO integration configuration.

    2. **Parameter Extraction:** Identifies the target `Username` provided in the
    action parameters.

    3. **API Request:** Initializes the DUO Admin API client and calls the `get_users_by_name`
    endpoint using the specified username.

    4. **Data Extraction:** Parses the response to identify the `user_id` and collects
    the complete user data object.

    5. **Reporting:** Packages the username, user ID, and full data into a JSON result
    which is attached to the action output for playbook consumption.


    ### Additional Notes

    This action does not automatically process entities from the SOAR case; it requires
    the target username to be provided explicitly via the action parameter. If no
    user is found, the action will still complete but the resulting data list will
    be empty.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Verifies the validity of the DUO Auth API integration credentials and connectivity.
    This action uses the DUO `/check` endpoint to ensure that the API Hostname, Auth
    Secret Key, and Auth Integration Key are properly configured and that API signatures
    are being generated correctly. It serves as a diagnostic tool to confirm the integration
    is functional.


    ### Parameters Description

    There are no action-specific parameters for this action. It relies entirely on
    the configuration parameters defined at the integration level (API Hostname, Auth
    Secret Key, and Auth Integration Key).


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the global integration settings,
    including the API Hostname and authentication keys.

    2. **Client Initialization**: It initializes a connection to the DUO Auth API
    using the provided credentials.

    3. **Validation Call**: It executes a call to the `/check` endpoint, which is
    a standard DUO API method for verifying credential validity.

    4. **Status Report**: The action returns a success state if the API responds affirmatively
    or a failure state with the specific error message if the authentication or connection
    fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
