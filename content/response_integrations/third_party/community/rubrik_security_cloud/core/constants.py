from __future__ import annotations

INTEGRATION_NAME = "Rubrik Security Cloud"

INTEGRATION_VERSION = "1.0.0"

RESULT_VALUE_TRUE = True
RESULT_VALUE_FALSE = False
DEFAULT_DEVICE_VENDOR = "Rubrik"
DEFAULT_DEVICE_PRODUCT = INTEGRATION_NAME
RULE_GENERATOR = DEFAULT_DEVICE_VENDOR
COMMON_ACTION_ERROR_MESSAGE = "Error while executing action {}. Reason: {}"
DEFAULT_PAGE_SIZE = 1000
RETRY_COUNT = 3
WAIT_TIME_FOR_RETRY = 5
DEFAULT_RESULTS_LIMIT = 10000000
RATE_LIMIT_EXCEEDED_STATUS_CODE = 429
UNAUTHORIZED_STATUS_CODE = 401
DEFAULT_REQUEST_TIMEOUT = 60
DEFAULT_OFFSET = "0"
DEFAULT_LIMIT = "100"
MAX_TABLE_RECORDS = 20
MAX_JSON_CHARS = 300
MAX_INT_VALUE = 65535
DEFAULT_REQUEST_NAME = "GoogleSecOps"
DEFAULT_SCAN_NAME = "Google-SecOps-{DATE}-{TIME}"
DEFAULT_LIMIT = "50"
MAX_SNAPSHOTS_LIMIT = 1000
DEFAULT_TIMEZONE = "UTC"
DEFAULT_SNAPSHOTS_SORT_TYPE = "ASC"
DEFAULT_SONAR_FILE_SORT_ORDER = "DESC"
INTERNAL_SERVER_ERROR_STATUS_CODES = [500, 502, 503, 504]
LIST_EVENTS_DEFAULT_SORT_BY = "LAST_UPDATED"
LIST_EVENTS_DEFAULT_SORT_ORDER = "DESC"
DEFAULT_SEARCH_TIME_PERIOD = "7"
TOKEN_EXPIRY_BUFFER_SECONDS = 30  # 30 seconds buffer
DEFAULT_EXPIRY_SECONDS = 1800 - TOKEN_EXPIRY_BUFFER_SECONDS  # 30 minutes
EXPIRES_IN_KEY = "expires_in"

# Time formats
UNIX_FORMAT = "unix"
ISO_FORMAT = "%Y-%m-%dT%H:%M:%S.%fZ"

# Scripts Name
PING_SCRIPT_NAME = f"{INTEGRATION_NAME} - Ping"
TURBO_IOC_SCAN_SCRIPT_NAME = f"{INTEGRATION_NAME} - Turbo IOC Scan"
ADVANCE_IOC_SCAN_SCRIPT_NAME = f"{INTEGRATION_NAME} - Advanced IOC Scan"
IOC_SCAN_RESULTS_SCRIPT_NAME = f"{INTEGRATION_NAME} - IOC Scan Results"
LIST_OBJECT_SNAPSHOTS_SCRIPT_NAME = f"{INTEGRATION_NAME} - List Object-Snapshots"
LIST_SONAR_FILE_CONTEXTS_SCRIPT_NAME = f"{INTEGRATION_NAME} - List Sonar File Contexts"
LIST_EVENTS_SCRIPT_NAME = f"{INTEGRATION_NAME} - List Events"
GET_CDM_CLUSTER_LOCATION_SCRIPT_NAME = f"{INTEGRATION_NAME} - Get CDM Cluster Location"
GET_CDM_CLUSTER_CONNECTION_STATE_SCRIPT_NAME = (
    f"{INTEGRATION_NAME} - Get CDM Cluster Connection State"
)
GET_SONAR_SENSITIVE_HITS_SCRIPT_NAME = f"{INTEGRATION_NAME} - Get Sonar Sensitive Hits"

# Action Identifiers
PING_ACTION_IDENTIFIER = "ping"
TURBO_IOC_SCAN_ACTION_IDENTIFIER = "turbo_ioc_scan"
ADVANCE_IOC_SCAN_ACTION_IDENTIFIER = "advance_ioc_scan"
IOC_SCAN_RESULTS_ACTION_IDENTIFIER = "ioc_scan_results"
LIST_OBJECT_SNAPSHOTS_ACTION_IDENTIFIER = "list_object_snapshots"
LIST_SONAR_FILE_CONTEXTS_ACTION_IDENTIFIER = "list_sonar_file_contexts"
LIST_EVENTS_ACTION_IDENTIFIER = "list_events"
GET_CDM_CLUSTER_LOCATION_ACTION_IDENTIFIER = "get_cdm_cluster_location"
GET_CDM_CLUSTER_CONNECTION_STATE_ACTION_IDENTIFIER = "get_cdm_cluster_connection_state"
GET_SONAR_SENSITIVE_HITS_ACTION_IDENTIFIER = "get_sonar_sensitive_hits"

# GraphQL URL
GRAPHQL_URL = "https://{domain}/api/graphql"

# IOC type mapping from UI dropdown/JSON keys to Rubrik GraphQL iocKind values
IOC_TYPE_MAP = {
    "INDICATOR_OF_COMPROMISE_TYPE_HASH": "IOC_HASH",
    "INDICATOR_OF_COMPROMISE_TYPE_PATH_OR_FILENAME": "IOC_FILE_PATTERN",
    "INDICATOR_OF_COMPROMISE_TYPE_YARA_RULE": "IOC_YARA",
    # Also allow direct GraphQL kinds if passed in JSON
    "IOC_HASH": "IOC_HASH",
    "IOC_PATH_OR_FILENAME": "IOC_FILE_PATTERN",
    "IOC_YARA_RULE": "IOC_YARA",
}

# ENUM Lists
SORT_ORDER_ENUM = ["ASC", "DESC"]
