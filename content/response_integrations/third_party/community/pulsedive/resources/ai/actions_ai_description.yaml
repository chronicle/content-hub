Enrich IP:
  ai_description: "### General Description\nEnriches IP Address entities using threat\
    \ intelligence from Pulsedive. This action retrieves detailed indicator information,\
    \ including risk levels, risk factors, and community comments, to provide context\
    \ for security investigations. It allows users to define a risk threshold for\
    \ marking entities as suspicious and provides flexible reporting options.\n\n\
    ### Parameters Description\n| Parameter | Type | Mandatory | Description |\n|\
    \ :--- | :--- | :--- | :--- |\n| Threshold | DDL | Yes | Specifies the risk level\
    \ (verylow, low, medium, high, critical) at which an entity should be marked as\
    \ suspicious in Google SecOps. |\n| Retrieve Comments | Boolean | No | If enabled,\
    \ the action retrieves community comments about the entity from Pulsedive. Default\
    \ is true. |\n| Only Suspicious Entity Insight | Boolean | No | If enabled, an\
    \ entity insight will only be created for entities that meet or exceed the specified\
    \ risk threshold. Default is false. |\n| Max Comments To Return | String | No\
    \ | Specifies the maximum number of comments to retrieve and display in the case\
    \ wall data table. Default is 50. |\n\n### Flow Description\n1. **Parameter Initialization**:\
    \ The action retrieves the Pulsedive API configuration and user-defined parameters,\
    \ including the risk threshold and comment settings.\n2. **Entity Filtering**:\
    \ The action identifies all IP Address (`ADDRESS`) entities within the target\
    \ scope.\n3. **Data Retrieval**: For each IP, the action queries the Pulsedive\
    \ API to fetch indicator data, risk scores, and optional comments.\n4. **Risk\
    \ Evaluation**: The retrieved risk level is compared against the user-defined\
    \ `Threshold`. If the risk meets or exceeds the threshold, the entity is marked\
    \ as suspicious.\n5. **Internal Data Mutation**: \n    *   **Enrichment**: Entity\
    \ attributes are updated with Pulsedive data (prefixed with 'PD').\n    *   **Data\
    \ Tables**: If comments are retrieved, a data table is added to the case wall\
    \ for each entity.\n    *   **Insights**: An HTML insight is generated for the\
    \ entity, summarizing the risk level and factors. This is subject to the `Only\
    \ Suspicious Entity Insight` filter.\n6. **Completion**: The action updates the\
    \ entities in Google SecOps and returns a JSON result containing the raw data\
    \ and a global risk flag.\n\n### Additional Notes\n* The action uses a internal\
    \ mapping to convert string risk levels (e.g., 'medium', 'high') into numeric\
    \ scores for comparison logic."
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes with enrichment data, sets the suspicious flag based
      on risk thresholds, adds data tables for community comments, and creates entity
      insights.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich URL:
  ai_description: "### General Description\nEnriches URL entities using threat intelligence\
    \ from Pulsedive. This action retrieves comprehensive data about a URL, including\
    \ its risk level, risk factors, and community comments. It evaluates the retrieved\
    \ risk level against a user-defined threshold to determine if the entity should\
    \ be marked as suspicious within Google SecOps.\n\n### Parameters Description\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | Threshold | DDL | Yes | Specifies the risk level (verylow, low, medium, high,\
    \ critical) at which an entity is considered suspicious. |\n| Retrieve Comments\
    \ | Boolean | No | If enabled (default: true), the action fetches community comments\
    \ associated with the URL from Pulsedive. |\n| Max Comments To Return | String\
    \ | No | Defines the maximum number of comments to retrieve and display in the\
    \ case wall (default: 50). |\n| Only Suspicious Entity Insight | Boolean | No\
    \ | If enabled, an entity insight will only be created if the URL's risk level\
    \ meets or exceeds the specified threshold. |\n\n### Additional Notes\n- The action\
    \ maps Pulsedive's risk levels (none, low, medium, high, critical) to internal\
    \ scores to perform threshold comparisons.\n- Enrichment data is prefixed with\
    \ 'PD' in the entity's additional properties.\n\n### Flow Description\n1. **Filter\
    \ Entities**: The action identifies all URL entities within the current context.\n\
    2. **Fetch Data**: For each URL, it queries the Pulsedive API to retrieve indicator\
    \ details and optionally community comments.\n3. **Risk Evaluation**: It compares\
    \ the URL's risk level from Pulsedive against the configured `Threshold` parameter.\n\
    4. **Internal Updates**: \n    - If the risk meets the threshold, the entity is\
    \ marked as suspicious.\n    - The entity's additional properties are updated\
    \ with enrichment data (e.g., indicator ID, retired status, seen/probed timestamps).\n\
    \    - The entity is marked as enriched.\n5. **Case Wall & Insights**: \n    -\
    \ If comments are retrieved, they are formatted into a data table and added to\
    \ the case wall.\n    - An entity insight is created containing a detailed risk\
    \ report, including risk factors and indicator names, subject to the `Only Suspicious\
    \ Entity Insight` setting.\n6. **Finalization**: The action updates the entities\
    \ in the system and returns a JSON result containing the raw data for all processed\
    \ URLs."
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates entity attributes such as 'is_suspicious', 'is_enriched',
      and 'additional_properties'. It also creates entity insights and adds data tables
      to the case wall.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Threat Details:
  ai_description: >-
    ### General Description

    The **Get Threat Details** action retrieves comprehensive intelligence about a
    specific threat from Pulsedive. It allows users to query by either a threat name
    or a unique threat ID to obtain data such as risk levels, threat categories, wiki
    summaries, and associated news articles.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Threat Name** | String | No | The name of the threat to retrieve information
    for (e.g., 'Zeus'). |

    | **Threat ID** | String | No | The unique Pulsedive ID for the threat. |

    | **Retrieve Comments** | Boolean | No | If enabled, fetches user comments associated
    with the threat. Defaults to true. |

    | **Split Risk** | Boolean | No | If enabled, provides a breakdown of associated
    indicators by their risk levels. Defaults to true. |

    | **Create Insight** | Boolean | No | If enabled, creates a Google SecOps insight
    containing the threat summary. Defaults to false. |


    ### Additional Notes

    - Either **Threat Name** or **Threat ID** must be provided for the action to execute
    successfully. If both are provided, the action prioritizes the Threat Name.

    - If comments are retrieved, they are displayed in a data table on the Case Wall.


    ### Flow Description

    1. **Initialization**: The action retrieves Pulsedive API credentials (API Root,
    API Key) and user-defined parameters.

    2. **API Request**: It queries the Pulsedive `info` endpoint using the provided
    Threat Name or ID.

    3. **Data Processing**:
        - If comments are found and the `Retrieve Comments` parameter is enabled,
    they are formatted into a CSV-style table.
        - Threat news and risk summaries are parsed into structured data models.
    4. **Internal Updates**:
        - A data table is added to the case wall if comments exist.
        - A Case Insight is created if the `Create Insight` parameter is set to true,
    using the threat's risk and category information.
    5. **Output**: The action returns a JSON object containing the full threat profile
    and updates the action status to completed.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action adds a data table to the case wall containing threat comments and
      can create a case insight with threat details if the 'Create Insight' parameter
      is enabled.
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a connectivity test designed to verify the communication
    between Google SecOps and the Pulsedive API. It ensures that the provided configuration
    parameters, such as the API Root and API Key, are valid and that the network allows
    for a successful connection.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **API Root** | String | Yes | The base URL of the Pulsedive API instance. |

    | **API Key** | String | Yes | The authentication key used to authorize requests
    to Pulsedive. |

    | **Verify SSL** | Boolean | No | If enabled (True), the action will verify the
    SSL certificate of the Pulsedive server. Defaults to True. |


    ### Additional Notes

    This action does not process any entities and is typically used during the initial
    setup of the integration or for troubleshooting connection issues.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify SDK and retrieves
    the integration's configuration parameters (API Root, API Key, and SSL verification
    setting).

    2. **Manager Setup**: A `PulsediveManager` instance is created using the retrieved
    credentials.

    3. **Connectivity Test**: The manager executes a `test_connectivity` call, which
    performs a GET request to the Pulsedive `search` endpoint using a set of predefined
    test parameters.

    4. **Validation**: The response from the API is validated. If the status code
    is successful (200 OK), the action proceeds.

    5. **Finalization**: The action returns a success message and a boolean result
    (`True`) if the connection is established, or a failure message and `False` if
    an exception occurs (e.g., unauthorized access, network timeout).
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Scan Indicator:
  ai_description: >-
    ### General Description

    Performs a scan on indicator entities using Pulsedive to retrieve comprehensive
    threat intelligence. This action supports both passive and active scanning modes
    to gather data such as risk levels, risk factors, and community comments. It is
    designed to enrich entities within Google SecOps, providing security analysts
    with context regarding the reputation and history of specific indicators.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Scan Type** | DDL | Yes | Determines the scan method. `Passive` fetches existing
    data without direct interaction with the indicator, while `Active` performs a
    more intensive, real-time scan. |

    | **Threshold** | DDL | Yes | Sets the risk level (verylow, low, medium, high,
    critical) at which an entity is automatically marked as suspicious in Google SecOps.
    |

    | **Retrieve Comments** | Boolean | No | If enabled (default: true), the action
    retrieves community comments associated with the indicator from Pulsedive. |

    | **Max Comments To Return** | String | No | Specifies the maximum number of comments
    to retrieve and display in the case wall (default: 50). |

    | **Only Suspicious Entity Insight** | Boolean | No | If enabled, the action will
    only generate an entity insight if the indicator's risk level meets or exceeds
    the specified threshold. |


    ### Additional Notes

    - This action is asynchronous; it submits a scan request and then polls Pulsedive
    until the report is ready.

    - The action updates the `is_suspicious` and `is_enriched` flags on entities based
    on the scan results and user-defined thresholds.


    ### Flow Description

    1. **Submission Stage**: The action iterates through all target entities and submits
    them to the Pulsedive `/api/analyze.php` endpoint using the selected scan type
    (Active or Passive).

    2. **Polling Stage**: The action enters an asynchronous state, periodically checking
    the status of the submitted scan IDs until Pulsedive marks them as completed.

    3. **Retrieval Stage**: Once the scans are finished, the action fetches the full
    report for each indicator, including risk scores, risk factors, and community
    comments.

    4. **Enrichment Stage**: The action updates entity attributes with the retrieved
    data, sets the suspicious status if the risk exceeds the threshold, and generates
    entity insights and data tables for the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes with Pulsedive threat intelligence, marks entities
      as suspicious based on risk scores, and creates entity insights and data tables
      for comments.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
