Enrich IP:
  ai_description: >-
    ### General Description

    Enriches IP Address entities using threat intelligence from Pulsedive. This action
    retrieves comprehensive indicator data, including risk levels, risk factors, and
    user comments. It allows for automated assessment of entities based on a configurable
    risk threshold, updating the entity's status within Google SecOps accordingly.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Threshold** | ddl | Yes | Specifies the risk level (verylow, low, medium,
    high, critical) at which an entity is marked as suspicious. |

    | **Retrieve Comments** | boolean | No | If enabled (default: true), the action
    retrieves and displays user comments associated with the IP in Pulsedive. |

    | **Max Comments To Return** | string/int | No | Limits the number of comments
    returned (default: 50) to prevent case wall clutter. |

    | **Only Suspicious Entity Insight** | boolean | No | If enabled, insights will
    only be generated for entities that meet or exceed the specified risk threshold.
    |


    ### Additional Notes

    - The action uses a risk scoring system where 'critical' is the highest (4) and
    'none/verylow' is the lowest (0). An entity is marked suspicious if its risk score
    from Pulsedive is equal to or greater than the score of the selected threshold.

    - The integration adds a 'PD' prefix to enriched properties in the entity's additional
    properties.


    ### Flow Description

    1. **Initialization:** The action initializes the Pulsedive manager using API
    credentials and retrieves user-defined parameters like risk thresholds and comment
    limits.

    2. **Entity Filtering:** It identifies all `ADDRESS` (IP) entities provided in
    the current scope.

    3. **Data Retrieval:** For each identified IP, it calls the Pulsedive API to fetch
    indicator metadata and associated comments (if enabled).

    4. **Risk Assessment:** It compares the entity's risk level against the user-defined
    threshold. If the threshold is met, the entity is marked as 'suspicious'.

    5. **Enrichment and Internal Updates:**
        - Updates the entity's additional properties with Pulsedive metadata.
        - Adds a CSV-formatted data table to the Case Wall containing indicator comments.
        - Creates a detailed entity insight containing risk factors and threat summary
    (optionally filtered by the 'Only Suspicious' toggle).
    6. **Finalization:** Updates the entities in Google SecOps and returns a comprehensive
    JSON result including a global 'is_risky' flag if any entity exceeded the threshold.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entities with enrichment data, risk status, and suspicious flags. It
      also populates the case wall with data tables and insights.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich URL:
  ai_description: >-
    Enriches URL entities using threat intelligence from Pulsedive. This action retrieves
    comprehensive data including risk levels, risk factors, and user-contributed comments.
    It evaluates the risk against a user-defined threshold to determine if the URL
    should be marked as suspicious within Google SecOps.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Max Comments To Return | String | No | Specifies the maximum number of Pulsedive
    comments to retrieve for each URL. Default is 50. |

    | Threshold | DDL | Yes | The risk level threshold (verylow, low, medium, high,
    critical) used to determine if an entity should be labeled as suspicious. |

    | Retrieve Comments | Boolean | No | If enabled, the action fetches historical
    comments for the URL and adds them to a case wall table. |

    | Only Suspicious Entity Insight | Boolean | No | If enabled, an entity insight
    will only be created if the URL's risk level meets or exceeds the specified threshold.
    |


    ### Flow Description

    1. **Initialization**: Retrieves API credentials and action parameters, including
    the risk threshold and comment limits.

    2. **Entity Filtering**: Identifies all URL entities within the current scope.

    3. **Data Retrieval**: For each URL, queries the Pulsedive API to get indicator
    details and optionally comments.

    4. **Risk Evaluation**: Compares the URL's Pulsedive risk score against the user-configured
    threshold.

    5. **Internal Enrichment**: Updates the entity's additional properties with Pulsedive
    data, sets the enrichment status, and marks the entity as suspicious if it exceeds
    the threshold.

    6. **Case Visualization**: Adds a data table to the Case Wall containing URL comments
    (if enabled) and creates an entity insight (subject to the 'Only Suspicious' filter).

    7. **Completion**: Updates all entities in the platform and returns a summarized
    JSON result.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates URL entities with enrichment properties, sets suspicious flags, and
      adds data tables and insights to the case.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Threat Details:
  ai_description: >-
    ### General Description

    Performs a lookup in Pulsedive to retrieve comprehensive threat intelligence,
    including risk scores, threat categories, wiki summaries, and recent news. This
    action allows analysts to investigate specific threat actors or campaigns by providing
    either a threat name or a unique threat ID.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Threat Name | string | No | The specific name of the threat to retrieve (e.g.,
    'Zeus'). Required if Threat ID is not provided. |

    | Threat ID | string | No | The unique Pulsedive ID for the threat. Required if
    Threat Name is not provided. |

    | Retrieve Comments | boolean | No | If set to true, fetches user-submitted comments
    associated with the threat. Default is true. |

    | Split Risk | boolean | No | If set to true, provides a breakdown of associated
    indicators by risk level. Default is true. |

    | Create Insight | boolean | No | If set to true, creates a Google SecOps Case
    Insight containing a summary of the threat. Default is false. |


    ### Additional Notes

    Either the 'Threat Name' or 'Threat ID' must be populated for the action to function
    correctly. If both are provided, 'Threat Name' takes precedence in the logic.


    ### Flow Description

    1. **Setup**: Initializes the Pulsedive manager with API credentials and parameters.

    2. **API Call**: Executes a GET request to the Pulsedive '/info' endpoint using
    the provided Threat Name or ID.

    3. **Data Processing**: Parses the returned JSON data into a structured threat
    data model, including risk summaries and news.

    4. **Wall Logs**: If comments are retrieved, the action constructs a CSV table
    and adds it to the case wall.

    5. **Insight Creation**: If 'Create Insight' is enabled, an HTML insight is generated
    showcasing the threat risk, wiki summary, and linked news articles.

    6. **Final Result**: Returns the complete threat object as a JSON result and updates
    the action status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Creates a case insight and adds a data table to the case wall representing threat
      comments and news.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a connectivity test designed to verify that the Google
    SecOps platform can successfully communicate with the Pulsedive API. It uses the
    provided connection parameters (API Root, API Key, and SSL verification settings)
    to perform a test request to the Pulsedive search endpoint. This ensures that
    the integration is correctly configured before running enrichment or containment
    actions.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | API Root | String | Yes | The base URL for the Pulsedive API instance. |

    | API Key | String | Yes | The API key used for authentication with Pulsedive.
    |

    | Verify SSL | Boolean | No | If enabled (True), the action will verify the SSL
    certificate for the connection. Default is True. |


    ### Additional Notes

    - This action does not process or require any entities (IPs, URLs, etc.) to run.

    - It is primarily used for troubleshooting and initial setup validation.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify context and logs the
    start of the process.

    2. **Parameter Extraction**: It retrieves the `API Root`, `API Key`, and `Verify
    SSL` settings from the integration configuration.

    3. **Connectivity Test**: It creates an instance of the `PulsediveManager` and
    executes the `test_connectivity` method.

    4. **API Interaction**: The manager sends a GET request to the Pulsedive search
    endpoint using a set of default test parameters to confirm the API key's validity
    and network reachability.

    5. **Completion**: If the request is successful, the action returns a success
    message and terminates with a completed status. If an error occurs (e.g., 401
    Unauthorized or connection timeout), it captures the exception and returns a failure
    status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Scan Indicator:
  ai_description: >-
    ### General Description

    Performs an automated scan on indicators such as IP addresses, domains, URLs,
    and file hashes using the Pulsedive platform. This asynchronous action allows
    for either passive retrieval of existing data or active probing of the target.
    It enriches entities with comprehensive threat intelligence, including risk levels,
    risk factors, and community comments, while automatically flagging suspicious
    indicators based on configurable risk thresholds.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Scan Type | Dropdown | Yes | Determines the scan method: 'Passive' (retrieves
    existing Pulsedive data) or 'Active' (triggers a new, more intrusive analysis).
    |

    | Threshold | Dropdown | Yes | Defines the minimum risk level (verylow, low, medium,
    high, critical) required to mark an entity as suspicious and potentially trigger
    an insight. |

    | Only Suspicious Entity Insight | Boolean | No | If set to true, insights will
    only be generated for entities that reach the specified risk threshold. |

    | Retrieve Comments | Boolean | No | When enabled, the action will fetch and display
    community-sourced comments for the indicator. |

    | Max Comments To Return | String | No | Specifies the maximum number of comments
    to retrieve and display in the SOAR (default is 50). |


    ### Additional Notes

    This is an asynchronous action. It initiates a scan request and then polls the
    Pulsedive API until the analysis is complete before performing final enrichment
    and reporting.


    ### Flow Description

    1. **Submission Phase**: Submits entity identifiers to the Pulsedive analysis
    queue via the `/api/analyze.php` endpoint.

    2. **Status Polling**: The action monitors the returned Queue ID (qid) to check
    when the analysis report is ready.

    3. **Data Retrieval**: Once completed, the detailed indicator report is fetched,
    containing risk scores and community comments.

    4. **Risk Assessment**: Compares the entity's risk score against the user-defined
    threshold to determine suspicious status.

    5. **SOAR Integration**: Updates entity properties with enrichment data, creates
    insights for the analysis results, and adds data tables for comments to the case
    wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    - DOMAIN
    - FILEHASH
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
