Add Note:
  ai_description: >-
    ### General Description

    Adds a note to a specific entity (Host, Account, or Detection) within the Vectra
    platform. This action allows analysts to attach documentation, comments, or investigation
    notes directly to Vectra entities for better context and collaboration within
    the external security platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Note** | string | Yes | The textual content of the note to be added to the
    entity. |

    | **Entity ID** | string | Yes | The unique numerical identifier of the entity
    in Vectra. The action validates that this is a valid integer. |

    | **Entity Type** | ddl | Yes | The category of the entity to which the note is
    being added. Expected values are 'Account', 'Host', or 'Detection'. |


    ### Flow Description

    1. **Initialization**: Connects to the Vectra RUX instance using the provided
    API credentials (API Root, Client ID, and Client Secret).

    2. **Validation**: Validates that the provided `Entity ID` is a valid integer.

    3. **External Interaction**: Sends a POST request to the Vectra API endpoint `/api/v3.4/entities/{entity_id}/notes`
    with the note content and the specified entity type.

    4. **Data Retrieval**: Receives the newly created note's metadata (such as ID,
    creation date, and creator) from the Vectra API.

    5. **Reporting**: Adds the resulting note details to a data table named "Add Note"
    and includes the full raw response in the JSON results for use in subsequent playbook
    steps.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new note object within the external Vectra platform via a POST request
      to the entities notes endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add Tags:
  ai_description: >-
    ### General Description: Adds tags to specific entities in the Vectra RUX platform.
    This action allows users to append labels to Hosts, Accounts, or Detections by
    merging new tags with the existing ones on the platform. ### Parameters description:
    | Parameter | Type | Mandatory | Description | | :--- | :--- | :--- | :--- | |
    Tags | string | Yes | Comma-separated list of tags to be added to the entities.
    | | Entity IDs | string | Yes | Comma-separated list of numeric IDs of the entities
    to be tagged. | | Entity Type | ddl | Yes | The category of the entity to update.
    Options: Account, Host, Detection. | ### Flow Description: 1. Parameter extraction:
    Retrieves API configuration and user-provided tags, entity IDs, and entity type.
    2. Validation: Cleans the input strings and validates that Entity IDs are numeric.
    3. Tag Merging: For each entity ID, the action first fetches existing tags from
    Vectra RUX to avoid overwriting current labels. 4. Mutation: Combines the existing
    tags with the new tags (removing duplicates) and performs a PATCH request to update
    the entity in Vectra. 5. Status Reporting: Records success or failure for each
    ID and produces a detailed data table in the case wall results. ### Additional
    Notes: This action does not automatically process entities from the SOAR context;
    it relies on explicit IDs provided in the parameters.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates entity metadata in Vectra RUX by adding new tags to existing Hosts,
      Accounts, or Detections via a PATCH request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Assign Entity:
  ai_description: >-
    ### General Description

    This action assigns a specific entity (either a Host or an Account) to a target
    user within the Vectra RUX platform. It is used to manage ownership and accountability
    for detected threats or monitored assets by programmatically creating assignments
    in the external system.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | String | Yes | The unique numeric identifier of the entity in Vectra
    RUX that needs to be assigned. |

    | Entity Type | DDL | Yes | The category of the entity. Possible values are 'Account'
    or 'Host'. |

    | User ID | String | Yes | The unique numeric identifier of the user in Vectra
    RUX to whom the entity will be assigned. |


    ### Flow Description

    1. **Initialization**: The action extracts configuration parameters (API Root,
    Client ID, Client Secret) and action parameters (User ID, Entity ID, Entity Type).

    2. **Validation**: It validates that both the `Entity ID` and `User ID` are valid
    non-negative integers using internal utility methods.

    3. **Manager Setup**: Initializes the `VectraRUXManager` to handle authentication
    and API communication.

    4. **Execution**: Sends a POST request to the Vectra RUX assignments endpoint
    with the user and entity details.

    5. **Output**: Upon success, it generates a data table and a JSON result containing
    the details of the created assignment (including the Assignment ID). If validation
    fails or the API returns an error, the action execution state is set to failed.


    ### Additional Notes

    - Both Entity ID and User ID must be numeric strings as they are converted to
    integers before the API call.

    - The 'Entity Type' is case-insensitive in the logic but provided as a fixed list
    (Host/Account) in the UI.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new assignment record in the Vectra RUX platform, linking a specific
      host or account entity to a designated user.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Assign Group:
  ai_description: >-
    ### General Description

    The **Assign Group** action adds members to a specific group within the Vectra
    RUX platform. It identifies the target group by its ID and appends a provided
    list of members (such as Hostnames, IP addresses, Accounts, or Domains) to that
    group. This action is primarily used for maintaining and updating group-based
    configurations or policy scopes within Vectra.


    ### Parameters Description

    | Name | Description | Mandatory | Type |

    | :--- | :--- | :--- | :--- |

    | **Group ID** | The unique numerical identifier of the target group in Vectra
    RUX. | Yes | String (Validated as Integer) |

    | **Members** | A comma-separated list of member identifiers to assign to the
    group. The identifier type must match the group's type (e.g., host names for host
    groups, IPs for IP groups). | Yes | String |


    ### Additional Notes

    - The action performs a 'patch' operation with an 'append' action, meaning existing
    members are preserved.

    - The script performs validation to check which members were successfully added
    and reports any that were not found or invalid within the Vectra environment.


    ### Flow Description

    1. **Initialization**: Validates the provided Group ID to ensure it is a valid,
    non-zero positive integer.

    2. **Member Processing**: Parses the comma-separated string of members into a
    unique list.

    3. **API Interaction**: Authenticates with Vectra RUX and sends a PATCH request
    to the groups endpoint, targeting the specific Group ID with the list of members
    and the 'append' membership action.

    4. **Verification**: Compares the list of requested members against the returned
    group membership list from Vectra to determine successful vs. failed assignments.

    5. **Visualization**: Generates an HTML representation of the updated group properties
    and membership list for display in the Google SecOps Case Wall.

    6. **Finalization**: Returns the full updated group object as JSON and provides
    a summary message detailing the number of successfully assigned members.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action modifies group membership in the Vectra RUX platform by adding specified
      members to a target group via a PATCH request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Describe Assignment:
  ai_description: >-
    ### General Description

    The **Describe Assignment** action retrieves comprehensive details for a specific
    assignment from the Vectra RUX platform based on its unique Assignment ID. This
    is a read-only enrichment action designed to provide SOC analysts with full context
    regarding how a specific task or detection was assigned, who is responsible for
    it, its current resolution status, and associated entity details (Host or Account).


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Assignment ID** | String | Yes | The unique numerical identifier of the assignment
    you wish to retrieve details for. The value must be a non-negative integer. |


    ### Flow Description

    1.  **Input Validation:** The action first validates that the provided `Assignment
    ID` is a valid, non-negative integer.

    2.  **Authentication:** The script initializes the `VectraRUXManager` using provided
    API Root, Client ID, and Client Secret to authenticate and generate a Bearer token.

    3.  **Data Retrieval:** A GET request is sent to the Vectra RUX API endpoint for
    the specific assignment.

    4.  **Processing:** The raw response is parsed into an `Assignment` data model
    which extracts key fields like `assigned_to`, `resolved_by`, `outcome`, and identifiers
    for the associated host or account.

    5.  **Output Generation:** The action populates the `JsonResult` with the full
    raw response and creates a formatted Data Table (CSV) for the SOAR user interface
    summarizing the assignment details.


    ### Additional Notes

    - This action does not interact with entities currently present in the SOAR case;
    it functions solely based on the provided `Assignment ID` parameter.

    - If the Assignment ID is not found, the action will return a failure status with
    a specific error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Describe Detection:
  ai_description: >-
    ### General Description

    The "Describe Detection" action retrieves comprehensive information about a specific
    detection from the Vectra RUX platform using its unique ID. This action is used
    to obtain detailed metadata, including the detection's state, category, type,
    and source entity information (Host or Account), allowing analysts to perform
    deep-dive investigations within the SOAR platform.


    ### Parameters Description

    | Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Detection ID | The unique identifier for the specific detection record in Vectra
    RUX. | string | Yes |


    ### Additional Notes

    The action validates that the provided Detection ID is a valid integer before
    making the API request. If the ID is not found or is invalid, the action will
    report a failure state.


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the API credentials (API Root,
    Client ID, Client Secret) and the target Detection ID from the configuration and
    parameters.

    2. **Input Validation**: The Detection ID is validated to ensure it is formatted
    as a valid integer.

    3. **Manager Initialization**: A `VectraRUXManager` instance is created, which
    handles authentication (OAuth2) and session management with the Vectra RUX API.

    4. **API Request**: The action sends a GET request to the Vectra RUX detections
    endpoint for the specified ID.

    5. **Data Processing**: The response is parsed into a Detection data model, which
    extracts key fields like ID, Detection Type, State, and Category.

    6. **Result Output**: The action populates a data table for the case wall and
    attaches the raw detection data as JSON for downstream use.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Describe Entity:
  ai_description: >-
    ### General Description

    This action retrieves comprehensive details for a specific entity (either an Account
    or a Host) from the Vectra RUX platform using its unique ID. It provides deep
    visibility into the entity's status, urgency scores, attack ratings, and associated
    detection sets, helping analysts understand the risk context of a specific asset
    or user account.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Entity ID | The unique integer identifier for the entity (Account or Host) within
    the Vectra RUX platform. | String | Yes |

    | Entity Type | The category of the entity to describe. Supported values are 'Account'
    or 'Host'. | DDL | Yes |


    ### Flow Description

    1. **Initialization**: The action extracts API credentials and the user-provided
    entity ID and type.

    2. **Validation**: It validates that the 'Entity ID' is a valid non-negative integer.

    3. **API Interaction**: It authenticates with the Vectra RUX API and performs
    a GET request to the specific entity endpoint, specifying the type as a query
    parameter.

    4. **Data Parsing**: The raw JSON response is parsed into a structured Entity
    data model, which processes fields like severity, urgency scores, and detection
    lists.

    5. **Output Generation**: The action creates a summary data table and attaches
    the full raw JSON response to the action results for the analyst's review.


    ### Additional Notes

    This action is a standalone lookup and does not iterate over entities currently
    attached to the SOAR case context; instead, it relies explicitly on the provided
    'Entity ID' parameter.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Download PCAP:
  ai_description: >-
    ### General Description

    This action downloads a PCAP (Packet Capture) file from Vectra RUX associated
    with a specific detection ID. It is primarily used for deep-packet analysis during
    an investigation to understand the network traffic that triggered a detection.
    The action retrieves the binary content, saves it to a local directory on the
    execution server, and attaches the file directly to the Google SecOps action results
    for analyst review.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Detection ID | string | Yes | The unique numerical identifier for the detection
    in Vectra RUX from which the PCAP file should be retrieved. |


    ### Additional Notes

    - The action requires valid API credentials (API Root, Client ID, and Client Secret)
    configured in the integration settings.

    - The downloaded file is base64 encoded before being attached to the SOAR action
    results.

    - If the detection ID is not found or does not have an associated PCAP, the action
    will return a failure status.


    ### Flow Description

    1. **Initialization**: The action initializes the VectraRUX manager and extracts
    the provided Detection ID.

    2. **Validation**: It validates that the Detection ID is a valid integer.

    3. **API Interaction**: It makes a GET request to the Vectra RUX API endpoint
    `api/v3.4/detections/{detection_id}/pcap`.

    4. **File Processing**: Upon a successful 200 OK response, it extracts the filename
    from the `Content-Disposition` header.

    5. **Internal Storage**: The PCAP content is saved to a local path on the SOAR
    worker's filesystem.

    6. **Result Attachment**: The file content is base64 encoded and attached to the
    action's result using the SOAR SDK.

    7. **Completion**: The action concludes by reporting the filename and the status
    of the download.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action saves the downloaded PCAP file to a local directory on the Google
      SecOps server and adds it as a base64-encoded attachment to the action's result
      data.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Assignments:
  ai_description: >-
    ### General Description

    This action retrieves a list of assignments from the Vectra RUX platform based
    on various filtering criteria. Assignments represent tasks or investigations associated
    with security events in Vectra. The action allows analysts to search for assignments
    by account, host, or assignee, as well as by their resolution status and creation
    time.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Accounts IDs | string | No | Comma-separated list of account IDs to filter the
    assignments. |

    | Assignees IDs | string | No | Comma-separated list of user/assignee IDs to filter
    the assignments. |

    | Resolution IDs | string | No | Comma-separated list of outcome/resolution IDs
    to filter results. |

    | Resolved | ddl | No | Filter assignments based on whether they are resolved.
    Options: None, True, False. |

    | Created After | string | No | Filter assignments created after a specific time.
    Supports relative formats (e.g., '2 days') or ISO timestamps. |

    | Limit | string | No | The maximum number of assignment records to retrieve.
    |

    | Hosts IDs | string | No | Comma-separated list of host IDs to filter the assignments.
    |


    ### Additional Notes

    * The action does not require specific entity context from the case; it performs
    a global search based on the provided parameters.

    * Input IDs (Accounts, Hosts, Assignees, etc.) are validated as integers before
    being sent to the Vectra API.


    ### Flow Description

    1.  **Initialization**: Authenticates with the Vectra RUX platform using configured
    API credentials (Client ID and Secret).

    2.  **Parameter Parsing**: Collects and validates input filters. Time-based filters
    and integer-based ID lists are processed into the appropriate format for the query.

    3.  **API Request**: Executes a GET request to the Vectra `/assignments` endpoint
    with the specified query parameters.

    4.  **Pagination**: If the number of results exceeds the page size but is within
    the user-defined limit, the action automatically handles pagination to fetch all
    requested records.

    5.  **Output Generation**: Formats the retrieved assignments into a data table
    for the case view and a raw JSON object for downstream logic.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Detections:
  ai_description: "Lists detections from Vectra RUX based on various filtering criteria\
    \ such as entity IDs, detection categories, and threat levels. This action is\
    \ primarily used for security investigation and hunting, allowing analysts to\
    \ retrieve detailed information about specific security events associated with\
    \ hosts or accounts. \n\n### Parameters\n| Parameter | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| Detection Category | Dropdown | No | Filter\
    \ detections by category (e.g., Exfiltration, Lateral Movement). |\n| Threat GTE\
    \ | String | No | Filter detections with a threat score greater than or equal\
    \ to this value. |\n| Certainty GTE | String | No | Filter detections with a certainty\
    \ score greater than or equal to this value. |\n| Last Timestamp GTE | String\
    \ | No | Filter detections with a last detection timestamp greater than or equal\
    \ to this value. |\n| Last Timestamp LTE | String | No | Filter detections with\
    \ a last detection timestamp less than or equal to this value. |\n| Tags | String\
    \ | No | Comma-separated list of tags to filter detections. |\n| Entity Type |\
    \ Dropdown | No | Type of entity to filter (Host or Account). |\n| Entity ID |\
    \ String | No | The unique identifier of the entity in Vectra. |\n| Is Targeting\
    \ Key Asset | Dropdown | No | Filter detections based on whether they target a\
    \ key asset. |\n| Note Modified Timestamp GTE | String | No | Filter detections\
    \ based on when notes were last modified. |\n| Limit | String | No | The maximum\
    \ number of detections to retrieve. |\n| Order | Dropdown | No | Sort order (Ascending\
    \ or Descending). |\n| Order By | Dropdown | No | Field to sort by (last_timestamp,\
    \ threat_score, or certainty_score). |\n| State | Dropdown | No | Filter by detection\
    \ state (Active, Inactive, Fixed). |\n| Detection Type | String | No | Specific\
    \ type of detection to filter for. |\n\n### Flow Description\n1. **Initialization:**\
    \ Authenticates with the Vectra RUX API using the configured Client ID and Secret.\n\
    2. **Parameter Validation:** Validates numeric inputs like Threat/Certainty scores\
    \ and result limits.\n3. **Data Retrieval:** Sends a paginated GET request to\
    \ the Vectra detections endpoint with all provided filters.\n4. **Data Normalization:**\
    \ Processes the results to remove API versioning strings from URLs and extracts\
    \ source host/account details.\n5. **Output Generation:** Populates a data table\
    \ named 'List Of Detections' with key fields (ID, Type, State, Timestamps) and\
    \ attaches the full raw JSON response."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Entities:
  ai_description: "### General Description\nThis action retrieves a list of entities\
    \ (either Hosts or Accounts) from the Vectra RUX platform based on various filter\
    \ criteria. It is designed to provide visibility into entities managed by Vectra,\
    \ allowing security analysts to search for specific records based on their state,\
    \ tags, timestamps, and priority status.\n\n### Parameters Description\n| Parameter\
    \ | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| Entity\
    \ Type | DDL | True | Specifies the type of entities to retrieve. Options are\
    \ 'Host' or 'Account'. |\n| Order By | DDL | False | Field used to sort the results\
    \ (e.g., urgency_score, last_detection_timestamp, name, last_modified_timestamp).\
    \ |\n| Fields | Multi-choice | False | A list of specific fields to include in\
    \ the response. If not provided, a default set of fields is returned. |\n| Name\
    \ | String | False | Filter entities by their specific name. |\n| State | DDL\
    \ | False | Filter entities by their current state ('Active' or 'Inactive'). |\n\
    | Last Detection Timestamp GTE | String | False | Filters entities where the last\
    \ detection occurred on or after this timestamp. |\n| Last Detection Timestamp\
    \ LTE | String | False | Filters entities where the last detection occurred on\
    \ or before this timestamp. |\n| Tags | String | False | A comma-separated list\
    \ of tags to filter the entities. |\n| Note Modified Timestamp GTE | String |\
    \ False | Filters entities where a note was modified on or after this timestamp.\
    \ |\n| Prioritized | DDL | False | Filters entities based on whether they are\
    \ marked as prioritized ('True' or 'False'). |\n| Limit | String | False | The\
    \ maximum number of entity records to retrieve. |\n| Order | DDL | False | Determines\
    \ the sorting direction: 'Ascending' or 'Descending'. |\n\n### Additional Notes\n\
    - If 'Descending' is selected for the 'Order' parameter and an 'Order By' field\
    \ is provided, the API query will prepend a '-' to the sorting field to enforce\
    \ descending order.\n- The action automatically cleans up URLs in the results\
    \ by removing internal API versioning strings for better readability.\n- Results\
    \ are outputted as both a raw JSON object and a formatted data table on the case\
    \ wall.\n\n### Flow Description\n1. **Parameter Extraction:** The action extracts\
    \ the API configuration and all user-provided filter parameters.\n2. **Validation:**\
    \ It validates the 'Limit' parameter to ensure it is a valid integer.\n3. **API\
    \ Request:** It initializes the VectraRUX Manager and executes a paginated GET\
    \ request to the `/entities` endpoint using the provided filters.\n4. **Data Processing:**\
    \ The returned entities are processed to remove API versioning from URLs and mapped\
    \ into a structured format.\n5. **Output Generation:** \n   - A data table named\
    \ 'List Of Entities' is created and added to the case wall logs.\n   - The full\
    \ raw data set is attached as a JSON result.\n   - The action finishes with a\
    \ success message indicating the number of entities retrieved."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Entity Detections:
  ai_description: >-
    ### General Description

    The **List Entity Detections** action retrieves all security detections associated
    with a specific entity (Host or Account) identified by its unique ID in the Vectra
    RUX platform. This is an investigative action used to understand the threat landscape
    of a specific asset by listing its linked detections, their types, categories,
    and severity details.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | string | Yes | The unique numeric identifier of the entity in Vectra
    RUX. |

    | Entity Type | ddl | Yes | Specifies whether the entity is an 'Account' or a
    'Host'. |

    | Limit | string | No | The maximum number of detections to retrieve. Must be
    a positive integer. |

    | State | ddl | Yes | Filters detections by their current status. Options include
    'Active', 'Inactive', and 'Fixed'. |


    ### Flow Description

    1. **Authentication and Setup:** The action initializes the Vectra RUX manager
    using the provided API Root, Client ID, and Client Secret.

    2. **Input Validation:** It validates that the 'Entity ID' and 'Limit' parameters
    are valid integers.

    3. **Entity Discovery:** The action first calls the `describe_entity` endpoint
    to fetch the specific entity details and retrieve its associated list of detection
    IDs.

    4. **Detection Querying:** If detection IDs are present, it queries the `list_entity_detections`
    endpoint to fetch detailed information for each detection, applying the 'State'
    filter and the 'Limit'.

    5. **Result Processing:** The retrieved data is converted into JSON and a CSV-formatted
    data table, which are then attached to the action results for the analyst.


    ### Additional Notes

    - If the entity exists but has no detections, the action returns a successful
    message indicating no detections were found.

    - If the Entity ID is invalid or not found, an error is raised to notify the user.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Groups:
  ai_description: >-
    ### General Description

    Lists groups from the Vectra RUX platform based on various query parameters. This
    action is primarily used for discovering and retrieving metadata about specific
    groups of entities (hosts, accounts, domains, IPs) defined in the Vectra environment.
    It supports multiple filters such as group type, importance, and modification
    timestamps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Last Modified Timestamp GTE | String | No | Filter for groups modified on or
    after this timestamp. |

    | Last Modified By | String | No | Filter for groups last modified by a specific
    username. |

    | Name | String | No | Filter for groups by their name. |

    | Type | DDL | No | Filter by the type of group. Options: account, ip, domain,
    host. |

    | Limit | String | No | The maximum number of group records to fetch. |

    | Account Names | String | No | Comma-separated list of account names to filter
    group members. |

    | Domains | String | No | Comma-separated list of domains to filter group members.
    |

    | Host Ids | String | No | Comma-separated list of host IDs to filter group members.
    |

    | Host Names | String | No | Comma-separated list of host names to filter group
    members. |

    | Importance | DDL | No | Filter groups by their importance level (e.g., high,
    medium, low). |

    | IPs | String | No | Comma-separated list of IP addresses to filter group members.
    |

    | Description | String | No | Filter for groups based on their description (case-insensitive
    match). |


    ### Flow Description

    1. **Initialization**: The action initializes the Vectra RUX Manager using API
    credentials from the integration configuration.

    2. **Parameter Processing**: It validates input parameters, specifically ensuring
    the 'Limit' is a valid integer.

    3. **Data Retrieval**: It performs a GET request to the Vectra RUX `/groups` endpoint,
    applying all user-specified filters. The action handles pagination automatically
    to respect the requested limit.

    4. **Parsing**: Retrieved group data is converted into structured Group data models.

    5. **Output**: The action constructs a CSV Data Table titled "List Of Groups"
    for the SOAR UI and provides the raw list of groups as a JSON result.


    ### Additional Notes

    This is a discovery action and does not require specific entity context to run;
    it queries the entire Vectra RUX platform based on the provided inputs.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Outcomes:
  ai_description: "### General Description\nThe **List Outcomes** action retrieves\
    \ a comprehensive list of all assignment outcomes configured in the Vectra RUX\
    \ platform. Assignment outcomes are used within the Vectra ecosystem to classify\
    \ the resolution or status of security assignments. This action is primarily used\
    \ for administrative or investigative context, allowing users to see what classification\
    \ options are available for closing out alerts or entity assignments.\n\n### Parameters\
    \ Description\n| Parameter | Type | Mandatory | Description |\n| :--- | :--- |\
    \ :--- | :--- |\n| Limit | String | No | The maximum number of outcome records\
    \ to retrieve. If not specified, the system fetches all available records (subject\
    \ to platform defaults). The value must be a positive integer. |\n\n### Additional\
    \ Notes\n- This is a utility action that does not require or act upon specific\
    \ entities (like IP addresses or Hostnames) within a case.\n- The output is provided\
    \ both as a structured data table and a raw JSON object for downstream playbook\
    \ processing.\n\n### Flow Description\n1. **Credential Initialization:** The action\
    \ extracts API Root, Client ID, and Client Secret from the integration configuration\
    \ to authenticate with the Vectra RUX API.\n2. **Parameter Validation:** If a\
    \ `Limit` is provided, it is validated to ensure it is a non-zero, positive integer.\n\
    3. **API Request:** The action executes a paginated GET request to the `assignment_outcomes`\
    \ endpoint of the Vectra RUX API.\n4. **Data Parsing:** The raw API response is\
    \ parsed into `Outcome` data models, extracting key attributes such as ID, Title,\
    \ Category, and whether the outcome is a system built-in or user-selectable.\n\
    5. **Output Generation:** \n   - A data table named \"Outcome Details\" is created\
    \ for the case UI.\n   - The full JSON payload is attached to the action result."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Users:
  ai_description: "### General Description\nRetrieves a list of users from the Vectra\
    \ RUX platform based on specific filtering criteria. This action allows security\
    \ teams to audit user accounts, verify roles, and monitor login activity within\
    \ the Vectra environment. It is primarily used for user management and investigative\
    \ context gathering.\n\n### Parameters Description\n\n| Parameter | Description\
    \ | Type | Mandatory |\n|-----------|-------------|------|-----------|\n| Role\
    \ | Filters the user list by a specific security or system role (e.g., admin,\
    \ read-only). | String | No |\n| Email | Filters the user list to find a specific\
    \ user account by their email address. | String | No |\n| Last Login GTE | Filters\
    \ for users whose last login timestamp is greater than or equal to the provided\
    \ value. | String | No |\n| Limit | Specifies the maximum number of user records\
    \ to retrieve. | String | No |\n\n### Flow Description\n1. **Initialization**:\
    \ The action initializes the Vectra RUX manager using configuration parameters\
    \ including API Root, Client ID, and Client Secret.\n2. **Parameter Extraction**:\
    \ Retrieves user-provided filters for Role, Email, Last Login timestamp, and a\
    \ result Limit from the action parameters.\n3. **Validation**: Validates the 'Limit'\
    \ parameter to ensure it is a valid integer greater than zero.\n4. **API Interaction**:\
    \ Executes a paginated GET request to the Vectra RUX `/users` endpoint, applying\
    \ the specified filters to the query.\n5. **Data Processing**: Parses the JSON\
    \ response into structured User objects.\n6. **Output Generation**: \n    - If\
    \ users are found, it generates a data table titled 'List Of Users' featuring\
    \ details such as Name, Email, Role, and Last Login timestamp.\n    - The full\
    \ user list is also attached as a JSON result for further automated processing.\n\
    \n### Additional Notes\n- If no users match the specified criteria, the action\
    \ returns a successful status with a 'No users were found' message.\n- The 'Last\
    \ Login GTE' parameter should ideally follow a standard timestamp format supported\
    \ by the Vectra API."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Mark Detection Fixed:
  ai_description: >-
    ### General Description

    Marks specific detections as fixed within the Vectra RUX platform. This action
    allows analysts or automated workflows to update the state of detections in bulk
    by providing their unique identifiers. It is primarily used for remediation and
    closing out identified threats that have been resolved.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Detection IDs** | A comma-separated list of numeric detection IDs to be marked
    as fixed. | String | Yes |


    ### Flow Description

    1.  **Initialization**: Extracts API credentials (API Root, Client ID, Client
    Secret) and the 'Detection IDs' action parameter.

    2.  **Validation**: Splitting the input string by commas and validating that each
    ID is a valid integer.

    3.  **Authentication**: Establishes a session with the Vectra RUX API using OAuth2
    (client credentials or refresh token logic).

    4.  **Mutation**: Sends a `PATCH` request to the Vectra detections endpoint (`/api/v3.4/detections`)
    with the payload containing the list of IDs and the `mark_as_fixed` flag set to
    `True`.

    5.  **Result Handling**: Captures the API response, attaches it as a JSON result
    to the action, and outputs a success or failure message.


    ### Additional Notes

    - This action performs an external state change (Mutation) and is not considered
    an enrichment action.

    - It does not automatically run on entities in the case; it relies strictly on
    the provided 'Detection IDs' parameter.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of detections in the Vectra RUX system to 'fixed' via a PATCH
      request to the /detections API endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Mark Entity Fixed:
  ai_description: "Marks all security detections associated with a specific entity\
    \ (Host or Account) as 'fixed' within the Vectra RUX platform. This action is\
    \ used to programmatically resolve multiple detections at once based on an entity's\
    \ unique identifier. \n\n### Parameters\n| Parameter | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| Entity ID | string | Yes | The unique integer\
    \ identifier of the entity in Vectra whose detections should be marked as fixed.\
    \ |\n| Entity Type | ddl | Yes | The type of entity being targeted. Must be either\
    \ 'Account' or 'Host'. |\n\n### Flow Description\n1. **Validation:** The action\
    \ validates that the provided `Entity ID` is a valid integer.\n2. **Entity Retrieval:**\
    \ It queries the Vectra API to describe the specified entity and retrieve its\
    \ associated `detection_ids`.\n3. **Detection Check:** If no detections are found\
    \ for the entity, the action terminates with a success message indicating no work\
    \ was needed.\n4. **Mutation:** If detections exist, the action sends a PATCH\
    \ request to the Vectra platform to update the state of all identified detections\
    \ to 'fixed'.\n5. **Results:** The raw response from the Vectra API regarding\
    \ the update is returned as JSON."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of detections associated with the specified entity to 'fixed'
      in the Vectra RUX platform via a PATCH request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    Tests the connectivity between the Google SecOps server and the Vectra platform
    by verifying authentication credentials. This action ensures that the configured
    API Root, Client ID, and Client Secret are valid and that the SOAR platform can
    successfully obtain an OAuth2 access token from the Vectra server.


    ### Parameters

    | Parameter Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | None | This action does not have any action-level parameters. It uses integration-wide
    configuration settings. | - | - |


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the required authentication
    details (API Root, Client ID, and Client Secret) from the integration configuration.

    2. **Authentication Attempt**: The action initializes the `VectraRUXManager`,
    which triggers an authentication flow. It attempts to retrieve an OAuth2 access
    token using the `client_credentials` grant type.

    3. **Connectivity Verification**: The `test_connectivity` method is called to
    confirm that the connection to the Vectra API is established and functional.

    4. **Status Report**: The action ends with a success message if authentication
    succeeds or an error message detailing the failure if the connection or credentials
    are invalid.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Assignment:
  ai_description: >-
    Removes an assignment for a specific entity within the Vectra RUX platform. This
    action targets a single entity identified by its ID and type (Host or Account)
    and clears any active assignment associated with it.


    ### General Description

    This action interacts with the Vectra RUX API to identify and delete an assignment
    linked to a specific entity. It is primarily used to clear investigator ownership
    or resolution status on entities once a task is completed or needs to be reassigned
    manually.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | string | Yes | The unique numeric identifier of the entity in Vectra
    RUX from which the assignment should be removed. |

    | Entity Type | ddl | Yes | The category of the entity. Options are 'Account'
    or 'Host'. This determines which API endpoint is queried to find the entity. |


    ### Additional Notes

    - The action first verifies if the entity currently has an assignment. If no assignment
    exists for the provided ID, the action will return a failure state indicating
    that no assignment was found.

    - The Entity ID must be a valid integer.


    ### Flow Description

    1. **Initialization**: Extracts API credentials and validates that the provided
    Entity ID is an integer.

    2. **Entity Lookup**: Queries the Vectra RUX API to retrieve metadata for the
    specified Entity Type and Entity ID.

    3. **Assignment Verification**: Checks the retrieved entity metadata for an existing
    'assignment' object.

    4. **Mutation**: If an assignment is found, the action extracts the assignment
    ID and sends a DELETE request to the Vectra RUX assignments endpoint.

    5. **Completion**: Reports success if the assignment was deleted or failure if
    the entity lacked an assignment or the ID was invalid.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Performs a DELETE request to the Vectra RUX API to remove an existing assignment
      record associated with a Host or Account.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Group:
  ai_description: >-
    ### General Description

    This action removes specified members from a Vectra AI group using its unique
    Group ID. It interacts with the Vectra RUX API to verify current membership, perform
    the removal, and provide a summary of the operation. It is useful for automated
    remediation where malicious or unauthorized entities need to be evicted from managed
    groups.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Group ID | string | Yes | The numeric identifier of the group in Vectra. Must
    be a valid positive integer. |

    | Members | string | Yes | A comma-separated list of member identifiers to be
    removed. The format of these identifiers (e.g., IP, Hostname, Account UID) must
    match the type of the group being modified. |


    ### Additional Notes

    - The action compares the group membership before and after the update to accurately
    report which members were successfully removed and which were not found or were
    invalid.

    - If none of the provided members are found in the group, the action will return
    a failed execution state.


    ### Flow Description

    1. **Validation**: The action validates that the provided `Group ID` is a valid
    integer and processes the `Members` string into a list.

    2. **Retrieval**: It fetches the current membership of the group from the Vectra
    API to establish a baseline.

    3. **Removal**: It sends a PATCH request to the Vectra API with the `membership_action`
    set to `remove` for the specified members.

    4. **Comparison**: The action compares the updated membership list against the
    baseline to determine which members were successfully evicted.

    5. **Reporting**: It generates a JSON output of the group state and an HTML table
    for the Case Wall, displaying properties like Group Name, Type, and the updated
    list of members.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates group membership in Vectra AI by removing specified members via a PATCH
      request to the group management endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Note:
  ai_description: >-
    ### General Description

    Removes a specific note from an entity (Account, Host, or Detection) within the
    Vectra RUX platform. This action is designed to manage and clean up documentation
    stored in the external system by targeting unique note identifiers associated
    with specific entity IDs.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | String | Yes | The unique numerical identifier of the entity in
    Vectra RUX from which the note should be removed. |

    | Note ID | String | Yes | The unique numerical identifier of the specific note
    to be deleted. |

    | Entity Type | DDL | Yes | The category of the entity. Supported values are:
    Account, Host, Detection. |


    ### Additional Notes

    - Both the Entity ID and Note ID must be valid integers.

    - This action performs a permanent deletion in the external Vectra RUX system.


    ### Flow Description

    1. **Param Initialization:** The action retrieves configuration parameters (API
    Root, Client ID, Client Secret) and action parameters (Entity ID, Note ID, Entity
    Type).

    2. **Vectra RUX Connection:** It establishes a session with the Vectra RUX API
    and validates/generates the necessary OAuth2 tokens.

    3. **Input Validation:** The script ensures that both the Entity ID and Note ID
    are valid integers before proceeding.

    4. **API Call:** It sends a DELETE request to the Vectra RUX endpoint constructed
    using the provided IDs and Entity Type.

    5. **Completion:** Upon success, it reports the deletion of the specific note;
    otherwise, it handles errors (such as 404 Not Found) and returns a failed execution
    state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes data by deleting a specific note record associated with an entity in
      the Vectra RUX platform via a DELETE API call.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Tags:
  ai_description: >-
    ### General Description

    The **Remove Tags** action allows users to programmatically remove specific tags
    from entities within the Vectra AI platform. It supports modifying tags for Accounts,
    Hosts, and Detections based on a provided unique identifier. This action is crucial
    for maintaining accurate metadata and lifecycle management of security objects
    within Vectra.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Tags** | String | Yes | A comma-separated list of tags that should be removed
    from the target entity. Duplicate tags and extra whitespace are automatically
    handled. |

    | **Entity ID** | String | Yes | The unique identifier (ID) of the entity in Vectra
    from which the tags will be removed. This must be a valid integer. |

    | **Entity Type** | DDL | Yes | Specifies the category of the entity. Options
    include: `Account`, `Host`, or `Detection`. This determines the appropriate API
    endpoint. |


    ### Additional Notes

    - This action performs a "safety check" by first fetching the current tags of
    the entity. If none of the tags provided in the input are currently present on
    the entity, the action will fail with a `TagsUpdateFailException` to avoid unnecessary
    API calls.

    - The action uses a `PATCH` request to update the entity state in Vectra with
    the modified tag list.


    ### Flow Description

    1.  **Parameter Extraction:** The action retrieves the configuration (API credentials)
    and input parameters (Tags, Entity ID, and Entity Type).

    2.  **Validation:** The `Entity ID` is validated to ensure it is a valid integer.
    The `Tags` string is parsed into a unique list of strings.

    3.  **Data Retrieval:** The action queries the Vectra API to fetch the current
    list of tags associated with the specified `Entity ID` and `Entity Type`.

    4.  **Tag Comparison:** It compares the existing tags with the user-provided removal
    list. It identifies tags that successfully match for removal and those that do
    not exist.

    5.  **State Mutation:** If valid tags are found for removal, the action calculates
    the new tag set and sends a `PATCH` request to Vectra to update the entity.

    6.  **Reporting:** The action outputs a JSON result and a data table named "Tag
    Updated Status" to the Google SecOps case wall, detailing which tags were removed
    and which were not found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the entity state in the Vectra AI platform by removing specific tags
      via a PATCH request to the tagging endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Resolve Assignment:
  ai_description: "### General Description\nResolves a specific assignment in Vectra\
    \ RUX using a designated outcome ID and optional triage information. This action\
    \ allows analysts to close out investigations within the Vectra platform directly\
    \ from Google SecOps, ensuring consistency between the two systems.\n\n### Parameters\
    \ Description\n| Parameter | Type | Mandatory | Description |\n| :--- | :--- |\
    \ :--- | :--- |\n| **Outcome ID** | string | Yes | The ID representing the resolution\
    \ outcome (e.g., '1' for Benign True Positive, '2' for Malicious True Positive,\
    \ '3' for False Positive). Custom outcomes are also supported. |\n| **Assignment\
    \ ID** | string | Yes | The unique identifier of the assignment to be resolved.\
    \ |\n| **Note Title** | string | No | A descriptive note to be added to the assignment\
    \ upon resolution. |\n| **Triage As** | string | No | Specifies a triage rule\
    \ to apply. Note: If this is used, 'Detection IDs' must also be provided. |\n\
    | **Detection IDs** | string | No | A comma-separated list of integer detection\
    \ IDs to be associated with the resolution. Required if 'Triage As' is set. |\n\
    \n### Additional Notes\n- Either provide both 'Triage As' and 'Detection IDs'\
    \ together, or leave both empty. The action will fail if 'Triage As' is provided\
    \ without at least one detection ID.\n- 'Assignment ID' and 'Outcome ID' must\
    \ be valid integers.\n\n### Flow Description\n1. **Validation**: The action first\
    \ validates that the `Assignment ID` and `Outcome ID` are integers. It also validates\
    \ the `Triage As` string format and ensures that if triage is requested, `Detection\
    \ IDs` are present.\n2. **Manager Initialization**: It initializes the `VectraRUXManager`,\
    \ which handles OAuth2 authentication (generating or refreshing access tokens).\n\
    3. **API Interaction**: The action sends a `PUT` request to the Vectra RUX endpoint\
    \ `/api/v3.4/assignments/{assignment_id}/resolve` with the outcome, note, and\
    \ triage details.\n4. **Result Processing**: Upon a successful API call, the raw\
    \ response is attached as `JsonResult`. \n5. **Data Visualization**: A data table\
    \ named 'Resolved Assignment' is created containing key details such as the Assigned\
    \ User, Outcome Title, and associated Host or Account IDs."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Resolves an assignment in the Vectra RUX platform by sending a PUT request to
      the resolve endpoint, changing its status and potentially adding notes or triage
      rules.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Unmark Detection Fixed:
  ai_description: >-
    ### General Description

    Unmarks specific detections as 'fixed' in the Vectra AI (VectraRUX) platform.
    This action allows analysts to revert the status of detections if they were prematurely
    or incorrectly marked as resolved, ensuring they return to an active state for
    further investigation.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Detection IDs | A comma-separated list of numerical IDs (e.g., '123, 456') representing
    the detections to be unmarked as fixed. | string | Yes |


    ### Flow Description

    1. **Parameter Initialization:** The action extracts the API configuration and
    the `Detection IDs` provided as input.

    2. **ID Validation:** The comma-separated string is split into individual IDs,
    and each is validated to ensure it is a valid integer. This prevents malformed
    requests to the Vectra API.

    3. **API Request:** The `VectraRUXManager` sends a `PATCH` request to the detections
    endpoint (`/api/v3.4/detections`). The payload includes the list of IDs and the
    attribute `mark_as_fixed` explicitly set to `False`.

    4. **Outcome Reporting:** The action captures the response from Vectra. If successful,
    it attaches the JSON response to the action results and completes with a success
    message. If IDs are invalid or an API error occurs, the action fails and logs
    the specific error reason.


    ### Additional Notes

    - This action does not process SOAR entities (like IP addresses or Hostnames);
    it targets specific detection record IDs internal to Vectra AI.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Changes the status of detections in Vectra AI by setting the 'mark_as_fixed'
      field to 'False' for the specified Detection IDs.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Assignment:
  ai_description: >-
    Updates the assigned user for a specific assignment associated with an entity
    in Vectra RUX. This action allows security analysts to reassign ownership of detections
    or assignments linked to specific hosts or accounts.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | string | Yes | The unique identifier of the host or account in Vectra.
    |

    | Entity Type | ddl | Yes | The type of the entity, either 'Account' or 'Host'.
    |

    | User ID | string | Yes | The unique identifier of the user to whom the assignment
    should be reassigned. |


    ### Flow Description

    1. **Validation**: Validates that the provided `Entity ID` and `User ID` are valid
    integers.

    2. **Entity Lookup**: Retrieves detailed information for the specified entity
    from the Vectra API to locate its current assignment.

    3. **Assignment Identification**: Checks if the entity has an active assignment.
    If no assignment is found, the action fails.

    4. **Update Request**: Executes a `PUT` request to the Vectra API to update the
    `assign_to_user_id` field for the identified assignment.

    5. **Output**: Returns the updated assignment details in JSON format and populates
    a data table named 'Updated Assignment' with the transaction details.


    ### Additional Notes

    - This action performs an external state change by modifying assignment ownership
    in the Vectra RUX platform.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the 'assign_to_user_id' for a specific assignment in the Vectra RUX
      platform via a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
