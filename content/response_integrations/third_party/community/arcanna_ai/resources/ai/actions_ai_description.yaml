Export full event:
  ai_description: >-
    ### General Description

    The **Export full event** action retrieves the complete data for a specific event
    from the Arcanna.ai platform. This action is designed to fetch detailed event
    information using specific identifiers, allowing for deep-dive analysis or data
    propagation within a playbook.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | String | Yes | The unique identifier of the Arcanna job associated
    with the event. |

    | **Event ID** | String | Yes | The unique identifier of the specific event to
    be exported. |


    ### Flow Description

    1. **Initialization**: The action initializes the Arcanna client using the provided
    integration URL, API Key, and SSL verification settings.

    2. **Parameter Extraction**: It extracts the `Job ID` and `Event ID` from the
    action parameters.

    3. **Data Retrieval**: The action performs a GET request to the Arcanna API endpoint
    `/api/v1/events/{job_id}/{event_id}/export` to fetch the full event details.

    4. **Result Processing**: The retrieved JSON data is added to the action's result
    object, making it available for subsequent steps in the workflow.


    ### Additional Notes

    This action does not process or filter SecOps entities. It operates strictly as
    a data retrieval utility based on the provided Job and Event IDs.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get AI Job by name:
  ai_description: >-
    ### General Description

    Retrieves detailed information about a specific AI job from the Arcanna.ai platform
    using the job's name. This action is useful for workflows that need to programmatically
    access job configurations or statuses based on a human-readable identifier.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job name** | String | Yes | The specific name of the Arcanna AI job for which
    details should be retrieved. |


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the Arcanna URL, API Key, and SSL verification
    settings from the integration configuration.

    2. **Parameter Extraction**: Retrieves the mandatory `Job name` from the action
    parameters.

    3. **API Interaction**: Initializes the Arcanna client and sends a request to
    the `/api/v1/jobs/get_by_name` endpoint using the provided job name.

    4. **Result Processing**: Captures the JSON response containing job details and
    attaches it to the action's execution results for use in subsequent playbook steps.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get AI Job decision set:
  ai_description: >-
    ### General Description

    Retrieves the decision set (labels) associated with a specific Arcanna.ai Job
    ID. This action is used to fetch the classification categories or labels that
    a particular AI job is trained to identify or assign. It is primarily a utility
    action for retrieving metadata about the AI model's configuration.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | string | Yes | The unique numerical identifier of the Arcanna.ai
    job for which the decision set (labels) should be retrieved. |


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the Arcanna.ai URL, API
    Key, and SSL verification settings from the integration configuration.

    2. **Parameter Parsing**: The `Job ID` provided by the user is extracted and converted
    to an integer.

    3. **API Interaction**: The action uses the `ArcannaClient` to perform a GET request
    to the `/api/v1/jobs/{job_id}/labels` endpoint.

    4. **Result Processing**: The retrieved JSON response containing the decision
    set is added to the action's execution results.

    5. **Completion**: The action finishes by providing a status message and the raw
    JSON data.


    ### Additional Notes

    - This action does not operate on entities (IPs, Hostnames, etc.) and instead
    focuses on job-level metadata.

    - The `Job ID` must be a valid integer corresponding to an existing job in the
    Arcanna.ai instance.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get AI Job decision set by job name:
  ai_description: >-
    ### General Description

    Retrieves the decision set (labels) associated with a specific AI job in Arcanna.ai
    based on the provided job name. This action allows users to programmatically fetch
    the classification categories or labels that a specific AI model is trained to
    output, providing context for automated decision-making workflows.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job name | String | Yes | The unique name of the Arcanna AI job for which the
    decision set (labels) should be fetched. |


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the Arcanna URL, API Key,
    and SSL verification settings from the integration's global configuration.

    2. **Parameter Extraction**: The action retrieves the `Job name` provided by the
    user.

    3. **API Interaction**: The action initializes the Arcanna client and sends a
    request to the `/api/v1/jobs/get_by_name/labels` endpoint using the job name.

    4. **Result Processing**: The API response, containing the decision set, is attached
    to the action results as a JSON object for use in subsequent playbook steps.


    ### Additional Notes

    - This action does not process or interact with SecOps entities (IPs, Hosts, etc.).

    - While the underlying API call uses a POST method, it is strictly a data retrieval
    operation and does not modify the state of the Arcanna AI job.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Arcanna decision:
  ai_description: >-
    ### General Description

    Retrieves an AI-driven decision from Arcanna.ai for a specific event associated
    with a job. This action is primarily used to poll for the results of an analysis
    previously submitted to Arcanna, handling cases where the decision might still
    be in a pending state.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job Id | String | Yes | The unique identifier of the Arcanna job. |

    | Event Id | String | Yes | The unique identifier of the event for which the decision
    is requested. |

    | Retry count | String | Yes | The number of times the action will attempt to
    poll for a decision if the status is 'pending_inference'. Default is 20. |

    | Seconds per retry | String | Yes | The duration (in seconds) to wait between
    each polling attempt. Default is 5. |


    ### Additional Notes

    - This action does not operate on entities; it requires specific IDs provided
    as parameters.

    - The total wait time is approximately `Retry count` * `Seconds per retry`.


    ### Flow Description

    1. **Initialization**: Extracts integration configuration (URL, API Key, SSL settings)
    and action parameters (Job ID, Event ID, Retry settings).

    2. **Polling Loop**: Enters a loop that executes for the specified number of retries
    using a built-in retry mechanism.

    3. **Status Check**: Calls the Arcanna API to retrieve the current status of the
    event.

    4. **Decision Handling**:
        - **OK**: If the status is 'OK', the action retrieves the decision data, adds
    it to the action's JSON results, and completes successfully.
        - **pending_inference**: If the status is 'pending_inference', the action
    logs the status, waits for the specified interval, and retries.
        - **ERROR**: If the API returns an 'ERROR' status, the action logs the error
    details and fails.
    5. **Timeout**: If the retry limit is reached without receiving a final decision,
    the action fails with a message suggesting an increase in the retry window.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Jobs:
  ai_description: >-
    ### General Description

    The **Get Jobs** action retrieves a list of all available jobs from the Arcanna.AI
    platform. This action is primarily used for discovery and orchestration, allowing
    users to see which AI models or processing pipelines are currently configured
    and active within their Arcanna.AI instance. The retrieved data includes job identifiers
    and metadata necessary for other actions that target specific jobs.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Url** | String | Yes | The base URL of the Arcanna.AI instance (e.g., `https://arcanna.example.com`).
    Found under the 'Integration' configuration block. |

    | **Api Key** | String | Yes | The API key used for authentication with the Arcanna.AI
    service. Found under the 'Integration' configuration block. |

    | **SSL Verification** | Boolean | Yes | A configuration parameter (extracted
    from the 'SSL Verification' block) that determines whether the action should verify
    the server's SSL certificate. Note: In the current implementation, the code looks
    for a parameter named 'Api Key' within the 'SSL Verification' block to determine
    this boolean value. |


    ### Flow Description

    1. **Initialization:** The action initializes the Siemplify context and logs the
    start of the process.

    2. **Configuration Retrieval:** It extracts the Arcanna.AI URL, API Key, and SSL
    verification settings from the integration and action configurations.

    3. **API Interaction:** The action uses the `ArcannaClient` to perform a GET request
    to the `/api/v1/jobs` endpoint.

    4. **Data Processing:** The JSON response containing the list of jobs is captured.

    5. **Output:** The retrieved job list is attached to the action results as a JSON
    object (`JsonResult`), and the action completes with a success message and the
    raw response data.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility designed to verify the connectivity between the
    Google SecOps environment and the Arcanna.ai platform. It performs a simple health
    check against the Arcanna.ai API to ensure that the provided credentials and URL
    are correct and that the service is reachable.


    ### Parameters Description

    There are no action-specific parameters for this action. It relies entirely on
    the following **Integration Configuration** parameters:


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Url | String | Yes | The base URL of the Arcanna.ai instance (e.g., `https://arcanna.example.com`).
    |

    | Api Key | String | Yes | The API key used to authenticate requests to the Arcanna.ai
    service. |

    | SSL Verification | String | Yes | Determines whether to verify the SSL certificate
    of the Arcanna.ai server. Note: The code specifically looks for a parameter named
    'Api Key' under the 'SSL Verification' configuration block. |


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the URL, API Key, and SSL
    verification settings from the integration configuration.

    2. **Client Initialization**: An `ArcannaClient` is initialized using the provided
    connection details.

    3. **Health Check**: The action calls the `/api/v1/health` endpoint of the Arcanna.ai
    API via a GET request.

    4. **Result Processing**: The JSON response from the health check is added to
    the action's result data.

    5. **Completion**: The action completes with a success status if the health check
    is successful, or a failure status if an exception occurs (e.g., connection timeout,
    invalid credentials).


    ### Additional Notes

    - This action does not operate on entities and is intended for configuration validation.

    - The SSL Verification parameter name in the configuration is expected to be 'Api
    Key' based on the current implementation logic.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Active Alert from Case to Arcanna:
  ai_description: >-
    ### General Description

    The **Send Active Alert from Case to Arcanna** action transmits the currently
    active alert from a Google SecOps case to the Arcanna.ai platform. This allows
    Arcanna's AI models to process the alert data for decision-making, classification,
    or further automated analysis.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | String | Yes | The specific Job ID in Arcanna.ai where the alert
    should be ingested. |

    | **Alert identifier field** | String | No | The field within the alert JSON that
    contains the unique identifier. Defaults to "identifier". |

    | **Use Alert ID as ID in Arcanna** | Boolean | No | If set to `True`, the action
    uses the value from the "Alert identifier field" as the ID in Arcanna. If `False`,
    Arcanna generates a new unique ID. |


    ### Flow Description

    1. **Initialization**: Retrieves integration configuration (URL, API Key, SSL
    settings) and action parameters (Job ID, Identifier settings).

    2. **Case Retrieval**: Fetches the full case details from Google SecOps and identifies
    the specific active alert currently being processed in the playbook context.

    3. **Alert Matching**: Iterates through the case's cyber alerts to find the raw
    payload matching the current alert's identifier.

    4. **Data Transmission**: Sends the raw alert payload to the Arcanna API via a
    POST request to the `/api/v1/events/` endpoint, optionally including a specific
    event ID.

    5. **Result Handling**: Captures the API response from Arcanna and attaches it
    as a JSON result to the action for use in subsequent playbook steps.


    ### Additional Notes

    - This action specifically targets the "Active Alert" in the context of the playbook
    execution rather than processing all alerts in a case.

    - Ensure the Job ID exists in Arcanna.ai before running the action.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends alert data to Arcanna.ai to create a new event record for AI processing
      and analysis.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Analyst Feedback to Arcanna:
  ai_description: >-
    ### General Description

    This action sends analyst feedback for a specific event to Arcanna.ai. It is used
    to provide human-in-the-loop feedback to the Arcanna AI model, allowing it to
    learn from analyst decisions and improve its future predictions. The action targets
    a specific event within a specific job using their respective IDs.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Event Id | string | Yes | The unique identifier of the event in Arcanna for
    which feedback is being provided. |

    | Username | user | Yes | The name of the analyst providing the feedback. |

    | Job Id | string | Yes | The unique identifier of the Arcanna job associated
    with the event. |

    | Analyst Feedback | string | Yes | The specific label or feedback string provided
    by the analyst regarding the event. |


    ### Flow Description

    1. **Initialization**: The action extracts integration configuration (URL, API
    Key, SSL settings) and action parameters (Job ID, Event ID, Username, and Feedback).

    2. **Client Setup**: It initializes the Arcanna API client with the provided credentials.

    3. **API Interaction**: The action performs a PUT request to the Arcanna endpoint
    `/api/v1/events/{job_id}/{event_id}/feedback` containing the analyst's username
    and feedback label.

    4. **Result Processing**: The response from the Arcanna API is captured and added
    to the action's JSON results. If the request is successful, the action completes;
    otherwise, it logs the error and fails.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates an existing event record in Arcanna.ai with analyst feedback using a
      PUT request to the feedback endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Case to Arcanna:
  ai_description: >-
    ### General Description

    The **Send Case to Arcanna** action exports the current Google SecOps case data
    to the Arcanna.ai platform. This allows Arcanna's AI models to analyze the case
    context, including all associated entities, to provide automated decision support
    or further processing.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | String | Yes | The ID of the Arcanna job that should receive and
    process the case data. |

    | **Case identifier field** | String | No | The specific field within the case
    data to be used as the identifier in Arcanna (defaults to "identifier"). |

    | **Use case ID as ID in Arcanna** | Boolean | No | If set to `True`, the action
    will use the value from the 'Case identifier field' as the event ID in Arcanna.
    If `False`, Arcanna will generate a new unique ID. |


    ### Flow Description

    1. **Configuration Retrieval**: The action fetches the Arcanna URL, API Key, and
    SSL settings from the integration configuration.

    2. **Data Gathering**: It retrieves the full case object from Google SecOps and
    extracts the list of target entities from the current context.

    3. **Payload Construction**: The case data and entities are combined into a single
    JSON payload.

    4. **API Interaction**: The action sends a POST request to the Arcanna API's events
    endpoint, optionally specifying a custom event ID if configured.

    5. **Result Handling**: The response from Arcanna is captured and attached to
    the action results as JSON.


    ### Additional Notes

    - This action is typically used as part of a workflow to trigger external AI analysis
    of a security incident.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new event or case record in the Arcanna.ai platform via a POST request
      to the events endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send JSON Document to Arcanna:
  ai_description: >-
    ### General Description

    Sends a custom JSON document to Arcanna.ai for processing. This action allows
    users to ingest arbitrary JSON data into a specific Arcanna job, enabling AI-driven
    analysis and decision-making on external data sources or custom-formatted alert
    data.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job ID | String | Yes | The unique identifier of the Arcanna job that will process
    the document. |

    | Identifier field | String | No | The path (supporting dot notation, e.g., `metadata.id`)
    to a field within the JSON document that should be used as the event's unique
    identifier. |

    | Use document ID as ID in Arcanna | Boolean | No | If set to `True`, the value
    found in the 'Identifier field' will be used as the document ID in Arcanna. If
    `False`, Arcanna generates a new unique ID. |

    | JSON Document | Code | Yes | The raw JSON document to be sent. Must be a valid
    JSON object (root cannot be a list). |


    ### Additional Notes

    - The root of the JSON document must be an object, not a list.

    - If 'Use document ID as ID in Arcanna' is enabled, the 'Identifier field' must
    be provided and exist within the JSON document to successfully extract the ID.


    ### Flow Description

    1. **Configuration Extraction:** Retrieves integration settings (URL, API Key,
    SSL Verification) and action parameters (Job ID, Identifier field, JSON Document).

    2. **JSON Parsing:** Validates and parses the 'JSON Document' input. If the JSON
    is invalid or the root is a list, the action fails.

    3. **ID Extraction:** If 'Use document ID as ID in Arcanna' is true, the action
    extracts the value from the specified 'Identifier field' using dot notation logic.

    4. **API Interaction:** Sends a POST request to the Arcanna.ai `/api/v1/events/`
    endpoint with the job ID, the raw JSON body, and the optional event ID.

    5. **Result Handling:** Captures the API response, adds it to the action's result
    JSON, and completes the execution.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new event or document record in the Arcanna.ai platform for processing
      by an AI job via a POST request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send event to Arcanna:
  ai_description: >-
    ### General Description

    The **Send event to Arcanna** action exports case or alert data from Google SecOps
    to the Arcanna.ai platform. This allows Arcanna's AI models to process security
    events for automated analysis, decision support, or model training. The action
    can be configured to send either the entire case context (including all entities)
    or just the specific alert currently being processed.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | String | Yes | The unique identifier of the Arcanna job that will
    process the event. |

    | **Username** | User | Yes | The username registered for audit purposes in Arcanna.ai.
    |

    | **Event ID mapping field** | String | No | A dot-notation path (e.g., `alert.id`)
    used to extract a specific value from the payload to serve as the reference ID
    in Arcanna. |

    | **Send individual alerts from case** | Boolean | No | If set to `true`, the
    action only sends the data for the current alert. If `false` (default), the entire
    case object, including all associated entities, is sent. |


    ### Additional Notes

    - This action performs an external POST request to create an event record in Arcanna.ai.

    - If `Send individual alerts from case` is enabled, the script will filter the
    case's alerts to find the one matching the current alert identifier.


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the Arcanna API key and URL from the
    integration settings and the Job ID and Username from the action parameters.

    2. **Case Retrieval**: Fetches the full case object from the Google SecOps environment.

    3. **Payload Selection**:
        - **Individual Alert Mode**: If enabled, the script iterates through the case's
    alerts to find the one matching the current alert context.
        - **Full Case Mode**: If disabled, the script prepares the entire case object
    and explicitly attaches the list of target entities to the payload.
    4. **Reference ID Mapping**: If an `Event ID mapping field` is provided, the script
    traverses the selected payload using dot-notation to extract a reference ID.

    5. **External Transmission**: Sends the final payload and metadata to the Arcanna.ai
    API via a POST request.

    6. **Result Reporting**: Captures the API response and adds it to the action's
    JSON results for downstream use in the playbook.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new event or alert record in the Arcanna.ai platform for AI analysis.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Trigger AI Model training:
  ai_description: >-
    ### General Description

    Triggers the training process for a specific AI model associated with a Job ID
    in the Arcanna.ai platform. This action is used to initiate model learning based
    on the data and feedback collected within a specific job context.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | string | Yes | The unique identifier for the Arcanna job where
    the AI model training will be triggered. Note: The code converts this value to
    an integer. |

    | **Username** | user | Yes | The username of the analyst or system triggering
    the training, used by Arcanna.ai for audit logging. |


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the Arcanna URL, API Key, and SSL verification
    settings from the integration configuration.

    2. **Parameter Extraction**: Retrieves the mandatory `Job ID` and `Username` from
    the action parameters.

    3. **Client Initialization**: Initializes the `ArcannaClient` with the provided
    credentials and connection settings.

    4. **API Interaction**: Executes a POST request to the Arcanna API endpoint `/api/v1/jobs/{job_id}/train`,
    passing the username as a query parameter and in the request body.

    5. **Result Processing**: Captures the API response. If successful, the response
    data is attached to the action results as JSON. If the request fails, an error
    is logged and the action status is set to failed.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Triggers a training job for an AI model within the Arcanna.ai platform, which
      initiates a computational process and changes the state of the model.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update alert priority:
  ai_description: >-
    ### General Description

    Updates the priority level of the current alert within Google SecOps. This action
    is typically used to dynamically adjust alert severity based on analysis results
    from external tools like Arcanna.ai. It requires Google SecOps version 5.6 or
    higher to function.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Priority | string | Yes | The new priority level to assign to the alert. Must
    be one of the following: `Informative`, `Low`, `Medium`, `High`, or `Critical`.
    |


    ### Additional Notes

    - This action interacts with the internal Google SecOps SDK API endpoint `/external/v1/sdk/UpdateAlertPriority`.

    - It performs a version check before execution; if the system version is below
    5.6, the action will fail with an informative message.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify context and retrieves
    the current alert identifier.

    2. **Validation**: It checks if a valid alert identifier exists and extracts the
    `Priority` parameter.

    3. **Constraint Check**: Validates that the provided priority is within the allowed
    set of values and ensures the system version is 5.6 or higher.

    4. **Execution**: Constructs a request containing the case ID, alert identifier,
    alert name, and the new priority.

    5. **API Call**: Sends a POST request to the internal SecOps SDK to update the
    alert's priority.

    6. **Completion**: Validates the response and reports the success or failure of
    the update.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Updates the priority field of the current alert within the Google SecOps platform.
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
