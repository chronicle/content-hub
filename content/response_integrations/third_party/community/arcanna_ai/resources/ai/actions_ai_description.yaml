Export full event:
  ai_description: >-
    ### General Description

    Exports the full details of a specific event from the Arcanna.ai platform. This
    action retrieves the complete raw and processed data associated with an event
    linked to a specific AI job. It is used to get detailed visibility into why an
    AI decision was made or to archive event details within a case.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job ID | String | Yes | The unique identifier of the Arcanna job that processed
    the event. The value is converted to an integer during execution. |

    | Event ID | String | Yes | The unique identifier of the specific event to retrieve
    from the Arcanna.ai system. |


    ### Flow Description

    1. **Parameter Extraction**: Retrieves the Job ID and Event ID from the action
    inputs and integration configuration settings (URL and API Key).

    2. **Authentication**: Establishes a session with the Arcanna.ai API using the
    provided API Key.

    3. **Data Fetching**: Executes a GET request to the Arcanna export endpoint using
    the Job ID and Event ID.

    4. **Result Processing**: Receives the full JSON event object and attaches it
    to the action results for use in downstream playbook steps.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get AI Job by name:
  ai_description: >-
    Retrieves detailed configuration and status information for a specific AI Job
    in Arcanna.ai by its name. This action is primarily used to gather metadata about
    an AI job, such as its ID, status, and configuration details, which can then be
    used in subsequent workflow steps.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job name | String | Yes | The specific name of the Arcanna.ai job for which
    details should be fetched. |


    ### Flow Description

    1. **Initialization**: The action initializes the Arcanna.ai client using the
    provided URL, API Key, and SSL verification settings from the integration configuration.

    2. **Parameter Extraction**: It retrieves the 'Job name' from the action parameters.

    3. **API Interaction**: The script calls the Arcanna.ai API endpoint `/api/v1/jobs/get_by_name`
    using a POST request containing the job name.

    4. **Result Processing**: Upon a successful response, the action parses the job
    details and attaches them as a JSON result to the action execution.

    5. **Completion**: The action ends by providing a summary of the retrieved job
    data in the output message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get AI Job decision set:
  ai_description: >-
    ### General Description

    Retrieves the decision set (labels) associated with a specific Job ID from Arcanna.ai.
    This action is primarily used to identify the valid classification categories
    or outcomes defined for an AI job, enabling dynamic decision-making and logic
    branching within playbooks.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job ID | string | Yes | The unique identifier of the Arcanna.ai job for which
    you want to fetch the label set. Note: The script converts this string to an integer
    during execution. |


    ### Additional Notes

    This action requires the Arcanna.ai integration to be configured with a valid
    URL and API Key. It performs a read-only operation and does not affect the state
    of the Arcanna.ai job or Google SecOps entities.


    ### Flow Description

    1. **Setup**: Initializes the Arcanna.ai client using the integration's base URL,
    API key, and SSL verification settings.

    2. **Parameter Retrieval**: Extracts the mandatory `Job ID` provided by the user.

    3. **API Interaction**: Makes a GET request to the Arcanna.ai API endpoint `/api/v1/jobs/{job_id}/labels`.

    4. **Output**: Receives the decision set JSON and attaches it as the action's
    result JSON (`JsonResult`), making it accessible for downstream playbook tasks.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get AI Job decision set by job name:
  ai_description: >-
    ### General Description

    Retrieves the decision set (labels) associated with a specific AI Job by its name
    from Arcanna.ai. This action is used to programmatically identify the classification
    categories available for a particular machine learning job, which can then be
    used for automated triage or feedback logic.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job name | string | True | The name of the AI job for which the decision set
    (labels) should be fetched. |


    ### Additional Notes

    - This action does not interact with entities (IPs, Hosts, etc.) within the case;
    it is a utility action that fetches configuration data from the Arcanna.ai platform
    based on a provided string input.


    ### Flow Description

    1. **Initialization**: The action initializes the Arcanna client using the provided
    API URL, API Key, and SSL Verification settings from the integration configuration.

    2. **Parameter Extraction**: It extracts the `Job name` parameter provided by
    the user.

    3. **API Request**: The action sends a POST request to the Arcanna API endpoint
    `/api/v1/jobs/get_by_name/labels` containing the job name.

    4. **Result Handling**: The JSON response containing the available labels/decisions
    for that job is captured.

    5. **Output**: The retrieved JSON is added to the action results, and the action
    concludes with a success status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Arcanna decision:
  ai_description: >-
    ### General Description

    The **Get Arcanna decision** action retrieves the AI-driven inference results
    for a specific event from the Arcanna.ai platform. It is designed to poll for
    a decision after an event has been submitted for analysis, allowing the SOAR platform
    to receive automated classification or recommendations from the Arcanna AI engine.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job Id | string | Yes | The unique identifier of the Arcanna Job that processed
    the event. |

    | Event Id | string | Yes | The unique identifier for the specific event within
    the Arcanna Job. |

    | Retry count | string | Yes | The number of times the action will attempt to
    poll for a result if the decision is still pending. Default is 20. |

    | Seconds per retry | string | Yes | The duration (in seconds) to wait between
    each polling attempt. Default is 5. |


    ### Flow Description

    1. **Establish Connection:** The action initializes the Arcanna client using the
    integration's URL and API Key.

    2. **Polling Loop:** It enters a loop to check the status of the event based on
    the provided Job and Event IDs.

    3. **Status Check:** It queries the Arcanna API. If the status is `pending_inference`,
    it waits for the specified `Seconds per retry` and tries again until the `Retry
    count` is exhausted.

    4. **Data Retrieval:** If the API returns a status of `OK`, the full decision
    details are captured and added to the action's JSON result.

    5. **Failure Handling:** If the API returns an `ERROR` status or if the polling
    period expires without a result, the action terminates with a failure status.


    ### Additional Notes

    * This action does not use or iterate through entities on the case; it relies
    strictly on the provided Job and Event IDs.

    * The total execution time is bounded by the product of the retry count and seconds
    per retry.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Jobs:
  ai_description: "Retrieves a list of all available jobs from the Arcanna.AI platform.\
    \ This action is primarily used for administrative purposes or as a prerequisite\
    \ step in a playbook to identify existing job IDs or names for subsequent processing.\
    \ \n\n### Parameters\n| Parameter | Type | Mandatory | Description |\n| :--- |\
    \ :--- | :--- | :--- |\n| Url | String | Yes | The base URL of the Arcanna.AI\
    \ instance, configured in the integration settings. |\n| Api Key | String | Yes\
    \ | The API key used for authentication, configured in the integration settings.\
    \ |\n| SSL Verification | Boolean | Yes | Specifies whether to verify the SSL\
    \ certificate of the Arcanna.AI server. |\n\n### Flow Description\n1. **Initialization**:\
    \ The action initializes the Arcanna.AI client using the provided integration\
    \ configuration including URL, API Key, and SSL preference.\n2. **Data Retrieval**:\
    \ Performs a GET request to the `/api/v1/jobs` endpoint of the Arcanna.AI API\
    \ to fetch the list of all configured jobs.\n3. **Result Processing**: Captures\
    \ the JSON response from the API containing job metadata and details.\n4. **Output**:\
    \ Attaches the full list of jobs as a JSON result to the action execution and\
    \ logs a summary message including the response content.\n\n### Additional Notes\n\
    This action does not run on entities and is intended as a utility/management function\
    \ to browse available AI models or jobs within Arcanna.AI."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a connectivity utility designed to verify the connection
    between Google SecOps and the Arcanna.ai instance. It performs a basic health
    check against the Arcanna.ai API to ensure that the provided configuration parameters
    (URL and API Key) are valid and that the service is reachable.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Url | String | Yes | The base URL of the Arcanna.ai server. |

    | Api Key | String | Yes | The API key used to authenticate requests to the Arcanna.ai
    API. |

    | SSL Verification | Boolean | Yes | Determines whether to verify the SSL certificate
    of the Arcanna.ai server. |


    ### Additional Notes

    - This action does not interact with any entities and is primarily used for troubleshooting
    and initial setup verification.


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the URL, API Key, and SSL verification
    settings from the integration's configuration.

    2. **Client Initialization**: Initializes the Arcanna.ai API client with the provided
    credentials.

    3. **Health Check**: Executes a GET request to the `/api/v1/health` endpoint of
    the Arcanna.ai API.

    4. **Result Output**: Captures the API response and adds it to the action's result
    JSON. If the connection fails, it logs the error and marks the execution as failed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Active Alert from Case to Arcanna:
  ai_description: >-
    ### General Description

    This action transmits the currently active alert from a Google SecOps case to
    the Arcanna.ai platform. It is designed to facilitate AI-driven analysis by sending
    the raw alert payload to a specific Arcanna job. This allows security teams to
    leverage Arcanna's decision-making capabilities for triage and risk assessment.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job ID | string | Yes | The specific Job ID in Arcanna.ai that will receive
    and process the alert data. |

    | Alert identifier field | string | No | The JSON path (e.g., 'identifier' or
    'id') within the alert payload that contains the unique ID to be used in Arcanna.
    Defaults to 'identifier'. |

    | Use Alert ID as ID in Arcanna | boolean | No | If set to True, the action will
    use the value found in the 'Alert identifier field' as the unique ID for the event
    in Arcanna. If False, Arcanna will generate its own unique ID. |


    ### Flow Description

    1. **Initialization**: The action extracts integration configuration (URL, API
    Key, SSL settings) and action-specific parameters (Job ID, Identifier Field, and
    ID usage flag).

    2. **Case Retrieval**: It retrieves the full case context and identifies the specific
    'current alert' that the action is being executed on.

    3. **Alert Selection**: The script iterates through all alerts associated with
    the case and identifies the payload that matches the current active alert's identifier.

    4. **ID Extraction**: If configured to use an existing ID, it parses the alert
    JSON to extract the value from the specified identifier field.

    5. **API Transmission**: The raw alert payload is sent via a POST request to the
    Arcanna.ai `/api/v1/events/` endpoint.

    6. **Results**: The response from Arcanna is captured, added to the JSON results
    of the action, and a completion status is returned to the SOAR.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new event or alert record in the Arcanna.ai platform by sending the
      alert payload for AI analysis.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
    - ALERT
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Analyst Feedback to Arcanna:
  ai_description: >-
    ### General Description

    Sends analyst feedback for a specific event within an Arcanna AI job. This action
    allows an analyst to provide manual feedback (labels) to Arcanna, which is essential
    for human-in-the-loop workflows and AI model training.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Event Id | string | True | The unique identifier of the event in Arcanna. |

    | Username | user | True | The name of the analyst providing the feedback. |

    | Job Id | string | True | The unique identifier of the Arcanna job associated
    with the event. |

    | Analyst Feedback | string | True | The actual feedback or label string to be
    submitted to Arcanna. |


    ### Flow Description

    1. **Initialization**: Retrieves the Arcanna URL, API Key, and SSL verification
    settings from the integration configuration.

    2. **Input Extraction**: Captures the Job ID, Event ID, Username, and Analyst
    Feedback from the action parameters.

    3. **API Request**: Uses the Arcanna client to execute a PUT request to the `/api/v1/events/{job_id}/{event_id}/feedback`
    endpoint with the feedback data.

    4. **Finalization**: Logs the API response and sets the action result to the JSON
    response received from Arcanna.


    ### Additional Notes

    This action does not interact with SOAR entities. It relies entirely on the IDs
    provided as direct input parameters.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the feedback label for a specific event in the external Arcanna AI platform
      using a PUT request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Case to Arcanna:
  ai_description: >-
    ### General Description

    The **Send Case to Arcanna** action exports an entire Google SecOps case, including
    its metadata and associated target entities, to the Arcanna.ai platform. This
    integration allows users to leverage Arcanna's AI capabilities for automated decision-making
    and analysis of security incidents. The action packages the case data and sends
    it as a raw event to a specific AI Job within the Arcanna environment.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | String | Yes | The unique identifier for the AI Job in Arcanna.ai
    that will process the incoming case data. |

    | **Case identifier field** | String | No | The JSON path (e.g., 'identifier'
    or 'id') within the case object used to extract a unique ID. Defaults to 'identifier'.
    |

    | **Use case ID as ID in Arcanna** | Boolean | Yes | If set to **True**, the value
    retrieved from the *Case identifier field* is used as the event ID in Arcanna.
    If **False**, Arcanna generates a new unique ID for the event. |


    ### Additional Notes

    - This action acts at the case level and does not iterate through entities individually;
    instead, it bundles all current target entities into the payload sent to Arcanna.

    - SSL verification is configurable through the integration settings to handle
    self-signed certificates or specific proxy requirements.


    ### Flow Description

    1. **Initialization**: Retrieves the Arcanna API key, URL, and SSL verification
    settings from the integration configuration.

    2. **Parameter Extraction**: Parses the Job ID and identifies whether an existing
    case ID should be used for the external system.

    3. **Data Retrieval**: Fetches the complete JSON representation of the current
    SOAR case and all associated target entities.

    4. **Payload Construction**: Combines the case data and target entities into a
    single JSON payload.

    5. **Event Ingestion**: Performs a POST request to the Arcanna API to ingest the
    case data into the specified AI Job.

    6. **Result Handling**: Captures the API response from Arcanna and adds it as
    a JSON result to the action output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Ingests full case data and entity details into the Arcanna.ai platform, creating
      a new event record for processing.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send JSON Document to Arcanna:
  ai_description: >-
    ### General Description

    Sends a custom JSON document to Arcanna.ai for AI-driven analysis. This action
    allows users to ingest arbitrary data structures into a specific Arcanna job,
    providing flexibility for cases where standard alert or case formats are insufficient
    for the required analysis.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job ID | String | Yes | The unique identifier of the job in Arcanna.ai that
    will process the event. |

    | Identifier field | String | No | The field path (supporting dot notation, e.g.,
    'doc.id') used to extract a specific value from the JSON document to serve as
    the Arcanna event ID. |

    | Use document ID as ID in Arcanna | Boolean | No | If set to True, Arcanna will
    use the value extracted via the 'Identifier field' as the event's unique ID. If
    False, Arcanna generates its own unique ID. |

    | JSON Document | Code | Yes | The raw JSON document to be sent to Arcanna. The
    root of the document must be an object (dictionary), not a list. |


    ### Additional Notes

    - If 'Use document ID as ID in Arcanna' is enabled, the 'Identifier field' should
    be provided to ensure a valid ID is extracted from the payload.

    - The action will fail if the provided JSON document is an array/list at the root
    level.


    ### Flow Description

    1. **Setup**: Retrieves integration configuration (URL, API Key, SSL settings)
    and action parameters.

    2. **Validation**: Parses the 'JSON Document' string into a JSON object and verifies
    it is a dictionary.

    3. **ID Processing**: If configured to use an existing ID, the action uses a utility
    to navigate the JSON structure via dot notation and retrieve the identifier.

    4. **Transmission**: Calls the Arcanna API via a POST request to create a new
    event for the specified Job ID.

    5. **Output**: Captures the API response, logs it to the case, and returns the
    resulting JSON data to the SOAR environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new event record in the Arcanna.ai platform for a specific job, initiating
      AI analysis.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send event to Arcanna:
  ai_description: >-
    ### General Description

    The **Send event to Arcanna** action exports Google SecOps case or alert data
    to the Arcanna.ai platform. It allows analysts to send investigation context (including
    raw alert payloads, case metadata, and associated entities) to Arcanna's AI engine
    for classification, analysis, or decision support. The action can be configured
    to send the entire case as a single document or to send the specific active alert
    being processed.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Job ID** | string | Yes | The specific Arcanna.ai Job ID that will receive
    and process the exported event data. |

    | **Username** | user | Yes | The username associated with the action for audit
    and tracking purposes within Arcanna. |

    | **Event ID mapping field** | string | No | A dot-notation path (e.g., `alert.id`
    or `common.event_id`) used to extract a specific unique identifier from the case/alert
    data to serve as the reference ID in Arcanna. |

    | **Send individual alerts from case** | boolean | No | If set to `true`, only
    the data for the current active alert is sent. If `false` (default), the entire
    case object, including metadata and all associated entities, is sent. |


    ### Additional Notes

    - This action uses the `Integration` level configuration for the **Url** and **Api
    Key** to authenticate with the Arcanna API.

    - When sending an entire case, the action automatically includes the list of `target_entities`
    in the JSON payload sent to Arcanna.


    ### Flow Description

    1.  **Configuration Retrieval:** The action fetches the Arcanna API URL and API
    Key from the integration settings and the Job ID, Username, and mapping preferences
    from the action parameters.

    2.  **Context Preparation:** It retrieves the current case details from Google
    SecOps.

    3.  **Data Selection:**
        - If **Send individual alerts from case** is enabled, it identifies the current
    alert context and prepares its raw payload.
        - Otherwise, it prepares the full case object, enriching it with the current
    list of target entities.
    4.  **Event ID Extraction:** If an **Event ID mapping field** is provided, the
    script traverses the JSON data using the provided path to find a unique reference
    ID.

    5.  **Transmission:** The prepared payload is sent to Arcanna via a POST request
    to the `/api/v1/events/` endpoint.

    6.  **Result Handling:** The response from Arcanna (typically containing the processed
    event status or ID) is added to the action's JSON results for downstream use in
    the playbook.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends case or alert telemetry to Arcanna.ai, which creates a new event record
      or updates an existing one within the Arcanna platform for AI analysis.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Trigger AI Model training:
  ai_description: >-
    ### General Description

    Triggers the training process for an AI model associated with a specific Job ID
    within the Arcanna.ai platform. This action is typically used to retrain models
    after new feedback has been provided, ensuring the AI remains updated with the
    latest analyst decisions.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Job ID | String | Yes | The unique identifier of the Arcanna job for which the
    AI model training will be initiated. In the code logic, this is processed as an
    integer. |

    | Username | User | Yes | The username of the person or system account triggering
    the training, used for audit logging within the Arcanna.ai platform. |


    ### Flow Description

    1. **Configuration Retrieval:** The action extracts the Arcanna URL, API Key,
    and SSL Verification settings from the integration's global configuration.

    2. **Parameter Extraction:** It retrieves the `Job ID` and `Username` provided
    by the user in the action parameters.

    3. **API Client Initialization:** An `ArcannaClient` is initialized using the
    retrieved configuration.

    4. **Trigger Training:** The action sends a POST request to the Arcanna.ai API
    endpoint `/api/v1/jobs/{job_id}/train`, passing the `Username` as a query parameter
    and in the request body.

    5. **Result Handling:** The response from Arcanna (typically containing status
    information about the training job) is captured and attached to the action's JSON
    results. The action completes with a success status if the API call succeeds.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates a state-changing operation on the Arcanna.ai platform by triggering
      the training cycle of an AI model.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update alert priority:
  ai_description: >-
    ### General Description

    The **Update alert priority** action allows users to dynamically change the priority
    level of an alert within Google SecOps. This is primarily used in automation workflows
    to adjust alert severity based on external analysis or logic, ensuring that analysts
    focus on the most critical threats.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Priority | String | Yes | The new priority level to assign to the alert. Must
    be one of: `Informative`, `Low`, `Medium`, `High`, or `Critical`. |


    ### Flow Description

    1. **Alert Identification**: The action retrieves the unique identifier for the
    current alert in the case context.

    2. **Parameter Validation**: It verifies that the provided `Priority` value is
    within the supported list of priority levels.

    3. **Compatibility Check**: It checks the system version of the Google SecOps
    environment; changing alert priority via this method requires version 5.6 or higher.

    4. **Execution**: It performs an internal API call to the Google SecOps platform
    (via the SDK) to update the alert's priority metadata using the current case and
    alert identifiers.


    ### Additional Notes

    This action modifies internal alert metadata within Google SecOps and does not
    interact with external Arcanna AI endpoints directly during execution, though
    it is often used to apply decisions derived from Arcanna AI.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: >-
      Updates the priority attribute of the current alert metadata within the Google
      SecOps platform.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
