Gather Remote Agent Datapoints:
  ai_description: >-
    ### General Description

    Gather diagnostic information and logs from a Google SecOps Remote Agent. This
    action acts as a support tool to troubleshoot issues related to the agent's performance,
    environment, or specific integration/connector failures. It aggregates system-level
    data, environment configurations, and log excerpts from the agent machine to provide
    a comprehensive view of its state.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **IntegrationName** | string | Yes | The name of the integration for which logs
    and data points need to be collected. |

    | **ConnectorName** | string | No | The specific name of a connector within the
    integration to narrow down log collection. If provided, the action will attempt
    to find and parse specific connector runner logs. |


    ### Additional Notes

    - This action does not process entities. It is a utility tool that operates based
    on integration and connector names provided as script parameters.

    - The action executes local system commands (like `uptime`, `free`, `lscpu`) on
    the machine where the agent is installed. Sensitive information like tokens, keys,
    and hostnames are filtered out from the collected environment variables.


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the target `IntegrationName` and `ConnectorName`
    from the action parameters.

    2. **Agent Status Collection (CASI)**: Reads the `agent_status.json` file to retrieve
    agent details, versions, and current system time/timezone.

    3. **System Load Collection (CALI)**: Executes system commands to gather CPU architecture
    (`lscpu`), system uptime/load average (`uptime`), and memory usage (`free -h`).

    4. **Environment Check**: Retrieves environment variables and filters out potentially
    sensitive data containing keys or tokens.

    5. **File System Inspection (CFI)**: Lists the contents of the agent's working
    directory to verify file permissions and existence.

    6. **Agent Log Parsing (CSAL)**: Scans the primary `agent.log` for error signatures
    and captures the most recent occurrences.

    7. **Integration Log Parsing**: If an integration and connector name are specified,
    the action locates the corresponding integration folders and parses the `connectors_runner.log`
    for specific execution errors.

    8. **Data Logging**: All gathered information is written to the Siemplify log
    for analysis by administrators or support teams.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
