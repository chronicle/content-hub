GatherRemoteAgentDatapoints:
  ai_description: >-
    ### General Description

    This action is a diagnostic utility designed to gather comprehensive technical
    datapoints from a Chronicle Remote Agent. It is primarily used for troubleshooting
    and support purposes, allowing administrators to inspect the health, configuration,
    and error logs of the agent and its associated integrations/connectors directly
    from the Google SecOps interface.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | IntegrationName | String | Yes | The name of the specific integration for which
    you want to analyze logs and configuration (e.g., 'VirusTotal'). |

    | ConnectorName | String | No | The specific name of the connector within the
    integration to gather targeted logs for. If omitted, the action focuses on general
    integration and agent logs. |


    ### Flow Description

    1.  **Configuration Extraction**: Retrieves the `IntegrationName` and `ConnectorName`
    from the action parameters.

    2.  **Agent Metadata Collection**: Reads the `agent_status.json` file to identify
    installed integrations and versions, and retrieves the system time and OpenSSL
    version.

    3.  **System Performance Profiling**: Executes shell commands (`lscpu`, `uptime`,
    `free`) to collect CPU architecture, system load, and memory utilization data.

    4.  **Environment and File Audit**: Captures non-sensitive environment variables
    and performs a directory listing (`ls -lart`) of the agent's working directory
    to verify file permissions and existence.

    5.  **Log Parsing**: Scans the main agent log (`agent.log`) and specific connector
    runner logs for error patterns (e.g., `- agent - ERROR`). It captures a defined
    limit of the most recent error snippets.

    6.  **Reporting**: Aggregates all collected information and outputs it to the
    action's execution logs (logger).
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
