Add  Permission:
  ai_description: >-
    ### General Description

    Adds permissions to a Google Spreadsheet for one or more users. This action allows
    administrators to programmatically manage access levels (Owner, Writer, Reader)
    for specific email addresses on a target sheet.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | string | Yes | The unique identifier of the Google Spreadsheet,
    found in the URL between '/d/' and '/edit'. |

    | **Role** | ddl | Yes | The access level to grant. Options include: **Owner**
    (full control), **Reader** (view only), and **Writer** (can edit and comment).
    |

    | **Emails** | string | Yes | A semicolon-separated list of email addresses (e.g.,
    `user1@gmail.com;user2@gmail.com`) to which the permissions will be applied. |


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the service account credentials from
    the integration settings.

    2. **Parameter Parsing**: Extracts the target Sheet ID, the desired role, and
    the list of email addresses from the action input.

    3. **Client Initialization**: Authenticates with Google APIs using the provided
    credentials to create a Google Sheets client.

    4. **Permission Mutation**: Executes a request to the Google Drive/Sheets API
    to insert the specified permissions for each provided email address.

    5. **Completion**: Returns a success message if the permissions are granted or
    an error message if the operation fails.


    ### Additional Notes

    This action interacts with both the Google Sheets and Google Drive APIs to manage
    sharing settings. It does not process or filter entities from the Google SecOps
    case; it operates strictly based on the provided parameters.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Modifies the Access Control List (ACL) of a Google Spreadsheet by adding new
      user permissions.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add Row:
  ai_description: >-
    ### General Description

    This action adds a new row of data to a specified Google Sheets spreadsheet. It
    is designed to export or log information from Google SecOps into a centralized
    spreadsheet for reporting, tracking, or external collaboration. The action uses
    service account credentials to authenticate and interact with the Google Sheets
    API.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Sheet Id | String | Yes | The unique identifier of the spreadsheet, found in
    the URL: `https://docs.google.com/spreadsheets/d/{SheetId}/edit`. |

    | Worksheet Name | String | No | The name of the specific tab (worksheet) within
    the spreadsheet. Defaults to the first sheet (Sheet1) if not provided. Note: This
    is case-sensitive. |

    | Row Index | String | No | The 1-based index where the row should be inserted.
    If omitted, the row is typically appended or inserted at the default position
    (usually the top) depending on the API's default behavior. |

    | Values | String | Yes | A comma-separated list of values to be inserted into
    the row (e.g., "Value1,Value2,Value3"). |


    ### Additional Notes

    - The integration requires a valid 'Credentials Json' (Service Account Key) to
    be configured in the integration settings.

    - Ensure the Service Account has 'Editor' permissions on the target spreadsheet.


    ### Flow Description

    1. **Authentication**: The action initializes a connection to Google Sheets using
    the provided Service Account credentials.

    2. **Spreadsheet Access**: It opens the spreadsheet identified by the `Sheet Id`.

    3. **Worksheet Selection**: It selects the worksheet specified by `Worksheet Name`
    or defaults to the first available sheet.

    4. **Data Parsing**: The comma-separated `Values` string is split into a list
    of individual cell values.

    5. **Row Insertion**: The action inserts the values into the worksheet at the
    specified `Row Index` (if provided) or uses the default insertion logic.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action adds a new row of data to an external Google Sheets spreadsheet,
      modifying the content of the file.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add or Update Rows:
  ai_description: >-
    ### General Description

    This action manages data within a Google Spreadsheet by either updating existing
    rows or appending new ones. It functions as a synchronization tool that uses a
    specific column and field value as a lookup key to determine if a row already
    exists in the target sheet. If the value is found, the action updates the specified
    range of that row; otherwise, it appends the data as a new row.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Column Number** | String | Yes | The column index (e.g., "1") where the action
    will search for the value of the specified 'Field Name'. |

    | **Start Column** | String | Yes | The starting column identifier (e.g., "A")
    for the range to be updated or added. |

    | **End Column** | String | Yes | The ending column identifier (e.g., "C") for
    the range to be updated or added. |

    | **Field Name** | String | Yes | The key in the provided JSON objects whose value
    will be used as the search term in the 'Column Number'. |

    | **Json** | Code | Yes | A JSON array of objects. Each object represents a row
    to be processed. The keys should correspond to the data being written. |

    | **Sheet Id** | String | Yes | The unique ID of the spreadsheet, found in the
    URL: `https://docs.google.com/spreadsheets/d/{SheetId}/`. |

    | **Worksheet Name** | String | No | The name of the specific tab (worksheet)
    to use. Defaults to the first sheet if not provided. |


    ### Additional Notes

    - The action iterates through every object in the 'Json' parameter, performing
    a search-and-update/append operation for each.

    - The 'Field Name' must exist as a key in the JSON objects provided.

    - The 'Column Number' is used to validate the search result to ensure the correct
    row is identified.


    ### Flow Description

    1. **Authentication**: Initializes a connection to Google Sheets using service
    account credentials.

    2. **Resource Access**: Opens the spreadsheet by ID and selects the specified
    worksheet (or the default first sheet).

    3. **Data Parsing**: Loads the input JSON string into a list of row objects.

    4. **Search Logic**: For each row object, it extracts the value associated with
    'Field Name' and searches for it within the worksheet.

    5. **Conditional Execution**:
        - **Update**: If the value is found in the specified 'Column Number', the
    action calculates the target range (using 'Start Column' and 'End Column') and
    updates the existing row.
        - **Append**: If the value is not found, the action appends the row data to
    the end of the worksheet.
    6. **Completion**: Returns the total count of rows processed and the specific
    ranges that were modified.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action updates existing cells or appends new rows to a Google Spreadsheet
      based on the provided JSON data and search criteria.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Sheet:
  ai_description: >-
    ### General Description

    Creates a new Google Spreadsheet in the connected Google Drive account. This action
    allows for the automated creation of spreadsheets which can be used for reporting,
    data logging, or collaborative tracking during an incident response process.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Sheet Name | String | Yes | The name of the new Google Spreadsheet to be created.
    |

    | Share with emails | String | No | A semicolon-separated list of email addresses
    (e.g., `user1@example.com;user2@example.com`) that will be granted "writer" permissions
    to the newly created sheet. |


    ### Flow Description

    1. **Authentication**: Initializes the Google Sheets client using the provided
    service account credentials.

    2. **Creation**: Sends a request to Google Sheets API to create a new spreadsheet
    with the name provided in the `Sheet Name` parameter.

    3. **Permission Management**: If the `Share with emails` parameter is populated,
    the action parses the list and iterates through each email address.

    4. **Sharing**: For each email, it updates the spreadsheet's permissions to grant
    "writer" access to that specific user.

    5. **Completion**: Returns the unique ID of the created spreadsheet to the SOAR
    platform.


    ### Additional Notes

    - Ensure the service account used in the integration configuration has the necessary
    Drive and Spreadsheet API scopes enabled.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new Google Spreadsheet and modifies its sharing permissions to include
      specified email addresses.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Delete Rows:
  ai_description: >-
    ### General Description

    The **Delete Rows** action allows users to remove a specific range of rows from
    a Google Sheets worksheet. This is useful for data cleanup, managing logs, or
    removing processed entries from a shared spreadsheet. The action interacts directly
    with the Google Sheets API to perform the deletion based on the provided row indices.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | string | Yes | The unique identifier for the spreadsheet, found
    in the URL: `https://docs.google.com/spreadsheets/d/{Sheet-Id}/edit`. |

    | **Worksheet Name** | string | No | The name of the specific tab within the spreadsheet.
    If not provided, the action defaults to the first worksheet ("Sheet1"). Note:
    This is case-sensitive. |

    | **From Row** | string | Yes | The starting row number for the deletion range
    (inclusive). |

    | **To Row** | string | Yes | The ending row number for the deletion range (inclusive).
    |


    ### Additional Notes

    - The row numbers are 1-indexed (e.g., row 1 is the first row).

    - Ensure the service account used in the integration configuration has "Editor"
    permissions on the target spreadsheet.


    ### Flow Description

    1. **Authentication**: The action authenticates with Google Cloud using the provided
    Service Account JSON credentials.

    2. **Spreadsheet Access**: It opens the target spreadsheet using the `Sheet Id`.

    3. **Worksheet Selection**: It selects the worksheet specified by `Worksheet Name`
    or defaults to the first sheet if the parameter is empty.

    4. **Row Deletion**: It executes the deletion command for the range defined by
    `From Row` and `To Row`.

    5. **Completion**: The action returns a success message if the rows are deleted
    or an error message if the operation fails (e.g., invalid row range or insufficient
    permissions).
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action deletes rows from a Google Sheets worksheet, which permanently modifies
      the content of an external document.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Delete Sheet:
  ai_description: >-
    ### General Description

    Deletes a specific Google Spreadsheet from Google Drive using its unique Sheet
    ID. This action is used to programmatically remove spreadsheets that are no longer
    needed or were created during an automated workflow.


    ### Parameters Description

    | Parameter Name | Description | Type | Mandatory | Notes |

    | :--- | :--- | :--- | :--- | :--- |

    | Sheet Id | The unique identifier of the spreadsheet to be deleted. This can
    be found in the spreadsheet's URL: `https://docs.google.com/spreadsheets/d/{SheetId}/edit`.
    | String | Yes | Ensure the service account has sufficient permissions to delete
    the file. |


    ### Additional Notes

    This action interacts with the Google Drive API via the `gspread` library to perform
    the deletion. It requires valid service account credentials configured in the
    integration settings.


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the Google service account
    credentials from the integration configuration.

    2. **Parameter Retrieval**: The action extracts the `Sheet Id` provided by the
    user.

    3. **Client Initialization**: A Google Sheets client is initialized using the
    provided credentials and necessary OAuth scopes.

    4. **Deletion Execution**: The action calls the deletion method on the Google
    Sheets client for the specified `Sheet Id`.

    5. **Result Reporting**: The action concludes by providing a success message if
    the sheet was deleted or an error message if the operation failed.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Deletes a spreadsheet file from the user's Google Drive/Google Sheets environment.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get All:
  ai_description: >-
    ### General Description

    The **Get All** action retrieves all rows and columns from a specified Google
    Sheets worksheet and returns them as a list of JSON objects. This action is designed
    to ingest tabular data from a spreadsheet into the SOAR platform for use in playbooks,
    such as for lookups, allowlists, or data processing tasks.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | String | Yes | The unique identifier of the spreadsheet, found
    in the URL: `https://docs.google.com/spreadsheets/d/{Sheet-Id}/edit`. |

    | **Worksheet Name** | String | No | The name of the specific tab (worksheet)
    to retrieve data from. If not provided, the action defaults to the first worksheet
    (Sheet1). Note: This is case-sensitive. |


    ### Flow Description

    1. **Authentication**: The action initializes a connection to the Google Sheets
    API using the service account credentials provided in the integration configuration.

    2. **Spreadsheet Access**: It opens the spreadsheet identified by the provided
    `Sheet Id`.

    3. **Worksheet Selection**: It selects the worksheet specified by the `Worksheet
    Name` parameter. If the parameter is empty, it defaults to the first sheet in
    the workbook.

    4. **Data Retrieval**: It fetches all records from the worksheet using the `get_all_records()`
    method. Each row is converted into a dictionary where the keys are the column
    headers.

    5. **Output**: The retrieved data is added to the action's JSON result, making
    it available for subsequent playbook steps.


    ### Additional Notes

    - This action does not interact with or filter SOAR entities; it is a standalone
    data retrieval utility.

    - Ensure the service account associated with the `Credentials Json` has at least
    "Viewer" access to the target spreadsheet.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Range:
  ai_description: >-
    ### General Description

    Retrieves values from a specified range within a Google Sheets spreadsheet. This
    action is designed to fetch data from external spreadsheets to be used as context
    or reference within playbook logic.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | String | Yes | The unique identifier of the spreadsheet, found
    in the URL: `https://docs.google.com/spreadsheets/d/{SheetId}/edit`. |

    | **Worksheet Name** | String | No | The name of the specific tab/worksheet. Defaults
    to the first sheet ("Sheet1") if left empty. |

    | **Range** | String | Yes | The range of cells to retrieve using A1 notation
    (e.g., "A1:C10"). |


    ### Additional Notes

    - This action does not operate on SOAR entities and does not require any entities
    to be present in the scope.

    - The Service Account used in the integration configuration must have access to
    the spreadsheet.


    ### Flow Description

    1. **Authentication**: Connects to the Google Sheets API using the provided Service
    Account credentials.

    2. **Spreadsheet Access**: Opens the spreadsheet identified by the `Sheet Id`
    parameter.

    3. **Worksheet Selection**: Selects the worksheet specified by `Worksheet Name`
    or the first sheet by default.

    4. **Data Retrieval**: Fetches the values for the specified `Range` using a batch
    get request.

    5. **Output**: Returns the retrieved data as a JSON object in the action results.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Row:
  ai_description: >-
    ### General Description

    Retrieves the values of a single row from a Google Sheets spreadsheet. This action
    is designed to fetch data from a specific row based on its index, allowing for
    data retrieval or lookup operations within a SOAR workflow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Sheet Id | String | Yes | The unique identifier of the spreadsheet, which can
    be extracted from the spreadsheet's URL. |

    | Worksheet Name | String | No | The name of the specific worksheet (tab) to target.
    If not provided, the action defaults to the first worksheet in the spreadsheet.
    |

    | Row Number | String | Yes | The one-based index of the row to retrieve (e.g.,
    '1' for the first row, '2' for the second). |


    ### Additional Notes

    - This action requires a Service Account JSON with appropriate permissions (Spreadsheets
    and Drive scopes) to be configured in the integration settings.

    - The output is provided as a JSON array containing the values of the cells in
    the requested row.


    ### Flow Description

    1. **Authentication**: The action authenticates with the Google Sheets API using
    the provided Service Account credentials.

    2. **Spreadsheet Connection**: It opens the spreadsheet using the provided `Sheet
    Id`.

    3. **Worksheet Selection**: It identifies the target worksheet. If a `Worksheet
    Name` is specified, it selects that sheet; otherwise, it defaults to the first
    sheet (`sheet1`).

    4. **Row Retrieval**: The action fetches all cell values for the specified `Row
    Number` using the `gspread` library.

    5. **Result Processing**: The retrieved row values are attached to the action's
    result as a JSON object, and the action completes successfully.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Import CSV:
  ai_description: >-
    ### General Description

    This action imports data from a local CSV file into a specified Google Spreadsheet.
    It is a destructive operation that replaces the content of the first worksheet
    and removes all other worksheets within the target spreadsheet. It is primarily
    used for bulk data updates or resetting a spreadsheet's state with fresh data
    from a CSV source.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Sheet Id | String | Yes | The unique identifier of the Google Spreadsheet, found
    in the URL (e.g., `https://docs.google.com/spreadsheets/d/{SheetId}/edit`). |

    | CSV Path | String | Yes | The absolute file path on the local system where the
    CSV file to be imported is located. |


    ### Additional Notes

    * **Warning:** This action will delete all worksheets in the spreadsheet except
    for the first one.

    * The integration requires a valid 'Credentials Json' (Service Account) configured
    in the integration settings with access to the target spreadsheet.


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves the Google Sheets credentials
    from the configuration and the `Sheet Id` and `CSV Path` from the action parameters.

    2. **Connection Establishment:** It initializes a connection to the Google Sheets
    API using the provided service account credentials.

    3. **File Access:** The action reads the raw content of the CSV file from the
    specified local path.

    4. **Data Import:** It calls the Google Sheets API to import the CSV content into
    the spreadsheet. This process automatically clears existing data, replaces the
    first sheet's content, and deletes any additional worksheets.

    5. **Completion:** The action returns a success message and the spreadsheet ID
    upon successful import, or fails with an error message if the file is missing
    or permissions are insufficient.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action overwrites the content of the first worksheet in a Google Spreadsheet
      and deletes all other worksheets in that spreadsheet.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify the connectivity
    and authentication status between Google SecOps and the Google Sheets API. It
    validates that the configured service account has the appropriate permissions
    to perform operations within the Google Sheets and Google Drive environments.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Credentials Json | String | Yes | The service account JSON key used for authentication.
    This is extracted from the integration's configuration settings. |


    ### Flow Description

    1. **Authentication**: The action retrieves the `Credentials Json` from the integration
    configuration and initializes a Google Sheets client using the `gspread` library.

    2. **Write Verification**: It attempts to create a new spreadsheet with a unique
    identifier (e.g., 'Test-uuid') to confirm that the service account has 'Write'
    permissions.

    3. **Delete Verification**: Immediately after creation, the action attempts to
    delete the newly created spreadsheet to confirm 'Delete' permissions and ensure
    no temporary files remain in the Google Drive.

    4. **Status Reporting**: If both the creation and deletion are successful, the
    action completes with a 'Connected successfully' message. If any step fails, it
    captures the exception and reports the failure.


    ### Additional Notes

    This action does not process any entities and is strictly used for configuration
    validation. It requires the service account to have the `https://www.googleapis.com/auth/spreadsheets`
    and `https://www.googleapis.com/auth/drive` scopes.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action creates and then immediately deletes a temporary spreadsheet in the
      user's Google Drive to verify that the API credentials have sufficient permissions.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Row:
  ai_description: >-
    ### General Description

    The **Search Row** action allows users to locate a specific row within a Google
    Sheets spreadsheet based on a search value. It retrieves the entire content of
    the row where the value is first found, providing the data in a structured JSON
    format for use in subsequent playbook steps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | String | Yes | The unique identifier of the spreadsheet, found
    in the URL: `https://docs.google.com/spreadsheets/d/{Sheet-Id}/edit`. |

    | **Worksheet Name** | String | No | The name of the specific tab (worksheet)
    to search. If not provided, the action defaults to the first sheet (Sheet1). |

    | **Column Number** | String | Yes | The index of the column intended for the
    search. **Note:** The current implementation searches the entire worksheet for
    the value, but uses this parameter for reporting in the output message. |

    | **Search value** | String | Yes | The specific string or value to search for
    within the worksheet. |


    ### Additional Notes

    - The search is performed across the entire worksheet. If the value exists in
    multiple locations, only the first occurrence is processed.

    - The action requires valid Google Service Account credentials with access to
    the specified spreadsheet.


    ### Flow Description

    1. **Authentication:** The action authenticates with the Google Sheets API using
    the provided Service Account JSON credentials.

    2. **Spreadsheet Access:** It opens the spreadsheet identified by the `Sheet Id`
    and selects the specified `Worksheet Name` (or the first sheet by default).

    3. **Search Operation:** It searches the worksheet for the first cell containing
    the `Search value`.

    4. **Data Retrieval:** If the value is found, the action retrieves all values
    from the corresponding row.

    5. **Output:** The row data is added to the action's JSON results, and the row
    index is returned as the primary result value. If the value is not found, the
    action fails with a 'CellNotFound' status.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Rows:
  ai_description: >-
    ### General Description

    The **Search Rows** action allows users to search for specific values within a
    designated column of a Google Sheet. It is designed to identify and retrieve the
    row indices and full row data for all matches found within a specific worksheet.
    This action is useful for lookups, data validation, or retrieving contextual information
    stored in spreadsheets.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | String | Yes | The unique identifier of the spreadsheet, which
    can be extracted from the URL: `https://docs.google.com/spreadsheets/d/{SheetId}/edit`.
    |

    | **Worksheet Name** | String | No | The name of the specific tab (worksheet)
    to search. If left blank, the action defaults to the first tab (Sheet1). Note:
    This is case-sensitive. |

    | **Column Number** | String | Yes | The 1-based index of the column to search
    within (e.g., '1' for column A). |

    | **Search value** | String | Yes | The specific text or value to search for in
    the designated column. |


    ### Flow Description

    1. **Authentication**: The action initializes a connection to Google Sheets using
    service account credentials provided in the integration configuration.

    2. **Spreadsheet Access**: It opens the target spreadsheet using the provided
    `Sheet Id`.

    3. **Worksheet Selection**: It identifies the correct worksheet based on the `Worksheet
    Name` parameter or defaults to the first available sheet.

    4. **Search Execution**: The action searches the entire worksheet for the `Search
    value` using the `findall` method.

    5. **Column Filtering**: It iterates through the search results and filters them
    to include only those that reside in the specified `Column Number`.

    6. **Data Aggregation**: It collects the row numbers of all matches and retrieves
    the full row values for the identified rows.

    7. **Result Reporting**: The action outputs the list of matching row numbers and
    the values of the first found row as JSON results, and provides a summary message
    of the findings.


    ### Additional Notes

    * The action will fail if the `Search value` is not found in the specified column.

    * The `Column Number` must be provided as a numeric string.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update  Cell:
  ai_description: >-
    ### General Description

    Updates a specific cell within a Google Sheets worksheet. This action allows for
    direct modification of spreadsheet data by specifying the spreadsheet ID, the
    worksheet name, the target cell coordinate, and the new value to be written.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Sheet Id | string | Yes | The unique identifier of the spreadsheet, found in
    the URL: `https://docs.google.com/spreadsheets/d/{SheetId}/edit`. |

    | Worksheet Name | string | No | The name of the specific tab (worksheet) to update.
    If not provided, the action defaults to the first sheet ('Sheet1'). Note: This
    is case-sensitive. |

    | Cell | string | Yes | The A1 notation of the cell to update (e.g., 'A12', 'B5').
    |

    | Value | string | Yes | The data/value to be written into the specified cell.
    |


    ### Additional Notes

    - The action requires valid Google Service Account credentials configured in the
    integration settings.

    - If the 'Worksheet Name' is left empty, the action will attempt to update the
    first worksheet in the spreadsheet.


    ### Flow Description

    1. **Authentication**: Initializes a Google Sheets client using the provided Service
    Account credentials.

    2. **Spreadsheet Access**: Opens the target spreadsheet using the provided 'Sheet
    Id'.

    3. **Worksheet Selection**: Identifies the target worksheet based on the 'Worksheet
    Name' parameter or defaults to the first sheet.

    4. **Data Update**: Executes a write operation to the specified 'Cell' with the
    provided 'Value'.

    5. **Completion**: Reports success or failure based on the API response.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the content of a specific cell in a Google Spreadsheet via the Google
      Sheets API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Row:
  ai_description: >-
    ### General Description

    The **Update Row** action allows users to modify data within a specific row of
    a Google Spreadsheet. It is designed to overwrite existing cell values in a sequential
    manner starting from the first column of the designated row. This action is particularly
    useful for logging results, updating status trackers, or maintaining external
    databases directly from a SOAR workflow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Sheet Id** | String | Yes | The unique identifier of the spreadsheet, found
    in the URL: `https://docs.google.com/spreadsheets/d/{Sheet-Id}/edit`. |

    | **Worksheet Name** | String | No | The name of the specific tab (worksheet)
    to update. If left blank, the action defaults to the first worksheet (Sheet1).
    Note: This is case-sensitive. |

    | **Row Number** | String | Yes | The numerical index of the row to be updated
    (e.g., '1', '5'). |

    | **Values** | String | Yes | A comma-separated list of values (e.g., 'val1,val2,val3')
    that will be written into the row starting from Column A. |


    ### Additional Notes

    - The action uses a service account (via Credentials JSON) to authenticate with
    the Google Sheets API.

    - Values are mapped to columns based on their position in the comma-separated
    string (the first value goes to Column A, the second to Column B, etc.).

    - This action does not interact with SecOps entities; it operates purely based
    on the provided parameters.


    ### Flow Description

    1. **Authentication**: The action initializes a connection to Google Sheets using
    the provided service account credentials.

    2. **Spreadsheet Access**: It opens the target spreadsheet using the **Sheet Id**.

    3. **Worksheet Selection**: It selects the worksheet specified by **Worksheet
    Name** or defaults to the first available sheet.

    4. **Data Parsing**: The **Values** string is split into individual items based
    on the comma delimiter.

    5. **Row Update**: The action iterates through the parsed values and updates each
    corresponding cell in the specified **Row Number**, starting from the first column
    (Column 1).
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates cell values within a specific row of a Google Spreadsheet via the Google
      Sheets API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Rows:
  ai_description: >-
    ### General Description

    Updates specific rows in a Google Sheet with provided values. This action allows
    users to modify existing spreadsheet data by specifying row numbers and the values
    to be inserted into those rows starting from the first column.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Row Number | string | Yes | The row numbers you want to update. Should be comma
    separated (e.g., "1,2"). |

    | Values | content | Yes | The values you want to update. Should be comma separated
    (e.g., "value1,value2,value3"). These will be applied to each specified row starting
    from column 1. |

    | Sheet Id | string | Yes | The unique identifier of the spreadsheet, found in
    the URL: `https://docs.google.com/spreadsheets/d/{Sheet Id}/edit`. |

    | Worksheet Name | string | No | The name of the worksheet tab. Defaults to "Sheet1"
    if not provided. Note: This is case-sensitive. |


    ### Additional Notes

    This action does not interact with Google SecOps entities. It operates purely
    based on the provided parameters to modify external spreadsheet data.


    ### Flow Description

    1. **Authentication**: Initializes the Google Sheets client using the provided
    service account credentials.

    2. **Spreadsheet Access**: Opens the target spreadsheet using the `Sheet Id`.

    3. **Worksheet Selection**: Selects the specific worksheet tab by name or defaults
    to the first sheet.

    4. **Data Parsing**: Splits the `Row Number` and `Values` strings into lists.

    5. **Row Update**: Iterates through each specified row number and updates the
    cells sequentially (Column 1, Column 2, etc.) with the provided values.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates cell values within a Google Spreadsheet based on the provided row numbers
      and values.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
