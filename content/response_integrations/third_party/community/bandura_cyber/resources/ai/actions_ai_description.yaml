Add Domain to Allowed Lists:
  ai_description: >-
    ### General Description\nAdds URL entities to a specific Domain Allowed List in
    Bandura Cyber. This action allows security teams to whitelist domains by extracting
    the network location (domain) from a URL entity and adding it to a managed list
    within the Bandura Cyber platform.\n\n### Parameters Description\n| Parameter
    | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| List Name
    | String | Yes | The name of the Allowed List where the domain will be added.
    Note: This is case-sensitive. |\n| Description | String | No | A descriptive note
    to associate with the domain entry in the allowed list. |\n| Expiration Date |
    String | No | The date and time when the domain should be automatically removed
    from the list. Expected format: 2020-01-01T12:00:00.000+00:00. |\n\n### Flow Description\n1.
    **Authentication**: Connects to the Bandura Cyber API using the provided credentials
    to obtain an access token.\n2. **Entity Filtering**: Identifies all URL entities
    within the current action scope.\n3. **List Resolution**: For each URL, it queries
    the Bandura Cyber API to find the unique identifier (UUID) of the allowed list
    specified by the 'List Name' parameter.\n4. **Domain Extraction**: Parses the
    URL to extract the domain (netloc).\n5. **Mutation**: Sends a POST request to
    Bandura Cyber to add the extracted domain to the identified allowed list, including
    the optional description and expiration date.\n6. **Reporting**: Collects the
    results and provides a summary of which domains were successfully added.\n\n###
    Additional Notes\n- The action specifically targets URL entities and will ignore
    other entity types.\n- The domain is extracted using standard URL parsing; ensure
    the URL entities are well-formed.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds a domain entry to a specified allowed list in Bandura Cyber.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add Domain to Denied Lists:
  ai_description: >-
    ### General Description

    Adds URL entities to a specified Domain Denied List in Bandura Cyber. This action
    extracts the domain (netloc) from the URL entity and registers it in the Bandura
    GMC platform to block associated traffic. It supports optional descriptions and
    expiration dates for the denied entries.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | List Name | String | Yes | The case-sensitive name of the Denied List in Bandura
    where the domain will be added. |

    | Description | String | No | A descriptive note to be attached to the denied
    list entry for context. |

    | Expiration Date | String | No | The date and time when the entity should be
    automatically removed from the list. Expected format: `2020-01-01T12:00:00.000+00:00`.
    |


    ### Flow Description

    1. **Initialization**: Retrieves Bandura Cyber API configuration (API Root, Username,
    Password) and action parameters (List Name, Description, Expiration Date).

    2. **Entity Filtering**: Identifies all URL entities within the current action
    scope.

    3. **Domain Extraction**: For each URL entity, the action parses the URL to extract
    the network location (domain). It prioritizes the 'OriginalIdentifier' from additional
    properties if available.

    4. **List Lookup**: Queries the Bandura API to find the unique identifier (UUID)
    for the specified Denied List name.

    5. **Mutation**: Executes a POST request to the Bandura API to add the extracted
    domain to the identified Denied List, applying the provided description and expiration
    date.

    6. **Result Aggregation**: Collects the API responses for each entity and provides
    a summary message of the entities successfully added to the list.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds domain entries to a specified Denied List within the Bandura Cyber platform
      via a POST request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add IP to Allowed Lists:
  ai_description: >-
    ### General Description

    This action adds IP Address entities to a specified IPv4 Allowed List within the
    Bandura Cyber platform. It allows security analysts to whitelist specific IPs
    by providing a list name, an optional description, a CIDR mask, and an expiration
    date for the entry. This is primarily used for managing access controls and ensuring
    that trusted traffic is not blocked by Bandura Cyber's security policies.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | List Name | String | Yes | The name of the Allowed List where the IP will be
    added. Note: This value is case-sensitive. |

    | Description | String | No | A descriptive comment to associate with the IP entry
    in the list. |

    | Maskbit | Integer | No | Defines the CIDR mask for the IP range. Defaults to
    32 (single IP). |

    | Expiration Date | String | No | The date and time when the IP should be automatically
    removed from the list (e.g., 2020-01-01T12:00:00.000+00:00). |


    ### Additional Notes

    - The action specifically targets entities of type `ADDRESS` (IP addresses).

    - The `List Name` must match an existing list in Bandura Cyber exactly due to
    case sensitivity.


    ### Flow Description

    1. **Initialization**: The action extracts integration configuration (API Root,
    credentials) and action parameters (List Name, Maskbit, etc.).

    2. **Authentication**: It authenticates with the Bandura Cyber API to obtain an
    access token.

    3. **Entity Filtering**: It identifies all `ADDRESS` entities within the current
    scope.

    4. **List Lookup**: For each entity, it queries the Bandura Cyber API to find
    the unique identifier (UUID) of the Allowed List specified by the user.

    5. **Mutation**: It sends a POST request to the Bandura Cyber API to add the IP
    address to the identified list, applying the provided mask, description, and expiration
    date.

    6. **Result Aggregation**: The action collects the API responses for each entity
    and provides a summary message of the successful additions.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action adds new IP address entries to an existing Allowed List in Bandura
      Cyber via a POST request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add IP to Denied Lists:
  ai_description: >-
    ### General Description

    Adds IP Address entities to a specified Denied List in Bandura Cyber. This action
    is primarily used for containment and blocking purposes by updating external threat
    intelligence lists that the Bandura Cyber platform enforces.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **List Name** | String | Yes | The name of the Denied List where the IP will
    be added. Note: This value is case-sensitive. |

    | **Description** | String | No | A descriptive note to associate with the entry
    in the Denied List. |

    | **Maskbit** | String | No | Defines the CIDR mask for the IP address (e.g.,
    '32' for a single host). Defaults to '32'. |

    | **Expiration Date** | String | No | The date and time when the IP should be
    automatically removed from the list. Expected format: `YYYY-MM-DDTHH:MM:SS.SSS+00:00`.
    |


    ### Additional Notes

    - The action first performs a lookup to find the unique identifier (UUID) of the
    Denied List based on the provided name before attempting to add the entity.

    - Only entities of type `ADDRESS` are processed.


    ### Flow Description

    1. **Initialization**: Authenticates with the Bandura Cyber GMC API using provided
    credentials to obtain an access token.

    2. **Entity Filtering**: Identifies all `ADDRESS` entities within the current
    action scope.

    3. **List Resolution**: For each entity, the action queries the Bandura Cyber
    API to retrieve the UUID of the Denied List specified in the 'List Name' parameter.

    4. **Mutation**: Sends a POST request to the Bandura Cyber API to add the IP address,
    mask, description, and expiration date to the resolved Denied List.

    5. **Result Collection**: Captures the API response for each entity and aggregates
    them into the action's JSON results.

    6. **Finalization**: Reports the list of successfully added entities and completes
    the action.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds new IP address entries to a Denied List on the Bandura Cyber platform via
      a POST request, which modifies the active security policy of the external system.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Allowed Domain Lists:
  ai_description: "### General Description\nThe **Get Allowed Domain Lists** action\
    \ retrieves information about domain lists configured in the Bandura Cyber platform's\
    \ 'Allowed' category. It allows users to view all available lists or filter for\
    \ a specific list by name. The retrieved data includes list metadata such as UUIDs,\
    \ names, descriptions, and update intervals. This action is primarily used for\
    \ visibility into existing configurations within the Bandura Cyber environment.\n\
    \n### Parameters Description\n| Parameter | Type | Mandatory | Description |\n\
    | :--- | :--- | :--- | :--- |\n| **List Name** | String | No | The specific name\
    \ of the allowed domain list to retrieve. If provided, the action filters the\
    \ results to match this name (case-sensitive). If omitted, all allowed domain\
    \ lists are returned. |\n\n### Flow Description\n1. **Authentication**: The action\
    \ logs into the Bandura Cyber GMC API using the provided credentials to obtain\
    \ an access token.\n2. **Data Retrieval**: It sends a GET request to the Bandura\
    \ Cyber API to fetch the allowed domain lists.\n3. **Filtering**: If a **List\
    \ Name** is provided, the action filters the API response to find the specific\
    \ list matching that name.\n4. **Output Generation**: \n    * The raw JSON response\
    \ is added as a file attachment named 'allowed_domain_lists.txt'.\n    * A data\
    \ table named 'Bandura Allowed Domain Lists' is created to display the list details\
    \ in the UI.\n    * The results are returned as JSON for use in subsequent playbook\
    \ steps.\n5. **Cleanup**: The action logs out of the Bandura Cyber session to\
    \ ensure security.\n\n### Additional Notes\n* This action does not require any\
    \ entities to run and operates as a utility or configuration retrieval task.\n\
    * The **List Name** parameter is case-sensitive."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Allowed IP Lists:
  ai_description: "### General Description\nThis action retrieves information about\
    \ Allowed IPv4 Lists from the Bandura Cyber platform. It allows users to fetch\
    \ all available allowed IP lists or filter for a specific list by its name. The\
    \ retrieved data is presented as a JSON result, a data table, and a text attachment\
    \ for further analysis within the SOAR platform.\n\n### Parameters Description\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | List Name | String | No | The specific name of the Allowed IPv4 List to retrieve.\
    \ Note that this value is case-sensitive. If left empty, the action will return\
    \ all available allowed IP lists. |\n\n### Additional Notes\n- This action does\
    \ not operate on specific entities (like IP addresses or Hostnames) within the\
    \ case; instead, it queries the global configuration of the Bandura Cyber instance.\n\
    - The action performs a session-based authentication (login/logout) for each execution.\n\
    \n### Flow Description\n1. **Authentication**: The action logs into the Bandura\
    \ Cyber API using the provided API Root, Username, and Password.\n2. **Data Retrieval**:\
    \ It requests the list of Allowed IPv4 configurations from the Bandura Cyber backend.\n\
    3. **Filtering**: If a `List Name` was provided in the action parameters, the\
    \ script filters the API response to include only the list matching that specific\
    \ name.\n4. **Output Generation**: \n    - It attaches the raw JSON response as\
    \ a file named `allowed_ip_lists.txt`.\n    - It constructs a CSV data table named\
    \ `Bandura Allowed IP Lists` for display in the case wall.\n    - It populates\
    \ the `JsonResult` with the retrieved list data.\n5. **Cleanup**: The action logs\
    \ out of the Bandura Cyber session to ensure security and resource management."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Denied Domain Lists:
  ai_description: "### General Description\nRetrieves information about denied domain\
    \ lists from the Bandura Cyber platform. This action allows users to fetch all\
    \ available denied domain lists or filter for a specific list by name. The retrieved\
    \ data is presented as a data table and attached as a JSON file to the case for\
    \ further analysis.\n\n### Parameters Description\n| Parameter Name | Type | Mandatory\
    \ | Description |\n| :--- | :--- | :--- | :--- |\n| **List Name** | String | No\
    \ | The specific name of the denied domain list to retrieve. If provided, the\
    \ action filters the results to match this name (case-sensitive). If omitted,\
    \ all denied domain lists are returned. |\n\n### Additional Notes\n- This action\
    \ does not operate on specific entities (like Domains or IPs) within the case;\
    \ instead, it queries the global configuration of the Bandura Cyber instance.\n\
    - The action performs a session-based authentication (login/logout) for each execution.\n\
    \n### Flow Description\n1. **Authentication**: Connects to the Bandura Cyber API\
    \ using the provided credentials (Username and Password) to obtain an access token.\n\
    2. **Data Retrieval**: Sends a GET request to the Bandura Cyber API to fetch the\
    \ collection of denied domain lists.\n3. **Filtering**: If a `List Name` is provided,\
    \ the action filters the API response to find the specific list matching that\
    \ name.\n4. **Output Generation**: \n    - Converts the resulting list data into\
    \ a CSV format for a SOAR Data Table.\n    - Attaches the raw JSON response as\
    \ a file named `denied_domain_lists.txt` to the case.\n    - Sets the action result\
    \ to `True` if lists are found, or `False` otherwise.\n5. **Cleanup**: Logs out\
    \ of the Bandura Cyber session."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action adds a data table to the case and uploads a text attachment containing
      the retrieved domain list data.
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Denied IP Lists:
  ai_description: >-
    ### General Description

    The **Get Denied IP Lists** action retrieves information about Denied IPv4 Lists
    from the Bandura Cyber platform. It allows users to fetch all available denied
    lists or filter for a specific list by name. The retrieved data is presented as
    a data table and attached as a JSON file to the case for further analysis.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **List Name** | String | No | The specific name of the denied IPv4 list to retrieve.
    If provided, the action filters the results to match this name (case-sensitive).
    If omitted, all denied lists are returned. |


    ### Flow Description

    1. **Authentication**: The action connects to the Bandura Cyber API using the
    provided credentials (Username and Password) to obtain an access token.

    2. **Data Retrieval**: It sends a GET request to the Bandura Cyber endpoint to
    fetch the Denied IPv4 Lists.

    3. **Filtering**: If a `List Name` is specified in the parameters, the action
    filters the retrieved list data to find a match.

    4. **Output Generation**:
        *   The raw JSON response is added as an attachment named `denied_ip_lists.txt`
    to the case.
        *   A data table named `Bandura Denied IP Lists` is created to display the
    list details in a readable format.
        *   The results are also provided in the `JsonResult` output.
    5. **Cleanup**: The action performs a logout to terminate the session with the
    Bandura Cyber API.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action adds a data table and a file attachment containing the denied IP
      list information to the Google SecOps case.
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool used to verify the connectivity between
    Google SecOps and the Bandura Cyber platform. Its primary purpose is to ensure
    that the integration configuration (API Root, Username, and Password) is correct
    and that the system can successfully authenticate with the external API.


    ### Parameters Description

    This action does not require any input parameters. It relies entirely on the global
    integration configuration settings:

    * **API Root**: The base URL for the Bandura Cyber API instance.

    * **Username**: The credential used for authentication.

    * **Password**: The credential used for authentication.

    * **Verify SSL**: A boolean flag determining whether to validate the SSL certificate
    of the API endpoint.


    ### Flow Description

    1. **Configuration Retrieval**: The action starts by extracting the mandatory
    integration parameters (API Root, Username, Password) and the optional Verify
    SSL setting.

    2. **Authentication Attempt**: It instantiates the `BanduraCyberManager`, which
    automatically performs a POST request to the `/auth/login` endpoint of the Bandura
    Cyber API to obtain an access token.

    3. **Session Cleanup**: Immediately following the authentication attempt, the
    action calls the `logout` method, which sends a POST request to the `/auth/logout`
    endpoint to invalidate the session.

    4. **Connectivity Check**: The action evaluates whether an access token was successfully
    retrieved during the initialization of the manager.

    5. **Result Reporting**: If a token was found, it returns a success message ('Connection
    Established') and sets the result value to true. Otherwise, it returns 'Connection
    Failed'.


    ### Additional Notes

    This action does not process entities, fetch threat intelligence, or modify any
    security data. It is strictly for testing the communication channel.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
