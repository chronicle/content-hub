Community IP Lookup:
  ai_description: "### General Description\nThe Community IP Lookup action queries\
    \ IP addresses against the GreyNoise Community (Free) API. Its primary purpose\
    \ is to distinguish between IPs that are part of the GreyNoise 'Noise' dataset\
    \ (opportunistic scanners) and the 'RIOT' dataset (known, trustworthy business\
    \ services). This helps analysts quickly filter out internet background noise\
    \ and identify legitimate business traffic.\n\n### Parameters Description\n| Parameter\
    \ Name | Expected Type | Mandatory | Description |\n| :--- | :--- | :--- | :---\
    \ |\n| GN API Key | String | Yes | The API key used to authenticate with the GreyNoise\
    \ Community API. This is a configuration-level parameter extracted from the integration\
    \ settings. |\n\n### Additional Notes\n* This action specifically uses the 'community'\
    \ offering of the GreyNoise SDK.\n* It handles rate limiting and authentication\
    \ failures gracefully, providing specific error messages for each.\n* It identifies\
    \ and skips non-routable or invalid IP addresses.\n\n### Flow Description\n1.\
    \ **Initialization**: The action retrieves the GreyNoise API key from the integration\
    \ configuration and initializes the GreyNoise client with the 'community' offering.\n\
    2. **Entity Filtering**: It identifies all entities of type `ADDRESS` within the\
    \ current context.\n3. **API Query**: For each IP address, it performs a lookup\
    \ against the GreyNoise API.\n4. **Insight Generation**: \n    * If the IP is\
    \ found in the **Noise** dataset, an insight is created displaying the classification\
    \ (malicious, benign, or unknown), the name of the scanner/actor, and the last\
    \ seen timestamp.\n    * If the IP is found in the **RIOT** dataset, an insight\
    \ is created identifying it as a common business service that can likely be trusted.\n\
    5. **Data Enrichment**: Detailed JSON results for each processed IP are added\
    \ to the action's result set for further use in playbooks.\n6. **Final Reporting**:\
    \ The action concludes by reporting the list of successfully processed IPs and\
    \ any invalid IPs that were skipped."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Context IP Lookup:
  ai_description: >-
    ### General Description

    The **Context IP Lookup** action queries IP addresses against the GreyNoise Noise
    dataset to identify if an IP is associated with opportunistic scanning or mass-internet
    noise. This action helps analysts distinguish between targeted attacks and common
    internet-wide background noise, thereby reducing alert fatigue.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | GN API Key | String | Yes | The API Key used to authenticate with GreyNoise
    services. This is extracted from the integration's configuration. |


    ### Flow Description

    1. **Configuration Extraction:** The action retrieves the GreyNoise API Key from
    the integration settings.

    2. **Entity Selection:** The action filters the available entities to identify
    those of type `ADDRESS`.

    3. **External Query:** For each identified IP address, the action performs a lookup
    against the GreyNoise Context API.

    4. **Result Processing:**
        *   **If Found (Seen):** The action marks the IP as 'noise', retrieves classification
    (e.g., malicious, benign, unknown), organization details, and last seen timestamp.
    It then generates a detailed Entity Insight containing this information and a
    link to the GreyNoise Visualizer.
        *   **If Not Found:** The action records that the IP has not been observed
    mass-scanning the internet within the last 90 days.
    5. **Data Enrichment:** The raw JSON response for each IP is added to the action's
    result set.

    6. **Final Report:** The action concludes by summarizing the processed IPs and
    noting any invalid routable IPs that were skipped.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Execute GNQL Query:
  ai_description: >-
    ### General Description

    Executes a GreyNoise Query Language (GNQL) search to retrieve mass-scanning and
    threat intelligence data from GreyNoise. This action is used to find IPs matching
    specific behavioral or classification criteria defined in the query string. Note
    that this action consumes one Search credit per IP returned by the query.


    ### Parameters Description

    | Parameter | Type | Mandatory | Default | Description |

    | :--- | :--- | :--- | :--- | :--- |

    | query | string | Yes | classification:malicious last_seen:1d | GreyNoise Query
    in GNQL format to execute. |

    | limit | string | No | 10 | Maximum number of results to return. |


    ### Additional Notes

    This action does not run on specific entities within the case; instead, it performs
    a broad search based on the provided GNQL query. The results are returned as a
    JSON object containing the list of matching IP addresses and their associated
    metadata.


    ### Flow Description

    1.  **Authentication**: Retrieves the GreyNoise API key from the integration configuration.

    2.  **Parameter Extraction**: Collects the GNQL query string and the result limit
    from the action input.

    3.  **API Execution**: Calls the GreyNoise SDK `query` method with the provided
    parameters.

    4.  **Error Handling**: Validates the response, handling specific cases for authentication
    failures (401), rate limits, and general request failures.

    5.  **Output Generation**: Adds the raw query results to the action's JSON results
    and provides a summary message including the total count of matches found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Full IP Lookup:
  ai_description: >-
    Enriches IP Address entities by querying the GreyNoise intelligence platform to
    identify opportunistic scanners (Noise) and common business services (RIOT). This
    action provides context on whether an IP is malicious, benign, or part of a known
    service, helping analysts prioritize alerts by filtering out background internet
    noise.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | GN API Key | String | Yes | The API key for GreyNoise, extracted from the integration's
    configuration settings. Used for authentication with the GreyNoise API. |


    ### Flow Description

    1. **Entity Filtering:** Identifies all entities of type `ADDRESS` within the
    current alert scope.

    2. **Quick Lookup:** Performs a GreyNoise 'Quick' lookup for each identified IP
    to check if it is indexed in the 'Noise' or 'RIOT' datasets.

    3. **Conditional Enrichment:**
        - If found in the **Noise** dataset: Retrieves detailed IP context including
    classification (malicious/benign), organization, and country.
        - If found in the **RIOT** dataset: Retrieves information about the common
    business service associated with the IP.
        - If found in both: Merges both datasets into a single result.
    4. **Insight Generation:** Creates formatted HTML insights on the entity's side
    panel, providing visual cues for classification (e.g., red for malicious, green
    for benign).

    5. **Data Population:** Appends raw JSON results to the action output for use
    in downstream playbook logic.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
IP Similarity Lookup:
  ai_description: >-
    ### General Description

    The **IP Similarity Lookup** action checks a provided IP address against the GreyNoise
    database to identify other IPs that exhibit similar scanning behaviors. This action
    is valuable for identifying clusters of related malicious activity or broad internet-scale
    scanning campaigns. It requires a specific GreyNoise license to function and consumes
    one Search credit per valid IP processed.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **limit** | string | Yes | The maximum number of similar IP results to retrieve
    from GreyNoise. Default is 50. |

    | **minimum_score** | ddl | Yes | The minimum similarity score (0-100) required
    for a result to be returned. Predefined values range from 75 to 100. Default is
    90. |


    ### Additional Notes

    *   **License Requirement:** This action requires a GreyNoise license that includes
    access to the Similarity API.

    *   **Resource Consumption:** Each valid IP address submitted consumes 1 GreyNoise
    Search credit.

    *   **Insight Display:** While the action can retrieve many results based on the
    `limit`, the generated Entity Insight table only displays the first 10 matches
    for readability.


    ### Flow Description

    1.  **Authentication:** The action initializes a GreyNoise session using the API
    key provided in the integration configuration.

    2.  **Entity Filtering:** It identifies all `ADDRESS` entities within the current
    context.

    3.  **Lookup Execution:** For each IP, it queries the GreyNoise Similarity API
    using the specified `minimum_score` and `limit` parameters.

    4.  **Data Processing:**
        *   If similar IPs are found, the raw JSON data is attached to the action
    results.
        *   An **Entity Insight** is created, featuring an HTML table that summarizes
    the total number of similar IPs and lists details (IP, score, and shared features)
    for the top 10 matches.
    5.  **Error Handling:** The action gracefully handles invalid (non-routable) IPs,
    rate limiting (429 errors), and authentication failures, reporting the status
    of each IP processed in the final output message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
IP Timeline Lookup:
  ai_description: >-
    ### General Description

    Retrieves daily scanning events for IP Address entities using the GreyNoise service.
    This action allows analysts to view historical activity timelines for specific
    IPs, including classifications and tags associated with their scanning behavior
    over a defined period. Note: This action requires an additional GreyNoise license
    and consumes one search credit per valid IP submitted.


    ### Parameters

    | Parameter | Type | Mandatory | Default | Description |

    | :--- | :--- | :--- | :--- | :--- |

    | days | string | Yes | 30 | Number of days from today to retrieve historical
    timeline information. |

    | limit | string | Yes | 50 | Maximum number of timeline events to return in the
    results. |


    ### Flow Description

    1. **Initialization**: The action initializes the GreyNoise session using the
    provided API key and sets up the environment.

    2. **Entity Selection**: Identifies all entities of type `ADDRESS` (IP Addresses)
    within the current scope.

    3. **Parameter Parsing**: Extracts and validates the `days` and `limit` parameters,
    ensuring they are valid integers.

    4. **Data Retrieval**: For each IP address, it queries the GreyNoise API for its
    daily timeline activity.

    5. **Insight Generation**: If activity is found, it generates a formatted HTML
    insight for the entity, displaying up to the first 10 scanning matches including
    timestamps, classifications, and tags.

    6. **Result Compilation**: Appends the raw JSON data for each IP to the action
    results and generates a summary message indicating success or failure for each
    processed entity.

    7. **Error Handling**: Handles common issues such as invalid IP addresses, authentication
    failures, rate limits, and general API request errors.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Adds entity insights to the case and populates result JSON with retrieved GreyNoise
      timeline data.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    This action performs a connectivity and authentication check for the GreyNoise
    integration. It validates that the provided API key is correct, active, and identifies
    the subscription level associated with the key (Enterprise or Community).


    ### Parameters

    There are no specific action parameters for this action. It relies on the global
    integration configuration parameter:

    * **GN API Key**: The API key used to authenticate with GreyNoise services.


    ### Flow Description

    1. **Initialization**: The action initializes the GreyNoise SDK using the configured
    API key and a predefined User-Agent.

    2. **Connection Test**: It executes a connection test against the GreyNoise API
    endpoints.

    3. **Subscription Validation**: The logic parses the API response to determine
    the subscription 'offering' type.

    4. **Expiration Check**: For non-community keys, it compares the 'expiration'
    date from the API response against the current system time to ensure the key is
    still valid.

    5. **Completion**: If the connection is successful and the key is valid, the action
    returns a success message. If authentication fails or the key is expired, it reports
    a failure with a descriptive error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Quick IP Lookup:
  ai_description: >-
    ### General Description

    Performs a rapid IP lookup using the GreyNoise service to determine if an IP address
    is associated with mass internet scanning traffic (noise). This action helps analysts
    quickly identify known-benign scanning traffic versus potentially targeted activity.
    It retrieves a summary status for each IP entity provided.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | N/A | N/A | N/A | This action does not have any input parameters. It relies
    on the global 'GN API Key' configured in the integration settings. |


    ### Additional Notes

    - This action consumes 1 GreyNoise Search credit per valid IP submitted.

    - Only publicly routable IP addresses are processed; internal or invalid IPs are
    skipped and reported in the output message.

    - Authentication errors or rate limiting by GreyNoise will result in an action
    failure.


    ### Flow Description

    1. **Initialization**: The action retrieves the GreyNoise API key from the integration
    configuration.

    2. **Entity Filtering**: It identifies all entities in the current scope that
    are of type ADDRESS (IP Address).

    3. **External Lookup**: For each identified IP, the action calls the GreyNoise
    'Quick' API endpoint.

    4. **Data Processing**: If the API returns data, the action marks the IP result
    as noise and prepares the data for output. If the IP is invalid or not routable,
    it is added to a skip list.

    5. **Error Handling**: The script catches specific exceptions such as authentication
    failures (RequestFailure) or exceeding usage limits (RateLimitError).

    6. **Final Output**: The action aggregates the raw JSON results for all processed
    IPs and displays a summary message indicating which IPs were processed and which
    were skipped.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
RIOT IP Lookup:
  ai_description: >-
    ### General Description

    Queries IP addresses against the GreyNoise RIOT (Rule It Out) dataset to identify
    traffic coming from known benign services and common business applications. This
    action is primarily used to filter out noise from trusted sources such as CDNs,
    cloud providers (e.g., Google, Microsoft), and public DNS services.


    ### Parameters Description

    | Parameter Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | None | This action does not require any additional input parameters. | N/A |
    N/A |


    ### Additional Notes

    *   This action consumes 1 GreyNoise Search per valid IP submitted.

    *   The **GN API Key** must be properly configured in the integration settings
    for this action to function.

    *   Invalid or non-routable IPs are logged and skipped without failing the entire
    action.


    ### Flow Description

    1.  **Configuration Retrieval:** The action retrieves the GreyNoise API key from
    the integration's configuration parameters.

    2.  **Entity Filtering:** It identifies all 'ADDRESS' (IP Address) entities present
    in the current context.

    3.  **GreyNoise RIOT API Call:** For each IP, it performs a lookup against the
    GreyNoise RIOT database.

    4.  **Data Processing:**
        *   If the IP is found in the RIOT dataset, the action extracts the service
    name, category, and an explanation for why it is considered benign.
        *   If the IP is not found, it notes that the address is not associated with
    a known Common Business Service.
    5.  **Internal Enrichment:**
        *   Creates an **Entity Insight** for found IPs, displaying a table with service
    details and a link to the GreyNoise visualizer.
        *   Adds the raw JSON data from the API response to the action's execution
    results.
    6.  **Error Handling:** Manages specific exceptions for rate limiting, authentication
    failures, and network errors, providing descriptive status messages.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
