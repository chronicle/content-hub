Add User:
  ai_description: >-
    ### General Description

    This action registers a new user in the VanillaForums platform. It handles user
    creation with specific roles, profile pictures, and email confirmation statuses.
    A key feature of this action is its ability to handle username collisions by attempting
    to create unique variations using user-provided special characters.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **First Name** | The first name of the new user. | String | Yes |

    | **Last Name** | The last name of the new user. | String | Yes |

    | **Email** | The email address for the new account. | String | Yes |

    | **Role ID** | The numerical ID of the role to be assigned to the user. | String
    | Yes |

    | **Password** | The password for the account. Must be at least 6 characters long
    and contain both letters and digits. | Password | Yes |

    | **Override Name Duplicity** | If set to 'True', the system will allow the creation
    of the user even if a user with the same name exists, as long as the email is
    different. | Boolean | No |

    | **Additional Identifiers** | A comma-separated list of characters (e.g., `_,~,-`)
    used to replace the space in a username if the original name is already taken.
    | String | No |

    | **Email Confirmed** | Indicates if the user's email address is already verified.
    | Boolean | No |

    | **Photo URL** | The URL for the user's profile image. | String | No |


    ### Additional Notes

    - The action performs a complexity check on the password (minimum 6 characters,
    must contain at least one letter and one digit) before attempting to communicate
    with the VanillaForums API.

    - If username variations using all provided 'Additional Identifiers' are already
    taken, the action will fail.


    ### Flow Description

    1. **Validation**: The script first validates that the provided password meets
    the complexity requirements.

    2. **Username Check**: It searches the VanillaForums system for an existing user
    with the same first and last name.

    3. **Collision Handling**: If a duplicate is found and `Override Name Duplicity`
    is active, the script iterates through the `Additional Identifiers` to find a
    unique name variation (e.g., changing 'John Doe' to 'John_Doe').

    4. **User Creation**: The script sends a POST request to the `/v2/users` endpoint
    with the finalized username, email, password, and role information.

    5. **Result Handling**: Upon success, the user details are returned as a JSON
    result; otherwise, an error message is generated.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new user record in the VanillaForums database via the /v2/users API
      endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Generate Password:
  ai_description: "### General Description\nGenerates a random password that meets\
    \ Vanilla Forums' security requirements. This action is a utility designed to\
    \ produce a compliant password string locally without making external API calls\
    \ to the Vanilla Forums service.\n\n### Parameters Description\n\n| Parameter\
    \ | Description | Type | Mandatory | \n| :--- | :--- | :--- | :--- |\n| Length\
    \ | Specifies the total number of characters for the generated password. The value\
    \ must be an integer (provided as a string) of at least 6. | String | No (Default:\
    \ 6) |\n\n### Additional Notes\n- Although this action is part of the Vanilla\
    \ Forums integration, the password generation logic is performed entirely within\
    \ the local Python environment using the `random` and `string` libraries. It does\
    \ not communicate with the Vanilla Forums server.\n- If a length of less than\
    \ 6 is provided, the action will fail with a validation error.\n\n### Flow Description\n\
    1. **Parameter Extraction:** The action retrieves the `Length` parameter from\
    \ the user input, defaulting to 6 if not specified.\n2. **Validation:** It checks\
    \ if the requested length is at least 6 characters. If the validation fails, an\
    \ exception is raised, and the action status is set to failed.\n3. **Password\
    \ Generation:** The action calls the `generate_pass` method in the `VanillaManager`.\
    \ The logic ensures the password contains at least one uppercase letter, one lowercase\
    \ letter, and is padded to the requested length using digits.\n4. **Result Reporting:**\
    \ The generated password string is returned as the script result value, and a\
    \ success message is logged to the case."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get User Details:
  ai_description: >-
    ### General Description

    This action retrieves comprehensive details for a specific user from Vanilla Forums
    using their unique User ID. It is designed to provide administrative or moderator-level
    context about a forum participant, which can be useful for investigations involving
    user activity or account management.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | User ID | The unique identifier of the user in Vanilla Forums whose details
    you want to retrieve. | String | Yes |


    ### Flow Description

    1. **Initialization**: The action initializes the VanillaManager with the provided
    API Token and Base URL from the integration configuration.

    2. **Parameter Extraction**: It retrieves the `User ID` from the action input
    parameters.

    3. **API Interaction**: The action calls the `get_user_details` method in the
    manager, which executes a GET request to the `/v2/users/{user_id}` endpoint.

    4. **Processing**: Upon a successful response, the action parses the user's data
    (such as name, email, roles, etc.).

    5. **Output**: The retrieved data is attached as a JSON result to the action,
    and a success message is displayed. If the user is not found or an error occurs,
    the action fails with an error message.


    ### Additional Notes

    - This action does not interact with the entities currently present in the Google
    SecOps case; it relies solely on the provided `User ID` parameter.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get a Leaderboard Analytics:
  ai_description: >-
    ### General Description

    The 'Get a Leaderboard Analytics' action retrieves analytics data for specified
    leaderboards from Vanilla Forums within a defined timeframe. It is designed to
    provide visibility into community engagement metrics such as top posters or discussion
    starters over a specific period.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Leaderboards** | String | Yes | A comma-separated list of leaderboard identifiers
    to query (e.g., 'top-posters, top-discussion-starters'). |

    | **From** | String | Yes | The start of the time frame for the analytics query,
    formatted as YYYY-MM-DD. |

    | **To** | String | Yes | The end of the time frame for the analytics query, formatted
    as YYYY-MM-DD. |

    | **Amount Limit** | String | Yes | The maximum number of rows (positions) to
    return for each individual leaderboard. |


    ### Flow Description

    1. **Initialization**: The action retrieves integration configuration (API Token
    and Base URL) and user-provided parameters.

    2. **Parsing**: The comma-separated string of leaderboards is split into an iterable
    list.

    3. **Data Retrieval**: The action iterates through each leaderboard and calls
    the Vanilla Forums API (`/v2/analytics/leaderboard`) using the provided time range
    and row limit.

    4. **Aggregation**: Analytics data for each board is collected into a JSON list.

    5. **Completion**: The aggregated data is added as a result JSON, and the action
    concludes with a success message summarizing the fetched boards.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Checks connectivity with VanillaForums by performing a test API call to verify
    the validity of the integration configuration. This action confirms that the Google
    SecOps instance can communicate with the VanillaForums API using the provided
    credentials.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    This is a standard connectivity test action. It relies on the 'API Token' and
    'URL' provided in the integration configuration rather than action-specific input
    parameters.


    ### Flow Description

    1. **Configuration Retrieval**: Extracts the API Token and Base URL from the integration
    settings.

    2. **Manager Initialization**: Creates an instance of the VanillaManager using
    the connection details.

    3. **Connectivity Verification**: Executes the `test_connectivity` method, which
    makes a GET request to the `/v2/categories` endpoint with a limit of one result
    to minimize data transfer.

    4. **Execution Reporting**: If the request is successful, it returns a success
    message and sets the result value to true. If an exception occurs, it captures
    the error message and reports a failed execution state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search User By Email and Name:
  ai_description: >-
    ### General Description

    This action searches for a user within the Vanilla Forums platform using both
    an email address and a full name. It provides a verification mechanism to check
    if specific user identifiers exist in the system, returning boolean indicators
    for each and detailed user information if a match is found by email.


    ### Parameters

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | User Email | string | True | The specific email address of the user to search
    for. The value is normalized to lowercase and trimmed of whitespace. |

    | User Name | string | True | The full name or username of the user to search
    for. The value is trimmed of whitespace. |


    ### Flow Description

    1. **Initialization**: The action initializes the Vanilla Forums manager using
    the provided API Token and Base URL from the integration configuration.

    2. **Parameter Extraction**: It extracts the `User Name` and `User Email` from
    the action parameters, applying formatting (trimming and lowercasing for the email).

    3. **Email Search**: It executes a paginated search against the Vanilla Forums
    `/v2/users` endpoint to find a user matching the provided email.

    4. **Name Search**: It executes a search against the `/v2/users/by-names` endpoint
    to find a user matching the provided username.

    5. **Result Aggregation**: The action compiles the search results, setting flags
    to indicate whether the email or username exists. If the email is found, it includes
    the full user details in the results.

    6. **Completion**: It returns a success status with a summary message indicating
    which identifiers were found or if no match was found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Badge:
  ai_description: >-
    ### General Description

    The **Update Badge** action awards a specific badge to a user within the Vanilla
    Forums platform. It is designed to facilitate community management by programmatically
    assigning rewards or recognitions to users based on their unique identifiers.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **User ID** | String | Yes | The unique identifier of the user who will receive
    the badge. |

    | **Badge ID** | String | Yes | The unique identifier of the badge to be awarded
    to the user. |


    ### Flow Description

    1. **Setup**: The action retrieves the integration's API token and Base URL from
    the configuration.

    2. **Parameter Extraction**: It extracts the `User ID` and `Badge ID` provided
    by the user in the action parameters.

    3. **API Interaction**: The action calls the `give_user_badge` method in the `VanillaManager`,
    which sends a POST request to the Vanilla Forums API (`/v2/badges/{badge_id}/users`)
    to perform the assignment.

    4. **Completion**: Upon a successful response, the action returns the badge details
    in JSON format and updates the execution status to completed. If the request fails,
    it captures the error and reports it to the case wall.


    ### Additional Notes

    This action does not operate on SOAR entities; it relies entirely on the IDs provided
    manually or through playbooks as parameters.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Assigns a badge to a specific user account in Vanilla Forums by making a POST
      request to the platform's API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Rank:
  ai_description: >-
    Edits the rank of a user in Vanilla Forums.


    ### General Description

    This action updates the rank of a specific user within the Vanilla Forums platform.
    It requires the User ID of the target user and the specific Rank ID to be assigned.
    This is useful for administrative tasks or automated community management within
    the SOAR workflow.


    ### Parameters description

    | Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Rank ID | The unique identifier of the rank you wish to assign to the user.
    | string | Yes |

    | User ID | The unique identifier of the user whose rank is being updated. | string
    | Yes |


    ### Flow description

    1. **Initialization:** The action initializes the Vanilla Forums manager using
    the provided API Token and URL from the integration configuration.

    2. **Parameter Extraction:** The `Rank ID` and `User ID` are extracted from the
    action input parameters.

    3. **API Execution:** The action calls the Vanilla Forums API (`PUT /v2/users/{user_id}/rank`)
    with the specified rank identifier.

    4. **Outcome Reporting:** The action returns the resulting JSON from the API and
    provides a success or failure message based on the response status.


    ### Additional notes

    This action does not run on entities; it operates based on the specific IDs provided
    in the parameters. It performs an external state change by modifying user metadata
    in the Vanilla Forums system.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the rank assigned to a specific user in Vanilla Forums by performing
      a PUT request to the service's API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update User Role:
  ai_description: >-
    ### General Description

    Updates the role assigned to a user in Vanilla Forums. This action allows for
    the programmatic modification of user permissions by specifying the target User
    ID and the new Role ID to be applied.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **UserID** | string | Yes | The unique identifier of the user whose role is
    to be changed. |

    | **RoleID** | string | Yes | The unique identifier of the role to be assigned
    to the user. |


    ### Flow Description

    1. **Initialization**: The action initializes the `VanillaManager` using the API
    Token and Base URL from the integration's configuration.

    2. **Parameter Retrieval**: It extracts the `UserID` and `RoleID` parameters provided
    by the user.

    3. **Execution**: The action calls the `give_user_role` method from the manager.
    This method performs a `PATCH` request to the Vanilla Forums API endpoint `/v2/users/{userID}`
    with a payload containing the new `roleID`.

    4. **Validation**: The manager validates the response to ensure the role update
    was successful and that the role ID provided was valid.

    5. **Completion**: The action reports the success or failure of the operation
    back to the SOAR case wall and includes the raw JSON response from the API.


    ### Additional Notes

    - This action does not utilize entities from the alert scope; it operates exclusively
    on the provided UserID and RoleID parameters.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action performs a PATCH request to the Vanilla Forums API, which modifies
      the user's role profile on the external platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
