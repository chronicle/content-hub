Enrich Entities:
  ai_description: >-
    ### General Description

    Enriches Hostname and URL entities using the WHOIS XML API. This action retrieves
    detailed registration information, including registrant details, and maps them
    to the entity's additional properties within Google SecOps to provide context
    for investigations.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | API Key | String | Yes | The API key required to authenticate with the WHOIS
    XML API service. This is a configuration-level parameter extracted from the integration
    settings. |


    ### Flow Description

    1. **Initialization**: Retrieves the API Key from the integration configuration.

    2. **Entity Filtering**: Iterates through target entities, selecting only `URL`
    entities or `HOSTNAME` entities that are not marked as internal.

    3. **Data Retrieval**: For each selected entity, it performs a GET request to
    the WHOIS XML API to fetch WHOIS records in JSON format.

    4. **Data Extraction**: Extracts `registrant` details from the `WhoisRecord` in
    the API response.

    5. **Enrichment**: Updates the entity's `additional_properties` with the extracted
    registrant information.

    6. **Finalization**: Updates the entities in the system, attaches the raw JSON
    results to the action, and returns a summary message of successfully processed
    entities.


    ### Additional Notes

    - This action only processes external hostnames; internal hostnames are skipped
    to avoid unnecessary API calls and focus on external threat intelligence.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity additional properties with registrant details retrieved from
      the WHOIS XML API.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - HOSTNAME
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: true
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Domain Details:
  ai_description: >-
    ### General Description

    Retrieves comprehensive WHOIS information for a specified domain using the WHOIS
    XML API. This action provides details such as registration dates, registrar information,
    and registrant contact details in a structured JSON format for use in playbooks.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Domain Name | String | Yes | The specific domain name (e.g., google.com) to
    retrieve WHOIS data for. |

    | Check availability | Boolean | No | If set to `true`, the API will include domain
    availability status in the response. Defaults to `false`. |


    ### Additional Notes

    This action operates independently of the entities present in the Google SecOps
    case. It uses the provided "Domain Name" parameter as the primary input rather
    than iterating over case entities.


    ### Flow Description

    1. **Initialization**: Extracts the API Key from the integration configuration
    and the domain and availability parameters from the action input.

    2. **Request Construction**: Builds the WHOIS XML API request URL, appending the
    domain name and the availability check flag (converted to a query string integer).

    3. **Data Retrieval**: Executes a GET request to the external WHOIS XML API service.

    4. **Output**: Parses the JSON response and attaches it to the action results
    (both as a result JSON and a named JSON object) for use in subsequent playbook
    steps.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify the connectivity
    between Google SecOps and the **WHOIS XML API** service. Its primary purpose is
    to validate that the integration's configuration, specifically the API Key, is
    correct and that the external service is reachable.


    ### Parameters Description

    This action does not require any input parameters. It utilizes the global integration
    configuration for authentication.


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the `API Key` from the WHOIS
    XML API integration settings.

    2. **Service Request**: It performs a GET request to the WHOIS XML API endpoint
    using a hardcoded domain (`google.com`) to test the connection.

    3. **Response Validation**: The script checks the API response for specific error
    strings related to authentication failures.

    4. **Completion**: If the request is successful and authentication passes, the
    action concludes with a 'Successful Connection' status.


    ### Additional Notes

    This is a system-level utility action and does not interact with or process any
    entities within a case.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
