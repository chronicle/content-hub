Create Token:
  ai_description: >-
    ### General Description

    Creates a new webhook token and generates a unique, accessible URL. This action
    allows users to specify the default content and content type that the URL will
    present when visited, making it useful for creating mock endpoints or receiving
    callbacks from external services.


    ### Parameters Description

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Default Content | String | Yes | The actual content or message body that will
    be served by the webhook URL. |

    | Default Content Type | String | Yes | The MIME type of the content (e.g., `text/html`
    or `application/json`). |

    | Timeout | String | No | An optional value (max 10 seconds) defining how long
    the server should wait before returning the response to a requester. |


    ### Flow Description

    1. **Initialization**: The action retrieves the base URL from the Webhook integration
    configuration.

    2. **Parameter Processing**: It extracts the 'Default Content', 'Default Content
    Type', and 'Timeout' values provided by the user.

    3. **API Interaction**: The action calls the `WebhookManager.create_token` method,
    which sends a POST request to the external service's `/token` endpoint with the
    specified payload.

    4. **Response Handling**: It captures the unique UUID returned by the service
    and constructs the final public Webhook URL.

    5. **Completion**: The resulting JSON (including the URL and token details) is
    added to the action results, and the execution status is updated to completed.


    ### Additional Notes

    - This action does not use or interact with entities (such as IPs or Hostnames)
    from the Google SecOps case.

    - The external service is assumed to handle the lifecycle and storage of the created
    token.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new webhook resource (token and endpoint) on the target external system
      via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Delete Token:
  ai_description: >-
    ### General Description

    Deletes a specific Webhook token from the external Webhook service using its unique
    identifier. This action effectively makes the webhook URL associated with that
    token inaccessible and removes the token configuration from the service.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Token ID | String | Yes | The unique identifier (ID) of the webhook token that
    needs to be deleted. Default value is '111'. |


    ### Flow Description

    1. **Initialization**: The action retrieves the integration configuration (Base
    URL) and extracts the mandatory `Token ID` parameter.

    2. **External Interaction**: The script utilizes the `WebhookManager` to send
    an HTTP DELETE request to the specific token endpoint (e.g., `{BaseURL}/token/{TokenID}`).

    3. **Validation**: The action checks the response from the external service to
    ensure the deletion was successful.

    4. **Finalization**: The script returns a success status and an output message
    confirming the deletion or detailing any errors encountered during the process.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Performs an HTTP DELETE request to the external Webhook service to remove a
      specific token, making the associated endpoint permanently inaccessible.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Webhook Response:
  ai_description: >-
    ### General Description

    The **Get Webhook Response** action retrieves request logs for a specific webhook
    endpoint identified by a **Token ID**. It is an asynchronous action designed to
    monitor activity on a generated URL, often used to capture user interaction or
    callbacks from external systems. It interacts with an external Webhook service
    to fetch metadata about HTTP requests (headers, payload, source IP) sent to that
    specific token.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Token ID** | String | Yes | The unique identifier of the webhook token to
    monitor. |

    | **Pending Condition** | DDL | Yes | Defines the wait logic: `TimeFrame` (wait
    for a set duration before returning all data) or `AwaitClick` (complete as soon
    as at least one request is detected). |

    | **TimeFrame** | String | Yes | The duration in minutes to wait before fetching
    data if the 'TimeFrame' condition is selected. |

    | **Responses To Retrieve** | DDL | Yes | Specifies whether to return `All` recorded
    requests or only the `Latest` one. |


    ### Flow Description

    1. **Initialization:** The action extracts the Token ID and configuration parameters.

    2. **Execution State Management:**
       - If **TimeFrame** is selected: The action records the start time. On subsequent
    runs, it checks if the duration has elapsed. If not, it returns an 'IN_PROGRESS'
    state.
       - If **AwaitClick** is selected: The action immediately checks for requests.
    If the request list is empty, it returns an 'IN_PROGRESS' state.
    3. **Data Retrieval:** Once the condition (time elapsed or data present) is met,
    the action queries the Webhook manager to fetch request details.

    4. **Filtering:** The action automatically filters out requests originating from
    'Slack' user agents (e.g., link previews) to reduce noise.

    5. **Output:** The retrieved request data is formatted into the action's JSON
    results, and the action is marked as 'COMPLETED'.


    ### Additional Notes

    - This action does not run on entities; it relies entirely on the manually provided
    **Token ID** parameter.

    - Because it is asynchronous, the action may remain in the 'In Progress' queue
    for several minutes depending on the configured TimeFrame.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Tests connectivity to the Webhook service to ensure the integration is properly
    configured and the target URL is reachable. This is a standard health-check action
    used to verify that the SOAR can communicate with the external Webhook endpoint.


    ### Parameters Description

    There are no parameters for this action. The connectivity test relies entirely
    on the 'URL' provided in the integration's general configuration.


    ### Additional Notes

    This action performs a simple GET request to the base URL defined in the integration
    configuration to validate the connection.


    ### Flow Description

    1.  **Retrieve Configuration:** The script fetches the integration configuration,
    specifically extracting the base URL.

    2.  **Initialize Manager:** A WebhookManager instance is created using the base
    URL.

    3.  **Connectivity Test:** The script calls the `test_connectivity` method, which
    executes an HTTP GET request to the base URL.

    4.  **Process Response:** If the request is successful (HTTP status code 2xx),
    the action returns success. If an error occurs (e.g., timeout, 404, 500), an error
    message is generated and the action fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
