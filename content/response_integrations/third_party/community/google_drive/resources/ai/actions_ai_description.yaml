Add Permission:
  ai_description: >-
    ### General Description

    Adds permissions for a specific file stored in Google Drive to one or more users.
    This action allows an analyst to programmatically grant 'Owner', 'Writer', or
    'Reader' access to a document by providing its unique file ID and the target email
    addresses. It is primarily used for remediation or collaboration tasks where access
    control needs to be updated during an incident response flow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **File Id** | string | Yes | The unique identifier of the file (found in the
    Google Drive URL). |

    | **Role** | ddl | Yes | The level of access to grant: 'owner' (full control),
    'writer' (can comment/edit), or 'reader' (view only). |

    | **Emails** | string | Yes | Semicolon-separated list (e.g., `user1@example.com;user2@example.com`)
    of target users. |

    | **Should send notification** | boolean | No | If true, Google will send an email
    notification to the users receiving the new permission. |


    ### Additional Notes

    While the configuration metadata marks 'Should send notification' as not mandatory,
    the underlying script logic enforces it as a required parameter during extraction.
    Ensure this boolean is explicitly set in the action configuration.


    ### Flow Description

    1. **Extraction:** The action retrieves the Google Drive service account credentials
    from the integration configuration and the specific file ID, role, and target
    emails from the action parameters.

    2. **Manager Initialization:** Initializes the Google Drive Manager using the
    provided service account JSON.

    3. **Processing:** The semicolon-separated list of emails is parsed into individual
    addresses.

    4. **Execution:** For each email, a request is sent to the Google Drive API's
    `permissions.create` endpoint to assign the specified role to the user for the
    given file ID.

    5. **Completion:** The action concludes by returning a success message to the
    Case Wall indicating which permissions were granted.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates new permission records in the Google Drive API for the specified file,
      effectively changing the Access Control List (ACL) of external cloud resources.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Delete File:
  ai_description: >-
    ### General Description

    The **Delete File** action permanently removes a specific file from Google Drive.
    Unlike moving a file to the trash, this operation is a hard delete and cannot
    be easily undone through the UI. It is primarily used for remediation and automated
    cleanup of unauthorized or malicious files discovered during an investigation.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **File Id** | String | Yes | The unique identifier of the file in Google Drive.
    This ID can be extracted from the file's URL (e.g., `https://drive.google.com/drive/u/0/folders/{file-id}`).
    |


    ### Flow Description

    1. **Credential Setup**: The action retrieves the service account credentials
    from the integration configuration.

    2. **Input Validation**: The action extracts the mandatory `File Id` provided
    in the action parameters.

    3. **API Execution**: The action initializes the Google Drive Manager and executes
    a `delete` command via the Google Drive API v3 for the specified `file_id`.

    4. **Finalization**: If the API call is successful, the action returns a confirmation
    message indicating the file was deleted.


    ### Additional Notes

    * **Permanent Deletion**: Files deleted using this action skip the 'Trash' folder
    and are permanently removed from the drive.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Permanently deletes a file from the user's Google Drive storage via the Google
      Drive API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Download File To Base64:
  ai_description: "### General Description\nThis action downloads a file from Google\
    \ Drive based on a provided File ID and converts its content into a Base64 encoded\
    \ string. It is designed to facilitate file retrieval for automated workflows,\
    \ such as malware analysis or data exfiltration checks. The action automatically\
    \ handles Google-specific file formats (Docs, Sheets, Slides) by converting them\
    \ into standard Microsoft Office formats (docx, xlsx, pptx) during the download\
    \ process.\n\n### Parameters Description\n| Parameter | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| File Id | String | Yes | The unique identifier\
    \ of the file in Google Drive. It is typically found within the file's URL (e.g.,\
    \ https://drive.google.com/drive/u/0/folders/{file-id}). |\n\n### Flow Description\n\
    1. **Initialization**: The action initializes the Google Drive Manager using the\
    \ provided Service Account credentials.\n2. **Metadata Lookup**: It calls the\
    \ Google Drive API to retrieve the file's metadata, specifically identifying the\
    \ file name and its MIME type.\n3. **Content Retrieval**: \n   - If the file is\
    \ a Google-native document (Doc, Sheet, or Presentation), the action uses the\
    \ `export_media` method to convert and download it in an Office-compatible format.\n\
    \   - For all other file types, it uses the `get_media` method to download the\
    \ raw binary content.\n4. **Base64 Conversion**: The downloaded binary stream\
    \ is encoded into a Base64 string.\n5. **Output**: The action returns a JSON object\
    \ containing the file name, the detected file type, and the Base64 encoded content.\n\
    \n### Additional Notes\nThe Service Account associated with the provided Credentials\
    \ JSON must have at least 'Reader' access to the file or folder being accessed."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Download File To Path:
  ai_description: >-
    Downloads a specific file from Google Drive and saves it to a designated local
    directory on the Google SecOps worker filesystem. This action is designed to retrieve
    external documents or binary artifacts for use in subsequent playbook steps.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Id | String | Yes | The unique identifier of the file, typically found
    in its Google Drive URL. |

    | Folder Path | String | No | The local path on the execution environment where
    the file should be saved. Defaults to `/temp`. |


    ### Flow Description

    1. **Authentication**: Initializes a connection to Google Drive using provided
    Service Account credentials.

    2. **Metadata Lookup**: Retrieves the filename and MIME type of the file associated
    with the provided `File Id`.

    3. **Format Handling**: Checks if the file is a Google Workspace format (Doc,
    Spreadsheet, or Presentation). If so, it configures the download to export the
    file into standard Office formats (.docx, .xlsx, or .pptx).

    4. **Download Execution**: Streams the file content (either as a direct media
    download or an export) from Google Drive into memory.

    5. **Local Storage**: Writes the binary stream to the specified `Folder Path`
    on the local disk of the worker.

    6. **Finalization**: Returns the metadata of the downloaded file and the absolute
    path where it was saved.


    ### Additional Notes

    * This action requires the Service Account to have at least 'Reader' permissions
    on the target file.

    * The action performs file I/O operations on the local worker environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action writes the downloaded file content to the local filesystem of the
      execution worker at the specified 'Folder Path'. It also temporarily creates
      a credentials.json file in the execution directory.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get File Metadata:
  ai_description: >-
    ### General Description\nRetrieves detailed metadata for a specific file stored
    in Google Drive using its unique File ID. This action interacts with the Google
    Drive API to fetch all available properties of a file, such as ownership, permissions,
    size, and creation timestamps, which is essential for forensic investigations
    or auditing file access.\n\n### Parameters Description\n\n| Parameter | Type |
    Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| File Id | String |
    Yes | The unique identifier of the file found in the Google Drive URL. For example,
    in 'https://drive.google.com/file/d/1A2B3C/view', the File ID is '1A2B3C'. |\n\n###
    Flow Description\n1. **Initialization**: The action starts by extracting the service
    account credentials from the integration settings and the File ID from the action
    parameters.\n2. **Manager Setup**: It initializes the Google Drive Manager, which
    handles the authentication and API communication with Google Cloud.\n3. **Data
    Retrieval**: The manager executes a GET request to the Google Drive 'files' endpoint,
    requesting all fields ('*') for the provided File ID.\n4. **Result Processing**:
    The retrieved metadata JSON is attached to the action's result set, and the action
    terminates successfully, providing the file's ID as the primary result value.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Permission List:
  ai_description: >-
    ### General Description

    Retrieves a list of users and their associated permissions (e.g., owner, writer,
    reader) for a specific file stored in Google Drive. This action is primarily used
    for auditing and security investigations to identify who has access to sensitive
    files and documents.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Id | string | Yes | The unique identifier of the file, which can be extracted
    from the file's sharing URL (e.g., https://drive.google.com/drive/u/0/folders/{file-id}).
    |


    ### Flow Description

    1. **Extraction**: The action retrieves the integration configuration (credentials)
    and the mandatory `File Id` parameter from the SOAR environment.

    2. **Initialization**: It initializes the `GoogleDriveManager` using the provided
    service account credentials.

    3. **Data Retrieval**: It calls the Google Drive API's `permissions().list` method
    for the specified `File Id` to fetch all permission records, including user emails
    and roles.

    4. **Aggregation**: The action counts the total number of permissions retrieved.

    5. **Completion**: It adds the full list of permissions as a JSON result to the
    action and ends the execution with a message stating the total count of permissions
    found.


    ### Additional Notes

    This action is a read-only enrichment process and does not modify any files, permissions,
    or internal SOAR entity data.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is designed to verify the connectivity between Google SecOps
    and the Google Drive API. It ensures that the provided service account credentials
    are valid and that the integration has the necessary permissions to interact with
    the Google Drive environment. This is typically used as a health check for the
    integration.


    ### Parameters Description

    This action does not have any direct input parameters. It relies on the global
    integration configuration for its execution.


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Credentials Json | String | Yes | This is an integration configuration parameter.
    It contains the JSON content of the Google Service Account key used for authentication.
    |


    ### Additional Notes

    *   The action uses a specific API call to list image files to test the connection.

    *   The service account must have at least metadata read permissions for the test
    to succeed.


    ### Flow Description

    1.  **Extract Configuration:** The action retrieves the `Credentials Json` from
    the Google Drive integration settings.

    2.  **Initialize Manager:** It initializes the `GoogleDriveManager`, which writes
    the credentials to a temporary local file and builds the Google Drive API v3 client.

    3.  **Test Connection:** It executes a `test_connectivity` call, which performs
    a GET request to the Google Drive API (`files.list`) searching for JPEG images.

    4.  **Report Result:** If the API call is successful, the action terminates with
    a success state and a "Connected successfully" message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Permission:
  ai_description: >-
    ### General Description

    The **Remove Permission** action allows users to revoke a specific access permission
    from a file stored in Google Drive. This is typically used in security orchestration
    to immediately de-provision access for a specific user, group, or domain when
    a data leak or unauthorized access is suspected.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Id | String | Yes | The unique identifier for the Google Drive file. This
    can be found in the file's URL (e.g., `https://drive.google.com/drive/u/0/folders/{file-id}`).
    |

    | Permission Id | String | Yes | The unique identifier of the specific permission
    to be removed. This ID can be retrieved by running the 'List Permissions' action
    first. |


    ### Additional Notes

    - This action performs a hard delete of the permission, meaning the revocation
    is immediate and permanent unless re-added.

    - The action requires valid service account credentials with sufficient OAuth
    scopes (`drive` or `drive.file`).


    ### Flow Description

    1. **Configuration Extraction:** The action retrieves the Google service account
    credentials from the integration's configuration.

    2. **Parameter Retrieval:** The action extracts the `File Id` and `Permission
    Id` provided by the user.

    3. **Manager Initialization:** A `GoogleDriveManager` instance is created to handle
    API communication.

    4. **Execution:** The action calls the Google Drive API's `permissions().delete()`
    method using the provided identifiers.

    5. **Completion:** Upon success, the action returns a confirmation message to
    the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action deletes a permission entry from a Google Drive file's Access Control
      List (ACL), effectively revoking access for a user or entity.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Upload File From Base64:
  ai_description: >-
    ### General Description

    Uploads a file to Google Drive using a Base64 encoded string and optionally grants
    'writer' permissions to a list of specified email addresses. This action is useful
    for programmatically storing evidence, reports, or logs in a centralized Google
    Drive location and ensuring relevant stakeholders have access.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Name | string | Yes | The name of the file to be created in Google Drive,
    including the extension (e.g., 'report.pdf'). |

    | Share with emails | string | Yes | A semicolon-separated list of email addresses
    (e.g., 'user1@example.com;user2@example.com') that will be granted writer access
    to the uploaded file. |

    | Base64 String | string | Yes | The actual content of the file encoded in Base64
    format. |


    ### Additional Notes

    - The action determines the file's MIME type based on the file extension provided
    in the 'File Name' parameter. If the extension is unknown, it defaults to 'application/octet-stream'.

    - Authentication is handled via a Service Account JSON provided in the integration
    configuration.


    ### Flow Description

    1. **Extraction**: The action retrieves the Google Drive service account credentials
    from the integration configuration and the file details (Base64 content, name,
    and sharing list) from the action parameters.

    2. **Initialization**: It initializes the Google Drive API client using the provided
    service account credentials.

    3. **Upload**: The Base64 string is decoded into a binary stream and uploaded
    to Google Drive as a new file with the specified name.

    4. **Permission Management**: If the 'Share with emails' parameter is populated,
    the action iterates through each email and grants them 'writer' access to the
    newly created file.

    5. **Completion**: The action returns the metadata of the created file (including
    the unique File ID) and signals a successful completion.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new file in the user's Google Drive and modifies file permissions
      to grant access to specified email addresses.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Upload File From Path:
  ai_description: >-
    ### General Description

    Uploads a file from a specified local system path to Google Drive. This action
    is designed to move local artifacts or generated reports into a cloud storage
    environment for persistence or sharing. Additionally, it supports granting 'writer'
    permissions to a list of specified email addresses immediately after the upload
    is complete.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Path | string | Yes | The absolute or relative path on the local filesystem
    where the file to be uploaded is located (e.g., `/temp/image.png`). |

    | Share with emails | string | No | A semicolon-separated list of email addresses
    (e.g., `user1@gmail.com;user2@gmail.com`) to be granted 'writer' access to the
    uploaded file. |


    ### Flow Description

    1. **Configuration Retrieval:** The action extracts the Google Drive service account
    credentials and the user-provided parameters (File Path and Share with emails).

    2. **File Upload:** The `GoogleDriveManager` reads the file from the provided
    path and uses the Google Drive API to create a new file in the connected Drive
    account, using the original filename.

    3. **Permission Assignment:** If the 'Share with emails' parameter is populated,
    the script parses the string into individual email addresses and sends requests
    to the Google Drive API to add 'writer' permissions for each email to the newly
    created file.

    4. **Result Reporting:** The action returns the metadata of the uploaded file
    (including its unique File ID) as a JSON result and completes the execution.


    ### Additional Notes

    - This action does not run on specific entities (like IPs or Hostnames); it operates
    based on a direct file path provided as a parameter.

    - Ensure the service account associated with the provided credentials has the
    necessary 'drive' and 'drive.file' OAuth scopes.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action creates a new file in Google Drive and updates the file's permission
      list by adding new users as writers.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
