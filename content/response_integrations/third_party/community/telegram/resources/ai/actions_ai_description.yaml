Get Bot Details:
  ai_description: >-
    ### General Description

    The **Get Bot Details** action retrieves information about the Telegram bot associated
    with the configured API token. It is primarily used to verify the bot's connectivity,
    identity, and capabilities (such as whether it can join groups or read all group
    messages). This action returns metadata including the bot's unique ID, username,
    and name.


    ### Parameters Description

    This action does not have any input parameters. It relies solely on the **API
    Token** provided in the Telegram integration configuration.


    ### Flow Description

    1.  **Initialization**: The action initializes the Telegram Manager using the
    API Token retrieved from the integration's configuration.

    2.  **API Request**: It performs a GET request to the Telegram Bot API's `/getMe`
    endpoint.

    3.  **Data Retrieval**: The action captures the JSON response containing the bot's
    details (e.g., `id`, `first_name`, `username`, `can_join_groups`).

    4.  **Result Processing**: The retrieved bot details are added to the action's
    execution results as a JSON object.

    5.  **Completion**: The action concludes with a success message if the bot details
    were fetched correctly, or a failure message if an error occurred during the API
    call.


    ### Additional Notes

    *   This action does not require or process any entities.

    *   It serves as a diagnostic tool to ensure the bot token is valid and to identify
    the specific bot instance being used in the SOAR workflow.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Chat Details:
  ai_description: >-
    ### General Description

    Retrieves detailed metadata for a specific Telegram chat (group, channel, or private
    chat) using the Telegram Bot API. This action is used to obtain information such
    as the chat title, type, and importantly, the invite link for the specified chat
    identifier.


    ### Parameters Description


    | Parameter Name | Description | Expected Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Chat ID | The unique identifier or username (e.g., '@username') of the target
    Telegram chat. | String | Yes |


    ### Additional Notes

    - This action does not operate on SOAR entities; it relies entirely on the manually
    provided **Chat ID** parameter.

    - The bot must have the necessary permissions within the Telegram platform to
    access details for the specified chat.


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the Telegram Bot API Token from the
    integration configuration.

    2. **Parameter Retrieval**: Extracts the **Chat ID** from the action input parameters.

    3. **Manager Initialization**: Initializes the Telegram API manager using the
    provided credentials.

    4. **API Interaction**: Calls the Telegram `/getChat` endpoint to fetch metadata
    for the specified ID.

    5. **Result Processing**: Parses the response to extract specific fields like
    the invite link.

    6. **Output Generation**: Adds the full chat details as a JSON result and creates
    a direct link to the chat invite URL in the action output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Messages:
  ai_description: >-
    ### General Description

    Retrieves messages and updates from a Telegram chat where the configured bot is
    a member. This action uses the Telegram Bot API's `getUpdates` method to fetch
    recent interactions, including text messages, channel posts, and poll responses.
    It is primarily used for monitoring bot activity or ingesting external communications
    into the SOAR platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Last Message ID | string | No | The ID of the last message from which the action
    will start pulling updates. This serves as an offset to avoid retrieving older,
    previously processed messages. |

    | Message Types | content | No | A list of the specific update types to retrieve
    (e.g., ['channel_post', 'poll_answer']). If left empty, all update types are retrieved.
    |


    ### Flow Description

    1. **Initialization**: The action initializes the `TelegramManager` using the
    API Token provided in the integration configuration.

    2. **Parameter Extraction**: It extracts the starting message offset and the list
    of allowed update types from the action parameters.

    3. **API Request**: The action performs a GET request to the Telegram Bot API's
    `getUpdates` endpoint with the specified filters.

    4. **Result Processing**: The retrieved messages are formatted as a JSON object
    and attached to the action results for use in playbooks.


    ### Additional Notes

    - The bot must be a member of the chat or channel from which messages are being
    pulled.

    - This action does not delete or modify messages on the Telegram server; it only
    retrieves them.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action for the Telegram integration is a connectivity test utility.
    Its primary purpose is to verify that the Google SecOps environment can successfully
    communicate with the Telegram Bot API using the provided API Token. It acts as
    a health check to ensure the integration is properly configured before executing
    other functional actions like sending messages or managing chats.


    ### Parameters Description

    This action does not utilize any action-specific parameters. It relies exclusively
    on the integration-level configuration:


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **API Token** | String | Yes | The bot token provided by Telegram's BotFather,
    used to authenticate with the API. This is extracted from the integration configuration.
    |


    ### Additional Notes

    - This action does not process any entities (IPs, Hosts, etc.).

    - It is typically used during initial setup or troubleshooting to confirm network
    access and credential validity.


    ### Flow Description

    1.  **Initialization**: The script initializes the Siemplify Action and identifies
    the required integration configuration.

    2.  **Configuration Extraction**: It retrieves the `API Token` from the Telegram
    integration settings.

    3.  **Connectivity Test**: It calls the Telegram `getMe` API endpoint via the
    `TelegramManager`. This endpoint returns basic information about the bot in form
    of a GET request.

    4.  **Verification**: The response is parsed to check if the `ok` field is `True`.

    5.  **Result Reporting**: If the API call is successful, the action returns a
    completion state with a success message. If the call fails or an exception occurs,
    it returns a failed state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Document:
  ai_description: >-
    ### General Description

    The **Send Document** action allows a Google SecOps user to send a document located
    at a specific URL to a Telegram chat or channel using a Telegram bot. This is
    primarily used for notification purposes or for sharing automated reports and
    logs directly to a messaging platform.


    ### Parameters description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Document URL** | The direct URL of the document to be sent to the Telegram
    chat. | String | Yes |

    | **Chat ID** | The unique identifier or username of the target chat where the
    document will be sent. | String | Yes |


    ### Additional notes

    - This action requires a valid Telegram Bot API Token to be configured in the
    integration settings.

    - The bot must have permission to post in the specified chat or channel.


    ### Flow description

    1.  **Parameter Extraction:** The action retrieves the integration's API Token
    and the user-provided 'Chat ID' and 'Document URL'.

    2.  **API Interaction:** The script utilizes the `TelegramManager` to send a request
    to the Telegram Bot API endpoint `/sendDocument`.

    3.  **Transmission:** Telegram retrieves the document from the provided URL and
    delivers it to the specified chat.

    4.  **Result Reporting:** The action captures the response from Telegram (metadata
    of the sent message) and populates the action's JSON results. It then terminates
    with a success or failure message based on the API response.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action sends a document to a Telegram chat, which creates a new message/content
      entry in the external Telegram system.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Location:
  ai_description: >-
    Sends a geographic location to a specific Telegram chat using a Telegram Bot.
    The action takes a Chat ID and specific coordinates (Latitude and Longitude) as
    input and utilizes the Telegram Bot API to deliver the location as a map message
    within the chat.


    ### Parameters

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Chat ID | string | Yes | The unique identifier for the target chat, group, or
    channel where the location will be sent. |

    | Latitude | string | Yes | The latitude coordinate of the location to send (e.g.,
    30.0123213). |

    | Longitude | string | Yes | The longitude coordinate of the location to send
    (e.g., 30.456468). |


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the Telegram Bot API Token from
    the integration configuration and the Chat ID, Latitude, and Longitude from the
    action parameters.

    2. **Manager Initialization**: Initializes the TelegramManager using the provided
    API Token.

    3. **API Interaction**: Calls the Telegram `sendLocation` endpoint with the specified
    chat identifier and geographic coordinates.

    4. **Outcome Handling**: If the API call is successful, it returns the JSON response
    containing the message details; otherwise, it fails with an error message.


    ### Additional Notes

    - This action does not run on entities; it is a standalone messaging action based
    on the provided input parameters.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends a location message to an external Telegram chat, which changes the state
      of the chat history in the Telegram platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Message:
  ai_description: >-
    ### General Description

    The **Send Message** action allows a Google SecOps user to send a text message
    to a specific Telegram chat or group via a configured Telegram Bot. This is typically
    used for automated notifications, alerting team members, or logging information
    to a shared Telegram channel during an incident response workflow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Chat ID** | string | Yes | The unique numerical identifier or username (e.g.,
    '@channelname') for the chat where the message should be sent. |

    | **Message** | string | Yes | The text content of the message to be delivered
    by the bot. |


    ### Additional Notes

    - This action requires a valid **API Token** to be configured in the Telegram
    integration settings.

    - The bot must have permissions to send messages in the specified chat (e.g.,
    it must be a member of the group or have started a conversation with the user).


    ### Flow Description

    1. **Initialization:** The action retrieves the global Telegram API Token and
    the specific action parameters (Chat ID and Message).

    2. **Connection:** It establishes a connection to the Telegram API using the `TelegramManager`
    class.

    3. **Execution:** It calls the `telegram_bot_sendmessage` method, which sends
    a request to the Telegram Bot API's `/sendMessage` endpoint.

    4. **Result Handling:** If successful, the action returns a success status and
    includes the raw JSON response from Telegram (containing message details) in the
    action's result data. If the API returns an error or the request fails, the action
    reports a failure.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action sends a new message to an external Telegram chat, which changes the
      state of the chat history in the Telegram system.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Photo:
  ai_description: >-
    ### General Description\nSends a photo to a specific Telegram chat using a provided
    HTTP URL. This action allows for the automated sharing of visual content, such
    as screenshots or report images, directly through a Telegram bot. \n\n### Parameters
    Description\n| Parameter | Type | Mandatory | Description |\n| :--- | :--- | :---
    | :--- |\n| Photo URL | String | Yes | The HTTP URL of the image to be sent. The
    URL must be publicly accessible and should point to a valid image file type (e.g.,
    .png, .jpg, .jpeg). |\n| Chat ID | String | Yes | The unique numerical identifier
    or username of the Telegram chat or channel where the photo should be delivered.
    |\n\n### Flow Description\n1. **Initialization**: The action retrieves the Telegram
    Bot API Token from the integration configuration and the specific Chat ID and
    Photo URL from the action inputs.\n2. **API Communication**: The action uses the
    TelegramManager to interface with the Telegram Bot API.\n3. **Execution**: A request
    is made to the `sendPhoto` endpoint of the Telegram API using the provided parameters.\n4.
    **Finalization**: If the photo is successfully sent, the resulting JSON metadata
    from Telegram is added to the action's results, and the execution is marked as
    completed. If an error occurs (e.g., API connectivity issues or invalid parameters),
    the action reports the failure.\n\n### Additional Notes\n- This action does not
    rely on SOAR entities and functions independently based on the provided parameters.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends a photo message to a Telegram chat, which creates a new message entry
      in the external Telegram communication platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Poll:
  ai_description: >-
    ### General Description

    Sends an interactive poll with custom answer options to a designated Telegram
    chat using a bot. This action allows for automated data collection or human-in-the-loop
    decision-making by pushing questions directly to Telegram groups, channels, or
    private chats.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Chat ID | String | Yes | The unique identifier for the target chat, group, or
    channel. |

    | Question | String | Yes | The specific question text to be asked in the poll.
    |

    | Options | Content | Yes | A JSON-formatted array of strings representing the
    answer choices (e.g., `["Approve", "Deny"]`). |

    | Is Anonymous | Boolean | No | Determines if the poll results will be anonymous.
    Note: Non-anonymous polls cannot be sent to channel chats. Default is false. |


    ### Flow Description

    1. **Initialize Manager:** The action initializes the `TelegramManager` using
    the API Token provided in the integration configuration.

    2. **Extract Inputs:** It retrieves the target Chat ID, the question text, the
    list of options, and the anonymity setting from the action parameters.

    3. **API Call:** The action calls the Telegram `sendPoll` API endpoint via the
    `ask_question` method to create the poll in the specified chat.

    4. **Handle Response:** It captures the API response, adds the poll details to
    the JSON results, and reports a success message if the poll was sent successfully.


    ### Additional Notes

    * Ensure the bot has the necessary permissions to send polls in the target chat.

    * Non-anonymous polls are restricted from being used in Telegram Channels.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new poll object in an external Telegram chat, which changes the state
      of the chat history by adding a new interactive message.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Set Default Chat Permissions:
  ai_description: >-
    ### General Description

    The **Set Default Chat Permissions** action updates the default permissions for
    all new members within a specific Telegram group or supergroup. This action allows
    administrators to control member capabilities such as sending messages, polls,
    inviting others, or pinning messages globally for the chat.


    ### Parameters Description


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Chat ID** | string | Yes | The unique identifier or username for the target
    Telegram chat where permissions will be updated. |

    | **Can Send Messages** | boolean | No | If true (default), users are allowed
    to send text messages, contacts, and locations. |

    | **Can Send Polls** | boolean | No | If true (default), users are allowed to
    send polls. |

    | **Can Invite Users** | boolean | No | If true (default), users are allowed to
    invite new users to the chat. |

    | **Can Pin Messages** | boolean | No | If true (default), users are allowed to
    pin messages. Note: This cannot be applied in supergroups. |

    | **Can Edit Info** | boolean | No | If true (default), users can edit the chat
    title, photo, and other settings. Note: This cannot be applied in supergroups.
    |


    ### Additional Notes

    *   **Requirement:** The bot must be an administrator in the group/supergroup
    and must specifically have the `can_restrict_members` admin permission.

    *   The parameters **Can Pin Messages** and **Can Edit Info** are ignored by Telegram
    when applied to supergroups.


    ### Flow Description

    1.  **Initialization:** Extracts the Telegram API Token from the integration configuration
    and the chat permission settings from the action parameters.

    2.  **API Connection:** Instantiates the Telegram Manager using the provided API
    token.

    3.  **Permission Update:** Calls the Telegram API (`setChatPermissions`) with
    the specified `Chat ID` and the boolean flags for each permission type.

    4.  **Result Handling:** Captures the API response. If successful, it marks the
    action as completed; if the API returns an error (e.g., bot lacks permissions),
    the action fails with a descriptive error message.

    5.  **Output:** Provides the raw JSON response from Telegram in the action results.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action modifies the default permissions configuration for a Telegram chat,
      changing how all new members can interact with the group.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Set User Permissions:
  ai_description: >-
    ### General Description

    Updates or revokes administrative permissions for a specific user in a Telegram
    supergroup or channel. This action allows fine-grained control over what actions
    a user can perform, such as pinning messages, deleting content, or inviting others.
    It utilizes the Telegram Bot API's `promoteChatMember` capability.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Chat ID** | The unique identifier or username for the target chat/channel.
    | String | Yes |

    | **User ID** | The unique identifier of the user whose permissions are being
    modified. | String | Yes |

    | **Is Anonymous** | If true, the user's presence in the chat is hidden. | Boolean
    | No |

    | **Can Edit The Info** | Allows the user to change chat title, photo, and other
    settings. | Boolean | No |

    | **Can Post Messages** | Allows the user to post messages (relevant for channels).
    | Boolean | No |

    | **Can Edit Messages** | Allows the user to edit messages of other users. | Boolean
    | No |

    | **Can Delete Messages** | Allows the user to delete messages of other users.
    | Boolean | No |

    | **Can Invite Users** | Allows the user to invite new users to the chat. | Boolean
    | No |

    | **Can Restrict Members** | Allows the user to restrict, ban, or unban chat members.
    | Boolean | No |

    | **Can Promote Members** | Allows the user to add or revoke other administrators.
    | Boolean | No |

    | **Can Pin Messages** | Allows the user to pin messages (relevant for supergroups).
    | Boolean | No |


    ### Additional Notes

    - The Telegram bot must already be an administrator in the specified chat to execute
    this action.

    - The bot must possess the relevant administrative rights to grant them to others.

    - This action does not rely on SOAR entities; it uses specific IDs provided in
    the parameters.


    ### Flow Description

    1. **Initialization**: Retrieves the Telegram API Token from the integration settings.

    2. **Parameter Extraction**: Collects the Chat ID, User ID, and a comprehensive
    set of permission flags (Boolean) from the action inputs.

    3. **API Execution**: The `TelegramManager` calls the `promoteChatMember` endpoint
    using the provided parameters.

    4. **Result Handling**: Evaluates the API response. If successful, it returns
    the updated permission details as JSON; otherwise, it reports a failure with the
    error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Modifies user roles and permissions within the external Telegram platform via
      the promoteChatMember API endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Wait for poll results:
  ai_description: "### General Description\nWaits for and retrieves the results of\
    \ a specific Telegram poll. This action is designed to be used in an asynchronous\
    \ loop, polling the Telegram API until either a specific vote threshold is reached\
    \ or a maximum time limit expires. It is primarily used to facilitate user interaction\
    \ or decision-making via Telegram within a playbook.\n\n### Parameters Description\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | Poll ID | string | Yes | The unique identifier of the Telegram poll to monitor.\
    \ |\n| Answer Votes Threshold | string | Yes | The number of votes required for\
    \ any single option to trigger the completion of the action. |\n| Waiting Timeframe\
    \ | string | Yes | The maximum duration (in minutes) the action will wait for\
    \ results before timing out. |\n| Scan back Limit | string | Yes | The maximum\
    \ number of recent poll updates to retrieve from Telegram in a single check. Recommended\
    \ value is 300. |\n\n### Flow Description\n1. **Initialization**: The action retrieves\
    \ the Telegram Bot API Token from the configuration and extracts user-provided\
    \ parameters including the Poll ID, vote threshold, and timeframe.\n2. **State\
    \ Management**: It checks if this is the first run. If so, it initializes the\
    \ start time. On subsequent runs, it retrieves previous state data (start time\
    \ and last update offset) from the internal `additional_data` storage.\n3. **External\
    \ API Call**: The action calls the Telegram API (`getUpdates`) to fetch poll-related\
    \ updates based on the provided limit and offset.\n4. **Data Filtering**: It filters\
    \ all returned updates to isolate those belonging to the specific `Poll ID`. It\
    \ also tracks the highest update ID seen to optimize subsequent API calls.\n5.\
    \ **Condition Check**: \n    - **Threshold Met**: If any poll option has a vote\
    \ count equal to or greater than the `Answer Votes Threshold`, the action completes\
    \ with a success status.\n    - **Timeout**: If the threshold isn't met but the\
    \ `Waiting Timeframe` has elapsed, the action completes without meeting the threshold.\n\
    \    - **In Progress**: If neither condition is met, the action saves its current\
    \ state and sets the execution status to `INPROGRESS` to wait for the next polling\
    \ interval.\n6. **Results**: The action provides the raw Telegram response and\
    \ the current list of poll answers (options and vote counts) in the JSON result.\n\
    \n### Additional Notes\n- This action is **asynchronous** (`is_async: true`).\
    \ It will run repeatedly until a completion condition is met.\n- No entities are\
    \ required or processed by this action."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
