Enrich Actor:
  ai_description: "### General Description\nEnriches Threat Actor entities using Cybersixgill\
    \ Darkfeed intelligence. This action provides deep visibility into an actor's\
    \ activity within the underground ecosystem by retrieving all Indicators of Compromise\
    \ (IOCs) shared by the actor over the last 90 days. It helps security analysts\
    \ understand the actor's areas of activity, preferred choice of targets, and utilized\
    \ techniques.\n\n### Parameters Description\nThis action does not have any unique\
    \ action parameters. It relies on the global integration configuration for connectivity\
    \ (Client ID and Client Secret).\n\n### Additional Notes\n- This action specifically\
    \ targets `THREATACTOR` entities.\n- Entities successfully enriched will be marked\
    \ as 'suspicious' and 'enriched' within Google SecOps.\n\n### Flow Description\n\
    1.  **Extraction**: Retrieves the Cybersixgill API credentials (Client ID and\
    \ Client Secret) from the integration configuration.\n2.  **Entity Filtering**:\
    \ Filters the target entities to process only those of the `THREATACTOR` type.\n\
    3.  **Data Retrieval**: For each Threat Actor entity, queries the Cybersixgill\
    \ Enrich API to fetch relevant intelligence, including associated IOCs, descriptions,\
    \ and metadata.\n4.  **Internal Updates**: \n    - Updates the entity's `additional_properties`\
    \ with Sixgill-specific data (e.g., Feed Name, Source, Severity, Confidence).\n\
    \    - Sets the entity status to `is_enriched = True` and `is_suspicious = True`.\n\
    5.  **Enrichment & Documentation**: \n    - Creates a detailed **Case Insight**\
    \ containing a summary of the actor's intelligence.\n    - Adds a **Data Table**\
    \ to the entity containing structured records of the actor's activity.\n    -\
    \ Generates **Entity Links** to the Cybersixgill Portal for deeper investigation.\n\
    \    - Attaches the raw JSON results to the action output."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - THREATACTOR
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Domain:
  ai_description: >-
    ### General Description

    Enriches Hostname entities with dark web threat intelligence from the Cybersixgill
    Darkfeed. This action specifically checks if a domain is associated with compromised
    sites or is being sold on the dark web, providing critical context such as actor
    names, severity scores, and severity levels. It maps external intelligence from
    VirusTotal and MITRE ATT&CK to the entity when available.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The Client ID required for authenticating with the
    Cybersixgill Darkfeed API. |

    | Client Secret | String | Yes | The Client Secret required for authenticating
    with the Cybersixgill Darkfeed API. |


    ### Flow Description

    1. **Credential Retrieval**: Extracts the API credentials (Client ID and Client
    Secret) from the integration's configuration.

    2. **Target Filtering**: Scans the current case's entities and filters for those
    of type `HOSTNAME`.

    3. **Intelligence Gathering**: For each identified domain, it queries the Cybersixgill
    API to retrieve enrichment data specifically tagged as 'domain' indicators in
    the Darkfeed.

    4. **Entity Property Update**: Updates the entity status in Google SecOps to `is_enriched`
    and `is_suspicious`. It also adds custom additional properties prefixed with 'Sixgill'
    containing metadata like Feed Name, Source, and Actor.

    5. **Data Enrichment**: Parses associated threat data, extracting VirusTotal positive
    rates and MITRE ATT&CK tactics/techniques.

    6. **Result Presentation**: Generates a detailed Case Insight summarizing the
    threat, creates a structured data table for the entity result, and adds direct
    links to the Cybersixgill portal for further forensic analysis.


    ### Additional Notes

    While the underlying logic supports various entity types, this specific action
    is hard-coded to process only `HOSTNAME` entities. If no dark web matches are
    found, the entity will not be marked as suspicious.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - HOSTNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Hash:
  ai_description: >-
    ### General Description

    Enriches File Hash entities using Cybersixgill Darkfeed information. This action
    proactively analyzes and investigates malware hashes as they emerge on the dark
    web, often identifying threats undetected by traditional AV vendors. It retrieves
    detailed threat intelligence including actor attribution, source information,
    confidence scores, and severity levels, while also mapping findings to VirusTotal
    reputation data and MITRE ATT&CK tactics.


    ### Parameters Description

    This action does not have any action-specific parameters. It utilizes the integration
    configuration parameters (Client Id and Client Secret) to authenticate with the
    Cybersixgill service.


    ### Flow Description

    1. **Authentication**: The action retrieves the Client ID and Client Secret from
    the integration configuration to initialize the Cybersixgill manager.

    2. **Entity Selection**: It identifies and filters for File Hash entities (MD5,
    SHA-1, or SHA-256) within the current scope.

    3. **External Query**: For each hash, it queries the Cybersixgill Darkfeed API
    to retrieve enrichment indicators and malware analysis.

    4. **Data Parsing**: The processor parses the STIX-formatted results, extracting
    metadata such as description, feed name, actor, confidence, and severity. It also
    identifies external references to VirusTotal and MITRE ATT&CK.

    5. **Entity Updates**: It updates the entities in Google SecOps by marking them
    as enriched and suspicious, and populating their additional properties with the
    retrieved metadata.

    6. **Insight and Table Creation**: The action generates a detailed case insight
    for the investigation and attaches a data table to each entity containing the
    summarized analysis.

    7. **Resource Linking**: It adds entity links pointing directly to the Cybersixgill
    Portal for deeper investigation into the specific post or indicator.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes (is_enriched, is_suspicious), adds custom properties,
      creates case insights, and generates data tables for entities based on the information
      retrieved from Cybersixgill.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich IP:
  ai_description: >-
    ### General Description

    The **Enrich IP** action retrieves threat intelligence for IP Address entities
    using Cybersixgill Darkfeed. It identifies indicators associated with Command
    and Control (C2) servers, malware distribution, botnets, DDoS attacks, proxy anonymization,
    and compromised RDP addresses. The action provides comprehensive enrichment data,
    including severity scores, confidence levels, and context from external sources
    like VirusTotal and MITRE ATT&CK.


    ### Parameters Description

    | Parameter Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Client Id | The API Client ID for Cybersixgill authentication. | String | Yes
    |

    | Client Secret | The API Client Secret for Cybersixgill authentication. | String
    | Yes |


    ### Flow Description

    1. **Initialization:** Extracts the Cybersixgill API credentials and initializes
    the manager and result processor.

    2. **Data Retrieval:** For each IP Address entity in the current context, the
    action queries the Cybersixgill API for enrichment data.

    3. **Entity Processing:**
        * Marks the entity as **enriched** and **suspicious** if data is found.
        * Appends detailed metadata (Description, Feed Name, Source, Severity, Confidence)
    to the entity's **additional properties**.
        * Parses STIX patterns to identify related file hashes (MD5, SHA-1, SHA-256).
    4. **Internal Updates:**
        * Updates the entity attributes in Google SecOps.
        * Generates a **Case Insight** containing a detailed summary of the findings.
        * Adds a **Data Table** to the entity with structured threat information.
        * Adds **Entity Links** pointing to the Cybersixgill Portal and external references
    (VirusTotal/MITRE).
    5. **Completion:** Returns a JSON result set of all enriched data and ends the
    action with a status message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich URL:
  ai_description: >-
    ### General Description

    Enriches URL entities using the Cybersixgill Darkfeed Enrichment service. This
    action identifies whether a URL has been shared or hosted on underground file-sharing
    or paste sites, providing threat intelligence regarding associated malware and
    threat actors. It retrieves reputation data, including VirusTotal scores and Mitre
    ATT&CK mappings, and updates entity statuses within the platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | (Configuration Parameter) The unique Client ID used
    to authenticate with the Cybersixgill API. |

    | Client Secret | String | Yes | (Configuration Parameter) The secret key used
    alongside the Client ID for authentication. |


    ### Flow Description

    1. **Authentication**: Initializes the Cybersixgill manager using the Client ID
    and Client Secret provided in the integration configuration.

    2. **Entity Selection**: Targets only URL entities within the current alert scope.

    3. **Threat Intelligence Query**: Queries the Sixgill enrichment API to retrieve
    indicators of compromise (IOCs) and actor-related data associated with the URL.

    4. **Entity Enrichment**: Updates entity metadata, marking them as 'Enriched'
    and 'Suspicious' if matches are found. It populates additional properties with
    metadata such as Sixgill Confidence, Severity, Feed Source, and Actor information.

    5. **Result Generation**: Generates comprehensive data tables, creates case insights
    summarizing the findings, and attaches external links to the Cybersixgill portal
    and third-party reports (e.g., VirusTotal).


    ### Additional Notes

    - This is an enrichment action that fetches data from an external source without
    modifying the external state.

    - It requires valid Cybersixgill Darkfeed Enrichment credentials to function.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General description

    The **Ping** action is a utility designed to verify the connectivity between Google
    SecOps and the Cybersixgill Darkfeed Enrichment service. It ensures that the integration
    credentials (Client ID and Client Secret) are correctly configured and that the
    Cybersixgill API is reachable from the environment.


    ### Parameters description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | None | This action does not have any input parameters. | N/A | N/A |


    ### Additional notes

    This action performs a live test by attempting to enrich a neutral, hardcoded
    IP address (8.8.8.8). It does not process any entities from the current alert
    or case context.


    ### Flow description

    1. **Configuration Retrieval**: The action extracts the `Client Id` and `Client
    Secret` from the integration settings.

    2. **Manager Initialization**: It initializes the `SixgillEnrichManager` and the
    `SixgillActionResultProcessor` to handle the API interaction logic.

    3. **Connection Test**: It calls the `test_connectivity` method, which creates
    a Sixgill client and attempts a real enrichment request for the IP `8.8.8.8` to
    validate authentication and network path.

    4. **Status Reporting**: Based on the API response, it returns a success message
    if the request completes successfully or an error message if the authentication
    or connection fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
