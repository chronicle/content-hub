EnrichActor:
  ai_description: >-
    ### General Description

    Enriches Threat Actor entities using Cybersixgill Darkfeed intelligence. This
    action allows security analysts to uncover a threat actor's activity within the
    underground ecosystem by retrieving all Indicators of Compromise (IOCs) shared
    by the actor in the last 90 days. It provides deep visibility into their areas
    of activity, preferred choice of targets, and specific techniques used.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The API Client ID provided by Cybersixgill for authentication.
    |

    | Client Secret | String | Yes | The API Client Secret provided by Cybersixgill
    for authentication. |


    ### Flow Description

    1. **Authentication:** The action extracts configuration parameters to authenticate
    with the Cybersixgill Enrich API.

    2. **Entity Selection:** It identifies Threat Actor entities within the current
    scope of the alert/case.

    3. **Data Retrieval:** For each Threat Actor, the action queries Cybersixgill
    to retrieve detailed actor profiles, associated IOCs (IPs, Hashes, URLs), and
    underground post activities.

    4. **Entity Mutation:** The action updates the entities within Google SecOps,
    marking them as enriched and suspicious. It also appends detailed metadata (like
    Sixgill post IDs, severity, and confidence) to the entity's additional properties.

    5. **Enrichment Outputs:** It generates Case Insights, populates Entity Data Tables,
    and adds external links to the Cybersixgill portal for further investigation.


    ### Additional Notes

    * The action specifically targets `THREATACTOR` entities.

    * Entities are automatically marked as suspicious if matching intelligence is
    found in the Sixgill database.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity properties by adding threat intelligence metadata, sets the 'is_enriched'
      and 'is_suspicious' flags to true for identified actors, adds entity links to
      external threat portals, and creates case-level insights and data tables.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - THREATACTOR
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichDomain:
  ai_description: "### General Description\nEnriches **HOSTNAME** entities using threat\
    \ intelligence from **Cybersixgill Darkfeed**. This action identifies if a domain\
    \ is associated with compromised sites or is being sold on the dark web. It retrieves\
    \ comprehensive metadata, including actor information, post IDs, severity, and\
    \ confidence levels, while cross-referencing with VirusTotal and MITRE ATT&CK\
    \ frameworks.\n\n### Parameters\nThis action does not have any action-level input\
    \ parameters. It relies on the global integration configuration for authentication\
    \ (Client ID and Client Secret).\n\n### Additional Notes\n*   The action automatically\
    \ marks entities as **suspicious** and **enriched** if data is found in the Cybersixgill\
    \ database.\n*   It specifically targets Hostname entities, even though the underlying\
    \ processor supports multiple types.\n\n### Flow Description\n1.  **Authentication:**\
    \ Retrieves credentials from the integration configuration to initialize the Cybersixgill\
    \ manager.\n2.  **Entity Filtering:** Filters the target entities to identify\
    \ those of type **HOSTNAME**.\n3.  **Data Retrieval:** Queries the Cybersixgill\
    \ API for enrichment data specifically for the identified domains.\n4.  **Metadata\
    \ Extraction:** Parses the response to extract indicator patterns (MD5, SHA-1,\
    \ SHA-256), feed names, severity, confidence, and external references like VirusTotal\
    \ positive rates or MITRE tactics.\n5.  **Internal Updates:** \n    *   Updates\
    \ the entity's additional properties with a 'Sixgill' prefix.\n    *   Sets `is_enriched`\
    \ and `is_suspicious` to `True` for successful matches.\n6.  **Reporting:** Generates\
    \ a Case Insight containing a summary of the findings, attaches a data table to\
    \ the entity, and adds the raw JSON result for further investigation."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates internal entity attributes including suspicious status, enrichment status,
      and populates the entity's additional properties with detailed threat intelligence
      data.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - HOSTNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichHash:
  ai_description: >-
    Enriches File Hash entities using the Cybersixgill Darkfeed Enrichment service.
    This action proactively analyzes and investigates malware hashes as they emerge
    on the dark web, providing intelligence even for malware undetected by traditional
    antivirus vendors. It retrieves metadata such as feed names, source information,
    post titles, actors, and severity levels. Additionally, it integrates data from
    external references like VirusTotal (positive rates) and MITRE ATT&CK (tactics
    and techniques). The action updates the entity's status to 'suspicious' and 'enriched',
    populates additional properties, creates detailed case insights, and attaches
    data tables and external links for deeper investigation.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The API Client ID for Cybersixgill. |

    | Client Secret | String | Yes | The API Client Secret for Cybersixgill. |


    ### Flow Description

    1. **Authentication**: Retrieves the Cybersixgill Client ID and Client Secret
    from the integration configuration.

    2. **Entity Filtering**: Identifies all File Hash entities within the current
    scope.

    3. **External Query**: For each hash, it queries the Cybersixgill Darkfeed API
    for relevant dark web intelligence.

    4. **Data Enrichment**: If data is found, it extracts indicator patterns (e.g.,
    alternative hash formats like MD5 or SHA-1), actor details, and severity scores.

    5. **Internal Update**: Updates the SOAR entities by marking them as 'suspicious'
    and 'enriched', and adds the collected intelligence to the entity's additional
    properties.

    6. **Insight & Visualization**: Generates a comprehensive case insight with MITRE
    and VirusTotal details, adds a formatted data table to the entity, and provides
    direct links to the Cybersixgill portal and other external sources.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates entity attributes by setting 'is_enriched' and 'is_suspicious'
      to true. It also updates entity additional properties with threat intelligence
      data, creates case insights, and adds entity links and data tables within Google
      SecOps.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichIp:
  ai_description: "### General Description\nThe Enrich IP action retrieves threat\
    \ intelligence from Cybersixgill Darkfeed for IP Address entities. It identifies\
    \ if an IP is associated with C&C servers, botnets, DDoS attacks, proxy anonymization,\
    \ or compromised RDP addresses. The action enriches the entity within Google SecOps\
    \ with detailed metadata and marks it as suspicious if threat data is found.\n\
    \n### Parameters Description\n| Parameter Name | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| Client Id | String | Yes | The API Client\
    \ ID used to authenticate with Cybersixgill services. |\n| Client Secret | String\
    \ | Yes | The API Client Secret used to authenticate with Cybersixgill services.\
    \ |\n\n### Additional Notes\n- This action specifically targets `ADDRESS` (IP)\
    \ entities.\n- When data is found, the action automatically marks the entity as\
    \ `is_suspicious = True` and `is_enriched = True`.\n- Enrichment includes external\
    \ references to VirusTotal and MITRE ATT&CK if available in the Sixgill data.\n\
    \n### Flow Description\n1. **Authentication**: The action extracts the `Client\
    \ Id` and `Client Secret` from the integration configuration to initialize the\
    \ Cybersixgill manager.\n2. **Entity Filtering**: It identifies all `ADDRESS`\
    \ entities in the current context.\n3. **External Query**: For each IP address,\
    \ it queries the Cybersixgill Darkfeed API for enrichment data.\n4. **Internal\
    \ Data Mutation**: \n    - Updates entity attributes: Sets `is_enriched` and `is_suspicious`\
    \ flags.\n    - Populates `additional_properties` with Sixgill-specific metadata\
    \ (e.g., Feed Name, Confidence, Severity, Actor).\n5. **Insight & Table Creation**:\
    \ \n    - Generates an Entity Table containing detailed enrichment logs.\n   \
    \ - Creates a Case Insight summarizing the threat intelligence found (including\
    \ MITRE and VirusTotal links).\n    - Adds relevant external URLs as Entity Links.\n\
    6. **Final Result**: Returns a JSON object containing the full enrichment data\
    \ for all processed entities."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes (is_enriched, is_suspicious) and populates the entity's
      'additional_properties' field with threat intelligence data.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichUrl:
  ai_description: >-
    ### General Description

    This action enriches URL entities using Cybersixgill Darkfeed threat intelligence.
    It identifies and investigates URLs associated with malware shared or hosted on
    underground file-sharing and paste sites. The enrichment process retrieves comprehensive
    data including feed names, source details, actor information, severity/confidence
    levels, and cross-references from VirusTotal and MITRE ATT&CK frameworks.


    ### Parameters

    There are no action-specific parameters for this action. It relies on the global
    integration configuration for 'Client Id' and 'Client Secret'.


    ### Flow Description

    1. **Extraction**: Retrieves URL entities from the current SOAR context.

    2. **Intelligence Query**: Connects to the Cybersixgill API using configured credentials
    to fetch threat indicators and enrichment data for each URL.

    3. **Entity Update**: Updates entity attributes in Google SecOps, marking them
    as 'Enriched' and 'Suspicious'. It populates the 'Additional Properties' with
    Cybersixgill-specific metadata.

    4. **Insight Generation**: Creates detailed case insights containing formatted
    threat intelligence, including severity scores and external references.

    5. **Data Visualization**: Adds entity links and data tables to the entity workspace,
    providing direct access to the Cybersixgill portal and summarized VirusTotal/MITRE
    data.


    ### Additional Notes

    While the underlying processor supports multiple entity types, this specific action
    is scoped exclusively to **URL** entities as defined in the script logic.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates internal entity properties, sets the 'is_suspicious' and
      'is_enriched' flags to true, adds entity links, creates data tables, and generates
      case insights.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility function designed to verify the connectivity
    between the Google SecOps platform and the Cybersixgill Darkfeed Enrichment service.
    It ensures that the provided API credentials (Client ID and Client Secret) are
    valid and that the environment can successfully communicate with the external
    Cybersixgill API.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | None | N/A | N/A | This action does not require any input parameters. It utilizes
    global integration configuration settings. |


    ### Additional Notes

    - This action performs a lightweight API call (enriching a placeholder IP address:
    8.8.8.8) to validate the end-to-end communication flow.

    - It is primarily used during the initial setup or troubleshooting phases to confirm
    service availability.


    ### Flow Description

    1.  **Extraction**: The action retrieves the global configuration parameters,
    specifically the **Client Id** and **Client Secret**, from the integration settings.

    2.  **Initialization**: It initializes the `SixgillEnrichManager` using the extracted
    credentials.

    3.  **Connectivity Test**: The action calls the `test_connectivity` method, which
    attempts to authenticate and perform a sample indicator enrichment for a static
    IP address (8.8.8.8).

    4.  **Status Reporting**: Based on the API response, it determines the execution
    state (Success or Failure) and provides a descriptive message back to the Google
    SecOps console.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
