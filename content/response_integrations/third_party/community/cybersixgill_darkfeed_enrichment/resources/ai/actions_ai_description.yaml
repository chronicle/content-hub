Enrich Actor:
  ai_description: >-
    Enriches Threat Actor entities using Cybersixgill Darkfeed intelligence. This
    action retrieves detailed information about a threat actor's activity in the underground,
    including IOCs they have shared over the last 90 days, their choice of targets,
    and techniques used. It maps findings to MITRE ATT&CK tactics and techniques and
    provides VirusTotal reputation data where applicable.


    ### Parameters

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The API Client ID for Cybersixgill authentication.
    |

    | Client Secret | String | Yes | The API Client Secret for Cybersixgill authentication.
    |


    ### Flow Description

    1. **Authentication**: Initializes the Cybersixgill manager using the provided
    Client ID and Secret.

    2. **Entity Filtering**: Identifies all Threat Actor entities within the current
    scope.

    3. **Data Retrieval**: Queries the Cybersixgill API to fetch enrichment data specifically
    for the threat actor identifier.

    4. **Entity Enrichment**: Updates the entity's internal attributes, marking it
    as enriched and suspicious. It populates 'additional_properties' with metadata
    such as description, feed name, source, and severity.

    5. **Insight Generation**: Creates a detailed case insight containing a summary
    of the actor's activity and associated links.

    6. **Data Visualization**: Adds a data table to the entity containing structured
    records of the actor's posts and associated MITRE ATT&CK mappings.

    7. **External Linking**: Attaches direct links to the Cybersixgill portal and
    other external references (like VirusTotal) to the entity.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates entity attributes (is_enriched, is_suspicious), adds custom
      fields to additional_properties, creates case insights, adds entity links, and
      attaches data tables to the case.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - THREATACTOR
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Domain:
  ai_description: >-
    ### General Description

    The **Enrich Domain** action leverages Cybersixgill Darkfeed intelligence to enrich
    Hostname entities. It specifically identifies domains associated with compromised
    sites or those being traded on dark web marketplaces. The action provides deep
    context, including threat actor details, post titles, and severity levels, helping
    analysts understand the dark web exposure of a domain.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The Client ID for Cybersixgill API authentication.
    |

    | Client Secret | String | Yes | The Client Secret for Cybersixgill API authentication.
    |


    ### Flow Description

    1. **Authentication**: Initializes the Cybersixgill manager using the provided
    Client ID and Secret.

    2. **Entity Filtering**: Identifies all `HOSTNAME` entities within the current
    context.

    3. **Intelligence Retrieval**: For each domain, it queries the Cybersixgill Darkfeed
    for matching Indicators of Compromise (IOCs) or actor mentions.

    4. **Entity Enrichment**:
       - Updates the entity's `additional_properties` with Sixgill-specific metadata
    (e.g., Feed Name, Source, Actor, Confidence).
       - Marks the entity as `suspicious` and `enriched`.
    5. **Case Documentation**:
       - Creates a detailed **Case Insight** summarizing the findings.
       - Adds a **Data Table** to the entity containing structured intelligence.
       - Attaches **External Links** to the Cybersixgill portal and third-party sources
    like VirusTotal or MITRE ATT&CK if available.

    ### Additional Notes

    This action is read-only regarding external systems but performs significant internal
    data enrichment within Google SecOps. While the underlying processor supports
    multiple entity types, this specific action is scoped to Hostnames.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes (additional properties), marks entities as suspicious/enriched,
      creates case insights, and adds data tables and external links to the case.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - HOSTNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Hash:
  ai_description: >-
    ### General Description

    Enriches **File Hash** entities using Cybersixgill Darkfeed intelligence. This
    action proactively investigates malware hashes as they emerge on the dark web,
    providing context even for malware undetected by traditional AV vendors. It retrieves
    metadata such as feed names, sources, actor information, and severity scores.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The Client ID for Cybersixgill API authentication.
    |

    | Client Secret | String | Yes | The Client Secret for Cybersixgill API authentication.
    |


    ### Flow Description

    1. **Authentication**: Initializes the Cybersixgill client using the provided
    credentials.

    2. **Data Retrieval**: Iterates through File Hash entities and queries the Cybersixgill
    Darkfeed for matching indicators.

    3. **Entity Enrichment**: Updates the entity's `is_enriched` and `is_suspicious`
    flags. It also populates `additional_properties` with detailed intelligence (e.g.,
    MD5/SHA aliases, severity, confidence).

    4. **Insight Generation**: Creates a detailed case insight for each entity, including
    VirusTotal and MITRE ATT&CK references if available.

    5. **Visualization**: Adds a data table to the entity and provides external links
    to the Cybersixgill portal.


    ### Additional Notes

    This action specifically targets `FILEHASH` entities. While the underlying processor
    supports other types, this action is scoped to hashes.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes including 'is_enriched', 'is_suspicious', and 'additional_properties'.
      It also creates case insights and adds data tables to entities.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich IP:
  ai_description: "Enriches IP Address entities using Cybersixgill Darkfeed threat\
    \ intelligence. This action identifies IP addresses associated with Command and\
    \ Control (C&C) servers, botnets, DDoS attacks, proxy anonymization, and compromised\
    \ RDP addresses. It retrieves detailed metadata including confidence scores, severity,\
    \ and external references like VirusTotal reputation and MITRE ATT&CK mappings.\n\
    \n### Parameters\n| Parameter Name | Type | Mandatory | Description |\n| :---\
    \ | :--- | :--- | :--- |\n| Client Id | String | Yes | The API Client ID for Cybersixgill\
    \ authentication. |\n| Client Secret | String | Yes | The API Client Secret for\
    \ Cybersixgill authentication. |\n\n### Flow Description\n1. **Authentication:**\
    \ The action initializes a connection to Cybersixgill using the provided Client\
    \ ID and Client Secret.\n2. **Data Retrieval:** For each IP Address entity in\
    \ the scope, the action queries the Cybersixgill Darkfeed API for IOC enrichment\
    \ data.\n3. **Data Parsing:** The action parses the returned STIX-formatted data,\
    \ extracting attributes such as feed names, actors, confidence levels, and severity.\n\
    4. **External Enrichment:** It specifically looks for external references to VirusTotal\
    \ (positive rates) and MITRE ATT&CK (tactics and techniques).\n5. **Internal Updates:**\
    \ \n    * Updates the entity's `additional_properties` with Sixgill-specific metadata.\n\
    \    * Marks the entity as `is_enriched` and `is_suspicious`.\n    * Adds external\
    \ links to the Cybersixgill portal and VirusTotal/MITRE URLs.\n6. **Reporting:**\
    \ Generates a detailed Case Insight and a data table for each processed entity\
    \ containing the full enrichment summary."
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates entity attributes (additional_properties), sets the 'is_enriched'
      and 'is_suspicious' flags to true, and creates case insights and entity tables.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich URL:
  ai_description: >-
    ### General Description

    Enriches URL entities using Cybersixgill Darkfeed threat intelligence. This action
    identifies, investigates, and retrieves context for URLs that may be hosted on
    or shared via underground file-sharing and paste sites. It provides deep visibility
    into dark web activity, including associated malware, threat actors, and campaign
    details.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The Client ID for authenticating with the Cybersixgill
    API. |

    | Client Secret | String | Yes | The Client Secret for authenticating with the
    Cybersixgill API. |


    ### Flow Description

    1. **Authentication**: The action extracts the `Client Id` and `Client Secret`
    from the configuration to authenticate with the Cybersixgill service.

    2. **Entity Filtering**: It identifies all `URL` entities within the current context.

    3. **Data Retrieval**: For each URL, it queries the Cybersixgill Darkfeed to find
    matching Indicators of Compromise (IoCs) or actor mentions.

    4. **Entity Enrichment**: If a match is found, the entity is marked as suspicious
    and enriched. Detailed metadata (e.g., severity, confidence, feed name, source)
    is added to the entity's additional properties.

    5. **Insight Generation**: The action creates a detailed Case Insight for each
    enriched entity, including VirusTotal reputation scores and MITRE ATT&CK tactic/technique
    mappings where available.

    6. **Output Generation**: It populates a data table with the findings and adds
    direct links to the Cybersixgill portal for deeper investigation.


    ### Additional Notes

    This action is read-only regarding external systems and is designed specifically
    for threat intelligence enrichment.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes (is_enriched, is_suspicious, additional_properties),
      creates case insights, and adds data tables and links to entities.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility used to verify the connectivity between
    Google SecOps and the Cybersixgill Darkfeed Enrichment service. It ensures that
    the integration is properly configured and that the provided API credentials (Client
    ID and Client Secret) are valid and authorized to make requests.


    ### Parameters

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Client Id | String | Yes | The Client ID used for authentication with the Cybersixgill
    API (extracted from integration configuration). |

    | Client Secret | String | Yes | The Client Secret used for authentication with
    the Cybersixgill API (extracted from integration configuration). |


    ### Additional Notes

    * This action does not process any entities from the Google SecOps case.

    * It uses a hardcoded IP address (`8.8.8.8`) to perform a test enrichment query
    to validate the end-to-end communication path.


    ### Flow Description

    1. **Credential Extraction:** The action retrieves the `Client Id` and `Client
    Secret` from the integration's configuration parameters.

    2. **Manager Initialization:** It initializes the `SixgillEnrichManager` and the
    `SixgillActionResultProcessor` to handle the API interaction.

    3. **Connectivity Verification:** The action attempts to create a `SixgillEnrichClient`
    and executes a test enrichment request for the IP `8.8.8.8` using the `enrich_ioc`
    method.

    4. **Status Reporting:** If the request is successful, the action returns a success
    message. If the connection fails or credentials are invalid, it catches the exception
    and returns a failure status with the specific error message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
