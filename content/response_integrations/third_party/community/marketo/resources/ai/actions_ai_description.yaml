Create lead:
  ai_description: >-
    ### General Description

    Creates a new lead in Marketo using specific user details. This action is designed
    to programmatically register a person as a lead within the Marketo marketing automation
    platform by providing their contact information.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Email | String | Yes | The email address of the new lead. This is used as the
    primary lookup field. |

    | First Name | String | Yes | The first name of the new lead. |

    | Last Name | String | Yes | The last name of the new lead. |

    | Country | String | Yes | The country of the new lead. |


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves Marketo configuration (Client
    ID, Secret, Munchkin ID) and the specific lead details (Email, First Name, Last
    Name, Country) from the action parameters.

    2. **Client Initialization**: Initializes the Marketo Python client using the
    provided credentials.

    3. **Lead Creation**: Sends a request to Marketo's API using the `create_update_leads`
    method with the `createOnly` action. This ensures that a new lead is created rather
    than updating an existing one.

    4. **Response Handling**: Parses the API response. If the lead is successfully
    created, it returns the Lead ID. If the API returns an error or a specific reason
    for failure, the action reports a failure.

    5. **Result Reporting**: Adds the raw JSON response to the action results and
    provides a human-readable status message.


    ### Additional Notes

    This action does not run on entities; it relies entirely on the manual input of
    parameters.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new lead record in the Marketo marketing automation platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Lead By Email Param:
  ai_description: >-
    ### General Description: Retrieves lead information from Marketo for a specific
    email address provided as a parameter. This action is useful for identifying if
    a user exists in Marketo and obtaining their associated lead ID and other profile
    details. ### Parameters Description: | Parameter | Type | Mandatory | Description
    | | :--- | :--- | :--- | :--- | | Email | String | Yes | The email address of
    the user you want to retrieve details for. | ### Flow Description: 1. **Initialization**:
    The action initializes the Marketo client using the provided Client ID, Client
    Secret, and Munchkin ID from the integration configuration. 2. **Parameter Extraction**:
    It retrieves the Email parameter and converts it to lowercase. 3. **Data Retrieval**:
    It executes a query against Marketo's API to find leads matching the specified
    email address. 4. **Result Processing**: If a lead is found, it captures the lead
    ID and details. If no lead is found, it reports the absence. 5. **Output**: The
    action returns the raw lead data as a JSON result and provides a human-readable
    summary in the output message. ### Additional Notes: This action does not process
    entities from the case; it relies solely on the provided Email parameter.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Lead By Entity Email:
  ai_description: >-
    ### General Description

    Retrieves lead information from Marketo for email-based entities. This action
    is designed to enrich user entities with marketing context, such as names and
    lead IDs, by querying the Marketo database using the entity's email address.


    ### Parameters

    There are no action-specific parameters for this action. It utilizes the global
    integration configuration parameters: `Client Id`, `Client Secret`, and `Munchkin
    Id` to authenticate with the Marketo API.


    ### Flow Description

    1. **Initialization**: The action initializes the Marketo client using the configuration
    parameters provided in the integration settings.

    2. **Entity Filtering**: It iterates through the target entities in the current
    context, filtering for entities of type `USER` that have an identifier matching
    a valid email address format (via regex).

    3. **Data Retrieval**: For each valid entity, the action executes a query to the
    Marketo API (`get_multiple_leads_by_filter_type`) using the email address as the
    filter.

    4. **Enrichment**: If lead details are successfully retrieved, the action extracts
    the `firstName`, `lastName`, `email`, and `id` (LeadID).

    5. **Internal Update**: The action updates the entity's `additional_properties`
    with the extracted Marketo data and sets the `is_enriched` flag to `True`.

    6. **Finalization**: The action updates the entities within Google SecOps, adds
    a JSON result containing the enrichment details and lead count, and completes
    the execution with a summary message.


    ### Additional Notes

    The action performs a strict regex validation on the entity identifier to ensure
    it is a valid email address before attempting to query Marketo. Entities that
    do not meet the criteria (type `USER` and valid email format) are skipped.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity additional properties with lead information from Marketo and
      sets the is_enriched flag to true.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility used to verify the connectivity between
    Google SecOps and the Marketo instance. Its primary purpose is to validate that
    the integration's configuration parameters (Client ID, Client Secret, and Munchkin
    ID) are correct and that the network path to the Marketo API is open.


    ### Parameters Description

    This action does not require any user-provided input parameters at runtime. It
    utilizes the following integration configuration parameters:

    * **Client Id**: The unique identifier for the Marketo API client.

    * **Client Secret**: The secret key associated with the Marketo API client.

    * **Munchkin Id**: The unique account identifier for the Marketo instance.


    ### Flow Description

    1. **Parameter Retrieval**: The action extracts the `Client Id`, `Client Secret`,
    and `Munchkin Id` from the Marketo integration configuration.

    2. **Client Initialization**: It initializes the `MarketoClient` using the extracted
    credentials.

    3. **API Validation**: The action performs a test API call (`get_lead_by_id`)
    using a hardcoded ID (1). This step confirms that the client can successfully
    authenticate and retrieve data from Marketo.

    4. **Execution Completion**: If the API call is successful, the action terminates
    with a success status, indicating the connection is functional.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Request Campaign:
  ai_description: >-
    ### General Description

    The **Request Campaign** action triggers a specific Marketo campaign for a designated
    lead. It allows security teams or marketers to programmatically initiate marketing
    workflows or communication sequences directly from Google SecOps by providing
    the necessary identifiers and optional dynamic tokens.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Campaign Id** | string | Yes | The unique numerical identifier of the Marketo
    campaign to be executed. |

    | **Lead Id** | string | Yes | The unique numerical identifier of the lead (contact)
    for whom the campaign is being requested. |

    | **Tokens Json** | string | No | A JSON-formatted string representing key-value
    pairs (tokens) to be passed into the campaign for personalization or logic branching.
    |


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves the Marketo configuration (Client
    ID, Secret, Munchkin ID) and the action-specific parameters (Campaign ID, Lead
    ID, and Tokens JSON).

    2. **Token Processing:** If provided, the `Tokens Json` is parsed into a dictionary.
    The code performs a basic normalization by lowercasing keys (excluding those containing
    'password').

    3. **API Execution:** The action initializes the Marketo client and calls the
    `request_campaign` method, passing the campaign ID, the lead ID (as a list), and
    the processed tokens.

    4. **Result Handling:** If the API call is successful, the action completes with
    a success message. If an error occurs during the process, it logs the exception
    and fails the action.


    ### Additional Notes

    * This action does not operate on SecOps entities (like IP or Hostname). It requires
    explicit IDs provided as parameters.

    * The `Campaign Id` and `Lead Id` are treated as integers by the underlying SDK
    logic.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Triggers a campaign execution within the Marketo platform for a specific lead,
      which initiates external marketing workflows.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
