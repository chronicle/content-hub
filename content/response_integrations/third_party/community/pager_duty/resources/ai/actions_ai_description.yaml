Create Incident:
  ai_description: >-
    ### General Description

    Creates a new incident in PagerDuty with specified details, title, and urgency.
    This action allows for automated escalation of security events by programmatically
    opening incidents within the PagerDuty platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Title | string | Yes | The summary or title of the incident to be created in
    PagerDuty. |

    | Email | string | Yes | The email address of the PagerDuty user associated with
    the incident creation. This is used in the 'From' header required by the PagerDuty
    API. |

    | Urgency | string | Yes | The urgency level of the incident, typically 'high'
    or 'low'. |

    | Details | string | Yes | A comprehensive description or body of the incident
    providing context for the responder. |


    ### Additional Notes

    This action requires the 'Services' configuration parameter to be set in the PagerDuty
    integration settings, as it defines the specific PagerDuty service the incident
    will be attached to.


    ### Flow Description

    1. **Configuration Retrieval**: The action fetches the API token and Service ID
    from the integration's global configuration.

    2. **Parameter Parsing**: It extracts the Title, Email, Urgency, and Details provided
    by the user or playbook.

    3. **API Request**: The action uses the PagerDutyManager to send a POST request
    to the PagerDuty `/incidents` endpoint with the constructed payload.

    4. **Response Processing**: If successful, the full incident object returned by
    PagerDuty is added to the action's JSON results, and the action completes with
    a success message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new incident record in the PagerDuty platform via a POST request to
      the /incidents endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Filtered Incident List:
  ai_description: >-
    ### General Description

    This action retrieves a filtered list of incidents from PagerDuty based on a wide
    variety of criteria such as status, urgency, assigned users, teams, and date ranges.
    It is primarily used for searching and auditing incidents within the PagerDuty
    platform directly from Google SecOps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Email | String | Yes | The email address of the user making the request. Note:
    While mandatory in the configuration, it is primarily used for PagerDuty's 'From'
    header requirements in other actions; in this specific action, it is extracted
    but not actively used in the filtering logic. |

    | Additional_Data | Multi-select | No | Allows including additional details in
    the response, such as 'users', 'services', 'assignees', or 'teams'. |

    | sort_by | Multi-select | No | Determines the field to sort by (e.g., 'created_at',
    'urgency') and the order ('asc', 'desc'). |

    | Urgencies | Multi-select | No | Filters incidents by urgency level ('high' or
    'low'). |

    | User_IDS | String | No | A list or single ID of users to filter incidents by.
    Supports JSON-formatted lists. |

    | Team_IDS | String | No | A list or single ID of teams to filter incidents by.
    Supports JSON-formatted lists. |

    | Incident_Key | String | No | Filters incidents by a specific incident key. |

    | Incidents_Statuses | Multi-select | No | Filters incidents by their current
    state: 'triggered', 'acknowledged', or 'resolved'. |

    | Data_Range | String | No | A predefined string representing a date range. |

    | Since | String | No | The start date for the search in YYYY-MM-DD format. |

    | Until | String | No | The end date for the search in YYYY-MM-DD format. |

    | Service_IDS | String | No | A list or single ID of services to filter incidents
    by. Supports JSON-formatted lists. |


    ### Additional Notes

    - Parameters like `User_IDS`, `Team_IDS`, and `Service_IDS` can accept either
    a single string ID or a JSON-formatted list of strings (e.g., `["ID1", "ID2"]`).

    - The action does not interact with entities in the current Google SecOps case;
    it performs a global search based on the provided parameters.


    ### Flow Description

    1. **Initialization**: The action initializes the PagerDuty manager using the
    provided API token.

    2. **Parameter Extraction**: It extracts all filter parameters from the action
    configuration.

    3. **Parsing**: It attempts to parse string parameters that might contain JSON
    lists (like IDs) into Python lists and removes any empty or null values.

    4. **Query Construction**: It builds a dictionary of query parameters compatible
    with the PagerDuty API's `/incidents` endpoint.

    5. **API Request**: It executes a GET request to PagerDuty to retrieve the incidents
    matching the filters.

    6. **Result Processing**: The retrieved incidents are added to the action's JSON
    results, and the action completes with a success message if incidents are found.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Incident By ID:
  ai_description: >-
    ### General Description

    Retrieves detailed information about a specific PagerDuty incident using its unique
    identifier. This action is useful for incident response workflows where specific
    PagerDuty incident data is required for investigation or synchronization within
    Google SecOps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Incident Key | string | Yes | The unique identifier (Incident Key) of the PagerDuty
    incident to retrieve. |

    | Email | string | Yes | The email address of the PagerDuty user performing the
    action. This is required by PagerDuty's API for the 'From' header to track who
    is making the request. |


    ### Additional Notes

    - This action does not run on entities; it requires a specific Incident Key as
    input.

    - The action performs a read-only operation and does not modify any data in PagerDuty.


    ### Flow Description

    1. **Parameter Extraction**: The action extracts the `Incident Key` and the requester's
    `Email` from the input parameters.

    2. **Manager Initialization**: Initializes the PagerDuty API manager using the
    configured API token.

    3. **Data Retrieval**: Sends a GET request to the PagerDuty `/incidents` endpoint,
    passing the requester's email in the 'From' header.

    4. **Filtering**: Iterates through the retrieved incidents to find the one matching
    the provided `Incident Key`.

    5. **Result Processing**: If found, the incident details are added to the action's
    JSON results. If not found, a failure status is returned.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get User By Email:
  ai_description: >-
    ### General Description

    Retrieves detailed information for a specific PagerDuty user using their email
    address. This action is useful for identifying user IDs, roles, and contact information
    within PagerDuty based on a known email address provided as an input parameter.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Email | String | Yes | The email address of the PagerDuty user to retrieve information
    for. Defaults to 'test@example.com'. |


    ### Flow Description

    1. **Initialization**: The action initializes the PagerDuty manager using the
    API key from the integration configuration.

    2. **Parameter Retrieval**: It retrieves the target email address from the action
    parameters.

    3. **API Request**: It performs a GET request to the PagerDuty `/users` endpoint,
    using the email as a query parameter.

    4. **Data Filtering**: The action iterates through the list of users returned
    by the API to find an exact match for the provided email address.

    5. **Result Handling**: If a match is found, the user's full profile is added
    to the action's JSON results. If no user is found or the request fails, the action
    reports a failure.


    ### Additional Notes

    This action does not interact with Google SecOps entities. It relies entirely
    on the 'Email' input parameter to perform the lookup.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get User By ID:
  ai_description: "### General Description\nThe **Get User By ID** action retrieves\
    \ comprehensive details for a specific PagerDuty user based on their unique User\
    \ ID. This action is used to fetch metadata such as the user's name, email, time\
    \ zone, role, and contact methods directly from the PagerDuty platform.\n\n###\
    \ Parameters Description\n| Parameter | Type | Mandatory | Description |\n| :---\
    \ | :--- | :--- | :--- |\n| **UserID** | String | Yes | The unique identifier\
    \ (ID) of the user in PagerDuty (e.g., 'PXP9SRE'). |\n\n### Flow Description\n\
    1. **Parameter Extraction**: The action retrieves the `UserID` from the input\
    \ parameters and the API key from the integration configuration.\n2. **API Initialization**:\
    \ The `PagerDutyManager` is initialized to handle communication with the PagerDuty\
    \ API.\n3. **Data Retrieval**: The action performs a GET request to the PagerDuty\
    \ `/users/{id}` endpoint using the provided User ID.\n4. **Result Processing**:\
    \ \n    * If the user is found, the action retrieves the user object, adds it\
    \ to the JSON results, and completes successfully.\n    * If the user is not found\
    \ or an error occurs, the action captures the error and terminates with a failure\
    \ status.\n\n### Additional Notes\nThis action does not interact with or iterate\
    \ over Google SecOps entities. It operates exclusively based on the provided `UserID`\
    \ parameter."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List All OnCall:
  ai_description: >-
    ### General Description

    The **List All OnCall** action retrieves a comprehensive list of all current on-call
    shifts and schedules from the PagerDuty platform. This utility action is designed
    to provide visibility into which users or teams are currently active and responsible
    for incident response at any given time.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    This action does not require or process any Google SecOps entities. It performs
    a global data retrieval from the PagerDuty API and returns the raw JSON data for
    use in subsequent playbook steps.


    ### Flow Description

    1. **Initialization**: The action initializes the PagerDuty API manager using
    the API token provided in the integration's configuration settings.

    2. **API Request**: It sends a GET request to the PagerDuty `/oncalls` endpoint
    to fetch the current on-call list.

    3. **Data Handling**: The action captures the list of on-call entries from the
    API response.

    4. **Output**: The retrieved data is added to the action's JSON results, and the
    action completes with a success message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Incidents:
  ai_description: >-
    ### General Description

    The **List Incidents** action retrieves a complete list of all incidents from
    the PagerDuty platform. It is designed to provide visibility into external incident
    management data by fetching all records associated with the configured PagerDuty
    account and making them available within the Google SecOps environment.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    * This action does not require or process any entities from the Google SecOps
    case.

    * The retrieved data is returned as a JSON object for use in subsequent playbook
    steps.

    * Although the metadata description mentions 'hostname Parameters', the implementation
    performs a global fetch of all incidents without filtering.


    ### Flow Description

    1. **Configuration Retrieval**: The action starts by fetching the PagerDuty API
    key from the integration settings.

    2. **Manager Initialization**: It initializes the PagerDuty API manager to handle
    communication with the external service.

    3. **Data Retrieval**: The action calls the PagerDuty API's `/incidents` endpoint
    to fetch all available incident records.

    4. **Result Processing**: The retrieved list of incidents is attached to the action's
    execution results as a JSON object.

    5. **Finalization**: The action completes with a success message if incidents
    are found, or a 'not found' message if the list is empty.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Users:
  ai_description: >-
    ### General Description

    The **List Users** action retrieves a comprehensive list of all users associated
    with the PagerDuty account. This action is used to gather administrative data
    about the PagerDuty environment, providing details such as user names, emails,
    roles, and contact methods. It is a global action that does not require specific
    entities to execute.


    ### Parameters Description

    There are no input parameters for this action.


    ### Additional Notes

    This action returns the raw JSON response from the PagerDuty API, which can be
    used in subsequent playbook steps to map PagerDuty users to internal identities
    or to identify on-call personnel.


    ### Flow Description

    1. **Initialization**: The action initializes the PagerDuty manager using the
    API token provided in the integration's configuration.

    2. **API Request**: It executes a GET request to the PagerDuty `/users` endpoint
    to fetch all user records.

    3. **Data Handling**: The retrieved user data is processed and added to the action's
    JSON result output.

    4. **Finalization**: The action completes with a success message if users are
    found, or a failure message if an error occurs during the API call.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Tests connectivity to the PagerDuty API to verify that the integration is correctly
    configured and the API key is valid. This action is primarily used for health
    checks and troubleshooting connection issues.


    ### Parameters Description

    There are no action parameters for this action. It uses the `api_key` defined
    in the integration's configuration settings.


    ### Flow Description

    1. **Configuration Retrieval**: The action retrieves the mandatory `api_key` from
    the PagerDuty integration configuration.

    2. **Client Initialization**: It initializes the `PagerDutyManager` with the retrieved
    API key.

    3. **API Request**: It performs a GET request to the PagerDuty `/abilities` endpoint
    to verify authentication and connectivity.

    4. **Outcome**: If the request is successful, it returns a success message. If
    the request fails (e.g., invalid API key or network issues), it returns an error
    message.


    ### Additional Notes

    This action does not interact with any entities or modify any data within Google
    SecOps or PagerDuty.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Run Response Play:
  ai_description: >-
    ### General Description

    Runs a specified PagerDuty response play on a given incident. This action allows
    users to trigger automated workflows or response patterns defined within PagerDuty
    directly from Google SecOps. Note: This action is marked as deprecated.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Email | string | Yes | The email address of the PagerDuty user performing the
    action. This is used in the 'From' header of the API request. |

    | Response ID | string | Yes | The unique identifier (ID) of the response play
    to be executed. |

    | Incident_ID | string | Yes | The unique identifier (ID) of the PagerDuty incident
    on which the response play should be run. |


    ### Additional Notes

    - This action does not process Google SecOps entities; it relies entirely on the
    provided parameter values.

    - The action is deprecated and may be replaced by newer PagerDuty integration
    features.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the user's email, the Response
    Play ID, and the Incident ID from the input parameters.

    2. **API Initialization**: It initializes the PagerDuty manager using the configured
    API token.

    3. **Execution**: It sends a POST request to the PagerDuty API endpoint `/response_plays/{response_plays_id}/run`
    with the incident reference in the payload.

    4. **Result Handling**: The action captures the API response, adds it to the JSON
    results, and reports the execution status (Success or Failure) to the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Triggers a response play in PagerDuty, which can change the state of an incident,
      notify users, or initiate automated response workflows.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Snooze Incident:
  ai_description: >-
    ### General Description

    The **Snooze Incident** action allows users to temporarily silence a PagerDuty
    incident for a predefined period (1 hour). By providing a specific Incident ID
    and the email address of the requester, the action updates the incident's state
    in PagerDuty to 'snoozed', preventing further notifications until the snooze period
    expires or the incident is resolved.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Email** | String | Yes | The email address of the PagerDuty user performing
    the action. This is used in the 'From' header for API authentication and auditing.
    |

    | **IncidentID** | String | Yes | The unique identifier of the PagerDuty incident
    that needs to be snoozed. |


    ### Additional Notes

    - The snooze duration is currently hardcoded within the integration logic to **3600
    seconds (1 hour)**.

    - This action does not run on entities; it requires the specific Incident ID to
    be provided as an input parameter.


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves the `Email` and `IncidentID`
    from the user input.

    2. **Manager Initialization:** Initializes the PagerDuty API manager using the
    configured API key.

    3. **API Request:** Executes a POST request to the PagerDuty `/incidents/{incident_id}/snooze`
    endpoint with a payload specifying a 3600-second duration.

    4. **Result Processing:** If successful, the action captures the updated incident
    details and attaches them as a JSON result. If the API returns an error (e.g.,
    404 Not Found), the action fails with a descriptive error message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of an existing incident in PagerDuty to 'snoozed', which
      changes its state and suppresses notifications for a set duration.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
