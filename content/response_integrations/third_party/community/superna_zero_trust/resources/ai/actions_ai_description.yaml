Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify connectivity and
    validate the health status of the Superna Eyeglass Zero Trust API. It ensures
    that the Google SecOps environment can successfully communicate with the Superna
    Eyeglass server using the provided credentials and network configuration.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **api_token** | String | Yes | The API key used for authentication with the
    Superna Eyeglass Zero Trust service. |

    | **eyeglass_ip** | String | Yes | The IP address or hostname of the Superna Eyeglass
    server. |

    | **Verify SSL** | Boolean | No | Determines whether to verify the SSL certificate
    of the Eyeglass server. Defaults to `False`. |


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the `api_token`, `eyeglass_ip`,
    and `Verify SSL` settings from the integration configuration.

    2. **Endpoint Construction**: It constructs the full API URL targeting the `/sera/v1/healthcheck`
    endpoint on the specified Eyeglass server.

    3. **Health Check Execution**: The action performs an authenticated HTTP GET request
    to the health check endpoint.

    4. **Error Handling**: The script includes robust error handling for timeouts,
    connection failures, and HTTP errors (e.g., 401 Unauthorized or 404 Not Found).

    5. **Result Reporting**: The action returns the raw response text from the server
    and sets the execution state to `COMPLETED`, `FAILED`, or `TIMEDOUT` based on
    the request outcome.


    ### Additional Notes

    - This action does not interact with entities or alerts; it is strictly for integration
    health monitoring and troubleshooting.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Superna Snapshot Critical NAS Data:
  ai_description: >-
    ### General Description

    Triggers a snapshot of critical NAS (Network Attached Storage) data using the
    Superna Zero Trust API. This action is designed to protect critical data paths
    by initiating a snapshot via the Superna Eyeglass platform, typically as a response
    to ransomware threats or as a proactive security measure.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | api_token | String | Yes | The API key used to authenticate with the Superna
    Eyeglass server. This is retrieved from the integration configuration. |

    | eyeglass_ip | String | Yes | The IP address or hostname of the Superna Eyeglass
    server. This is retrieved from the integration configuration. |

    | Verify SSL | Boolean | No | If enabled, the action will verify the SSL certificate
    of the Superna Eyeglass server. Defaults to `False`. |


    ### Additional Notes

    This action does not operate on specific entities (e.g., IPs, Hostnames). It performs
    a global operation against the Superna Eyeglass platform based on the provided
    configuration parameters.


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the API token, Eyeglass IP,
    and SSL verification preference from the integration's configuration settings.

    2. **URL Construction**: It constructs the target API endpoint URL using the provided
    Eyeglass IP and the specific route for critical NAS paths (`/sera/v2/ransomware/criticalpaths`).

    3. **API Execution**: The action sends a POST request to the Superna Eyeglass
    server. It includes the API key in the request headers for authentication.

    4. **Response Processing**: The action captures the server's response. If the
    request is successful, it returns the response text and marks the action as completed.
    It also includes robust error handling for timeouts, connection issues, and HTTP
    errors.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates a snapshot of critical NAS data on the Superna Eyeglass platform via
      a POST request to the ransomware critical paths endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Superna Zero Trust User Lockout:
  ai_description: >-
    ### General Description

    Locks out a suspected user from all Superna protected NAS storage. This action
    interacts with the Superna Eyeglass Zero Trust API to resolve user permissions
    and apply a deny read permission to SMB shares, effectively isolating the user
    from the storage environment to prevent potential data exfiltration or ransomware
    spread.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | UserName | String | Yes | The user to be locked out of NAS storage. The value
    should be provided in the format `domain\username` or `user@domain`. |


    ### Flow Description

    1. **Configuration Retrieval**: The action fetches the API token, Eyeglass IP
    address, and SSL verification settings from the integration's configuration.

    2. **Input Preparation**: The target `UserName` is extracted from the action parameters
    and URL-encoded to ensure it is safely transmitted in the API request path.

    3. **API Execution**: A POST request is dispatched to the Superna Eyeglass endpoint
    (`/sera/v2/ransomware/lockout/{user}`).

    4. **Error Handling**: The script monitors for timeouts, connection failures,
    and HTTP errors, providing specific feedback for each failure state.

    5. **Completion**: Upon a successful request, the action returns the response
    text from the Superna server and marks the execution as completed.


    ### Additional Notes

    This action performs a state-changing operation on the external NAS storage system.
    Ensure the `UserName` is accurate to avoid accidental lockouts of legitimate users.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates a lockout command on the Superna Eyeglass server which modifies user
      permissions on NAS storage and applies deny read permissions to SMB shares.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Superna Zero Trust User Un Lock:
  ai_description: >-
    ### General Description

    This action unlocks a user account that was previously locked out from Superna
    protected NAS storage. It is typically used as a remediation step to restore access
    after a security incident or false positive lockout triggered by Zero Trust policies.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | UserName | String | Yes | The identifier of the user to be unlocked. The value
    should be provided in the format `domain\username` or `username@domain`. This
    value is URL-encoded before being sent to the API. |


    ### Additional Notes

    - This action requires the `api_token` and `eyeglass_ip` to be configured in the
    integration settings.

    - The action performs a state-changing operation (POST) on the external Superna
    Eyeglass system.


    ### Flow Description

    1. **Configuration Retrieval**: The action fetches the API token, Eyeglass IP,
    and SSL verification settings from the integration configuration.

    2. **Parameter Extraction**: It retrieves the `UserName` provided in the action
    parameters.

    3. **Data Preparation**: The username is URL-encoded to ensure it is safely transmitted
    within the API endpoint path.

    4. **API Execution**: A POST request is sent to the Superna Eyeglass API endpoint
    (`/sera/v2/ransomware/unlock/{user}`).

    5. **Response Handling**: The action evaluates the HTTP response. If successful,
    it marks the execution as completed; otherwise, it handles timeouts, connection
    errors, or HTTP failures and reports the specific error back to the case.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action performs a POST request to the Superna Eyeglass API to change the
      status of a user account from locked to unlocked across protected NAS storage.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
