Check Url:
  ai_description: >-
    ### General Description

    Checks URL entities against the PhishTank database to determine if they are associated
    with phishing activity. This action provides real-time reputation data, including
    verification status and links to PhishTank detail pages, helping analysts identify
    malicious URLs within a case.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Service Url | String | Yes | The API endpoint for the PhishTank service, configured
    at the integration level. |


    ### Flow Description

    1. **Entity Filtering**: The action identifies all `URL` entities within the current
    scope.

    2. **External Lookup**: For each URL, it sends a request to the PhishTank API
    to check its status in their database.

    3. **Data Parsing**: It processes the response to extract key details such as
    whether the URL is in the database, if it has been verified as phishing, and its
    validity.

    4. **Insight Generation**: An entity insight is created for every processed URL,
    containing the PhishTank detail link and verification status.

    5. **Entity Update**: If a URL is confirmed and verified as phishing, the action
    marks the entity as suspicious within Google SecOps.

    6. **Result Reporting**: The action concludes by providing a summary of found,
    verified, and missing URLs, along with detailed JSON results for further analysis.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates the 'is_suspicious' attribute of URL entities if they are verified as
      phishing in PhishTank and adds entity insights to the case.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool used to verify the connectivity between
    Google SecOps and the PhishTank API. Its primary purpose is to ensure that the
    integration is correctly configured and that the environment can successfully
    communicate with the PhishTank service.


    ### Parameters Description

    This action does not require any user-provided parameters at runtime. It utilizes
    the global integration configuration.


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Service Url | String | Yes | The base URL for the PhishTank API, retrieved from
    the integration's shared configuration settings. |


    ### Additional Notes

    - The action performs a hardcoded check by querying the status of 'google.com'
    against the PhishTank database to validate the API response format and connectivity.

    - No entities are processed or modified during this action.


    ### Flow Description

    1. **Configuration Extraction**: The script retrieves the `Service Url` from the
    PhishTank integration settings.

    2. **API Request**: It sends an HTTP POST request to the service URL with a test
    payload containing a sample URL ('google.com') and a request for a JSON response.

    3. **Response Validation**: The action uses standard HTTP status code validation
    to ensure the service responded successfully.

    4. **Status Reporting**: If the request is successful, the action terminates with
    a success message indicating that PhishTank is connected.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
