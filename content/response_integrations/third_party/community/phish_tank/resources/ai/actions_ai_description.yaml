Check Url:
  ai_description: >-
    ### General Description

    This action checks URL entities against the PhishTank database to determine if
    they are associated with phishing activities. It identifies whether a URL is known,
    verified, and currently valid within the PhishTank community. Based on the findings,
    the action enriches the entity by adding detailed insights and marking the entity
    as suspicious if it is verified as a phishing link.


    ### Parameters Description

    | Parameter | Usage | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- | :--- |

    | Service Url | Configuration | String | Yes | The API endpoint URL for the PhishTank
    service, used to perform the lookups. This is an integration-level configuration
    parameter. |


    ### Additional Notes

    * The action uses the PhishTank API with an XML response format, which is then
    parsed into JSON for processing.

    * If a URL is found and verified in the database, the action automatically marks
    the entity as suspicious in Google SecOps.


    ### Flow Description

    1. **Extraction**: Retrieve the PhishTank Service URL from the integration configuration.

    2. **Filtering**: Identify all `URL` entities within the current scope.

    3. **Querying**: For each URL, send a POST request to the PhishTank API to check
    its status.

    4. **Analysis**: Parse the XML response to extract phishing details such as the
    detail page link, verification status, and validity.

    5. **Enrichment**: Create an entity insight containing the retrieved metadata.

    6. **Internal Update**: If the URL is verified as a phish, update the entity's
    status to 'suspicious'.

    7. **Reporting**: Aggregate the results for all processed entities and provide
    a summary message and JSON output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates the 'is_suspicious' attribute of URL entities in Google SecOps if they
      are confirmed as verified phishing links in PhishTank.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The Ping action is a utility designed to verify the connectivity between Google
    SecOps and the PhishTank service. It acts as a health check to ensure that the
    communication channel is open and the integration's configuration (specifically
    the Service URL) is valid and reachable.


    ### Parameters

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Service Url | String | Yes | This is an integration-level configuration parameter
    used to define the API endpoint of PhishTank. |


    ### Additional Notes

    - This action does not require any input entities.

    - It uses a hardcoded test URL (`google.com`) to perform a sample check against
    the PhishTank API.


    ### Flow Description

    1. **Configuration Retrieval**: The action starts by extracting the 'Service Url'
    from the PhishTank integration configuration.

    2. **Connectivity Test**: It sends an HTTP POST request to the retrieved URL.
    The request includes a sample payload searching for 'google.com' in JSON format.

    3. **Validation**: The script utilizes `res.raise_for_status()` to check if the
    HTTP request was successful (e.g., status code 200).

    4. **Completion**: If the request succeeds, the action terminates with a success
    message indicating PhishTank is connected.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
