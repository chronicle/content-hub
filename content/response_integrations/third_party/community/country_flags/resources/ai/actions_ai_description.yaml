Get Country Flag:
  ai_description: >-
    ### General Description

    Retrieves a country's flag in Base64 format from an external service (countryflags.io).
    This action is useful for visual enrichment of dashboards or reports by providing
    a graphical representation of a country associated with an entity or a specific
    country code. It utilizes a local caching mechanism to improve performance and
    reduce external API calls.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Country Code Two Digit | String | No | A manual 2-character ISO country code
    (e.g., 'US', 'GB') to fetch a flag for. |

    | Country Code From Entity Field | String | No | A comma-separated list of field
    names to look for within the additional_properties of the target entities. The
    action will extract the country code from the first matching field found. |


    ### Additional Notes

    - The action requires at least one of the parameters to be configured to perform
    any work.

    - If Country Code From Entity Field is used, the action iterates through all entities
    in the scope.

    - The action maintains a local cache file (flags.json) within the execution folder
    to store previously fetched flags.


    ### Flow Description

    1. **Cache Initialization**: The action attempts to load existing flag data from
    a local flags.json file.

    2. **Entity Processing**: If entity fields are specified, the action iterates
    through all target entities, searching their additional_properties for a valid
    country code.

    3. **Flag Retrieval**: For each identified country code (from entities or manual
    input), the action checks the local cache. If the flag is missing, it performs
    a GET request to countryflags.io.

    4. **Data Encoding**: The retrieved image is encoded into a Base64 string.

    5. **Result Aggregation**: The Base64 strings are mapped to their respective entity
    identifiers or country codes in the final JSON result.

    6. **Cache Update**: If new flags were downloaded, the local flags.json file is
    updated.

    7. **Completion**: The action returns the aggregated JSON data and terminates.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a connectivity test designed to verify the communication
    between Google SecOps and the Country Flags service. Its primary purpose is to
    ensure that the integration can successfully reach the external API and process
    the returned image data.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    - This action uses a hardcoded country code ("us") to perform the connectivity
    test.

    - It utilizes a local cache file (`flags.json`) within the execution folder to
    store and retrieve flag data in base64 format.

    - The action does not interact with any entities or alerts within the case.


    ### Flow Description

    1. **Cache Initialization**: The script attempts to locate and read a local cache
    file named `flags.json` from the action's run folder.

    2. **Connectivity Check**: It checks if the base64 flag data for the country code
    "us" is already present in the loaded cache.

    3. **External API Request**: If the data is not found in the cache, the action
    sends a GET request to the Country Flags API (`https://www.countryflags.io/us/flat/64.png`)
    to retrieve the flag image.

    4. **Data Processing**: Upon a successful response, the retrieved image content
    is encoded into a base64 string.

    5. **Action Finalization**: The action concludes with a "Successful" status if
    the flag data is successfully obtained (either from the cache or the API). If
    the request fails or data cannot be processed, the action ends with a failure
    state.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
