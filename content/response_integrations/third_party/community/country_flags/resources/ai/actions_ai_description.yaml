Get Country Flag:
  ai_description: >-
    ### General Description

    This action retrieves a country's flag image in base64 format using the 2-digit
    ISO country code. It can process codes provided directly as a parameter or extract
    them from an entity's additional properties if previously enriched by another
    tool. The action uses a local caching mechanism to store and retrieve previously
    fetched flags to optimize performance and reduce external API calls.


    ### Parameters Description

    | Parameter Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Country Code Two Digit | A specific 2-digit country code (e.g., 'us', 'fr')
    to retrieve a flag for. | String | No |

    | Country Code From Entity Field | A comma-separated list of field names within
    an entity's `additional_properties` (e.g., 'CountryCode', 'location_country')
    where the 2-digit code can be found. | String | No |


    ### Additional Notes

    - Either `Country Code Two Digit` or `Country Code From Entity Field` (with valid
    entity data) must be provided for the action to produce results.

    - The action attempts to load a cache file named `flags.json` from the execution
    folder. If a flag is not found in the cache, it fetches the flag from `https://www.countryflags.io/`.

    - Results are returned as a JSON object mapping entity identifiers or country
    codes to their respective base64-encoded flag strings.


    ### Flow Description

    1. **Initialize Cache:** Attempts to load existing base64 flag data from a local
    JSON cache file.

    2. **Entity Processing:** Iterates through target entities and checks the fields
    specified in `Country Code From Entity Field` within the entity's `additional_properties`.

    3. **Flag Retrieval:** For each identified country code (from entities or the
    direct parameter), the action checks the cache. If missing, it performs a GET
    request to the external flag service, encodes the resulting image to base64, and
    updates the local cache data.

    4. **Update Cache:** If new flags were fetched during execution, the local `flags.json`
    file is overwritten with the updated dataset.

    5. **Output Results:** Returns a JSON object containing the base64 flags and completes
    the execution.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - GENERICENTITY
    filters_by_additional_properties: true
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Tests connectivity with the Country Flags service by attempting to retrieve the
    flag for a hardcoded country code ('us'). This action serves as a health check
    to verify that the integration can communicate with the external API and handle
    base64 image encoding.


    ### Parameters Description

    This action does not require any input parameters.


    ### Additional Notes

    This is a standard 'Ping' or 'Test Connectivity' action. It does not process entities
    from the case or alert context and relies on a hardcoded value to verify network
    connectivity.


    ### Flow Description

    1. **Initialize Action:** Starts the Siemplify Action module and sets the script
    name.

    2. **Load Cache:** Attempts to read a local cache file (`flags.json`) from the
    script's run folder to check for existing flag data.

    3. **Connectivity Check:** Hardcodes the country code to 'us' and checks if the
    flag is in the cache.

    4. **External API Call:** If not in the cache, it performs an HTTP GET request
    to `countryflags.io` to fetch the flag image.

    5. **Encoding:** Encodes the retrieved image content into a base64 string.

    6. **Finalize:** Returns a successful execution state if the flag data is successfully
    retrieved or found in the cache; otherwise, it returns a failed state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
