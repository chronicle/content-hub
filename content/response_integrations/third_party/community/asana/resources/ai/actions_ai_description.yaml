Add User To Workspace:
  ai_description: >-
    ### General Description

    Adds a user to a specific Asana workspace using their email address. This action
    first identifies the workspace by its name and then performs an API call to associate
    the user with that workspace.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Workspace Name | String | True | The name of the workspace to which you want
    to add the user. This parameter is case-sensitive. |

    | User's Email | String | True | The email address of the user you wish to add
    to the workspace. |


    ### Additional Notes

    This action does not run on entities; it uses provided input parameters to interact
    with the Asana API. It requires a valid Personal Access Token (PAT) configured
    in the integration settings.


    ### Flow Description

    1. **Authentication:** The action retrieves the Personal Access Token and Base
    URL from the integration configuration.

    2. **Workspace Identification:** It calls the Asana API to list all workspaces
    and matches the provided 'Workspace Name' to find its corresponding GID (Global
    Identifier).

    3. **User Association:** It executes a POST request to the Asana `/addUser` endpoint
    for the specific workspace, using the provided user email.

    4. **Result Reporting:** The action adds the resulting user data as a JSON result
    and provides a success or failure message based on whether the user was successfully
    added.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds a new user to an existing Asana workspace by sending a POST request to
      the Asana API.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Task:
  ai_description: >-
    ### General Description

    Creates a new task in a specified Asana project. This action allows for the automated
    generation of tasks, supporting specific subjects, descriptions, deadlines, and
    individual assignments within the Asana platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Task Subject | string | True | The subject or title of the new task. |

    | Assignee | string | False | The user to whom the task will be assigned. This
    parameter is case sensitive and typically expects a user identifier or email.
    |

    | Due Date | string | False | The deadline for the task, formatted as YYYY-MM-DD.
    |

    | Description | string | True | The detailed description or notes for the task.
    |

    | Project Name | string | True | The exact name of the Asana project where the
    task will be created. This is case sensitive. |


    ### Additional Notes

    - The 'Project Name' and 'Assignee' parameters are case sensitive; incorrect casing
    will result in the action failing to find the target project or user.

    - Either an assignee ID or email can be used, depending on the AsanaManager's
    implementation of user resolution.


    ### Flow Description

    1. **Configuration Extraction**: Retrieves the Asana API token and base URL from
    the integration settings.

    2. **Parameter Extraction**: Gathers the task metadata (subject, description,
    etc.) from the action inputs.

    3. **Project Identification**: Queries the Asana API to find the internal 'Project
    ID' based on the provided 'Project Name'.

    4. **User Identification**: If an 'Assignee' is specified, queries the Asana API
    to retrieve the 'User ID' associated with that assignee.

    5. **Task Creation**: Sends a POST request to Asana to create the task in the
    target project with the specified details.

    6. **Result Handling**: If successful, generates a direct permalink to the task
    and attaches the full JSON response to the action results.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new task record within the Asana platform, which changes the state
      of projects and task lists in the external system.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Task:
  ai_description: "### General Description\nThe **Get Task** action retrieves detailed\
    \ information about a specific task in Asana using its unique Task ID. This action\
    \ is primarily used for enrichment and visibility, allowing analysts to pull metadata\
    \ such as task names, due dates, and direct links into the Google SecOps platform\
    \ without leaving the interface.\n\n### Parameters Description\n| Parameter |\
    \ Description | Type | Mandatory |\n| :--- | :--- | :--- | :--- |\n| **Task ID**\
    \ | The unique identifier of the Asana task. This can be found in the Asana task\
    \ URL (e.g., `https://app.asana.com/0/{project_id}/{task_id}`). | String | **Yes**\
    \ |\n\n### Flow Description\n1.  **Extraction**: The action retrieves the Asana\
    \ API Token and Base URL from the integration configuration and the specific Task\
    \ ID from the action parameters.\n2.  **API Interaction**: It utilizes the `AsanaManager`\
    \ to execute a `GET` request to the Asana `/tasks/{task_id}` endpoint.\n3.  **Result\
    \ Processing**: \n    *   If the task is found, the action extracts the task name,\
    \ due date, and permalink URL.\n    *   It adds a direct link to the task in the\
    \ action's results section via `add_link`.\n    *   The complete task metadata\
    \ is attached as a JSON result for further automated processing.\n4.  **Completion**:\
    \ The action returns a success message if the task details are successfully retrieved,\
    \ or a failure message if the task is not found.\n\n### Additional Notes\nThis\
    \ action does not run on entities; it is a standalone utility that requires the\
    \ manual or automated input of a Task ID."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List My Tasks:
  ai_description: >-
    General description: Lists all tasks associated with a specific user in an Asana
    workspace. This action allows security analysts to retrieve task details for specific
    users to understand workload or verify task statuses within a workspace context.
    Parameters description: 1. User's Email (String, Mandatory): The email address
    of the Asana user whose tasks you want to retrieve. 2. Workspace Name (String,
    Mandatory): The exact, case-sensitive name of the Asana workspace. 3. Completed
    Status (Boolean, Optional, Default=False): Marking the checkbox will retrieve
    only the tasks that were completed by the user. Additional notes: Ensure the workspace
    name matches exactly as it appears in Asana. Flow description: 1. User Identification:
    Resolves the provided email to an Asana User GID. 2. Workspace Identification:
    Resolves the workspace name to its corresponding Workspace GID. 3. Task List Retrieval:
    Identifies the 'User Task List' unique to the user and workspace combination.
    4. Fetch Tasks: Retrieves the collection of tasks assigned to that list. 5. Detail
    Retrieval and Filtering: Fetches detailed information for each task and filters
    them based on the 'Completed Status' parameter. 6. Output: Populates the action
    results with JSON task data and adds direct clickable URLs to each task in the
    SOAR UI.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Project Tasks:
  ai_description: >-
    ### General Description

    The **List Project Tasks** action retrieves all tasks associated with a specific
    project in Asana. It allows users to view task details, including names and due
    dates, and provides direct links to the tasks within the Asana interface. The
    action can be filtered to return only completed or incomplete tasks based on user
    input.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Project Name** | string | True | The name of the project from which you would
    like to fetch all the tasks. Note: This search is case-sensitive based on the
    project names available in the Asana workspace. |

    | **Completed Status** | boolean | False | Determines which tasks to retrieve.
    If set to `true`, the action fetches only completed tasks. If set to `false` (default),
    it fetches only incomplete tasks. |


    ### Additional Notes

    - This action does not operate on SOAR entities; it uses the provided `Project
    Name` parameter to identify the target project.

    - The action performs multiple API calls: one to find the project ID, one to list
    task IDs for that project, and individual calls for each task to retrieve full
    details and completion status.


    ### Flow Description

    1.  **Authentication**: The action initializes the Asana manager using the configured
    Personal Access Token and Base URL.

    2.  **Project Identification**: It searches for the project ID by matching the
    provided `Project Name` against all projects accessible to the user.

    3.  **Task Retrieval**: If the project is found, it fetches a list of all task
    summaries (GIDs) associated with that project.

    4.  **Detail Enrichment & Filtering**: For each task ID, the action retrieves
    full task details (including completion status, due dates, and permalinks). It
    filters these results based on the `Completed Status` parameter.

    5.  **Output Generation**: Tasks matching the filter are added to the JSON results.
    The action also adds direct links (permalinks) to the SOAR action output for each
    identified task.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool designed to verify the connectivity between
    Google SecOps and the Asana platform. It validates that the integration's configuration,
    specifically the Personal Access Token and the Base URL, is correct and that the
    Asana service is reachable from the SOAR environment.


    ### Parameters Description

    This action does not require any specific input parameters. It utilizes the global
    configuration parameters defined at the integration level:

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Token | String | Yes | The Personal Access Token (PAT) used to authenticate
    with Asana. |

    | Base URL | String | Yes | The root URL for the Asana API endpoints. |


    ### Additional Notes

    Failure of this action typically indicates either an invalid authentication token,
    an incorrect Base URL, or network/firewall issues preventing communication with
    Asana.


    ### Flow Description

    1. **Configuration Retrieval**: The script extracts the global `Token` and `Base
    URL` from the Asana integration settings.

    2. **Manager Initialization**: It initializes the `AsanaManager` class with the
    extracted credentials.

    3. **Connectivity Test**: The action invokes the `test_connectivity` method, which
    sends a HTTP GET request to the `/users/me` endpoint of the Asana API.

    4. **Response Handling**: The script parses the response to ensure the API call
    was successful and returned valid JSON data.

    5. **Result Reporting**: The action concludes by returning a boolean value (`True`
    for success, `False` for failure) and an appropriate status message to the Siemplify
    workbench.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove User From Workspace:
  ai_description: >-
    ### General Description

    Removes a specific user from an Asana workspace based on their email address.
    This action is designed for automated user management and access control within
    the Asana platform, allowing for the revocation of a user's workspace access via
    API.


    ### Parameters

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Workspace Name | The case-sensitive name of the Asana workspace from which the
    user should be removed. | string | Yes |

    | User's Email | The email address of the user account that will be removed from
    the workspace. | string | Yes |


    ### Additional Notes

    - This action does not operate on Google SecOps entities (like ADDRESS or USER)
    automatically; it uses the specific email address provided in the parameters.

    - The workspace name search is case-sensitive; an exact match is required to find
    the correct Workspace ID.

    - Successful removal returns a boolean 'True'.


    ### Flow Description

    1. **Credential Extraction**: Retrieves the Personal Access Token and Base URL
    from the Asana integration configuration.

    2. **ID Lookup**: Calls the Asana API to list workspaces and filters them by the
    provided 'Workspace Name' to find the corresponding Workspace GID.

    3. **API Execution**: Sends a POST request to the Asana endpoint `/workspaces/{workspace_id}/removeUser`
    containing the user's email in the request body.

    4. **Result Validation**: Checks the response for valid data and returns a success
    or failure message to the Siemplify case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes a user's membership from an Asana workspace by making a POST request
      to the Asana removeUser endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Task:
  ai_description: >-
    ### General Description

    Updates an existing task in Asana with new information. This action allows for
    the modification of a task's assignee, due date, and description. It is useful
    for automated workflow management where task status or ownership needs to change
    based on security incident progression.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Task ID | string | True | The unique identifier of the Asana task to update.
    This can be found in the Asana task URL. |

    | Due Date | string | False | The new deadline for the task, formatted as YYYY-MM-DD.
    |

    | Description | string | False | The updated notes or description text for the
    task. |

    | Assignee | string | False | The email address of the user to whom the task should
    be reassigned. Note that this is case-sensitive. |


    ### Additional Notes

    If an assignee email is provided, the action will first perform a lookup to retrieve
    the internal Asana User GID before performing the update. If any optional parameter
    is left blank, that specific field on the Asana task will be updated with the
    value provided (or the API default if handled by the manager).


    ### Flow Description

    1. **Configuration Retrieval:** Extracts the Asana API Token and Base URL from
    the integration settings.

    2. **Parameter Extraction:** Retrieves the Task ID and the optional fields (Assignee,
    Due Date, Description) from the action input.

    3. **User ID Resolution:** If an assignee email is provided, the action calls
    the Asana API to find the corresponding User GID.

    4. **Task Update:** Sends a PUT request to Asana's `/tasks/{task_id}` endpoint
    with the new data payload.

    5. **Result Reporting:** Captures the updated task JSON from the response, attaches
    it to the action results, and returns a success message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the properties (assignee, due date, and notes) of an existing task in
      the external Asana project management system via a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
