JsonAdapter:
  ai_description: >-
    ### General Description

    The **json-adapter** action is a utility designed to transform raw log data from
    Logz.io accounts into a standardized JSON format. This format is specifically
    designed to be compatible with downstream processes in Google SecOps playbooks
    by mapping specific log fields to a generic `entityType` and `entityIdentifier`
    structure. It is primarily used to extract specific identifiers from a bulk log
    response for easier processing in subsequent playbook steps.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **fields_to_search** | String | Yes | A comma-separated list of keys (fields)
    to look for within the provided log entries. |

    | **raw_json** | String | Yes | The source JSON string to be parsed. This action
    expects the JSON to contain a top-level `"results"` key which holds a list of
    log objects. |


    ### Additional Notes

    - The action will only return a successful status (`EXECUTION_STATE_COMPLETED`)
    if at least one of the requested fields is found within the provided JSON data.

    - If the input JSON does not follow the expected structure (a dictionary containing
    a `"results"` list), the action may fail or return no results.


    ### Flow Description

    1. **Initialization**: Extracts the `fields_to_search` list and the `raw_json`
    string from the action parameters.

    2. **Parsing**: Converts the `raw_json` string into a Python dictionary and splits
    the `fields_to_search` string into a list of individual field names.

    3. **Search Logic**: Iterates through every object contained within the `"results"`
    array of the input JSON.

    4. **Transformation**: For each log entry, the script checks if any of the specified
    search fields exist. If a field is found, it creates a new object mapping the
    field name to `entityType` and the field value to `entityIdentifier`.

    5. **Output Generation**: All matched results are aggregated into a new JSON object
    under a `"results"` key. This JSON is then attached to the action results for
    use by the SOAR platform.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
LogzioGetLogsByEventId:
  ai_description: >-
    Fetches the specific logs that triggered a security event in Logz.io and brings
    them into Google SecOps for investigation. This action allows analysts to retrieve
    the raw log data associated with an alert by providing its unique Event ID, providing
    the necessary context for alert validation and incident response.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | alert_event_id | string | Yes | The unique GUID of the security event in the
    Logz.io security account that needs to be investigated. |

    | page_size | string | No | Controls the number of results per page (Valid: 1
    to 1000). Defaults to 25. |


    ### Flow Description

    1. **Initialization:** The action retrieves Logz.io connection details (API token
    and region) from the integration configuration.

    2. **Endpoint Resolution:** Determines the correct API endpoint based on the specified
    region or a custom endpoint if provided.

    3. **Data Retrieval:** Executes a POST request to the Logz.io 'search logs' API
    using the provided `alert_event_id`.

    4. **Pagination Handling:** If the event has more logs than the initial page size,
    the action uses a thread pool to concurrently fetch all remaining log pages.

    5. **Data Integration:** Aggregates all retrieved logs and adds them to the action's
    execution results in JSON format.

    6. **Insight Generation:** Automatically creates case insights in Google SecOps
    containing the log messages to provide immediate visibility on the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Creates case insights within Google SecOps to display the logs retrieved from
      Logz.io.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
LogzioSearchLogs:
  ai_description: >-
    ### General Description

    Searches logs in your Logz.io operations account using Lucene query syntax. This
    action is designed to retrieve specific log events based on search criteria and
    a specified time window. It outputs the log data in a structured JSON format to
    be used by subsequent actions in a Google SecOps playbook. It supports custom
    endpoints and regional API routing.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | query | string | No | A search query written in valid Lucene syntax. Defaults
    to '*' (wildcard) to return all logs within the specified time frame. |

    | size | string | No | The number of log results to return per query. The value
    must be between 1 and 1000. If the value is invalid or missing, it defaults to
    1000. |

    | from_time | string | Yes | The earliest time to search. Supports Unix timestamps,
    relative time (e.g., '5 minutes ago'), or standard date formats (parsed via dateparser).
    |

    | to_time | string | No | The latest time to search. Supports the same formats
    as 'from_time'. If using relative time in 'from_time', this should typically be
    left empty. |


    ### Additional Notes

    - The action requires a 'logzio_operations_token' and 'logzio_region' (or 'logzio_custom_endpoint')
    to be configured at the integration level.

    - Time parameters are converted to Unix milliseconds before being sent to the
    Logz.io API.


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the Logz.io API token, region,
    and optional custom endpoint from the integration settings.

    2. **Parameter Validation**: It retrieves the search query and validates the result
    size, ensuring it stays within the 1-1000 limit.

    3. **Time Parsing**: The 'from_time' and 'to_time' parameters are parsed and converted
    into Unix millisecond timestamps.

    4. **API Request**: A JSON request body is constructed using the Lucene query
    and time range, then sent via a POST request to the Logz.io Search API.

    5. **Data Extraction**: The action parses the API response, extracts the source
    data from the log hits, and attaches the results as a JSON object to the action
    output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility tool designed to verify connectivity between
    Google SecOps and the Logz.io platform. It validates the provided API tokens for
    both the Security and Operations accounts by making authenticated requests to
    the Logz.io 'whoami' endpoint. This ensures that the integration is correctly
    configured and that the API is reachable before attempting more complex operations.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | `logzio_security_token` | String | Yes | The API token used to authenticate
    with the Logz.io Security account. |

    | `logzio_operations_token` | String | Yes | The API token used to authenticate
    with the Logz.io Operations account. |

    | `logzio_region` | String | No | The specific Logz.io region (e.g., 'us', 'eu',
    'au'). If left blank or set to '-', the default 'us' region is used. |

    | `logzio_custom_endpoint` | String | No | An optional override for the API base
    URL. If provided, this URL is used instead of the region-based URL logic. |


    ### Additional Notes

    *   The action requires both tokens to be valid for a successful outcome.

    *   It specifically targets the `v1/account-management/whoami` endpoint to confirm
    identity and permissions.


    ### Flow Description

    1.  **Extraction**: The action retrieves the Security and Operations tokens, the
    region, and any custom endpoint provided in the configuration.

    2.  **Validation**: It performs a basic format check to ensure tokens are present
    and are strings.

    3.  **Endpoint Construction**: It builds the target URL. If a `logzio_custom_endpoint`
    is provided, it appends the API suffix to it. Otherwise, it constructs a regional
    URL (e.g., `api-eu.logz.io`).

    4.  **Security Ping**: Executes a GET request to the API using the `logzio_security_token`.
    It expects a 200 OK response containing the account name.

    5.  **Operations Ping**: Executes a GET request to the API using the `logzio_operations_token`.
    It expects a 200 OK response.

    6.  **Final Status**: If both requests succeed, the action marks the execution
    as completed and successful.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
