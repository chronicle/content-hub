DeleteAttachment:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    description: Deletes a specific attachment from a user's mailbox using the Microsoft
      Graph API. The action requires a User ID (User Principal Name), a Message ID,
      and an Attachment ID as inputs. It performs a DELETE request to remove the target
      file from the email message in Microsoft 365. The operation returns the execution
      status and HTTP response code to indicate whether the deletion was successful.
    entity_scopes: []
    external_data_mutation_explanation: Permanently deletes the specified attachment
      from the target user's email message in the Microsoft Graph/Exchange environment.
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
DeleteMessage:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    description: Deletes a specific email message from one or more Microsoft 365 mailboxes
      using the Microsoft Graph API. The action takes a Message ID and a User ID (or
      a CSV list of User IDs) as input and performs a DELETE operation on the specified
      message within the target mailbox(es). This is primarily used for remediation
      of malicious or unwanted emails.
    entity_scopes: []
    external_data_mutation_explanation: Permanently deletes email messages from specified
      user mailboxes in Microsoft 365 via the Microsoft Graph API.
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
GetMessage:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Retrieves a specific email message from a user's inbox using the
      Microsoft Graph API. The action utilizes the User ID (UPN) and a specific Message
      ID as input parameters to fetch the comprehensive message object. The retrieved
      data includes message metadata, subject line, body content, and sender information,
      which is then added to the action results as a JSON object. This enables security
      analysts to perform forensic analysis of email content during investigations
      without modifying the mailbox state or message properties.
    entity_scopes: []
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: true
GetUserMfa:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Retrieves Multi-Factor Authentication (MFA) registration and status
      details for users via the Microsoft Graph Security API. The action processes
      a primary 'User Email' parameter and additional email-based entities found within
      the case. It collects data points including registration status, enablement,
      MFA capability, and configured authentication methods. Results are returned
      as JSON, and analysts can optionally enable case insights for each evaluated
      user to streamline visibility into MFA compliance.
    entity_scopes:
    - USERUNIQNAME
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes:
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: true
ListAttachments:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Retrieves a list of attachment objects associated with a specific
      message in a user's mailbox using the Microsoft Graph API. The action requires
      a User ID (email or principal name) and a Message ID to identify the source.
      It returns the metadata for all attachments (such as file name, size, and type)
      as a JSON result for further processing within the playbook.
    entity_scopes: []
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: true
ListMailRules:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Retrieves all message rule objects (messageRule) defined for a specific
      user's inbox using the Microsoft Graph API. This action takes a User ID (email
      address) as input to fetch configurations of existing mail rules, which helps
      in identifying potentially malicious email filters, automatic forwarding, or
      hidden rules that could indicate a mailbox compromise. It retrieves details
      such as rule conditions, actions taken on messages, and the rule's priority
      and status.
    entity_scopes: []
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: true
ListMessages:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Lists email messages from a specific user's mailbox using the Microsoft
      Graph API. The action allows for granular filtering using standard OData query
      parameters (e.g., $filter) and field selection (e.g., sender, subject) to optimize
      data retrieval. It provides the retrieved message data in JSON format for further
      analysis in the SOAR platform.
    entity_scopes: []
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: true
Ping:
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    description: Tests connectivity to the Microsoft Graph Security API. This action
      validates the integration's configuration parameters by attempting to authenticate
      and generate an OAuth access token using the provided Client ID, Secret, or
      Certificate. It ensures that communication with the Microsoft Graph environment
      is functional.
    entity_scopes: []
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
  tags:
    is_enrichment: false
