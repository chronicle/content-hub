Enrich Entities:
  ai_description: >-
    ### General Description

    Enriches entities by querying the EclecticIQ platform to retrieve comprehensive
    threat intelligence. The action identifies observables corresponding to the entities,
    fetches related entity data, and maps source information to provide a detailed
    context of the threat landscape associated with the target entities.


    ### Parameters

    There are no parameters for this action.


    ### Additional Notes

    This action is strictly for enrichment. It retrieves data from EclecticIQ and
    updates the internal Google SecOps entity profiles without modifying any data
    on the EclecticIQ platform itself. It also provides direct links to the EclecticIQ
    platform for deeper investigation.


    ### Flow Description

    1. **Initialization**: Retrieves the EclecticIQ URL, API Token, and SSL verification
    settings from the integration configuration.

    2. **Data Retrieval**: Queries the EclecticIQ API to find observables matching
    the identifiers of all target entities in the current scope.

    3. **Context Gathering**: For each identified observable, the action fetches associated
    entities and resolves source IDs to human-readable source names.

    4. **Data Parsing**: Processes the raw API responses into structured formats,
    including JSON results, platform links, and CSV-formatted data tables.

    5. **Internal Update**: Updates the Google SecOps entities with the retrieved
    enrichment data (stored in `additional_properties`), marks them as enriched (`is_enriched
    = True`), and attaches platform links and data tables to the entity UI.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity attributes with enrichment data from EclecticIQ and sets the
      'is_enriched' flag to true.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    - ALERT
    - APPLICATION
    - CHILDHASH
    - CHILDPROCESS
    - CLUSTER
    - CONTAINER
    - CREDITCARD
    - CVE
    - CVEID
    - DATABASE
    - DEPLOYMENT
    - DESTINATIONDOMAIN
    - DOMAIN
    - EMAILSUBJECT
    - EVENT
    - FILEHASH
    - FILENAME
    - GENERICENTITY
    - HOSTNAME
    - IPSET
    - MacAddress
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - POD
    - PROCESS
    - SERVICE
    - SOURCEDOMAIN
    - THREATACTOR
    - THREATCAMPAIGN
    - THREATSIGNATURE
    - DestinationURL
    - USB
    - USERUNIQNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: "### General Description\nThis action facilitates testing connectivity\
    \ with the EclecticIQ platform to ensure that the integration configuration (URL,\
    \ API Token, and SSL settings) is correct and that the Google SecOps environment\
    \ can communicate with the external service.\n\n### Parameters\nThere are no action-specific\
    \ parameters for this action. It relies entirely on the integration's global configuration\
    \ settings:\n* **EclecticIQ URL**: The base URL of the EclecticIQ instance.\n\
    * **API Token**: The authentication token used to authorize requests.\n* **Verify\
    \ SSL**: A boolean flag indicating whether to verify the SSL certificate of the\
    \ EclecticIQ server.\n\n### Flow Description\n1. **Initialization**: The action\
    \ initializes the Siemplify context and retrieves the global integration configuration.\n\
    2. **Manager Setup**: It instantiates the `EclecticIQManager` using the provided\
    \ URL, API Token, and SSL verification preference.\n3. **Connectivity Test**:\
    \ The manager executes the `test_connectivity` method, which performs a GET request\
    \ to the `/api/v2/sources` endpoint of the EclecticIQ API.\n4. **Result Handling**:\
    \ \n    * If the request is successful (HTTP 200 OK), the action returns a success\
    \ message and sets the result value to `true`.\n    * If an exception occurs (e.g.,\
    \ connection timeout, invalid credentials, or 4xx/5xx errors), the action logs\
    \ the error, returns a failure message, and sets the result value to `false`.\n\
    5. **Termination**: The action ends by reporting the status and output message\
    \ to the SOAR platform."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Entities to EclecticIQ:
  ai_description: >-
    ### General Description

    The **Send Entities to EclecticIQ** action allows users to export entities from
    a Google SecOps case to the EclecticIQ Intelligence Center. By default, the action
    creates "sighting" entities in EclecticIQ, which include contextual metadata from
    the SecOps case (such as title, description, priority, and status). Users can
    also choose to create "indicator" entities alongside the sightings.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Group Name** | String | Yes | The name of the EclecticIQ Intelligence Center
    Group (e.g., "Testing Group") where the entities will be created. |

    | **Create Indicator** | Boolean | No | If set to `true`, the action creates both
    a sighting and an indicator in EclecticIQ. If `false` (default), only a sighting
    is created. |


    ### Additional Notes

    - The action maps various SecOps entity types (IP, Host, File, Process, etc.)
    to their corresponding EclecticIQ observable types.

    - A link to the created entity in the EclecticIQ platform is added to the SecOps
    case for quick access.


    ### Flow Description

    1. **Parameter Extraction:** Retrieves the EclecticIQ connection details and action
    parameters (`Group Name`, `Create Indicator`).

    2. **Group Identification:** Queries the EclecticIQ API to find the internal `source_id`
    associated with the provided `Group Name` via a GET request.

    3. **Data Preparation:** Iterates through the target entities in the case, filtering
    for supported types and mapping them to EclecticIQ observable kinds.

    4. **Metadata Compilation:** Aggregates case details (Title, Priority, Status,
    etc.) into a formatted HTML description for the EclecticIQ entities.

    5. **External Creation:** Sends a PUT request to the EclecticIQ `/api/v2/entities`
    endpoint to create the sighting (and indicator if requested).

    6. **Case Enrichment:** Adds a comment to the SecOps case wall and provides a
    direct URL link to the newly created entity in EclecticIQ.
  capabilities:
    can_create_case_comments: true
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates new sighting and indicator entities in the EclecticIQ Intelligence Center
      using a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: >-
      Adds a case comment confirming the creation of entities and adds a platform
      link to the created entity in EclecticIQ.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - CHILDHASH
    - CHILDPROCESS
    - CREDITCARD
    - CVE
    - CVEID
    - DESTINATIONDOMAIN
    - DOMAIN
    - FILEHASH
    - FILENAME
    - HOSTNAME
    - PARENTHASH
    - PARENTPROCESS
    - PHONENUMBER
    - PROCESS
    - SOURCEDOMAIN
    - THREATACTOR
    - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
