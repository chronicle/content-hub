Ping:
  ai_description: >-
    ### General Description

    The Ping action is designed to verify connectivity and validate the credentials
    provided in the SendGrid integration configuration. It ensures that the API Token
    is valid and possesses the necessary permissions (scopes) to perform operations,
    specifically checking for the `mail.send` permission.


    ### Parameters Description

    | Name | Usage | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- | :--- |

    | N/A | N/A | N/A | N/A | This action does not require any input parameters. |


    ### Additional Notes

    *   This action relies on the global integration configuration for the 'API Token'.

    *   It specifically checks for the `mail.send` scope in the API response to determine
    if the token is fully functional for email operations.


    ### Flow Description

    1.  **Configuration Retrieval**: The action retrieves the 'API Token' from the
    SendGrid integration settings.

    2.  **API Call**: It executes an HTTPS GET request to the SendGrid `/v3/scopes`
    endpoint using the provided token.

    3.  **Permission Validation**: The script parses the JSON response to extract
    the list of authorized scopes.

    4.  **Verification**: It uses a regular expression to search for the `mail.send`
    string within the scopes.

    5.  **Outcome Reporting**: If the scope is found, it returns a success message.
    If the scope is missing or the connection fails, it returns an error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Send Email:
  ai_description: >-
    ### General Description

    This action sends an email message using the SendGrid API. It is a utility action
    designed for automated communication within playbooks, allowing for the delivery
    of notifications, reports, or alerts to specified recipients. The action supports
    HTML content and can optionally return the API response status for tracking purposes.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Subject | string | Yes | The subject line of the email message. |

    | Email To | string | Yes | The recipient's email address. |

    | Email From | string | Yes | The sender's email address as registered in the
    SendGrid account. |

    | Content | email_content | Yes | The body of the email. Supports HTML formatting
    and template injection. |

    | Return Message Status | boolean | No | If true, the action will include the
    SendGrid API response status code and timestamp in the JSON result. Default is
    false. |


    ### Additional Notes

    - This action does not operate on entities; it is a standalone execution based
    on the provided parameters.

    - No retry logic is implemented; a failed API call will result in an action failure.

    - Ensure the 'Email From' address is authorized in your SendGrid configuration.


    ### Flow Description

    1. **Parameter Initialization**: The action retrieves the SendGrid API token from
    the integration configuration and loads the user-provided parameters (To, From,
    Subject, Content).

    2. **Message Construction**: It creates a SendGrid `Mail` object containing the
    specified sender, recipient, subject, and HTML content.

    3. **Email Transmission**: The action initializes the `SendGridAPIClient` and
    attempts to send the message.

    4. **Status Reporting**: If successful, the action logs the completion. If 'Return
    Message Status' is enabled, it adds the status code and metadata to the action's
    result JSON.

    5. **Error Handling**: If the API call fails, an error is logged and the action
    execution state is set to failed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends an email message via the SendGrid API, which creates an outbound communication
      record in the external SendGrid service.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
