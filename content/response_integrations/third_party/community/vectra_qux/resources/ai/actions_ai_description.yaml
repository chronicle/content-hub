Add Note:
  ai_description: >-
    ### General Description

    Adds a note to a specific entity identifier (Account, Host, or Detection) within
    the Vectra QUX platform. This action allows analysts to attach context or findings
    directly to Vectra entities from within Google SecOps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Note | string | Yes | The actual text content of the note to be added to the
    entity. |

    | Entity ID | string | Yes | The unique numerical identifier of the target entity
    in Vectra QUX. |

    | Entity Type | ddl | Yes | The category of the entity. Supported values are 'Account',
    'Host', or 'Detection'. |


    ### Flow Description

    1. **Initialization**: The action initializes the Vectra QUX manager using the
    provided API credentials and configuration.

    2. **Validation**: Validates that the 'Entity ID' provided is a valid integer.

    3. **Request**: Construct an API request targeting the specific entity type and
    ID.

    4. **Execution**: Sends a POST request to the Vectra QUX API containing the note
    content.

    5. **Results**: Upon success, the action returns the created note details, including
    the Note ID and creation timestamp, which are displayed in a data table and provided
    as raw JSON in the action results.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action creates a new note record associated with a Host, Account, or Detection
      entity in the external Vectra QUX platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add Outcome:
  ai_description: >-
    ### General Description

    Adds a new assignment outcome definition to the Vectra AI platform. This action
    allows administrators to define custom resolution types with specific categories,
    which can then be used to resolve host or account assignments within the Vectra
    environment.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Title | String | Yes | The unique title of the outcome to be created. |

    | Category | DDL | Yes | The category classification for the outcome. Supported
    values are: `malicious_true_positive`, `benign_true_positive`, and `false_positive`.
    |


    ### Additional Notes

    This action performs a state change in the external Vectra AI system by creating
    a new configuration resource. It is primarily used for management and workflow
    customization within the Vectra platform.


    ### Flow Description

    1. **Initialization**: Retrieves configuration parameters including API Root,
    API Token, and SSL verification settings to establish a session with the Vectra
    AI API.

    2. **Parameter Extraction**: Captures the 'Title' and 'Category' provided by the
    user.

    3. **API Interaction**: Sends a POST request to the `/api/v2.5/assignment_outcomes`
    endpoint with the outcome details.

    4. **Result Processing**: Parses the response to confirm successful creation and
    extracts the new Outcome ID.

    5. **Output Generation**: Populates a data table and a JSON result with the details
    of the created outcome for display in the Google SecOps interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new 'Assignment Outcome' resource in the Vectra AI system via a POST
      request to the management API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Add Tags:
  ai_description: >-
    Adds tags to specified entities (Account, Host, or Detection) in the Vectra AI
    platform. This action allows for bulk tagging by accepting comma-separated lists
    of tags and entity IDs. It ensures that existing tags are preserved by first fetching
    current tags and then merging them with the new ones before performing a PATCH
    update.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Tags | String | Yes | A comma-separated list of tags to add to the entities.
    |

    | Entity IDs | String | Yes | A comma-separated list of the numeric IDs of the
    entities in Vectra. |

    | Entity Type | DDL | Yes | The type of entity to tag. Options include 'Account',
    'Host', and 'Detection'. |


    ### Flow Description

    1. **Input Parsing:** Splits and cleans the provided Tags and Entity IDs parameters,
    removing duplicates and validating that IDs are integers.

    2. **Configuration:** Initializes the VectraQUX Manager using the provided API
    Root and Token.

    3. **Existing Tag Retrieval:** For each provided Entity ID, the action fetches
    current tags from Vectra to prevent overwriting existing data.

    4. **Tag Merging:** Combines the existing tags with the new user-provided tags
    into a unique set.

    5. **External Update:** Sends a PATCH request to the Vectra API to update the
    entity with the combined tag list.

    6. **Reporting:** Generates a 'Tag Update Status' data table and a detailed JSON
    result showing the success or failure for each entity ID processed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the 'tags' attribute for the specified Account, Host, or Detection entities
      in the Vectra AI platform via a PATCH request to the tagging API endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Assign Entity:
  ai_description: >-
    ### General Description

    Assigns a Vectra QUX entity, specifically a Host or an Account, to a designated
    User ID within the Vectra platform. This action is used for case management and
    remediation workflow, ensuring that specific security entities are tracked and
    handled by specific users in the external system.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | string | Yes | The unique numeric identifier of the entity (Host
    or Account) to be assigned. |

    | Entity Type | ddl | Yes | The type of entity being assigned. Must be either
    'Account' or 'Host'. |

    | User ID | string | Yes | The unique numeric identifier of the user to whom the
    entity will be assigned. |


    ### Additional Notes

    - Both the `Entity ID` and `User ID` are expected to be numeric values; the script
    includes validation logic to ensure they are valid integers before making the
    API call.

    - This action performs a POST request to create a new assignment record in Vectra
    QUX.


    ### Flow Description

    1. **Initialization**: The action retrieves the integration configuration (API
    Root, Token, SSL verification) and action parameters (`Entity ID`, `Entity Type`,
    `User ID`).

    2. **Validation**: The script validates that the `Entity ID` and `User ID` provided
    are non-negative integers.

    3. **API Interaction**: It initializes the `VectraQUXManager` and calls the `assign_entity`
    method, which sends a POST request to the Vectra QUX API endpoints.

    4. **Result Processing**: Upon a successful assignment creation, the script receives
    an `Assignment` data model object.

    5. **Output Generation**: The action creates a data table titled 'Assign Entity'
    containing the new assignment's metadata and adds the raw response JSON to the
    action results. It concludes by providing a success message with the Assignment
    ID.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new assignment record in the Vectra QUX platform using a POST request,
      linking a specific host or account entity to a user account.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Assign Group:
  ai_description: >-
    ### General Description

    This action adds members to a specific group in Vectra QUX. It is a management
    action used to modify the membership of existing groups (Hosts, Accounts, IPs,
    or Domains) by appending new members to the current list without removing existing
    ones.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Group ID** | string | Yes | The unique identifier of the target group in Vectra
    QUX. This must be a positive integer. |

    | **Members** | string | Yes | A comma-separated list of members to be assigned
    to the group. The specific value type (e.g., hostnames, IP addresses, UIDs) should
    match the 'type' of the group being updated. |


    ### Additional Notes

    - This action uses the `membership_action="append"` logic, meaning it only adds
    new members and does not replace the existing ones.

    - The action performs validation to check which provided members were successfully
    added and will report if any members were invalid for the specific group type.


    ### Flow Description

    1. **Initialization**: Retrieves configuration parameters (API Root, Token) and
    action parameters (Group ID, Members).

    2. **Validation**: Validates that the Group ID is a valid integer and processes
    the comma-separated Members list into a clean Python list.

    3. **API Interaction**: Communicates with the Vectra QUX API using a `PATCH` request
    to the groups endpoint to append the specified members.

    4. **Outcome Analysis**: Compares the requested members list against the updated
    group membership returned by the API to determine successful assignments versus
    failures.

    5. **Output Generation**: Renders an HTML table containing the updated group details
    and populates the JSON result with the full group object. If no members were successfully
    added, the action fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the membership list of a group in Vectra QUX by appending new members
      via a PATCH request to the API.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Describe Assignment:
  ai_description: >-
    ### General Description

    The **Describe Assignment** action retrieves comprehensive details for a specific
    assignment identifier within the Vectra QUX platform. This action is designed
    for information retrieval, allowing users to inspect metadata such as who assigned
    the task, who it is assigned to, its resolution status, and the specific outcome
    associated with it.


    ### Parameters Description

    | Parameter | Type | Mandatory | Default | Description |

    | :--- | :--- | :--- | :--- | :--- |

    | Assignment ID | String | Yes | 0 | The unique identifier of the assignment to
    be described. The value must be a valid positive integer representing an existing
    assignment in Vectra QUX. |


    ### Additional Notes

    - This action does not operate on SOAR entities; instead, it uses the provided
    **Assignment ID** to query the external system directly.

    - The output includes a detailed data table and a raw JSON object containing the
    complete API response.


    ### Flow Description

    1. **Initialization:** The script extracts the configuration settings (API Root,
    API Token, and SSL verification) and the target Assignment ID.

    2. **Validation:** The Assignment ID is validated to ensure it is a proper integer.

    3. **Request Execution:** The action performs a GET request to the Vectra QUX
    `/assignments/{assignment_id}` endpoint.

    4. **Data Processing:** The retrieved JSON response is parsed using the `VectraQUXParser`
    into an `Assignment` data model.

    5. **Information Display:**
       - The raw response is added to the script results as JSON.
       - A formatted data table titled 'Describe Assignment' is created, containing
    key fields such as Assigned User, Resolved By, Outcome, and Entity details.
    6. **Completion:** The action terminates with a success message containing the
    Assignment ID or handles errors if the ID is invalid or not found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Describe Detection:
  ai_description: "### General Description\nThe **Describe Detection** action retrieves\
    \ comprehensive metadata for a specific security detection within the Vectra QUX\
    \ platform. By providing a unique Detection ID, users can access detailed information\
    \ including detection type, state, category, source entity identifiers, and relevant\
    \ URLs. This action is primarily used for deep-dive investigations into specific\
    \ alerts identified by the Vectra system.\n\n### Parameters Description\n| Parameter\
    \ | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| **Detection\
    \ ID** | string | Yes | The unique numeric identifier for the detection to be\
    \ retrieved. Although provided as a string, it must represent a valid positive\
    \ integer. |\n\n### Flow Description\n1. **Parameter Initialization**: The action\
    \ retrieves the integration's configuration (API Root, Token, SSL verification)\
    \ and the mandatory `Detection ID` from the user input.\n2. **Validation**: The\
    \ `Detection ID` is validated to ensure it is a positive integer. If validation\
    \ fails, the action terminates with an error.\n3. **API Interaction**: The action\
    \ communicates with the Vectra QUX manager to call the `describe_detection` endpoint\
    \ using a GET request.\n4. **Data Sanitization**: The raw detection data is processed\
    \ by the internal data model, which cleans up internal API version strings from\
    \ URLs (e.g., removing `/api/v2.5`) to make them user-friendly.\n5. **Output Generation**:\
    \ \n    *   A **Data Table** titled \"Describe Detection\" is created, summarizing\
    \ key fields like ID, Type, State, and Category.\n    *   A detailed **JSON result**\
    \ containing the full raw response is attached to the action results for programmatic\
    \ use in playbooks."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Describe Entity:
  ai_description: "The 'Describe Entity' action retrieves comprehensive details for\
    \ a specific entity (either a Host or an Account) from the Vectra QUX platform\
    \ using its unique ID. This action is designed to provide security analysts with\
    \ deep-dive context about a specific asset, including its threat and certainty\
    \ scores, state, and associated detections. The results are presented as both\
    \ a structured data table and a raw JSON object for further analysis.\n\n### Parameters\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | Entity ID | String | Yes | The unique identifier for the Account or Host in\
    \ the Vectra system. This value must be a valid integer. |\n| Entity Type | DDL\
    \ | Yes | The type of entity to describe. Supported values are 'Account' and 'Host'.\
    \ |\n\n### Flow Description\n1. **Parameter Extraction:** The action extracts\
    \ the 'Entity ID' and 'Entity Type' from the user input and configuration.\n2.\
    \ **Validation:** It validates that the 'Entity ID' is a non-negative integer.\n\
    3. **API Interaction:** The action uses the VectraQUXManager to send a GET request\
    \ to the Vectra API endpoint corresponding to the entity type (e.g., `/api/v2.5/hosts/{id}`\
    \ or `/api/v2.5/accounts/{id}`).\n4. **Data Processing:** The retrieved JSON response\
    \ is parsed into an Entity data model.\n5. **Result Generation:** \n    *   A\
    \ CSV-formatted data table titled 'Describe Entity' is added to the case results.\n\
    \    *   The full raw JSON response is added as a JSON result.\n    *   The execution\
    \ completes with a success message containing the entity ID."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Download PCAP:
  ai_description: >-
    Downloads a Packet Capture (PCAP) file from Vectra AI based on a specific Detection
    ID. This action is used to retrieve raw network traffic data associated with a
    security detection for forensic analysis and investigation.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Detection ID | String | Yes | The unique numerical identifier for the detection
    in Vectra AI for which the PCAP file should be downloaded. |


    ### Flow Description

    1. **Parameter Validation**: The action validates that the provided `Detection
    ID` is a valid integer.

    2. **External API Call**: It makes a GET request to the Vectra AI API endpoint
    `/api/v2.5/detections/{detection_id}/pcap` to retrieve the binary file content.

    3. **File Handling**: The action extracts the filename from the response headers
    and saves the file content to a local temporary directory.

    4. **SOAR Attachment**: The retrieved PCAP file is encoded into Base64 and attached
    to the Google SecOps result as a downloadable attachment named 'PCAP file'.


    ### Additional Notes

    - This action does not run on entities; it requires a manual `Detection ID` input,
    which is often found in the metadata of an alert originating from Vectra AI.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Assignments:
  ai_description: >-
    ### General Description

    Lists assignment records from the Vectra AI QUX platform based on provided query
    parameters. This action is used to retrieve historical or current task assignments
    related to specific hosts, accounts, or assignees, allowing for better visibility
    into manual or automated remediation efforts. It supports various filters including
    account/host IDs, assignee IDs, resolution status, and temporal filters.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Accounts IDs | String | No | Comma-separated account IDs to filter the assignments.
    |

    | Hosts IDs | String | No | Comma-separated host IDs to filter the assignments.
    |

    | Assignees IDs | String | No | Comma-separated user IDs of the assignees to filter
    the results. |

    | Resolution IDs | String | No | Comma-separated resolution/outcome IDs to filter
    the results. |

    | Resolved | DDL | No | Filter by the resolution status (True, False, or None).
    |

    | Created After | String | No | Filter assignments created after a specific timestamp.
    Supports relative formats like '2 hours', '2 days' or absolute ISO formats. |

    | Limit | String | No | Specifies the maximum number of assignment records to
    fetch. |


    ### Additional Notes

    - If no filters are provided, the action will fetch the most recent assignments
    up to the specified limit.

    - All ID parameters (Accounts, Hosts, Assignees, Resolution) accept a comma-separated
    list of numeric or string identifiers which the action validates as integers internally.


    ### Flow Description

    1. **Initialization**: Retrieves configuration parameters (API Root, Token) and
    extracts action parameters from the SOAR environment.

    2. **Parameter Processing**: Validates 'Limit' and converts comma-separated ID
    strings into lists of integers for the API request.

    3. **Query Mapping**: Constructs a query mapping dictionary to filter the API
    request based on 'Resolved' status and 'Created After' timestamps.

    4. **Data Retrieval**: Calls the Vectra QUX API `/assignments` endpoint using
    a paginator to handle large result sets up to the defined limit.

    5. **Output Generation**: Formats the retrieved assignment objects into a structured
    Data Table named 'Assignment Details' and attaches the raw response as a JSON
    result.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Entity Detections:
  ai_description: "### General Description\nThe **List Entity Detections** action\
    \ retrieves a list of all security detections associated with a specific Entity\
    \ ID (Host or Account) from the Vectra AI platform. This action is used to provide\
    \ deep visibility into the security events linked to a particular entity, allowing\
    \ analysts to see the history and current status of detections within a SOAR workflow.\n\
    \n### Parameters\n| Parameter | Type | Mandatory | Description |\n| :--- | :---\
    \ | :--- | :--- |\n| Entity ID | string | Yes | The unique identifier for the\
    \ target Account or Host in Vectra. |\n| Entity Type | ddl | Yes | The category\
    \ of the entity. Options are **Account** or **Host**. |\n| Limit | string | No\
    \ | The maximum number of detection records to retrieve. If not specified, a default\
    \ limit is applied by the manager. |\n| State | ddl | Yes | Filters detections\
    \ by their current state. Options include **Active**, **Inactive**, or **Fixed**.\
    \ Defaults to **Active**. |\n\n### Flow Description\n1.  **Parameter Extraction:**\
    \ The action extracts the API configuration (Root, Token) and the action parameters\
    \ (Entity ID, Type, Limit, and State).\n2.  **Validation:** Validates that the\
    \ **Entity ID** and **Limit** are valid integers. The **Limit** must be greater\
    \ than 0 if provided.\n3.  **API Connection:** Initializes the `VectraQUXManager`\
    \ to communicate with the Vectra AI API.\n4.  **Data Retrieval:** Executes a GET\
    \ request to the Vectra search endpoint using a query string that specifically\
    \ targets detections associated with the provided Entity ID and Type, filtered\
    \ by the chosen state.\n5.  **Output Generation:** \n    *   If detections are\
    \ found, they are converted to JSON and returned as a result object.\n    *  \
    \ A CSV-formatted data table titled \"List Entity Detections\" is added to the\
    \ action results for display in the Google SecOps interface.\n    *   If no detections\
    \ are found, a corresponding message is returned to the user."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Groups:
  ai_description: >-
    Lists groups from the Vectra AI platform based on a variety of query parameters.
    This action is designed to search for and retrieve information about host, account,
    IP, or domain groups stored in Vectra. Users can apply multiple filters such as
    specific names, importance levels, or modification timestamps to narrow down results.
    The action produces a data table for quick reference and a full JSON response
    for subsequent automation steps.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Host Names | string | No | Comma-separated values of host names to filter groups
    by. |

    | Account Names | string | No | Comma-separated values of account names to filter
    groups by. |

    | Domains | string | No | Comma-separated values of domains to filter groups by.
    |

    | Host Ids | string | No | Comma-separated values of host IDs to filter groups
    by. |

    | Importance | ddl | No | Filters groups by their importance level (low, medium,
    high, never_prioritize, or None). |

    | IPs | string | No | Comma-separated values of IP addresses to filter groups
    by. |

    | Last Modified Timestamp GTE | string | No | Filters groups modified on or after
    this timestamp. |

    | Last Modified By | string | No | Filters groups modified by a specific username.
    |

    | Name | string | No | Matches groups with a specific name. |

    | Type | ddl | No | Filters groups by their type (host, account, ip, domain, or
    None). |

    | Limit | string | No | Specifies the maximum number of records to retrieve from
    the API. |

    | Description | string | No | Matches groups based on a case-insensitive description
    search. |


    ### Flow Description

    1. **Initialization**: Extracts connection settings (API Root, Token) and various
    optional filtering parameters from the action configuration.

    2. **Validation**: Validates the 'Limit' parameter to ensure it is a valid integer.

    3. **API Interaction**: Calls the Vectra AI API via the manager to fetch groups
    that match the provided criteria.

    4. **Data Processing**: Parses the API response into Group data models. If groups
    are found, it generates a data table containing IDs, Names, Types, and Descriptions.

    5. **Completion**: Attaches the full list of groups as a JSON result and outputs
    a summary message indicating success or if no groups were found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Outcomes:
  ai_description: "### General Description\n\nThe **List Outcomes** action retrieves\
    \ a list of all available assignment outcomes from the Vectra QUX platform. Assignment\
    \ outcomes define the results of a triage process (e.g., 'True Positive', 'Benign').\
    \ This action is primarily used for administrative visibility or to dynamically\
    \ fetch valid outcome IDs for subsequent resolution actions within a playbook.\n\
    \n### Parameters Description\n\n| Parameter | Type | Mandatory | Description |\n\
    | :--- | :--- | :--- | :--- |\n| **Limit** | String | No | The maximum number\
    \ of outcome records to retrieve. Must be a valid non-negative integer. If not\
    \ specified, the system default limit is applied. |\n\n### Additional Notes\n\n\
    - This action does not require any input entities and operates globally on the\
    \ Vectra QUX environment configuration.\n- If no outcomes are found in the system,\
    \ the action will return a successful message stating \"No outcomes found.\"\n\
    \n### Flow Description\n\n1.  **Parameter Extraction**: Retrieves the configuration\
    \ settings (API Root, Token, SSL) and the optional `Limit` parameter.\n2.  **Validation**:\
    \ Validates the `Limit` input to ensure it is a proper integer and greater than\
    \ 0 if provided.\n3.  **API Request**: Executes a paginated GET request to the\
    \ Vectra QUX `/assignment_outcomes` endpoint using the `VectraQUXManager`.\n4.\
    \  **Result Parsing**: Processes the raw JSON response into `Outcome` data models.\n\
    5.  **Output Generation**: \n    - Creates an \"Outcome Details\" data table containing\
    \ the Outcome ID, Title, Category, and flags for 'Built In' and 'User Selectable'\
    \ status.\n    - Adds the full raw response as a JSON result for advanced parsing\
    \ in playbooks."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Users:
  ai_description: "### General Description\nThis action lists users from the Vectra\
    \ QUX platform based on various filter criteria. It is used to audit user accounts,\
    \ verify roles, or check for recent logins within the Vectra environment. The\
    \ action retrieves detailed user information, including account type, role, and\
    \ last login time, and presents the data in both a structured data table and a\
    \ raw JSON format.\n\n### Parameters Description\n| Parameter | Type | Mandatory\
    \ | Description |\n| :--- | :--- | :--- | :--- |\n| Role | String | No | Filters\
    \ the user list by a specific role assigned in Vectra. |\n| Authentication Profile\
    \ | String | No | Filters users based on their associated authentication profile.\
    \ |\n| Last Login GTE | String | No | Filters users whose last login timestamp\
    \ is greater than or equal to the specified value. |\n| User Name | String | No\
    \ | Filters the results for a specific username. |\n| Account Type | String |\
    \ No | Filters users by their account type (e.g., local, LDAP). |\n| Limit | String\
    \ | No | Specifies the maximum number of user records to retrieve. Defaults to\
    \ system limits if not specified. |\n\n### Additional Notes\n- The 'Limit' parameter\
    \ must be a valid non-negative integer. If set to 0, the action will return an\
    \ error or no results depending on validation.\n- The action does not require\
    \ any entities to be present in the context; it performs a direct query against\
    \ the Vectra QUX user database.\n\n### Flow Description\n1.  **Initialization**:\
    \ Extracts the configuration parameters (API Root, Token, SSL verification) and\
    \ action parameters (filters and limit).\n2.  **Validation**: Validates that the\
    \ 'Limit' parameter is a valid integer.\n3.  **API Connection**: Establishes a\
    \ connection to the Vectra QUX manager using the provided credentials.\n4.  **Data\
    \ Retrieval**: Executes a GET request to the Vectra QUX users endpoint with the\
    \ specified filter parameters and pagination.\n5.  **Data Processing**: Parses\
    \ the API response into internal User data models.\n6.  **Output Generation**:\
    \ \n    - Creates a data table named 'List Of Users' containing key details like\
    \ Username, Role, and Last Login.\n    - Attaches the complete raw JSON response\
    \ to the action results for downstream use in the playbook."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Mark Detection Fixed:
  ai_description: "### General Description\nMarks specific detection records as 'fixed'\
    \ within the Vectra AI (QUX) platform. This is a management action used to transition\
    \ the status of detections programmatically, typically after an investigation\
    \ has concluded or remediation has been verified.\n\n### Parameters Description\n\
    \n| Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :---\
    \ |\n| Detection IDs | string | Yes | A comma-separated list of numeric identifiers\
    \ representing the detections to be updated. Each ID must be a valid non-zero,\
    \ non-negative integer. |\n\n### Additional Notes\n- The action performs validation\
    \ on the provided IDs to ensure they are integers before interacting with the\
    \ external API. \n- It uses a PATCH request to update the detection states in\
    \ bulk on the Vectra server.\n\n### Flow Description\n1. **Initialization**: Retrieves\
    \ configuration parameters (API Root, Token, SSL) and the list of detection IDs\
    \ from the action input.\n2. **Validation**: Processes the comma-separated string\
    \ of IDs, stripping whitespaces and validating that each entry is a valid non-negative\
    \ integer. If any ID is invalid, the action fails.\n3. **API Interaction**: Uses\
    \ the `VectraQUXManager` to send a PATCH request to the Vectra API detections\
    \ endpoint with the `mark_as_fixed` flag set to `True`.\n4. **Outcome Processing**:\
    \ If the request is successful, it captures the API's response, adds it to the\
    \ action results as JSON, and finishes with a success message. If the API returns\
    \ an error (e.g., 404 for invalid IDs), it handles the exception and fails the\
    \ action."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of specific detections in the Vectra AI platform to 'fixed'
      using a PATCH request to the /api/v2.5/detections endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Mark Entity Fixed:
  ai_description: >-
    ### General Description

    Marks all detections associated with a specific entity as 'fixed' within the Vectra
    AI platform. This action is used to programmatically resolve security findings
    for a given Host or Account by retrieving its current detection IDs and updating
    their status in bulk.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | string | Yes | The unique numerical identifier of the entity in
    Vectra AI. |

    | Entity Type | ddl | Yes | The category of the entity. Supported values are **Account**
    or **Host**. |


    ### Flow Description

    1.  **Parameter Extraction**: The action retrieves the `Entity ID` and `Entity
    Type` from the input parameters and validates that the ID is a valid integer.

    2.  **Entity Context Retrieval**: The action queries the Vectra AI API to describe
    the specified entity (Account or Host) and extracts the list of all associated
    `detection_ids`.

    3.  **Detection Resolution**: If detections are found, the action sends a PATCH
    request to the Vectra AI detections endpoint to mark all identified detections
    as 'fixed'.

    4.  **Result Reporting**: The action provides a summary of how many detections
    were updated and attaches the raw API response as a JSON result for further processing.


    ### Additional Notes

    - This action does not automatically iterate over SOAR entities; it requires the
    specific Vectra Entity ID as a parameter.

    - If the provided ID does not exist or has no active detections, the action will
    report a failure or a message indicating no detections were found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Changes the state of detections in the Vectra AI platform from active/triaged
      to 'fixed' for the specified entity.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: "### General Description\nThe **Ping** action is a utility designed\
    \ to verify the connectivity between the Google SecOps (Chronicle) server and\
    \ the Vectra platform. It ensures that the integration is properly configured\
    \ and that the server can communicate with the Vectra API using the provided credentials.\n\
    \n### Parameters Description\n| Parameter | Type | Mandatory | Description |\n\
    | :--- | :--- | :--- | :--- |\n| API Root | String | Yes | The base URL of the\
    \ Vectra instance (e.g., `https://<instance>.vectra.ai`). |\n| API Token | String\
    \ | Yes | The authentication token used to authorize requests to the Vectra API.\
    \ |\n| Verify SSL | Boolean | Yes | Specifies whether to verify the SSL certificate\
    \ of the Vectra server. Defaults to `True`. |\n\n### Additional Notes\n- This\
    \ action does not interact with any entities or alert data; it is strictly a health\
    \ check for the integration.\n- Failure typically indicates incorrect configuration\
    \ parameters (URL/Token) or network-level blocking (Firewall/Proxy).\n\n### Flow\
    \ Description\n1. **Initialization:** The script initializes the Siemplify action\
    \ and starts logging the process.\n2. **Configuration Extraction:** It retrieves\
    \ the integration's configuration parameters, including the API Root, API Token,\
    \ and SSL verification setting.\n3. **Manager Setup:** It instantiates the `VectraQUXManager`\
    \ using the provided configuration.\n4. **Connectivity Test:** The manager executes\
    \ the `test_connectivity()` method, which performs a GET request to the Vectra\
    \ hosts endpoint (`/api/v2.5/hosts`).\n5. **Result Handling:** \n    - If the\
    \ API call is successful, it sets the result to `True` and provides a success\
    \ message.\n    - If an exception occurs (e.g., 401 Unauthorized, 404 Not Found,\
    \ or Connection Timeout), it captures the error and sets the result to `False`.\n\
    6. **Finalization:** The action concludes by returning the connectivity status\
    \ and an informative message to the SOAR interface."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Assignment:
  ai_description: >-
    Removes the user assignment for a specified Host or Account entity in Vectra QUX.
    The action identifies the assignment associated with the provided Entity ID and
    type, then performs a deletion to clear the assignment state.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity ID | string | Yes | The numeric identifier of the entity (Account or
    Host) from which the assignment should be removed. |

    | Entity Type | ddl | Yes | The type of entity being targeted. Options are 'Account'
    or 'Host'. |


    ### Flow Description

    1. **Initialization**: Retrieves configuration parameters (API Root, Token, SSL
    verification) and action inputs (Entity ID and Type).

    2. **Validation**: Validates that the provided Entity ID is a valid integer.

    3. **Discovery**: Fetches current entity details from Vectra QUX to verify if
    an assignment exists for the specified entity.

    4. **Identification**: Extracts the `assignment_id` from the entity's current
    data if present.

    5. **Execution**: Performs a DELETE request to the Vectra API using the `assignment_id`
    to remove the assignment.

    6. **Result Reporting**: Returns a success message if the assignment was deleted,
    or a failure if no assignment was found for that entity.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes/deletes an existing assignment of a user to a specific host or account
      in the Vectra QUX platform via a DELETE request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Group:
  ai_description: >-
    ### General Description

    Removes specific members from a Vectra AI group based on a provided Group ID and
    a list of member identifiers. This action interacts with the Vectra AI API to
    modify group membership and provides a detailed summary of successfully removed
    versus missing members.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Group ID | String | Yes | The unique numeric identifier of the group from which
    members will be removed. |

    | Members | String | Yes | A comma-separated list of member identifiers to be
    removed. Identifiers must match the group type (e.g., Hostnames for host groups,
    IP addresses for IP groups, UIDs for account groups, or domains for domain groups).
    |


    ### Flow Description

    1. **Validation**: Validates that the Group ID is a positive integer.

    2. **Member Retrieval**: Fetches the current list of group members to compare
    against requested removals.

    3. **API Interaction**: Executes a PATCH request to the Vectra AI groups endpoint
    to remove the specified members.

    4. **Result Processing**: Analyzes the API response to determine which members
    were successfully removed and which were not present in the group.

    5. **Output Generation**: Adds an HTML table to the action results showing updated
    group properties and returns the full JSON response from the external system.


    ### Additional Notes

    - This action does not automatically iterate over entities from the Google SecOps
    case context; it operates solely on the values provided in the input parameters.

    - Providing identifiers that do not match the group's specific type (e.g., an
    IP in a hostname group) will result in those members not being removed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Modifies the membership of a group on the Vectra AI platform by removing specified
      member identifiers via a PATCH request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Note:
  ai_description: >-
    ### General Description Removes a specific note from an entity in the Vectra platform.
    This action allows analysts to manage and clean up notes associated with Accounts,
    Hosts, or Detections within the Vectra AI ecosystem by providing the specific
    identifiers for both the target entity and the note. ### Parameters Description
    | Parameter | Type | Mandatory | Description | | :--- | :--- | :--- | :--- | |
    Entity ID | String | Yes | The unique identifier of the entity (Account, Host,
    or Detection) in Vectra from which the note should be removed. | | Note ID | String
    | Yes | The unique identifier of the specific note to be deleted. | | Entity Type
    | DDL | Yes | The type of the target entity. Valid options are: Account, Host,
    or Detection. | ### Additional Notes - Both the Entity ID and Note ID are validated
    as integers before the request is initiated. - The action performs a hard deletion
    on the external Vectra system. ### Flow Description 1. **Parameter Initialization**:
    The action extracts the API credentials and the user-provided parameters (Entity
    ID, Note ID, and Entity Type). 2. **Manager Setup**: Initializes the VectraQUXManager
    to handle communication with the Vectra API. 3. **Validation**: Validates that
    the Entity ID and Note ID are valid integers. 4. **API Execution**: Sends a DELETE
    request to the Vectra API targeting the specific note ID associated with the provided
    Entity ID and Type. 5. **Finalization**: Reports a success message to the case
    wall if the note is successfully removed or raises an error if the operation fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Performs a DELETE request to the Vectra API to permanently remove a note from
      an Account, Host, or Detection.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Tags:
  ai_description: >-
    ### General Description

    The **Remove Tags** action allows users to programmatically remove specific tags
    from a target entity within the Vectra QUX platform. It supports modifying tags
    for Accounts, Hosts, and Detections by identifying them via their unique numerical
    IDs. This action is essential for managing entity lifecycles and metadata within
    the Vectra security environment.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Tags | String | Yes | A comma-separated list of tags to be removed from the
    specified entity. |

    | Entity ID | String | Yes | The unique numerical identifier of the target entity
    in Vectra QUX. |

    | Entity Type | DDL | Yes | The category of the entity from which tags will be
    removed. Options include: `Account`, `Host`, and `Detection`. |


    ### Additional Notes

    - The action requires a valid integer for the **Entity ID**.

    - If none of the provided tags exist on the entity, the action will fail and report
    that the tags were not found.

    - The action performs a partial update, meaning it fetches current tags and submits
    the filtered list back to the external system.


    ### Flow Description

    1. **Parameter Initialization**: Retrieves configuration (API Root, Token) and
    action parameters (Tags, Entity ID, Entity Type).

    2. **Validation**: Converts the comma-separated tag string into a unique list
    and validates that the Entity ID is an integer.

    3. **Existing Tag Fetch**: Calls the Vectra QUX API to retrieve the current tags
    assigned to the specified entity.

    4. **Comparison and Removal**: Compares requested tags against the retrieved list.
    Successfully identified tags are removed from the internal list.

    5. **External Update**: Submits a PATCH request to the Vectra QUX `tagging` endpoint
    with the updated tag set.

    6. **Result Generation**: Outputs a status message, a detailed JSON result, and
    a data table showing the final state of the entity's tags.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      The action sends a PATCH request to the Vectra QUX API to update the tags of
      a specific entity (Account, Host, or Detection), effectively removing the specified
      tags from that entity's record in the external system.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Resolve Assignment:
  ai_description: >-
    Resolves a specific assignment in VectraQUX based on a provided Assignment ID
    and Outcome ID. This action allows security analysts to close out assignments
    by specifying whether the activity was benign, malicious, or a false positive,
    while optionally adding triage rules and notes.


    ### Parameters Description:


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Outcome ID | String | Yes | The ID representing the resolution outcome. Default
    values: 1 (Benign True Positive), 2 (Malicious True Positive), 3 (False Positive).
    Custom IDs are supported. |

    | Assignment ID | String | Yes | The unique identifier of the assignment to be
    resolved. |

    | Note Title | String | No | A note or title to be associated with the resolution
    for documentation purposes. |

    | Triage As | String | No | The triage rule name to apply during resolution. Requires
    at least one Detection ID if used. |

    | Detection IDs | String | No | A comma-separated list of integer detection IDs
    to be associated with the resolution. |


    ### Additional Notes:

    - **Validation Logic:** If the 'Triage As' parameter is configured, the 'Detection
    IDs' parameter becomes effectively mandatory; the action will fail if triage is
    provided without at least one detection ID.

    - **Input Types:** Assignment ID, Outcome ID, and all Detection IDs must be valid
    integers.


    ### Flow Description:

    1. **Initialization:** Retrieves configuration details (API Root, Token) and action
    parameters.

    2. **Validation:** Validates that ID fields are integers and checks the 'Triage
    As' string for valid length (minimum 4 characters) and forbidden characters.

    3. **Conditional Check:** Ensures that if a triage rule is being applied, associated
    detection IDs are also provided.

    4. **API Interaction:** Executes a PUT request to the VectraQUX API endpoint `/assignments/{assignment_id}/resolve`
    with the specified outcome and metadata.

    5. **Reporting:** Returns the API response as JSON and creates a 'Resolved Assignment'
    data table in the SOAR interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of an assignment in the VectraQUX platform to 'Resolved'
      and applies specified outcomes, notes, and triage rules.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Accounts:
  ai_description: >-
    ### General Description

    The **Search Accounts** action allows users to query and retrieve account information
    from Vectra QUX based on a wide range of filter criteria. It is designed to list
    accounts that match specific threat scores, certainty levels, privilege categories,
    and detection timestamps. The results are returned as both a raw JSON object and
    a formatted data table for easy analysis within the case.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Order** | DDL | No | Specifies whether the results should be sorted in `Ascending`
    or `Descending` order. |

    | **Limit** | String | No | The maximum number of account records to fetch from
    the API. |

    | **Order By** | DDL | No | The attribute used to sort the results: `t_score`,
    `c_score`, `last_detection_timestamp`, or `id`. |

    | **Fields** | Multi-choice | No | A selection of specific account attributes
    to include in the results (e.g., `id`, `name`, `severity`, `tags`). |

    | **Name** | String | No | Filters accounts by their name. |

    | **State** | DDL | No | Filters based on the account's current state: `Active`
    or `Inactive`. |

    | **Threat GTE** | String | No | Filters for accounts with a Threat score greater
    than or equal to this value. |

    | **Certainty GTE** | String | No | Filters for accounts with a Certainty score
    greater than or equal to this value. |

    | **Last Detection Timestamp GTE** | String | No | Filters for accounts whose
    last detection occurred on or after this timestamp. |

    | **Last Detection Timestamp LTE** | String | No | Filters for accounts whose
    last detection occurred on or before this timestamp. |

    | **Tags** | String | No | Filters accounts by specific tags (comma-separated
    values). |

    | **Note Modified Timestamp GTE** | String | No | Filters accounts based on when
    their notes were last modified (on or after this timestamp). |

    | **Privilege Level** | String | No | Filters accounts by a specific privilege
    level. |

    | **Privilege Category** | DDL | No | Filters accounts by category: `Low`, `Medium`,
    or `High`. |


    ### Additional Notes

    - This action is a standalone search utility and does not require or process entities
    from the current alert context.

    - The `Fields` parameter is expected to be passed as a valid JSON list format
    by the UI.

    - Numeric parameters like `Limit`, `Threat GTE`, and `Certainty GTE` are strictly
    validated as integers.


    ### Flow Description

    1.  **Initialization**: The action extracts the integration configuration (API
    credentials) and the user-provided search parameters.

    2.  **Validation**: It validates numerical inputs (Limit, scores, etc.) and formats
    sorting parameters (e.g., prepending '-' for descending order).

    3.  **API Request**: The `VectraQUXManager` initiates a paginated GET request
    to the `/accounts` endpoint using the compiled query parameters.

    4.  **Data Processing**: The results are parsed, and sensitive or version-specific
    URL strings within the account objects are cleaned up (removing API version prefixes).

    5.  **Output Generation**: The filtered list of accounts is added to the action
    result as a JSON string and a structured data table titled "List Of Accounts".
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Detections:
  ai_description: >-
    ### General Description

    Retrieves a list of detections from Vectra QUX based on a wide variety of search
    criteria and filters. This action allows analysts to query threat detections using
    parameters such as IP addresses, host IDs, threat scores, certainty levels, and
    specific timeframes. The results are returned as a raw JSON payload and presented
    in a formatted data table for easier analysis within the case wall.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Last Timestamp GTE** | string | No | Filter for detections with a 'last_timestamp'
    greater than or equal to the provided value. |

    | **Host ID** | string | No | Filters results by a specific Vectra Host ID. |

    | **Tags** | string | No | A comma-separated list of tags to filter detections.
    |

    | **Is Targeting Key Asset** | ddl | No | Filter based on whether detections are
    targeting key assets (True/False). |

    | **Note Modified Timestamp GTE** | string | No | Filters detections based on
    the timestamp of the last note modification. |

    | **Order** | ddl | No | Specifies the sort order (Ascending or Descending). |

    | **Limit** | string | No | The maximum number of records to retrieve. Defaults
    to system limits if not provided. |

    | **Order By** | ddl | No | The field to sort the results by (e.g., last_timestamp,
    t_score, certainty). |

    | **Fields** | multi_choice | No | A selection of specific data fields to include
    in the output. |

    | **State** | ddl | No | Filter detections by their current state (Active, Inactive,
    Fixed). |

    | **Detection Type** | string | No | Filter by a specific type of detection (e.g.,
    'Brute Force'). |

    | **Detection Category** | ddl | No | Filter by category (e.g., Command and Control,
    Lateral Movement). |

    | **Src IP** | string | No | Filter detections associated with a specific source
    IP address. |

    | **Threat GTE** | string | No | Filter for detections with a threat score greater
    than or equal to this value. |

    | **Certainty GTE** | string | No | Filter for detections with a certainty score
    greater than or equal to this value. |


    ### Additional Notes

    - This action is a search utility and does not require or run automatically on
    entities present in the SOAR case context.

    - The 'Limit', 'Threat GTE', and 'Certainty GTE' parameters must be valid integers;
    the script includes validation logic to ensure correct formatting.

    - URL fields in the results are automatically cleaned to remove internal API version
    segments (e.g., /api/v2.5) for better readability.


    ### Flow Description

    1. **Initialization**: Connects to the Vectra QUX API using provided credentials
    and configuration.

    2. **Parameter Processing**: Extracts and validates the user-provided search filters
    and sorting options.

    3. **Data Retrieval**: Executes a GET request to the Vectra QUX `/detections`
    endpoint, utilizing pagination if the requested limit exceeds the default page
    size.

    4. **Data Sanitization**: Iterates through the results to normalize URLs and extract
    key fields (ID, type, category, timestamps, state).

    5. **Output Generation**: Populates the action result with a full JSON list of
    detections and constructs a CSV-formatted data table titled 'List Of Detections'
    for the SOAR interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Search Hosts:
  ai_description: >-
    ### General Description

    The **Search Hosts** action allows users to query and retrieve a list of host
    records from the Vectra AI platform based on a wide range of filtering criteria.
    This action is primarily used for threat hunting, investigation, and asset discovery
    by identifying hosts that meet specific security postures, such as threat scores,
    certainty levels, or active traffic status.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Limit | String | No | The maximum number of host records to retrieve. Must be
    a positive integer. |

    | Tags | String | No | Filter hosts by associated tags. |

    | Last Source | String | No | Filter hosts based on the last reporting source.
    |

    | Order | DDL | No | Specify the order of results: Ascending or Descending. |

    | Fields | Multi-select | No | Choose specific data fields to include in the output
    (e.g., id, name, ip, threat). |

    | Name | String | No | Filter hosts by their name. |

    | State | DDL | No | Filter hosts by their state: Active or Inactive. |

    | Threat GTE | String | No | Retrieve hosts with a threat score greater than or
    equal to this value. |

    | Certainty GTE | String | No | Retrieve hosts with a certainty score greater
    than or equal to this value. |

    | Last Detection Timestamp GTE | String | No | Filter hosts detected after this
    timestamp. |

    | Last Detection Timestamp LTE | String | No | Filter hosts detected before this
    timestamp. |

    | Is Targeting Key Asset | DDL | No | Filter hosts based on whether they are targeting
    designated key assets (True/False). |

    | Privilege Level GTE | String | No | Filter hosts with a privilege level greater
    than or equal to this value. |

    | Privilege Category | DDL | No | Filter by privilege category (Low, Medium, High).
    |

    | Active Traffic | DDL | No | Filter hosts that have shown active traffic in the
    last two hours (True/False). |

    | Order By | DDL | No | Field to sort the results by (t_score, c_score, id, or
    last_detection_timestamp). |

    | Note Modified Timestamp GTE | String | No | Filter hosts whose notes were modified
    after this timestamp. |


    ### Additional Notes

    - If no hosts are found matching the criteria, the action will complete successfully
    with an informative message.

    - The action performs data normalization on URL fields in the results to remove
    internal API versioning prefixes.

    - Numerical inputs like 'Limit' and 'Threat GTE' are validated for proper integer
    format.


    ### Flow Description

    1. **Initialization:** The action extracts API configuration and user-defined
    filtering parameters.

    2. **Validation:** It validates numerical parameters (Limit, Threat, Certainty,
    Privilege Level) to ensure they are valid non-negative integers.

    3. **API Request:** It communicates with the Vectra AI API `/api/v2.5/hosts` endpoint
    using a GET request with the defined filters and handles pagination.

    4. **Data Processing:** The action processes the raw JSON response to clean up
    URL structures and extracts key fields for summary reporting.

    5. **Reporting:** It outputs a JSON blob of all found hosts and populates a 'List
    Of Hosts' data table with essential host details for the SOAR interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Unmark Detection Fixed:
  ai_description: >-
    Unmarks specific detections as fixed in the Vectra platform. This action is used
    to reopen detections that were previously marked as resolved or fixed, ensuring
    they are visible for further investigation or monitoring.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Detection IDs | String | Yes | A comma-separated list of numeric identifiers
    for the detections to be unmarked as fixed. Each ID is validated as a positive
    integer before the request is processed. |


    ### Flow Description

    1. **Initialization:** Retrieves connection details (API Root, API Token, SSL
    verification) and the 'Detection IDs' input.

    2. **Validation:** Splits the input string of IDs and validates that each identifier
    is a valid integer.

    3. **API Interaction:** Connects to the Vectra API and sends a `PATCH` request
    to the detections endpoint.

    4. **Mutation:** Updates the `mark_as_fixed` status to `False` for all provided
    detection IDs.

    5. **Completion:** Returns the API response as a JSON object and provides a success
    or failure message based on the execution result.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the 'fixed' status attribute of specific detections in the Vectra platform
      to 'False'.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Assignment:
  ai_description: >-
    ### General Description

    Updates the assigned user for a specific assignment linked to an entity (Host
    or Account) in the Vectra AI platform. This action is used to reassign investigative
    responsibility for detections associated with a particular entity.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Entity ID | The unique identifier of the entity (Host or Account) to update
    the assignment for. | String | Yes |

    | Entity Type | The type of the entity. Can be 'Account' or 'Host'. | DDL | Yes
    |

    | User ID | The identifier of the Vectra user to whom the assignment will be reassigned.
    | String | Yes |


    ### Flow Description

    1. **Validation**: The action validates that the provided Entity ID and User ID
    are valid integers.

    2. **Entity Lookup**: Retrieves the current entity information from Vectra to
    extract its active assignment ID.

    3. **Assignment Update**: Sends a PUT request to the Vectra API to update the
    assignment ID with the new User ID.

    4. **Internal Reporting**: Adds the raw API response to the action results and
    creates a data table on the case wall titled 'Updated Assignment' summarizing
    the change.


    ### Additional Notes

    If the entity does not currently have an active assignment, the action will fail
    with an error message indicating that no assignment was found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the assigned user for a specific assignment ID in Vectra AI via a PUT
      request.
    fetches_data: true
    internal_data_mutation_explanation: >-
      Creates a data table on the case wall containing details of the updated assignment.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
