Acknowledge Console Alert:
  ai_description: >-
    ### General Description

    This action sets an alert as acknowledged on the Thinkst Canary console. It allows
    analysts to synchronize the response state of a Canary detection directly from
    Google SecOps, ensuring the external console reflects that the incident is being
    handled.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    - This action depends on the presence of an `AlertId` within the `additional_properties`
    of the security events associated with the alert. This ID is typically mapped
    by the Thinkst Canary connector during the ingestion process.

    - The action requires integration-level configuration (API Key and Console Hash)
    to be properly set up in the environment.


    ### Flow Description

    1. **Identify Incident ID**: The action accesses the security events of the current
    Google SecOps alert and extracts the `AlertId` from the first event's additional
    properties.

    2. **Authentication**: It initializes a connection to the Canary Console using
    the configured API Key and Console Hash.

    3. **API Request**: The action sends a POST request to the Canary API's acknowledge
    endpoint (`/api/v1/incident/acknowledge`) with the specific incident identifier.

    4. **Completion**: If the API responds with a success result, the action completes
    successfully and updates the execution status in the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of an incident on the Thinkst Canary console to 'Acknowledged'
      via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Verifies the connectivity and authentication credentials for the Thinkst Canary
    integration. This action utilizes the `/ping` endpoint of the Canary Console API
    to ensure that the provided API Key and Console Hash are valid and that the SOAR
    platform can successfully communicate with the external service.


    ### Parameters Description

    This action uses configuration parameters defined at the integration level rather
    than action-specific input parameters. If any parameters were present, they would
    be described below:


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | API Key | String | Yes | The authentication token used to access the Thinkst
    Canary Console API. |

    | Console Hash | String | Yes | The unique domain identifier for your Canary Console
    (the prefix of `.canary.tools`). |

    | Verify SSL | Boolean | No | Determines whether the action should verify the
    SSL certificate of the Canary Console. |


    ### Additional Notes

    - This action performs a basic health check and does not process or affect any
    case entities.

    - It validates that the configuration is not using default placeholder values
    for the API Key and Console Hash before attempting the connection.


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the 'API Key', 'Console Hash',
    and 'Verify SSL' settings from the integration's global configuration.

    2. **Validation**: It checks if the API Key and Console Hash are set to their
    default placeholder values. If they are, the action fails immediately with a descriptive
    error message.

    3. **Manager Initialization**: A `ThinkstActionManager` is initialized with the
    retrieved credentials and SSL settings.

    4. **API Request**: The manager executes a GET request to the `{console_url}/api/v1/ping`
    endpoint.

    5. **Response Handling**: The action checks the API response for a 'result' field
    equal to 'success'.

    6. **Final Status**: It reports a successful connection message if the API returns
    success, otherwise, it indicates a failure to connect.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
