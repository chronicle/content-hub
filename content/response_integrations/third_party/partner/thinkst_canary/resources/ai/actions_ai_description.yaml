ack_alert:
  ai_description: >-
    ### General Description

    This action acknowledges a specific alert (incident) on the Thinkst Canary console.
    It transition the state of the alert in the external system to 'Acknowledged'.
    The action relies on finding an 'AlertId' within the security events of the current
    Google SecOps alert, which is typically populated during the alert ingestion process
    by the Thinkst Canary connector.


    ### Parameters Description

    This action primarily uses configuration parameters defined at the integration
    level rather than action-specific parameters.


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **API Key** | String | Yes | The API Key used to authenticate with the Thinkst
    Canary Console. |

    | **Console Hash** | String | Yes | The specific subdomain/hash of your Canary
    console (e.g., 'example' in 'https://example.canary.tools'). |

    | **Verify SSL** | Boolean | No | If enabled, the action will verify the SSL certificate
    of the Canary console. |


    ### Additional Notes

    *   **AlertId Dependency:** The action expects the first security event associated
    with the alert to have an additional property named `AlertId`. If this property
    is missing, the action will fail.

    *   **Integration Level Config:** The parameters are extracted from the integration
    settings rather than manual input per action execution.


    ### Flow Description

    1.  **Extraction:** The script extracts the API Key, Console Hash, and SSL verification
    settings from the integration configuration.

    2.  **Validation:** It checks if the API Key and Console Hash are set to valid
    values (not defaults).

    3.  **Identifier Retrieval:** The script looks into the `current_alert` and accesses
    its `security_events`. It attempts to retrieve the `AlertId` from the `additional_properties`
    of the first event.

    4.  **API Call:** It sends a POST request to the Thinkst Canary API endpoint `/api/v1/incident/acknowledge`
    using the retrieved `AlertId`.

    5.  **Conclusion:** The action completes with a success message if the API returns
    a success result, otherwise, it reports a failure.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action performs a POST request to the Thinkst Canary API to change the
      status of an incident to 'Acknowledged'.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
ping:
  ai_description: >-
    Verifies the connectivity and authentication credentials for the Thinkst Canary
    Console. This action uses the `/ping` API endpoint to ensure that the provided
    API Key and Console Hash are valid and that the Google SecOps environment can
    reach the external service.


    ### Parameters

    | Parameter Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | API Key | The authentication token used to access the Canary Console API. |
    String | Yes |

    | Console Hash | The specific subdomain or identifier for your Thinkst Canary
    Console instance. | String | Yes |

    | Verify SSL | Determines whether to validate the SSL certificate of the Canary
    Console during the request. | Boolean | No |


    ### Additional Notes

    - This action does not process or require entities; it is a system-level connectivity
    test.

    - If the API Key or Console Hash remain as the default placeholder values, the
    action will fail with a descriptive error message.


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the API Key, Console Hash,
    and SSL verification settings from the integration's configuration.

    2. **Input Validation**: It verifies that the API Key and Console Hash are not
    set to default placeholder values.

    3. **API Interaction**: It initializes the `ThinkstActionManager` and performs
    a GET request to the `/ping` endpoint.

    4. **Status Evaluation**: It checks the JSON response for a successful result
    string.

    5. **Execution Completion**: Returns a success message if the connection is established;
    otherwise, it reports a failure.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
