Create Abuse Alert:
  ai_description: >-
    ### General Description

    This action creates an abuse alert in the DoppelVision system for a provided entity
    value (typically a URL). It is used to report or flag suspicious entities directly
    to Doppel's abuse box for further investigation or mitigation. The action will
    fail if the provided entity is invalid or protected within the Doppel system.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Entity | The specific entity value (e.g., a URL or domain) to be reported to
    the abuse box. | String | Yes |


    ### Flow Description

    1. **Extraction**: The action retrieves connection credentials (API Key, User
    API Key, Org Code) from the integration configuration and the target entity from
    the action parameters.

    2. **Manager Initialization**: Initializes the DoppelManager with the provided
    credentials to handle API communication.

    3. **API Request**: Executes a POST request to the DoppelVision API (`/alert/abuse`)
    containing the entity identifier.

    4. **Result Processing**: If the alert is successfully created, the response data
    from Doppel is attached to the action results as a JSON object.

    5. **Completion**: The action concludes with a success message if the alert was
    created, or a failure state if the API returned an error or the entity was protected.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new abuse alert record in the DoppelVision platform via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Alert:
  ai_description: >-
    ### General Description

    Creates a new alert within the DoppelVision system for a specific entity. This
    action is used to programmatically trigger alerts in Doppel for monitoring or
    security analysis of a specific indicator, such as a URL or domain.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity | String | Yes | The identifier (e.g., a URL) for which the alert should
    be created in the DoppelVision system. |


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the API Key, User API Key,
    and Organization Code from the integration's shared configuration.

    2. **Parameter Retrieval**: The action extracts the target entity string provided
    by the user.

    3. **Manager Initialization**: A `DoppelManager` instance is initialized with
    the retrieved credentials.

    4. **Alert Creation**: The action calls the `create_alert` method, which sends
    a POST request to the Doppel API (`/v1/alert`) with the entity identifier.

    5. **Result Processing**: If the API call is successful, the resulting alert JSON
    is stored in the action's result data. If the request fails or returns an empty
    response, the action is marked as failed.


    ### Additional Notes

    - This action performs a state-changing operation (POST) in the external Doppel
    system.

    - Ensure the 'Entity' provided is formatted correctly (e.g., as a URL) as per
    Doppel's requirements.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new alert record for the specified entity in the external DoppelVision
      system via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Alert:
  ai_description: >-
    ### General Description

    Retrieves the comprehensive details of a specific alert from the DoppelVision
    platform. This action allows users to look up alert information using either a
    specific Alert ID or the Entity (typically a URL) associated with the alert. It
    is primarily used for investigative purposes to gather context about a known threat
    or alert entry.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity | string | No | The specific entity (e.g., a URL) for which to fetch
    alert details. **Note:** Either this or 'Alert_ID' must be provided, but not both.
    |

    | Alert_ID | string | No | The unique identifier of the Alert on the Doppel Tenant.
    **Note:** Either this or 'Entity' must be provided, but not both. |


    ### Additional Notes

    - **Validation Logic:** The action will fail if both 'Entity' and 'Alert_ID' are
    provided simultaneously, or if neither is provided. Users must choose exactly
    one search method.

    - **Output:** The raw JSON data returned by the Doppel API is stored in the `JsonResult`
    for use in subsequent playbook steps.


    ### Flow Description

    1. **Initialization:** Extracts integration configuration parameters (API Keys
    and Organization Code) and action parameters (`Entity`, `Alert_ID`).

    2. **Validation:** Checks that only one of the search identifiers is provided.

    3. **API Request:** Communicates with the Doppel Manager to perform a GET request
    to the `/alert` endpoint with the relevant query parameter.

    4. **Data Handling:** If an alert is found, the script attaches the JSON response
    to the action results. If no alert is found or an error occurs, the action transitions
    to a failed state.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Alerts:
  ai_description: >-
    ### General Description

    Fetches a list of alerts from the DoppelVision platform based on various filtering
    criteria. This action is designed to retrieve broad sets of threat data and alert
    details from the Doppel tenant, which can then be used for further analysis or
    reporting within a playbook. It functions as a standalone data retrieval action
    and does not process specific entities from the case context.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Search Key | string | No | Currently only supports search by URL string. |

    | Product | ddl | No | Product category the report belongs to (e.g., domains,
    social_media, mobile_apps, ecommerce, crypto, emails, paid_adds). |

    | Created Before | string | No | Filter alerts created before this date. Expected
    format: 'YYYY-MM-DDTHH:MM:SS'. |

    | Created After | string | No | Filter alerts created after this date. Expected
    format: 'YYYY-MM-DDTHH:MM:SS'. |

    | Sort Type | ddl | No | The field to sort the reports by. Defaults to 'date_sourced'.
    Options: 'date_sourced', 'date_last_actioned'. |

    | Sort Order | ddl | No | The order to sort the reports by. Defaults to 'desc'.
    Options: 'asc', 'desc'. |

    | Page | string | No | Page number for pagination; defaults to 0. |

    | Queue State | ddl | No | Filter alerts by their current queue status (e.g.,
    doppel_review, actioned, taken_down). |

    | Tags | string | No | A comma-separated list of tags used to filter the alerts.
    |


    ### Flow Description

    1. **Initialization**: Extracts the API Key, User API Key, and Organization Code
    from the integration configuration.

    2. **Parameter Parsing**: Extracts user-provided filtering parameters such as
    date ranges, sorting preferences, and product categories. If tags are provided,
    they are split into a list.

    3. **Query Construction**: Builds a filter dictionary containing all non-null
    search parameters.

    4. **API Request**: Uses the `DoppelManager` to execute a GET request to the `/alerts`
    endpoint with the constructed filters.

    5. **Output Generation**: If alerts are found, they are added to the action's
    result JSON. The action completes with a success status and an informative message
    about the number of alerts retrieved.


    ### Additional Notes

    This action is a query-based utility and does not iterate over or modify entities
    within the Google SecOps case environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Tests the connectivity and validates the credentials (API Key, User API Key, and
    Organization Code) for the DoppelVision integration. This utility action is primarily
    used during configuration to ensure the SOAR platform can communicate effectively
    with the Doppel API.


    ### Parameters description

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | None | N/A | N/A | This action does not have any action-specific parameters.
    |


    ### Additional notes

    This action relies on the integration's global configuration parameters (API Key,
    User API Key, and Organization Code) rather than local action parameters. It performs
    a basic GET request to the `/alerts` endpoint to verify authentication.


    ### Flow description

    1. **Extract Configuration**: Retrieves the integration's API Key, User API Key,
    and Organization Code from the environment settings.

    2. **Initialize Manager**: Creates an instance of the DoppelManager using the
    extracted credentials.

    3. **Test Connection**: Executes a GET request to the Doppel API alerts endpoint.

    4. **Handle Result**: Returns a success message if the connection is established
    and credentials are valid, or an error message if the test fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Alert:
  ai_description: >-
    ### General Description

    Updates the status and state of a specific alert within the DoppelVision platform.
    This action manages the alert lifecycle by modifying its queue assignment and
    the operational state of the associated entity. It is primarily used to move alerts
    through workflow stages such as confirmation, takedown, or archiving.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Alert_ID | String | No* | The unique identity for a specific alert in the Doppel
    tenant. Required if 'Entity' is not provided. |

    | Entity | String | No* | The entity identifier (usually a URL) associated with
    the alert. Required if 'Alert_ID' is not provided. |

    | Queue_State | DDL | Yes | The target workflow state for the alert. Options:
    `doppel_review`, `needs_confirmation`, `monitoring`, `taken_down`, `actioned`,
    `archived`. |

    | Entity_State | DDL | Yes | The target operational state for the entity. Options:
    `active`, `down`, `parked`. |


    ### Additional Notes

    * **Mutual Exclusivity:** The action requires either the `Alert_ID` or the `Entity`
    parameter to be populated to identify the alert. Providing both parameters or
    neither will result in a validation error and action failure.


    ### Flow Description

    1. **Parameter Extraction:** Retrieves API credentials (API Key, User API Key,
    Org Code) from the integration configuration and alert details from the action
    parameters.

    2. **Input Validation:** Ensures that the user has provided exactly one identification
    method (either `Alert_ID` or `Entity`).

    3. **External API Interaction:** Executes a `PUT` request via the `DoppelManager`
    to the DoppelVision API endpoint. This request updates the `queue_state` and `entity_state`
    in the external system.

    4. **Outcome Processing:** Captures the JSON response of the updated alert from
    the API and attaches it to the action results. If the API call fails or returns
    an empty response, the action marks the execution as failed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the queue status and entity operational state of an existing alert in
      the DoppelVision platform via a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
