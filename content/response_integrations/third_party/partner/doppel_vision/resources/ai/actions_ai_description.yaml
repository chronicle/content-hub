Create Abuse Alert:
  ai_description: >-
    ### General Description

    Creates an abuse alert in DoppelVision for a specified entity, typically a URL.
    This action is designed to report malicious or suspicious entities directly to
    the Doppel abuse box for further analysis and mitigation. It is important to note
    that the action will fail if the provided entity is considered 'protected' (e.g.,
    major domains like google.com) within the Doppel system.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Entity | The specific value (e.g., a URL) that should be reported to the abuse
    box. | String | Yes |


    ### Flow Description

    1. **Configuration Retrieval**: The action extracts the necessary API credentials,
    including the API Key, User API Key, and Organization Code, from the integration
    configuration.

    2. **Input Extraction**: The mandatory 'Entity' parameter is retrieved from the
    action input.

    3. **Manager Initialization**: A `DoppelManager` instance is created to handle
    communication with the DoppelVision API.

    4. **API Request**: The action performs a POST request to the `/alert/abuse` endpoint
    of the DoppelVision API, passing the entity value in the payload.

    5. **Result Handling**: If the request is successful, the resulting alert data
    is attached to the action as a JSON result. If the request fails or the entity
    is invalid/protected, the action returns a failure status.


    ### Additional Notes

    This action does not process entities from the Google SecOps entity scope; it
    operates strictly on the single string value provided in the 'Entity' parameter.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new abuse alert record in the DoppelVision platform via a POST request
      to the /alert/abuse endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Alert:
  ai_description: "### General Description\nCreates a new alert in the DoppelVision\
    \ system for a specified entity. This action is designed to programmatically trigger\
    \ alert creation within Doppel's monitoring environment, allowing security teams\
    \ to flag specific assets or URLs for investigation directly from Google SecOps.\n\
    \n### Parameters Description\n| Parameter | Type | Mandatory | Description |\n\
    | :--- | :--- | :--- | :--- |\n| Entity | String | Yes | The specific entity (e.g.,\
    \ a URL) for which the alert should be created. Defaults to 'https://dummyrul.com'\
    \ if not specified. |\n\n### Flow Description\n1. **Credential Extraction**: The\
    \ action retrieves the API Key, User API Key, and Organization Code from the integration's\
    \ configuration settings.\n2. **Input Retrieval**: The target entity string is\
    \ extracted from the action parameters.\n3. **Manager Initialization**: A `DoppelManager`\
    \ instance is created to handle communication with the DoppelVision API.\n4. **API\
    \ Request**: The action calls the `create_alert` method, which sends a POST request\
    \ to the `/alert` endpoint of the DoppelVision API with the entity in the payload.\n\
    5. **Result Handling**: \n    - If the API returns a successful response, the\
    \ alert details are added to the action's JSON results.\n    - If the response\
    \ is empty or the request fails, an exception is raised, and the action is marked\
    \ as failed.\n6. **Completion**: The action concludes by logging the status and\
    \ providing an output message to the user.\n\n### Additional Notes\n- The action\
    \ will fail if the provided entity is invalid or if it is a protected entity within\
    \ the DoppelVision system."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new alert record in the DoppelVision platform via a POST request to
      the /alert endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Alert:
  ai_description: >-
    ### General Description

    Retrieves detailed information about a specific alert from the DoppelVision platform.
    This action allows users to fetch alert metadata, status, and associated data
    by providing either a unique Alert ID or an entity identifier (typically a URL).


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity | String | No | The entity identifier (e.g., a URL) associated with the
    alert you wish to retrieve. |

    | Alert_ID | String | No | The unique identifier of the alert within the Doppel
    tenant. |


    ### Additional Notes

    - Either the **Entity** or the **Alert_ID** must be provided for the action to
    execute.

    - Providing both parameters simultaneously will result in an execution failure.

    - This action is read-only and does not modify data in DoppelVision or Google
    SecOps.


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves the API credentials (API Key,
    User API Key, Org Code) and the user-provided search parameters (Entity or Alert_ID).

    2. **Validation:** It checks that exactly one search parameter is provided to
    ensure a valid API query.

    3. **API Request:** The action uses the `DoppelManager` to perform a GET request
    to the DoppelVision `/alert` endpoint using the provided identifier.

    4. **Result Processing:** If an alert is successfully retrieved, the data is stored
    in the action's JSON result. If no alert is found or an error occurs, the action
    reports a failure.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Alerts:
  ai_description: >-
    ### General Description

    This action retrieves a list of alerts from the Doppel platform based on specified
    filtering criteria. It is primarily used for searching and fetching alert data
    into Google SecOps for further analysis or reporting. The action supports various
    filters including product categories, time ranges, queue statuses, and tags.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Search Key | String | No | Filters alerts by a specific search term, currently
    primarily supporting URL searches. |

    | Product | DDL | No | Filters alerts by product category (e.g., domains, social_media,
    mobile_apps, ecommerce, crypto, emails, paid_adds). |

    | Created Before | String | No | Filters alerts created before a specific ISO
    8601 timestamp (e.g., '2024-01-05T13:45:30'). |

    | Created After | String | No | Filters alerts created after a specific ISO 8601
    timestamp (e.g., '2024-01-05T13:45:30'). |

    | Sort Type | DDL | No | The field to sort the results by. Options are 'date_sourced'
    (default) or 'date_last_actioned'. |

    | Sort Order | DDL | No | The order of sorting. Options are 'desc' (default) or
    'asc'. |

    | Page | String | No | The page number for paginated results; defaults to 0. |

    | Queue State | DDL | No | Filters alerts by their current queue status (e.g.,
    doppel_review, actioned, taken_down). |

    | Tags | String | No | A comma-separated list of tags to filter the alerts. |


    ### Additional Notes

    - This action does not operate on specific entities within the Google SecOps environment;
    it performs a global fetch of alerts from the Doppel tenant.

    - If no filters are provided, the action attempts to fetch all available alerts
    subject to default pagination and sorting.


    ### Flow Description

    1. **Initialization**: Extracts API credentials (API Key, User API Key, Org Code)
    from the integration configuration.

    2. **Parameter Extraction**: Retrieves optional filtering parameters from the
    action input.

    3. **Data Parsing**: Converts the comma-separated 'Tags' string into a list format
    compatible with the API.

    4. **Filter Construction**: Builds a filter dictionary, removing any parameters
    that were not provided by the user.

    5. **API Request**: Uses the `DoppelManager` to execute a GET request to the Doppel
    `/alerts` endpoint with the constructed filters.

    6. **Result Processing**: If alerts are returned, they are added to the action's
    JSON results. If no alerts are found, the action fails with an error message.

    7. **Completion**: Finalizes the action execution and logs the status.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility designed to verify the connectivity between Google
    SecOps and the DoppelVision platform. Its primary purpose is to validate the integration's
    configuration, specifically the API Key, User API Key, and Organization Code,
    ensuring that the system can successfully communicate with the Doppel API.


    ### Parameters

    There are no parameters for this action.


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the `API Key`, `User API
    Key`, and `Organization Code` from the DoppelVision integration settings.

    2. **Manager Initialization**: It initializes the `DoppelManager` using the retrieved
    credentials to handle API communication.

    3. **Connectivity Test**: The action invokes the `connection_test` method, which
    performs a `GET` request to the Doppel `/alerts` endpoint.

    4. **Validation**: If the API responds successfully (indicating valid credentials
    and network path), the action returns a success status. If the request fails due
    to invalid credentials or connectivity issues, it returns a failure message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Alert:
  ai_description: >-
    Updates the status and state of an alert within the DoppelVision platform. This
    action allows users to modify the lifecycle stage and the operational state of
    a specific alert identified by either its unique Alert ID or the associated Entity
    URL.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Alert_ID | string | No | The unique identifier for the specific alert in the
    Doppel tenant. |

    | Entity | string | No | The entity URL associated with the alert. |

    | Queue_State | ddl | Yes | The new queue state for the alert (e.g., 'actioned',
    'taken_down', 'monitoring'). |

    | Entity_State | ddl | Yes | The new state of the entity (e.g., 'active', 'down',
    'parked'). |


    ### Additional Notes

    * **Mutual Exclusivity:** You must provide either the `Alert_ID` or the `Entity`
    parameter, but providing both will result in an error.


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves the API credentials from the
    integration configuration and the alert details from the action parameters.

    2. **Validation:** It checks that exactly one identifier (`Alert_ID` or `Entity`)
    is provided.

    3. **API Interaction:** The action calls the Doppel API using a PUT request to
    update the alert's `queue_state` and `entity_state` based on the provided identifier.

    4. **Result Processing:** If the update is successful, the updated alert object
    is returned as a JSON result. If the API call fails or returns an empty response,
    the action fails with an error message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the queue state and entity state of an existing alert in the DoppelVision
      platform via a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
