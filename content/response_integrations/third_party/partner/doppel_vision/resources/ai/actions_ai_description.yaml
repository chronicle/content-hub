CreateAbuseAlert:
  ai_description: >-
    ### General Description

    Creates an abuse alert for a specific entity (such as a URL) within the DoppelVision
    platform. This action is used to report suspicious or malicious values to an abuse
    box for further processing or mitigation. If the provided entity value is invalid
    or belongs to a protected domain (like google.com) in Doppel's system, the action
    will fail.


    ### Parameters Description

    | Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity | String | Yes | The specific entity value (e.g., a URL) to be reported
    to the abuse box. |


    ### Flow Description

    1. **Parameter Extraction:** Retrieves the DoppelVision API configuration (API
    Key, User API Key, and Organization Code) and the target entity from the action
    parameters.

    2. **Manager Initialization:** Initializes the `DoppelManager` with the extracted
    credentials to handle the API communication.

    3. **Alert Creation:** Executes a POST request to the DoppelVision `/alert/abuse`
    endpoint using the provided entity value.

    4. **Result Processing:** Captures the JSON response from DoppelVision. If successful,
    the data is stored in the action's JSON results. If the API request fails or returns
    an empty response, the action execution state is set to failed.


    ### Additional Notes

    - This action does not automatically iterate over entities in a case; it requires
    the entity value to be passed explicitly via the 'Entity' parameter.

    - Ensure the 'Entity' value is not a protected domain in the Doppel system to
    avoid failure.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new abuse alert record in the DoppelVision platform for the specified
      entity via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
CreateAlert:
  ai_description: >-
    ### General Description

    This action creates a new alert within the DoppelVision system for a specific
    entity provided as a parameter. It is primarily used to programmatically trigger
    or document alerts in Doppel based on findings in Google SecOps.


    ### Parameters Description


    | Parameter | Description | Is Mandatory | Type | Default Value |

    | :--- | :--- | :--- | :--- | :--- |

    | Entity | The specific entity (typically a URL or identifier) for which the alert
    will be created in Doppel. | Yes | string | https://dummyrul.com |


    ### Flow Description

    1. **Extraction**: The action retrieves integration configuration (API Keys and
    Organization Code) and the 'Entity' input parameter.

    2. **Initialization**: It initializes the `DoppelManager` with the provided credentials.

    3. **API Interaction**: The action calls the Doppel API via a POST request to
    the `/alert` endpoint, passing the provided entity.

    4. **Processing**: If the alert is successfully created, the raw JSON response
    from Doppel is stored in the action's execution results.

    5. **Finalization**: The action completes with a success status if the API responds
    affirmatively, or a failure status if the entity is invalid, protected, or the
    request fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new alert record in the DoppelVision platform via a POST request to
      the /alert endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
GetAlert:
  ai_description: >-
    ### General Description

    This action retrieves detailed information about a specific alert from the DoppelVision
    platform. It allows users to query alerts using either a specific Entity identifier
    (typically a URL) or a unique Alert ID. The retrieved data is stored in the action's
    JSON results for use in downstream automation steps.


    ### Parameters Description


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Entity | String | No | The specific entity (e.g., a URL) associated with the
    alert. Either this or Alert_ID must be provided. |

    | Alert_ID | String | No | The unique identifier for the alert on the Doppel Tenant.
    Either this or Entity must be provided. |


    ### Additional Notes

    - **Mutual Exclusivity:** You must provide exactly one parameter: either 'Entity'
    or 'Alert_ID'. Providing both or neither will result in an action failure.

    - The action performs a read-only operation and does not modify data within DoppelVision
    or the Google SecOps case environment.


    ### Flow Description

    1. **Extraction:** The action extracts API credentials (API Key, User API Key,
    Org Code) and the action parameters (`Entity`, `Alert_ID`).

    2. **Validation:** It verifies that exactly one of the identifying parameters
    is present. If validation fails, the action terminates with a failure status.

    3. **Request:** It calls the DoppelManager's `get_alert` method, which executes
    an HTTP GET request to the `/alert` endpoint of the Doppel API.

    4. **Processing:** If a valid alert is found, the response JSON is added to the
    action results.

    5. **Completion:** The action completes with a success message if the alert is
    retrieved, or a failure message if the alert is not found or an error occurs.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
GetAlerts:
  ai_description: >-
    ### General Description

    This action fetches multiple alerts from the Doppel Vision platform based on specified
    filtering criteria. It is primarily used to ingest alert data into the SOAR platform
    for triage, reporting, or further automated processing. The action allows for
    extensive filtering by time range, product category, queue status, and custom
    tags.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Search Key | string | No | Filter alerts by a specific URL search key. |

    | Product | ddl | No | Filter by product category (e.g., domains, social_media,
    mobile_apps, ecommerce, crypto, emails, paid_adds). |

    | Created Before | string | No | Filter alerts created before a specific timestamp
    (e.g., '2024-01-05T13:45:30'). |

    | Created After | string | No | Filter alerts created after a specific timestamp
    (e.g., '2024-01-05T13:45:30'). |

    | Sort Type | ddl | No | The field to sort the results by. Options include 'date_sourced'
    or 'date_last_actioned'. |

    | Sort Order | ddl | No | The order of results: 'asc' (ascending) or 'desc' (descending).
    |

    | Page | string | No | Page number for paginated API responses (defaults to 0).
    |

    | Queue State | ddl | No | Filter alerts by their current status in Doppel (e.g.,
    doppel_review, actioned, needs_confirmation, taken_down, monitoring, archived).
    |

    | Tags | string | No | A comma-separated list of tags to filter the alerts. |


    ### Additional Notes

    - This action does not require any input parameters to run; if none are provided,
    it will fetch the most recent alerts from the tenant based on default sorting.

    - Date parameters should follow the ISO 8601 format for consistency.


    ### Flow Description

    1. **Authentication**: The action retrieves the API Key, User API Key, and Organization
    Code from the integration configuration.

    2. **Parameter Parsing**: It collects optional filters provided in the action
    step, specifically splitting the 'Tags' string into a list and converting the
    'Page' parameter to the correct type.

    3. **Request Preparation**: A filter dictionary is constructed, excluding any
    parameters that were left empty by the user.

    4. **API Execution**: The `DoppelManager` executes a GET request to the `/alerts`
    endpoint of the Doppel Vision API with the prepared filters.

    5. **Result Processing**: The list of retrieved alerts is stored in the action's
    JSON result for use in subsequent playbook steps. If no alerts are found, the
    action fails with an error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The Ping action allows users to test and validate connectivity between Google
    SecOps and the DoppelVision service. Its primary purpose is to verify that the
    provided credentials (API Key, User API Key, and Organization Code) are valid
    and that the network connection to the Doppel API is functional during the initial
    integration setup or troubleshooting.


    ### Parameters description

    There are no action-specific parameters for this action. It utilizes the following
    integration configuration parameters:


    | Parameter Name | Expected Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | API Key | String | Yes | The primary API Key used to authenticate with the Doppel
    service. |

    | User API Key | String | No | An optional User-specific API Key for authentication.
    |

    | Organization Code | String | No | An optional code used for multi-tenant organization
    identification. |


    ### Additional Notes

    This action does not process any entities and is intended purely for connectivity
    validation.


    ### Flow description

    1. **Credential Extraction**: The script retrieves the API Key, User API Key,
    and Organization Code from the integration's global configuration.

    2. **Manager Initialization**: It initializes the `DoppelManager` with the extracted
    credentials.

    3. **Connectivity Test**: The manager executes a GET request to the Doppel `/alerts`
    endpoint to verify the API's responsiveness and the validity of the credentials.

    4. **Result Reporting**: If the API call is successful, the action returns a 'true'
    status. If the request fails due to network issues or invalid credentials, it
    returns 'false' with an error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
UpdateAlert:
  ai_description: >-
    ### General Description

    This action updates an existing alert in the DoppelVision platform. It allows
    for modifying the alert's lifecycle status by updating its queue state and entity
    state. It is primarily used for alert management and remediation tracking within
    the DoppelVision ecosystem.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Alert_ID | String | No | The unique identifier for the specific alert in the
    Doppel tenant. Required if 'Entity' is not provided. |

    | Entity | String | No | The specific entity (usually a URL) associated with the
    alert to be updated. Required if 'Alert_ID' is not provided. |

    | Queue_State | DDL | Yes | The new queue state to assign to the alert. Supported
    values include: "doppel_review", "needs_confirmation", "monitoring", "taken_down",
    "actioned", "archived". |

    | Entity_State | DDL | Yes | The new state for the entity itself. Supported values
    include: "active", "down", "parked". |


    ### Additional Notes

    - **Logic Constraint**: The action requires either the 'Alert_ID' or the 'Entity'
    parameter to be populated. If both are provided or both are empty, the action
    will fail with a validation error.

    - **Authentication**: This action requires a valid API Key, User API Key, and
    Organization Code to be configured in the integration settings.


    ### Flow Description

    1. **Extraction**: The action retrieves integration configuration (API Key, User
    API Key, Org Code) and action-specific parameters.

    2. **Validation**: It checks that exactly one identifier (either Alert_ID or Entity)
    is present.

    3. **API Request**: The action uses the `DoppelManager` to send a PUT request
    to the `/alert` endpoint of the DoppelVision API, passing the states in the request
    body and the identifier in the query parameters.

    4. **Result Processing**: Upon a successful API response, the updated alert data
    is added to the action's result JSON.

    5. **Completion**: The action terminates with a success message and returns the
    updated state information.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the 'Queue State' and 'Entity State' of an alert in the external DoppelVision
      system using a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
