AddAnalystNote:
  ai_description: >-
    ### General Description

    Publishes an Analyst Note to the Recorded Future platform. This action allows
    analysts to document findings, intelligence reports, or investigative notes directly
    into the Recorded Future portal from within Google SecOps. The note includes a
    title, body text, and an optional categorization topic (e.g., 'Malware/Tool Profile').
    To ensure traceability, the action automatically appends the identifiers of all
    entities currently in the action's scope to the bottom of the note text.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Note Title** | String | Yes | The title of the analyst note to be published
    in Recorded Future. |

    | **Note Text** | String | Yes | The primary content or body of the analyst note.
    |

    | **Topic** | DDL | No | Categorizes the note based on Recorded Future's internal
    topics. If 'None' is selected, no specific topic is assigned. |


    ### Flow Description

    1.  **Initialization**: Extracts API configuration (URL, Key, SSL verification)
    and action parameters (Title, Text, Topic).

    2.  **Context Collection**: Retrieves the identifiers of all entities in the current
    context.

    3.  **Data Preparation**: Appends a list of the collected entity identifiers to
    the `Note Text` to provide context within the Recorded Future portal.

    4.  **External Request**: Uses the `RecordedFutureManager` to send a publication
    request to the Recorded Future API.

    5.  **Completion**: Returns the `note_id` (Document ID) generated by Recorded
    Future and marks the action as completed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates and publishes a new Analyst Note record within the Recorded Future platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - FILEHASH
      - DestinationURL
      - CVEID
      - HOSTNAME
      - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
DetonateFile:
  ai_description: >-
    ### General Description

    This action submits a file to the Recorded Future Sandbox (powered by Hatching
    Triage) for automated analysis and detonation. It is designed to evaluate potentially
    malicious files by executing them in a controlled environment and retrieving detailed
    behavioral reports. The action can retrieve files from two sources: a Google Cloud
    Platform (GCP) Bucket or the local file system. Because analysis takes time, this
    is an asynchronous action that polls for completion before returning results,
    including a risk score, behavioral signatures, and extracted indicators (IOCs).


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | File Path | String | Yes | The full path or identifier of the file to be analyzed.
    If using a GCP Bucket, this should be the object identifier. |

    | File Source | DDL | Yes | Specifies where the file is located. Options are 'GCP
    Bucket' or 'Local File System'. |

    | Profile | String | No | The specific Recorded Future Sandbox analysis profile
    to use (e.g., specific OS or environment). |

    | Password | String | No | The password required to extract the sample if it is
    provided as a password-protected archive (e.g., a ZIP file). |


    ### Flow Description

    1. **Initialization**: The action initializes the Recorded Future Sandbox client
    using the configured API URL and Key.

    2. **File Retrieval**: Based on the 'File Source' parameter, the script either
    opens a local file or retrieves the file content from a GCP Bucket using the TIPCommon
    library.

    3. **Submission**: The file is uploaded to the Sandbox with the specified profile
    and password. The resulting Sample ID is stored in the action context.

    4. **Asynchronous Polling**: The action enters an 'In Progress' state. In subsequent
    runs, it queries the Sandbox API using the Sample ID to check if the report status
    has changed to 'reported'.

    5. **Report Processing**: Once the analysis is complete, the action fetches the
    overview report, which includes the risk score (0-10), signatures, and identified
    network or file IOCs.

    6. **Finalization**: The action generates a detailed HTML insight containing the
    detonation results, adds the raw JSON data to the action results, and completes
    the execution.


    ### Additional Notes

    - This action is asynchronous; ensure the timeout in the IDE is set high enough
    to allow the Sandbox to complete its analysis (usually several minutes).

    - If the action times out before the report is ready, it will list the pending
    files in the output message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: >-
      Submits files to the Recorded Future Sandbox for analysis, which creates new
      sample records and detonation tasks on the external platform.
    fetches_data: true
    internal_data_mutation_explanation: >-
      Creates detailed case insights in Google SecOps containing the detonation analysis
      report in HTML format.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
DetonateURL:
  ai_description: >-
    ### General Description

    Submits URL entities to the Recorded Future Sandbox (Triage) for automated detonation
    and in-depth security analysis. This action is designed to handle potential threats
    by executing URLs in a controlled environment to observe behavior, determine risk
    scores, and extract Indicators of Compromise (IOCs). As an asynchronous action,
    it submits the tasks and then polls the sandbox until reports are ready, ensuring
    that long-running detonation processes do not block the SOAR workflow.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Profile | string | No | Specifies the Sandbox profile to be used for the analysis.
    If not provided, the default profile configured in the sandbox will be used. |


    ### Flow Description

    1. **Extraction**: The action identifies and extracts URL entities from the case's
    target entities.

    2. **Submission**: Each identified URL is submitted to the Recorded Future Sandbox
    API for detonation.

    3. **Asynchronous Monitoring**: The action enters an 'in-progress' state and periodically
    queries the sandbox to check if the analysis status has moved from 'pending' to
    'reported'.

    4. **Data Retrieval**: Upon completion, the action retrieves the comprehensive
    overview report, including risk scores and analysis tags.

    5. **Insight Generation**: A detailed HTML insight is created within the Google
    SecOps case for each analyzed URL, providing a visual summary of the sandbox findings
    (Score, TTPs, Signatures, and extracted IOCs).

    6. **Result Output**: The action returns the analysis results in JSON format and
    populates a data table with the detonation summary.


    ### Additional Notes

    This action requires a valid Recorded Future Sandbox API key and the selection
    of a supported sandbox URL in the integration configuration. The action will time
    out if the detonation process exceeds the global execution deadline.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Submits URL samples to the Recorded Future Sandbox, creating new analysis tasks
      and data entries in the external sandbox environment.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichCVE:
  ai_description: >-
    ### General Description: Enriches CVE entities using Recorded Future Intelligence.
    It retrieves risk scores, risk rules, and intelligence cards to provide threat
    intelligence. The action evaluates if a CVE is risky based on a user-defined threshold
    and can optionally contribute detections back to the Recorded Future community
    through Collective Insights. ### Parameters Description: | Parameter | Type |
    Mandatory | Description | | :--- | :--- | :--- | :--- | | Risk Score Threshold
    | String/Integer | Yes | The minimum malicious risk score (0-99) required to mark
    a CVE as suspicious. Default is 25. | | Include Links | Boolean | No | If enabled,
    retrieves information about related entity links. Default is False. | | Enable
    Collective Insights | Boolean | No | If enabled, contributes detection data back
    to Recorded Future. Default is True. | ### Flow Description: 1. Validates connectivity
    to the Recorded Future API. 2. Identifies all CVE entities in the current scope.
    3. For each CVE, queries Recorded Future for comprehensive reputation data, including
    risk scores and evidence. 4. If Collective Insights is enabled and the alert reporting
    vendor is not Recorded Future, submits detection telemetry to the external service.
    5. Compares the CVE risk score against the 'Risk Score Threshold'. 6. If the threshold
    is exceeded, marks the entity as suspicious, updates its 'is_risky' property,
    and generates a detailed case insight. 7. Populates entity additional properties
    and creates data tables for Overview, Risk Rules, and Links. 8. Adds a direct
    link to the Recorded Future Intel Card for deep-dive analysis. 9. Updates the
    entities within Google SecOps and returns the enrichment results. ### Additional
    Notes: Collective Insights submission is skipped if the alert was originally generated
    by Recorded Future to avoid feedback loops.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: >-
      If 'Enable Collective Insights' is enabled, the action submits detection metadata,
      including IOC values, types, and incident identifiers, to Recorded Future's
      Collective Insights service.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - CVE
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichHash:
  ai_description: "Enriches File Hash entities using the Recorded Future Intelligence\
    \ service. This action retrieves comprehensive threat intelligence, including\
    \ risk scores, triggered risk rules, and first/last seen timestamps. \n\n### Parameters\
    \ description\n| Parameter | Type | Mandatory | Description |\n| :--- | :--- |\
    \ :--- | :--- |\n| Risk Score Threshold | string | Yes | The minimum malicious\
    \ risk score (0-89) required to mark a Hash as suspicious/risky within the system.\
    \ Default is 25. |\n| Include Links | boolean | No | If enabled, the action retrieves\
    \ additional information about related entity links. |\n| Enable Collective Insights\
    \ | boolean | No | If enabled, the action contributes detection telemetry back\
    \ to Recorded Future to improve global threat intelligence. |\n\n### Flow description\n\
    1. **Initialization**: Retrieves configuration settings (API Key, URL) and action\
    \ parameters (Threshold, Links, Collective Insights status).\n2. **Entity Filtering**:\
    \ Identifies all `FILEHASH` entities within the current context.\n3. **Reputation\
    \ Lookup**: For each hash, queries the Recorded Future API to retrieve its risk\
    \ score, intelligence card URL, and evidentiary details.\n4. **Telemetry Contribution**:\
    \ If 'Enable Collective Insights' is active and the alert source is external,\
    \ sends detection data to Recorded Future.\n5. **Risk Assessment**: Compares the\
    \ retrieved risk score against the 'Risk Score Threshold'. If exceeded, the entity\
    \ is marked as suspicious.\n6. **Internal Updates**: Updates the SOAR entities\
    \ with enrichment data, generates data tables for the case wall, and creates a\
    \ detailed case insight for hashes deemed risky."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: >-
      If 'Enable Collective Insights' is enabled, the action submits detection information
      (IOC value, type, and case context) back to Recorded Future's Collective Insights
      service.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichHost:
  ai_description: >-
    ### General Description

    Enriches Hostname and Domain entities using Recorded Future Intelligence. This
    action retrieves comprehensive threat intelligence, including malicious risk scores,
    triggered evidence rules, and links to Recorded Future Intelligence Cards. It
    evaluates the risk score against a user-defined threshold to determine if an entity
    should be marked as suspicious within the case.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Risk Score Threshold | string | Yes | Represents the minimum malicious risk
    score (0-99) for a Host to be marked malicious. Scores are categorized as: Very
    Malicious (90-99), Malicious (65-89), Suspicious (25-64), Unusual (5-24), No Malicious
    content (0). Default is 25. |

    | Include Links | boolean | No | If enabled, the action retrieves additional information
    about entities linked to the host in the Recorded Future graph. Default is false.
    |

    | Enable Collective Insights | boolean | No | If enabled, contributes detection
    telemetry back to Recorded Future's Collective Insights service to improve community
    intelligence. Default is true. |


    ### Additional Notes

    - **Collective Insights Logic**: Contributing data back to Recorded Future (Collective
    Insights) only occurs if the following conditions are met: the action parameter
    is enabled, the global integration configuration for Collective Insights is enabled,
    and the alert's reporting vendor is not Recorded Future (to avoid circular reporting).

    - **Scope**: While the metadata may prioritize Hostnames, the underlying logic
    explicitly supports both `HOSTNAME` and `DOMAIN` entity types.


    ### Flow Description

    1.  **Initialization**: Authenticates with Recorded Future using the provided
    API Key and URL.

    2.  **Entity Selection**: Identifies all Hostname and Domain entities within the
    current SecOps context.

    3.  **Data Retrieval**: For each valid entity, queries Recorded Future for its
    reputation report, including risk scores and evidence details.

    4.  **Collective Insights Submission**: If configured, submits the detection event
    to Recorded Future's external telemetry system.

    5.  **Data Presentation**: Generates several data tables for the case, including
    an overview report, a list of triggered risk rules, and optionally, a table of
    linked entities.

    6.  **Threshold Evaluation**: Compares the retrieved risk score against the provided
    `Risk Score Threshold`. If the score is higher, the entity is flagged as suspicious.

    7.  **Enrichment & Insights**: Updates the entity properties with Recorded Future
    data, adds a link to the web-based Intelligence Card, and creates a detailed case
    insight if the entity is deemed risky.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: >-
      If 'Enable Collective Insights' is enabled, the action sends detection telemetry
      (IOC value, type, and incident details) back to Recorded Future's Collective
      Insights service.
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates Google SecOps entities with enrichment data from Recorded Future and
      may change their 'is_suspicious' status based on the risk score.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - HOSTNAME
      - DOMAIN
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichIOC:
  ai_description: >-
    ### General Description

    The **Enrich IOC** action queries Recorded Future Intelligence to retrieve comprehensive
    threat intelligence for various Indicators of Compromise (IOCs). It fetches risk
    scores, triggered risk rules, evidence details, and related entity links. The
    action enriches existing SOAR entities with this data and can automatically mark
    them as suspicious if their risk score exceeds a user-defined threshold. Additionally,
    it can contribute detection data back to Recorded Future via the 'Collective Insights'
    feature.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Risk Score Threshold** | string | Yes | The minimum malicious risk score (0-100)
    required for an entity to be marked as suspicious in the SOAR. Default is 25.
    |

    | **Include Links** | boolean | No | If enabled, the action retrieves and displays
    related entity links (e.g., related IPs or domains) in a data table. Default is
    false. |

    | **Enable Collective Insights** | boolean | No | If enabled, the action contributes
    detection information back to Recorded Future to improve global threat intelligence.
    This is only performed for alerts not originally generated by Recorded Future.
    Default is true. |


    ### Additional Notes

    - Supported entity types include: IP Address, Hostname, Domain, File Hash, CVE,
    and URL.

    - Collective Insights submission is skipped if the alert's reporting vendor is
    'Recorded Future' to prevent feedback loops.

    - Enrichment data is added to entities with the prefix `RF_`.


    ### Flow Description

    1.  **Configuration & Parameter Extraction:** The action retrieves API credentials
    from the integration settings and operational parameters (threshold, link inclusion,
    collective insights) from the action input.

    2.  **Entity Filtering:** It identifies supported entities within the current
    context (e.g., ADDRESS, HOSTNAME, FILEHASH, etc.).

    3.  **Intelligence Retrieval:** For each supported entity, it calls the Recorded
    Future API to fetch reputation and risk data.

    4.  **Collective Insights Submission:** If enabled and applicable, detection metadata
    (incident name, type, and timestamp) is sent back to Recorded Future.

    5.  **Data Population:** Results are formatted into data tables (Overview, Risk
    Rules, and Links) and attached to the action results.

    6.  **Entity Enrichment:** Entity properties are updated with Recorded Future
    intelligence (score, rules, intel card link). If the score exceeds the threshold,
    the entity is marked as suspicious.

    7.  **Insight Creation:** A detailed HTML case insight is generated for any entity
    determined to be risky, providing a deep dive into the evidence and risk details.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: >-
      If 'Enable Collective Insights' is set to true, the action sends detection data
      (IOC value, detection name, and incident metadata) to Recorded Future's Collective
      Insights service.
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity suspicious/enriched status, populates additional properties on
      entities, and creates case insights.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - HOSTNAME
      - CVE
      - FILEHASH
      - ADDRESS
      - DestinationURL
      - DOMAIN
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichIP:
  ai_description: "Enriches IP Address entities using Recorded Future threat intelligence.\
    \ This action queries the Recorded Future API to retrieve comprehensive reputation\
    \ data, including risk scores, triggered risk rules, location details (ASN, Country,\
    \ City), and related intelligence links. \n\n### Parameters\n| Parameter | Type\
    \ | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| Risk Score Threshold\
    \ | string | Yes | The minimum risk score (0-99) required to mark an IP as suspicious.\
    \ Default is 25. |\n| Include Links | boolean | No | If enabled, the action retrieves\
    \ and displays related entity links from Recorded Future. Default is false. |\n\
    | Enable Collective Insights | boolean | No | If enabled, the action contributes\
    \ detection telemetry back to Recorded Future's collective insights database.\
    \ Default is true. |\n\n### Flow Description\n1. **Initialization:** Retrieves\
    \ API configuration and action parameters (Threshold, Links, Collective Insights\
    \ settings).\n2. **Connectivity Check:** Validates the API key by performing a\
    \ test query (standard check using 8.8.8.8).\n3. **Entity Filtering:** Iterates\
    \ through all entities in the current scope, focusing exclusively on `ADDRESS`\
    \ (IP) types.\n4. **Reputation Lookup:** For each IP, it fetches intelligence\
    \ including risk scores and evidence details from Recorded Future.\n5. **Data\
    \ Presentation:** Adds multiple data tables to the action output, covering general\
    \ overview, risk rules, and (optionally) entity links.\n6. **Risk Assessment:**\
    \ Compares the retrieved risk score against the user-defined threshold. If the\
    \ threshold is exceeded, the entity is marked as suspicious and a detailed Case\
    \ Insight is created.\n7. **Enrichment:** Updates the entity's additional properties\
    \ with prefix 'RF' and marks it as enriched in the system.\n\n### Additional Notes\n\
    * The action automatically excludes 'Collective Insights' submissions if the alert\
    \ reporting vendor is Recorded Future itself to avoid redundant data loops.\n\
    * Detailed evidence for risk rules is formatted into a readable HTML insight for\
    \ security analysts."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: true
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichURL:
  ai_description: >-
    Enriches URL entities using Recorded Future's threat intelligence. This action
    retrieves comprehensive reputation data, including risk scores, triggered risk
    rules, and associated links. It evaluates each URL against a configurable threshold
    to determine if it should be marked as suspicious within the SOAR platform.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Risk Score Threshold | String | Yes | Minimum malicious risk score (0-99) required
    to mark a URL as malicious. Default is 25. |

    | Include Links | Boolean | No | If enabled, the action retrieves additional information
    about associated links for the URL. |

    | Enable Collective Insights | Boolean | No | If enabled, the action contributes
    detection telemetry back to Recorded Future's Collective Insights platform. |


    ### Flow Description


    1.  **Parameter Extraction:** Retrieves API credentials, SSL settings, and action-specific
    parameters (threshold, link inclusion, and collective insights toggle).

    2.  **Entity Filtering:** Identifies and iterates through all entities of type
    `URL` (mapped as DestinationURL) within the current alert context.

    3.  **Threat Intelligence Lookup:** For each entity, it queries Recorded Future's
    API for the URL's reputation report.

    4.  **Collective Insights Submission:** If enabled and the alert source is not
    Recorded Future itself, it submits a detection report (telemetry) to Recorded
    Future's Collective Insights service.

    5.  **Risk Evaluation:** Compares the retrieved risk score against the user-defined
    threshold. If the score exceeds the threshold, the entity is marked as suspicious.

    6.  **Data Attachment:** Adds detailed information to the Case Wall, including
    an Overview table, a Risk Rules table, and optionally a Links table. If the URL
    is determined to be risky, a Case Insight is created.

    7.  **Entity Enrichment:** Updates the entity's attributes (is_suspicious, is_enriched)
    and attaches raw intelligence data to the entity's additional properties.


    ### Additional Notes


    *   **Collective Insights:** This feature acts as a mutation to external data
    as it contributes information to Recorded Future's global telemetry. It is automatically
    disabled if the alert reporting vendor is 'Recorded Future' to avoid circular
    reporting.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: true
    can_mutate_external_data: true
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: >-
      Submits detection telemetry and 'Collective Insights' metadata to Recorded Future's
      external intelligence platform if enabled.
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity properties, modifies suspicious status, creates Case Insights,
      and adds data tables to the Case Wall.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes:
      - DestinationURL
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
GetAlertDetails:
  ai_description: >-
    ### General Description Retrieving comprehensive details for a specific Recorded
    Future Alert using its unique ID. This action provides deep context into the alert,
    including associated documents, related entities, evidence details, and the underlying
    intelligence rule that triggered it. This is useful for analysts who need to perform
    deep-dive investigations on alerts detected by the Recorded Future connector.
    ### Parameters Description | Parameter | Type | Mandatory | Description | | :---
    | :--- | :--- | :--- | | Alert ID | String | Yes | Specify the unique ID of the
    Recorded Future alert for which you would like to fetch details. | ### Flow Description
    1. **Authentication**: Initializes the Recorded Future manager using the provided
    API Key and URL. 2. **Data Retrieval**: Requests detailed information from the
    Recorded Future API for the specific alert ID provided in the parameters. 3. **Processing**:
    Transforms the API response into a structured data model, extracting metadata,
    entity hits, and rule information. 4. **Results**: Appends the structured alert
    details as a JSON result to the action and provides a direct web link to the Recorded
    Future portal report for further investigation.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
GetPlaybookAlertDetails:
  ai_description: "### General Description\nThe **Get Playbook Alert Details** action\
    \ retrieves comprehensive information about a specific Recorded Future Playbook\
    \ Alert and returns the results to the Google SecOps case. It is designed to provide\
    \ deep context on alerts such as updated DNS records, new vulnerability stages,\
    \ or exposed credentials, allowing analysts to investigate further directly within\
    \ the platform.\n\n### Parameters Description\n\n| Parameter | Type | Mandatory\
    \ | Description |\n| :--- | :--- | :--- | :--- |\n| Playbook Alert ID | String\
    \ | Yes | Specify the unique identifier of the Playbook Alert to retrieve details\
    \ for. |\n| Category | String | Yes | The specific category of the Playbook Alert.\
    \ Supported values: `domain_abuse`, `cyber_vulnerability`, `code_repo_leakage`,\
    \ `third_party_risk`, `identity_novel_exposures`, and `geopolitics_facility`.\
    \ |\n\n### Flow Description\n1. **Parameter Initialization:** The action extracts\
    \ the API configuration (URL, API Key, and SSL verification) and the specific\
    \ action parameters (`Playbook Alert ID` and `Category`).\n2. **Manager Setup:**\
    \ It initializes the `RecordedFutureManager` to facilitate communication with\
    \ the Recorded Future API.\n3. **Data Retrieval:** The action calls the Recorded\
    \ Future API to fetch the detailed object for the specified Playbook Alert based\
    \ on the provided ID and category.\n4. **Result Processing:** \n    * The retrieved\
    \ alert data is converted to JSON format and added as a script result.\n    *\
    \ A direct web link to the Recorded Future portal report is added to the case\
    \ results.\n5. **Completion:** The action concludes by outputting a success message\
    \ containing the Alert ID or an error message if the alert was not found or the\
    \ request was unauthorized."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: "### General Description\nVerifies the connectivity between Google\
    \ SecOps and the Recorded Future API. The action performs a test lookup for a\
    \ hardcoded dummy IP address (8.8.8.8) to confirm that the integration credentials\
    \ and network configurations are valid and operational.\n\n### Parameters Description\n\
    | Name | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| ApiUrl\
    \ | String | Yes | The base URL of the Recorded Future API used for requests.\
    \ |\n| ApiKey | String | Yes | The API key required to authenticate with the Recorded\
    \ Future service. |\n| Verify SSL | Boolean | No | If enabled, the action will\
    \ verify the SSL certificate of the Recorded Future API server. Defaults to False.\
    \ |\n\n### Flow Description\n1. **Initialization**: The action initializes the\
    \ Siemplify context and logs the start of the parameter initialization process.\n\
    2. **Parameter Extraction**: It extracts the `ApiUrl`, `ApiKey`, and `Verify SSL`\
    \ configuration parameters from the integration settings.\n3. **Manager Setup**:\
    \ A `RecordedFutureManager` instance is created with the extracted credentials\
    \ and SSL settings.\n4. **Connectivity Test**: The action calls the `test_connectivity`\
    \ method within the manager. This method specifically attempts a reputation lookup\
    \ for the IP '8.8.8.8' to trigger a live API request.\n5. **Execution Outcome**:\
    \ \n    * If the request succeeds, it logs a successful connection message and\
    \ sets the execution state to completed.\n    * If an exception occurs (e.g.,\
    \ authentication failure, timeout, or network error), it captures the error, logs\
    \ the failure, and sets the execution state to failed.\n6. **Finalization**: The\
    \ action terminates, returning the connectivity result status (True/False) and\
    \ a descriptive output message."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
RefreshPlaybookAlert:
  ai_description: >-
    ### General Description

    Updates and refreshes information in a Google SecOps case that was originally
    created by the Recorded Future Playbook Alerts Connector. This action fetches
    the latest intelligence and alert details directly from the Recorded Future platform
    for a specific Playbook Alert ID. It dynamically extracts related entities (such
    as IP addresses, domains, and file hashes) and adds them to the existing case
    to provide analysts with updated context. Additionally, it generates formatted
    HTML data intended for visual widgets and provides a direct link to the alert's
    web report in the Recorded Future portal.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Playbook Alert ID** | The unique identifier of the Playbook Alert in Recorded
    Future for which you want to fetch current details. | string | Yes |

    | **Category** | The specific category of the Playbook Alert. This determines
    how the data is parsed and which entities are extracted. Valid values include:
    `domain_abuse`, `cyber_vulnerability`, `code_repo_leakage`, `third_party_risk`,
    `identity_novel_exposures`, and `geopolitics_facility`. | string | Yes |


    ### Additional Notes

    - This action is designed specifically for cases originating from the Recorded
    Future Playbook Alerts Connector. It will fail if run on cases from other sources.

    - The action modifies the current case by adding new entities discovered during
    the refresh process.


    ### Flow Description

    1. **Validation**: The action first verifies that the current case is a Recorded
    Future Playbook Alert.

    2. **Data Retrieval**: It connects to the Recorded Future API to fetch the most
    recent data associated with the provided Playbook Alert ID and Category.

    3. **Entity Extraction**: Depending on the alert category, the logic parses relevant
    fields to identify indicators like target domains, compromised IPs, or associated
    CVEs.

    4. **Internal Mutation**: Discovered entities are added to the current Google
    SecOps case using the SOAR SDK.

    5. **Output Generation**: The action prepares a JSON result containing HTML-formatted
    summaries for display in SOAR widgets and adds a direct link to the Recorded Future
    intelligence card.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action adds new entities discovered in the Recorded Future Playbook Alert
      directly to the current Google SecOps case.
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
UpdateAlert:
  ai_description: >-
    ### General Description

    Updates an existing alert in Recorded Future by modifying its status, assigning
    it to a specific user, or adding an analyst note. This action is primarily used
    for alert lifecycle management and ensuring that Recorded Future alerts reflect
    the current investigative status managed within Google SecOps.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Alert ID | String | Yes | The unique identifier of the alert in Recorded Future
    that needs to be updated. |

    | Assign To | String | No | The target user to whom the alert should be assigned.
    Accepts ID, username, user hash, or email. |

    | Note | String | No | A specific note or comment to be appended to the alert
    record in Recorded Future. |

    | Status | DDL | Yes | The new status to be applied to the alert. Options: New,
    Pending, Dismissed, Resolved, Flag for Tuning. |


    ### Additional Notes

    * The action requires at least one of the following fields to be populated: **Assign
    To**, **Note**, or a non-default **Status**. If all these fields are empty, the
    action will fail with an error stating that at least one parameter must have a
    value.


    ### Flow Description

    1. **Parameter Extraction:** Retrieves API configuration (URL, Key, SSL) and action
    inputs (Alert ID, Status, Assignee, Note).

    2. **Validation:** Checks that at least one update field (Status, Assignee, or
    Note) is provided to ensure a meaningful update request.

    3. **Manager Initialization:** Initializes the `RecordedFutureManager` with the
    extracted credentials.

    4. **API Execution:** Executes the update via the Recorded Future API, applying
    the specified changes to the target alert ID.

    5. **Completion:** Returns the result of the operation in JSON format and updates
    the action status to completed or failed based on the API response.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Modifies the status, assignee, and notes of an existing alert within the Recorded
      Future platform.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
UpdatePlaybookAlert:
  ai_description: >-
    Updates a specific Playbook Alert in the Recorded Future platform. This action
    allows analysts to modify alert metadata such as status, priority, and assignee,
    while also providing a mechanism to log comments or set reopening strategies.
    It interacts with the Recorded Future API to synchronize alert management between
    Google SecOps and the Recorded Future Intelligence Cloud.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Playbook Alert ID | String | Yes | The unique identifier of the Recorded Future
    playbook alert to be updated. |

    | Playbook Alert Category | String | Yes | The category of the playbook alert
    (e.g., domain_abuse, cyber_vulnerability). |

    | Assign To | String | No | The unique user hash (uhash) of the Recorded Future
    user to whom the alert should be assigned. |

    | Log Entry | String | No | A comment or log message to be added to the alert's
    history during the update. |

    | Status | DDL | No | The new status for the alert. Options include: New, In Progress,
    Dismissed, Resolved. |

    | Priority | DDL | No | The new priority level for the alert. Options include:
    High, Moderate, Informational. |

    | Reopen Strategy | DDL | No | Specifies the behavior for reopening the alert
    if new activity occurs. Options: Never, Significant Updates. |


    ### Additional Notes

    At least one of the following parameters must be provided for the action to execute:
    'Assign To', 'Log Entry', 'Status', 'Priority', or 'Reopen Strategy'. If none
    of these are configured, the action will fail with a validation error.


    ### Flow Description

    1. **Extraction**: Retrieves API credentials (API Key, URL) and SSL settings from
    the integration configuration.

    2. **Parameter Parsing**: Extracts mandatory identifiers (Alert ID, Category)
    and optional modification parameters (Status, Priority, Assignee, etc.).

    3. **Validation**: Ensures that at least one field update is requested.

    4. **Execution**: Initializes the Recorded Future Manager, fetches the current
    state of the specified alert, and submits the update request to the Recorded Future
    API.

    5. **Completion**: Adds the raw API response to the action results and confirms
    successful update via the action output message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status, priority, assignee, log entries, and reopen strategy of
      a playbook alert in the Recorded Future platform.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
