ANYRUN TI Lookup:
  ai_description: >-
    ### General Description

    Performs threat intelligence lookups using the ANY.RUN TI Lookup service. This
    action allows users to retrieve detailed analysis reports for specific entities
    (IPs, Domains, URLs, Processes, File Hashes) or via a raw custom query. It provides
    a threat verdict and attaches the full JSON report to the case for further investigation.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Lookup Depth** | String | Yes | The number of days from the current date to
    look back for intelligence data. Default is 90. |

    | **Query** | String | No | A raw ANY.RUN query with filters. If provided, this
    query takes precedence over the entity identifiers. |

    | **Identifiers** | String | Yes | Comma-separated list of entity identifiers
    to look up. Usually populated by `[Entity.Identifier]`. |

    | **Types** | String | Yes | Comma-separated list of entity types corresponding
    to the identifiers. Usually populated by `[Entity.Type]`. |


    ### Additional Notes

    - Either the **Query** parameter must be provided, or both **Identifiers** and
    **Types** must be populated for the action to run on specific entities.

    - Supported entity types include: Address, IPSet, DestinationURL, Domain, Process,
    and FileHash.

    - The action does not update entity suspicious status directly but provides the
    verdict in the case comments.


    ### Flow Description

    1. **Initialization**: Retrieves the API key and SSL configuration from the integration
    settings.

    2. **Input Processing**: Checks if a raw `Query` is provided. If not, it processes
    the `Identifiers` and `Types` lists provided as action parameters.

    3. **Intelligence Retrieval**: For each target (query or entity), it calls the
    ANY.RUN API to fetch intelligence data within the specified `Lookup Depth`.

    4. **Data Persistence**:
        - Generates a direct lookup URL for the ANY.RUN interface.
        - Saves the full JSON response as an attachment to the case wall using the
    `save_attachment_to_case_wall` utility.
    5. **Verdict Calculation**: Maps the ANY.RUN threat level to a human-readable
    verdict (Suspicious, Malicious, or Unknown).

    6. **Reporting**: Aggregates results and posts a summary comment to the case wall
    containing the analysis results and lookup URLs.
  capabilities:
    can_create_case_comments: true
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action adds JSON lookup reports as attachments to the case wall and posts
      summary comments containing the analysis results and lookup URLs.
  categories:
    enrichment: false
  entity_usage:
    entity_types:
    - ADDRESS
    - IPSET
    - DestinationURL
    - DOMAIN
    - PROCESS
    - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool designed to verify the connectivity between
    the Google SecOps environment and the **ANY.RUN TI Lookup** service. Its primary
    purpose is to ensure that the integration is correctly configured and that the
    provided API key is valid and authorized.


    ### Parameters Description

    No action-specific parameters are required for this action. It utilizes the following
    integration configuration parameters:

    - **ANYRUN TI Lookup API KEY**: The API key used for authentication.

    - **Verify SSL**: Whether to verify the SSL certificate of the API endpoint.

    - **Enable proxy**: Whether to route traffic through a proxy server.

    - **Proxy host**: The hostname of the proxy server (required if proxy is enabled).

    - **Proxy port**: The port of the proxy server (required if proxy is enabled).


    ### Additional Notes

    - This action does not process or interact with any entities.

    - If 'Enable proxy' is checked, both 'Proxy host' and 'Proxy port' must be correctly
    configured in the integration settings to avoid execution failure.


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the API key, SSL verification
    preference, and proxy settings from the integration's global configuration.

    2. **Proxy Validation**: If proxying is enabled, the action attempts to establish
    a connection through the specified proxy server.

    3. **Authorization Check**: The action initializes a connection to the ANY.RUN
    TI Lookup service and executes an authorization check to verify the API key's
    validity.

    4. **Status Reporting**: The action concludes by reporting a successful connection
    or a failure with a descriptive error message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
