Add Comment To Issue:
  ai_description: >-
    ### General Description

    The **Add Comment To Issue** action allows users to append a text comment (note)
    to a specific issue within the Wiz platform. This action is primarily used to
    document investigation progress, provide updates, or synchronize communication
    between Google SecOps and the Wiz security platform.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | String | Yes | The unique identifier of the issue in Wiz to which
    the comment will be added. |

    | **Comment** | String | Yes | The text content of the comment to be added to
    the issue. |


    ### Flow Description

    1. **Parameter Extraction:** The action extracts the `Issue ID` and the `Comment`
    text from the user input.

    2. **API Client Initialization:** It initializes the Wiz API client using the
    integration's configuration parameters (API Root, Client ID, Client Secret).

    3. **Mutation Building:** The action constructs a GraphQL mutation (`createIssueNote`)
    using the `AddCommentThreadMutationBuilder`, which packages the issue ID and the
    comment text into a valid GraphQL request.

    4. **API Request:** The action sends a POST request to the Wiz GraphQL endpoint
    to execute the mutation.

    5. **Result Handling:** If successful, the action parses the response into an
    `IssueComment` data model, returns the JSON representation of the created comment,
    and outputs a success message. If the issue is not found, it raises a specific
    `IssueNotFoundError`.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds a new comment (note) to an existing issue in the Wiz platform using a GraphQL
      mutation.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Issue Details:
  ai_description: >-
    ### General Description

    Retrieves comprehensive details for a specific security issue within the Wiz platform
    using its unique identifier. This action is used to gather deep context about
    findings, including their lifecycle status, severity, description, and metadata
    about the affected cloud resources.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Issue ID | string | Yes | The unique identifier of the Wiz issue to retrieve
    or act upon. |


    ### Flow Description

    1. **Parameter Extraction**: The action extracts the mandatory `Issue ID` from
    the input parameters.

    2. **API Client Initialization**: Initializes the Wiz API client, which involves
    authenticating via OAuth2 to obtain a bearer token.

    3. **GraphQL Query Construction**: Builds a GraphQL query specifically for the
    `issue` object, requesting fields such as `id`, `status`, `severity`, `description`,
    `entitySnapshot` (cloud platform, region, name), `projects`, and `sourceRules`.

    4. **Data Retrieval**: Executes the POST request to the Wiz GraphQL endpoint.

    5. **Result Formatting**: Parses the response into a structured JSON object and
    returns it as the action result.


    ### Additional Notes

    This action does not process Google SecOps entities; it relies entirely on the
    provided `Issue ID` parameter to fetch data.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ignore Issue:
  ai_description: >-
    ### General Description

    The **Ignore Issue** action allows users to ignore a specific issue within the
    Wiz platform. This action is specifically intended for Graph Control or Cloud
    Configuration issues. By executing this action, the status of the issue in Wiz
    is updated to 'REJECTED', effectively ignoring it based on a provided reason and
    supporting note.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | String | Yes | The unique identifier of the issue in Wiz that
    needs to be ignored. |

    | **Resolution Reason** | DDL | No | The reason for ignoring the issue. Available
    options are: `False Positive`, `Exception`, and `Won't Fix`. Defaults to `False
    Positive`. |

    | **Resolution Note** | String | Yes | A mandatory note providing additional context
    or justification for why the issue is being ignored. |


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the `Issue ID`, `Resolution
    Reason`, and `Resolution Note` from the input parameters.

    2. **Validation**: It validates that the `Resolution Reason` matches one of the
    predefined allowed values.

    3. **API Initialization**: An authenticated Wiz API client is initialized using
    the integration's configuration (API Root, Client ID, Client Secret).

    4. **Mutation Execution**: The action constructs and sends a GraphQL mutation
    to the Wiz API. This mutation updates the specified issue's status to `REJECTED`
    and attaches the chosen resolution reason and note.

    5. **Result Handling**: Upon success, the action returns the updated issue data
    as a JSON result and provides a success message to the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action updates the status of an issue in the Wiz platform to 'REJECTED'
      and modifies its resolution reason and resolution note fields.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility designed to verify the connectivity between Google
    SecOps and the Wiz platform. It ensures that the provided integration parameters
    (API Root, Client ID, and Client Secret) are correct and that the network path
    to the Wiz API is open.


    ### Parameters Description

    There are no action-specific parameters for this action. It relies entirely on
    the global integration configuration parameters:

    * **API Root**: The base URL for the Wiz API.

    * **Client ID**: The OAuth2 client identifier.

    * **Client Secret**: The OAuth2 client secret.

    * **Verify SSL**: Boolean flag to enable/disable SSL certificate validation.


    ### Flow Description

    1. **Initialization**: The action initializes the Wiz API client using the integration's
    global configuration.

    2. **Authentication**: It performs an OAuth2 client credentials grant flow to
    obtain a bearer token from the Wiz authentication service.

    3. **Connectivity Test**: It executes a minimal GraphQL query (`query { issues(first:
    1) { nodes { id } } }`) to the Wiz `/graphql` endpoint.

    4. **Validation**: The action validates the HTTP response and the GraphQL response
    body. If the request is successful and no GraphQL errors are returned, the action
    reports a successful connection.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Reopen Issue:
  ai_description: >-
    ### General Description

    The **Reopen Issue** action allows users to change the status of a specific issue
    in Wiz back to 'OPEN'. This is typically used when a previously resolved or ignored
    issue is found to still be relevant or requires further investigation. The action
    communicates with the Wiz API via GraphQL mutations to perform the status update.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | String | Yes | The unique identifier of the issue in Wiz that
    you want to reopen. |


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the mandatory `Issue ID` from
    the input parameters.

    2. **API Initialization**: It initializes the Wiz API client using the integration's
    configuration (API Root, Client ID, Client Secret).

    3. **Mutation Construction**: The action builds a GraphQL mutation specifically
    designed to update the `status` field of the target issue to `OPEN`.

    4. **Execution**: The mutation is sent to the Wiz `/graphql` endpoint.

    5. **Result Processing**: Upon success, the action retrieves the updated issue
    data, converts it to JSON for the SOAR platform, and provides a success message.
    If the issue is not found, it raises a specific error.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of an issue in the Wiz platform to 'OPEN'.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Resolve Issue:
  ai_description: >-
    ### General Description

    The **Resolve Issue** action allows users to programmatically resolve a specific
    issue within the Wiz platform. It is specifically designed for Threat Detection
    issues. By providing the unique Issue ID, a resolution reason, and an optional
    note, the action updates the issue's status to 'RESOLVED' in Wiz and retrieves
    the updated issue details.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | String | Yes | The unique identifier of the issue in Wiz that
    needs to be resolved. |

    | **Resolution Reason** | DDL | Yes | The reason for resolving the issue. Options
    include: `Malicious Threat`, `Not Malicious Threat`, `Security Test Threat`, `Planned
    Action Threat`, and `Inconclusive Threat`. Defaults to `Not Malicious Threat`.
    |

    | **Resolution Note** | String | No | An optional text field to provide additional
    context or justification for the resolution. |


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves the `Issue ID`, `Resolution
    Reason`, and `Resolution Note` from the input parameters.

    2. **Validation:** It validates that the provided `Resolution Reason` matches
    the allowed values defined in the Wiz integration constants.

    3. **API Initialization:** Initializes the Wiz API client using the integration's
    configuration (API Root, Client ID, Client Secret).

    4. **Execution:** Sends a GraphQL mutation request to the Wiz API to update the
    specified issue's status to `RESOLVED`, applying the chosen reason and note.

    5. **Result Handling:** If successful, it parses the updated issue data into JSON
    format for the action results and provides a success message. If the issue is
    not found, it raises a specific error.


    ### Additional Notes

    - This action only supports **Threat Detection** issues in Wiz.

    - The action performs a state change (mutation) in the external Wiz environment.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of a specified issue in Wiz to 'RESOLVED' and attaches a
      resolution reason and note via a GraphQL mutation.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
