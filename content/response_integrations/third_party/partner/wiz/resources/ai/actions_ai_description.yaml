Add Comment To Issue:
  ai_description: >-
    ### General Description

    The **Add Comment To Issue** action allows users to post a comment or note to
    a specific security issue within the Wiz platform. This is useful for documenting
    investigation progress, adding context from other security tools, or communicating
    within the Wiz interface directly from Google SecOps.


    ### Parameters Description


    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | The unique identifier of the security issue in Wiz where the
    comment will be added. | String | Yes |

    | **Comment** | The actual text content of the comment to be added to the issue.
    | String | Yes |


    ### Flow Description

    1. **Authentication**: The action initializes by authenticating with the Wiz API
    using the configured Client ID and Client Secret.

    2. **Parameter Extraction**: It retrieves the mandatory 'Issue ID' and 'Comment'
    parameters from the action input.

    3. **GraphQL Mutation**: It constructs a GraphQL mutation (`createIssueNote`)
    containing the issue ID and the comment text.

    4. **API Execution**: The action sends a POST request to the Wiz GraphQL endpoint
    to execute the mutation.

    5. **Verification**: Upon success, it returns the details of the created comment
    (ID, text, and creation time) and updates the action output message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds a new comment (note) to a specified issue in the external Wiz platform
      via a GraphQL mutation.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Issue Details:
  ai_description: >-
    ### General Description

    The **Get Issue Details** action retrieves comprehensive information about a specific
    issue within the Wiz platform using its unique Issue ID. This action is primarily
    used for investigative purposes, allowing analysts to fetch metadata such as status,
    severity, description, related entity snapshots, and associated projects directly
    into Google SecOps.


    ### Parameters Description

    | Parameter Name | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Issue ID | The unique identifier of the Wiz issue to retrieve or act upon. |
    string | True |


    ### Flow Description

    1.  **Parameter Extraction**: The action retrieves the mandatory `Issue ID` provided
    by the user.

    2.  **API Initialization**: It initializes the Wiz API client, including the authentication
    process (generating a Bearer token via OAuth2).

    3.  **Query Construction**: A GraphQL query is built using the `IssueQueryBuilder`,
    targeting fields like `id`, `status`, `severity`, `description`, `entitySnapshot`,
    `projects`, and `sourceRules`.

    4.  **Data Retrieval**: The action performs a POST request to the Wiz GraphQL
    endpoint with the constructed query and variables.

    5.  **Parsing and Output**: The raw JSON response is parsed into an `Issue` data
    model. The resulting data is then returned as the action's JSON result, and a
    success message is displayed.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ignore Issue:
  ai_description: >-
    ### General Description

    The **Ignore Issue** action allows users to ignore a specific security issue within
    the Wiz platform. This action is primarily designed to handle **Graph Control**
    or **Cloud Configuration** issues. By ignoring an issue, its status is updated
    to 'REJECTED' in Wiz, effectively acknowledging the finding but removing it from
    the active queue based on a provided reason (e.g., False Positive).


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | String | Yes | The unique identifier of the issue in the Wiz
    platform that needs to be ignored. |

    | **Resolution Reason** | DDL | Yes | The reason for ignoring the issue. Options
    include `False Positive`, `Exception`, and `Won't Fix`. Defaults to `False Positive`.
    |

    | **Resolution Note** | String | Yes | A mandatory note providing additional context
    or justification for why this specific issue is being ignored. |


    ### Additional Notes

    - This action specifically updates the issue status to **REJECTED** in the Wiz
    backend.

    - Although the metadata suggests 'Resolution Reason' is optional, the Python implementation
    treats it as a mandatory field with a default value.

    - The action returns the full JSON representation of the updated issue object.


    ### Flow Description

    1. **Extraction**: The action retrieves the `Issue ID`, `Resolution Reason`, and
    `Resolution Note` from the input parameters.

    2. **Validation**: It validates that the `Resolution Reason` provided matches
    the allowed values defined in the integration's constants.

    3. **API Interaction**: The action initializes the Wiz API client and constructs
    a GraphQL mutation to update the issue's status to `REJECTED`, attaching the chosen
    reason and note.

    4. **Outcome**: If successful, the action returns the updated issue data and provides
    a success message to the Case Wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the status of an existing issue in Wiz to 'REJECTED' and adds a resolution
      reason and a mandatory note.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic tool used to verify the connectivity between
    Google SecOps and the Wiz platform. It ensures that the provided integration parameters
    (API Root, Client ID, and Client Secret) are correct and that the network path
    to the Wiz API is open.


    ### Parameters Description

    This action does not require any additional input parameters. It relies solely
    on the global integration configuration.


    ### Flow Description

    1. **Initialization**: The action initializes the Wiz API client using the global
    integration settings.

    2. **Authentication**: It authenticates with the Wiz OAuth service to retrieve
    a valid bearer token.

    3. **Connectivity Test**: It executes a minimal GraphQL query to fetch the ID
    of the first available issue from the Wiz platform.

    4. **Validation**: The action validates the API response to confirm the service
    is reachable and the credentials have the necessary permissions.

    5. **Completion**: If the query succeeds, it returns a success message; otherwise,
    it raises an error indicating a connectivity or authentication failure.


    ### Additional Notes

    This action is typically used during the initial setup of the integration or for
    troubleshooting communication issues.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Reopen Issue:
  ai_description: >-
    ### General Description

    The **Reopen Issue** action transitions the status of a specific security issue
    in Wiz back to 'OPEN'. This is typically used when a finding that was previously
    marked as resolved or ignored requires further attention or has been re-verified
    as an active threat.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Issue ID** | String | Yes | The unique identifier of the issue in Wiz that
    you want to reopen. |


    ### Additional Notes

    - This action performs a state-changing operation on the external Wiz platform.

    - It requires an API Client with permissions to update issue statuses via GraphQL.


    ### Flow Description

    1. **Extraction:** The action retrieves the `Issue ID` from the action parameters.

    2. **Initialization:** It initializes the Wiz API client using the integration's
    API Root, Client ID, and Client Secret.

    3. **Mutation Construction:** The action utilizes the `UpdateIssueMutationBuilder`
    to create a GraphQL mutation that specifically sets the `status` field of the
    target issue to `OPEN`.

    4. **Execution:** The mutation is sent to the Wiz `/graphql` endpoint via a POST
    request.

    5. **Completion:** The action parses the response, converts the updated issue
    data into a JSON result, and outputs a success message in the SOAR interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the 'status' attribute of a specified issue to 'OPEN' within the Wiz
      platform.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Resolve Issue:
  ai_description: >-
    ### General Description

    Use the Resolve Issue action to resolve a specified issue in Wiz. This action
    allows security analysts to programmatically mark issues as resolved within the
    Wiz platform, providing specific reasons and additional context via notes. It
    is specifically intended for use with Threat Detection issues.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Issue ID | string | Yes | The unique identifier of the issue in Wiz. |

    | Resolution Reason | ddl | No | The reason for the resolution of the issue. Available
    options include: Malicious Threat, Not Malicious Threat (Default), Security Test
    Threat, Planned Action Threat, and Inconclusive Threat. |

    | Resolution Note | string | No | A note providing additional context or justification
    for the resolution. |


    ### Additional Notes

    - This action specifically targets Threat Detection issues. Attempting to resolve
    other types of issues may result in errors depending on the Wiz API configuration.

    - The 'Resolution Reason' parameter is a drop-down list with a default value of
    'Not Malicious Threat'.


    ### Flow Description

    1. **Initialization:** The action extracts the Issue ID, Resolution Reason, and
    Resolution Note from the input parameters.

    2. **Validation:** It validates the Resolution Reason against the allowed list
    of values defined in the integration constants.

    3. **API Client Setup:** Initializes the Wiz API client and authenticates using
    the provided credentials (Client ID and Client Secret).

    4. **GraphQL Mutation:** Constructs a GraphQL mutation using the `UpdateIssueMutationBuilder`
    to set the issue status to 'RESOLVED' and apply the patch containing the reason
    and note.

    5. **API Execution:** Executes the mutation against the Wiz `/graphql` endpoint.

    6. **Results Handling:** Parses the API response into an Issue data model, sets
    the action output message, and returns the updated issue details as a JSON result.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Changes the status of an issue in Wiz to 'RESOLVED' and updates its resolution
      reason and resolution note fields.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
