{"Name":"Get Future Attack Indicatiors","Description":"This command fetch indicators of potential future attacks using a feed UUID.","Script":"from SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import unix_now, convert_unixtime_to_datetime, output_handler\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_FAILED,EXECUTION_STATE_TIMEDOUT\n\nfrom constants import (INTEGRATION_NAME, GET_FUTURE_ATTACK_INDICATORS_SCRIPT_NAME )\nfrom SilentPushManager import SilentPushManager\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n\n    siemplify.script_name = GET_FUTURE_ATTACK_INDICATORS_SCRIPT_NAME \n\n    # Extract Integration config\n    server_url = siemplify.extract_configuration_param(INTEGRATION_NAME, \"Silent Push Server\")\n    api_key = siemplify.extract_configuration_param(INTEGRATION_NAME, \"API Key\")\n\n    feed_uuid = siemplify.extract_action_param(\"feed_uuid\", print_value=True)\n    page_no = siemplify.extract_action_param(\"page_no\", print_value=True)\n    page_size = siemplify.extract_action_param(\"page_size\", print_value=True)\n    \n    if page_no is None:\n        page_no  = 1\n    if page_size is None:\n        page_size = 10000\n    print(page_no, page_size)\n    try:\n        sp_manager = SilentPushManager(server_url, api_key, logger=siemplify.LOGGER)\n        raw_response = sp_manager.get_future_attack_indicators(feed_uuid, page_no, page_size)\n        \n        # Handle list or dict gracefully\n        if isinstance(raw_response, list):\n            indicators = raw_response\n        else:\n            indicators = raw_response.get(\"indicators\", [])\n        \n        if not indicators:\n            error_message = f\"No data found for feed_uuid {feed_uuid}.\"\n            siemplify.LOGGER.error(error_message)\n            status = EXECUTION_STATE_FAILED\n            siemplify.end(error_message, \"false\", status)\n        \n        output_message = f\"Result : {indicators}\"\n        status = EXECUTION_STATE_COMPLETED\n        result_value = True\n        siemplify.result.add_result_json({\"Output\": indicators})\n    except Exception as error:\n        result_value = False\n        status = EXECUTION_STATE_FAILED\n        output_message = f\"Failed to retrieve data for feed_uuid {feed_uuid},  for {INTEGRATION_NAME} server! Error: {error}\"\n        siemplify.LOGGER.error(output_message)\n        siemplify.LOGGER.exception(error)\n\n\n    for entity in siemplify.target_entities:\n        print(entity.identifier)\n\n\n\n    siemplify.LOGGER.info(\"\\n  status: {}\\n  result_value: {}\\n  output_message: {}\".format(status,result_value, output_message))\n    siemplify.end(output_message, result_value, status)\n\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"Silent Push","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{}","ShowResult":false}],"Creator":"dc26f847-d850-429c-bc2c-59631a988301","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":4.0,"TimeoutSeconds":600,"IsAsync":false,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"99da9b6a-146b-4a4d-9929-5fd5c6e2c257","Description":"Unique ID for the feed.","Name":"feed_uuid","Value":"99da9b6a-146b-4a4d-9929-5fd5c6e2c257","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"1","Description":"The page number to fetch results from.","Name":"page_no","Value":"1","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"10000","Description":"The number of indicators to fetch per page.","Name":"page_size","Value":"10000","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":"","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}