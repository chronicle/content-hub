create_host_record:
  ai_description: >-
    Adds a new host record to the Infoblox NIOS instance, allowing for the management
    of IP addresses and hostnames within the IPAM environment. This action supports
    the creation of both IPv4 and IPv6 address associations and can automatically
    generate corresponding DNS records (A, AAAA, and PTR) if the DNS configuration
    is enabled.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Name | String | Yes | The FQDN of the host (e.g., `server1.auth.threat.zone`).
    It must be part of an existing DNS zone. |

    | IPv4 Addresses | String | No | A JSON array of IPv4 objects. Example: `[{"ipv4addr":"192.168.1.100","mac":"00:11:22:33:44:55","configure_for_dhcp":true}]`.
    |

    | IPv6 Addresses | String | No | A JSON array of IPv6 objects. Example: `[{"ipv6addr":"2001:db8::1"}]`.
    |

    | View | String | No | The DNS view where the record will reside. Defaults to
    `default`. |

    | Comment | String | No | Optional notes or description for the host record. |

    | Aliases | String | No | Comma-separated list of CNAME aliases for the host.
    |

    | Configure for DNS | Boolean | No | If true (default), Infoblox creates associated
    DNS records. If false, only the IPAM host record is created. |

    | Extended Attributes | String | No | Comma-separated key/value pairs for Infoblox
    Extended Attributes (e.g., `Site=New York,Dept=IT`). |

    | Additional Parameters | String | No | A JSON object containing extra API parameters
    supported by the Infoblox `/record:host` endpoint. |


    ### Additional Notes

    - Either `IPv4 Addresses` or `IPv6 Addresses` should be provided to make the host
    record useful, though the API may allow creation without them depending on your
    Infoblox version and configuration.

    - The `Additional Parameters` field must be a valid JSON object string.


    ### Flow Description

    1. **Initialization**: Collects API credentials and action parameters from the
    SOAR environment.

    2. **Validation**: Validates that the mandatory `Name` is provided and ensures
    that `IPv4 Addresses`, `IPv6 Addresses`, and `Additional Parameters` are formatted
    as valid JSON.

    3. **Parsing**: Converts the `Aliases` and `Extended Attributes` strings into
    the format required by the Infoblox WAPI.

    4. **API Execution**: Sends a POST request to the Infoblox NIOS API (`/record:host`)
    to create the host record.

    5. **Reporting**: Parses the API response, creates a data table in the SOAR UI
    showing the new record's details (Reference ID, IP addresses, View), and attaches
    the raw JSON result for further automation steps.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new host record and optionally associated DNS A, AAAA, and PTR records
      in the Infoblox NIOS database.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_response_policy_zone:
  ai_description: >-
    ### General Description

    This action creates a new Response Policy Zone (RPZ) in Infoblox NIOS to define
    custom DNS responses. RPZs are used to modify DNS response behavior, such as redirection
    or blocking, based on the queried domain. This is essential for implementing DNS-based
    security controls like sinkholing and threat prevention.


    ### Parameters Description

    | Parameter | Mandatory | Type | Description |

    | :--- | :--- | :--- | :--- |

    | FQDN | Yes | String | The name of the DNS zone in Fully Qualified Domain Name
    format. |

    | Substitute Name | No | String | The alternative name of the redirect target
    used for substitute response policy zones. |

    | Comment | No | String | A descriptive comment for the zone. |

    | RPZ Policy | No | DDL | The override policy for the zone. Options: DISABLED,
    GIVEN, NODATA, NXDOMAIN, PASSTHRU, SUBSTITUTE. Default is 'GIVEN'. |

    | RPZ Severity | No | DDL | The severity level of the zone. Options: CRITICAL,
    MAJOR, WARNING, INFORMATIONAL. Default is 'MAJOR'. |

    | RPZ Type | No | DDL | The type of Response Policy Zone. Options: FEED, FIREEYE,
    LOCAL. Default is 'LOCAL'. |

    | Fireeye Rule Mapping | No | String | A JSON object containing rules to map FireEye
    alerts to the zone. |

    | Additional Parameters | No | String | A JSON object containing any additional
    Infoblox WAPI parameters to include in the creation request. |


    ### Additional Notes

    - Either provide just the mandatory FQDN or include complex configurations via
    the `Fireeye Rule Mapping` and `Additional Parameters` fields, which must be valid
    JSON objects.

    - This action performs a state change (creation) on the Infoblox appliance.


    ### Flow Description

    1. **Parameter Initialization:** Retrieves integration configuration (API root,
    credentials) and extracts action parameters provided by the user.

    2. **Validation:** Checks that the FQDN is not empty and validates that `Fireeye
    Rule Mapping` and `Additional Parameters` (if provided) are valid JSON dictionaries.

    3. **API Request:** Initializes the APIManager and executes a POST request to
    the Infoblox WAPI `/zone_rp` endpoint with the zone's configuration data.

    4. **Outcome Processing:** Upon successful creation, the script parses the API
    response into a result JSON and generates a UI data table labeled 'RP Zone' for
    the Google SecOps case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new Response Policy Zone (RPZ) object in the Infoblox NIOS instance,
      which modifies the system's DNS response configuration.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_a_rule:
  ai_description: >-
    ### General Description

    Creates an RPZ (Response Policy Zone) Substitute rule in Infoblox NIOS. This rule
    allows for mapping a domain name (A record) or an IPv4 address to a substitute
    IPv4 address, which is commonly used for DNS redirection or blocking of malicious
    traffic.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Object Type | DDL | Yes | Specifies whether the rule is for an 'IP Address'
    or a 'Domain Name'. Allowed values: 'IP Address', 'Domain Name'. |

    | Name | String | Yes | The name of the rule (e.g., the FQDN or IP being redirected).
    |

    | RP Zone | String | Yes | The name of the Response Policy Zone where this rule
    will be assigned. |

    | IPv4 Address | String | Yes | The substitute IPv4 address that the target will
    resolve to. |

    | Comment | String | No | An optional comment to describe the rule's purpose in
    the Infoblox record. |

    | Additional Parameters | String | No | A JSON object string used to provide extra
    Infoblox API parameters during rule creation. |


    ### Additional Notes

    - The action performs internal validation on the 'IPv4 Address' parameter to ensure
    it is a valid IPv4 address before sending the request to Infoblox.

    - The 'Object Type' determines the specific Infoblox WAPI object type used (`record:rpz:a`
    for Domain Names and `record:rpz:a:ipaddress` for IP Addresses).


    ### Flow Description

    1. **Initialization**: Collects integration configuration (API root, credentials)
    and extracts user-provided action parameters.

    2. **Validation**: Ensures mandatory fields are populated, validates that the
    'IPv4 Address' parameter follows valid networking standards, and verifies that
    'Additional Parameters' is valid JSON.

    3. **Request Preparation**: Sets the Infoblox API identifier and record type based
    on whether the user selected 'Domain Name' or 'IP Address' as the Object Type.

    4. **Execution**: Invokes the Infoblox API via a POST request to create the specified
    RPZ rule.

    5. **Results Processing**: Parses the API response, stores the raw JSON result,
    and generates a data table (CSV format) summarizing the created rule for display
    in the Google SecOps interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new Response Policy Zone (RPZ) A rule in Infoblox NIOS, modifying
      the external DNS configuration and resolution behavior for the environment.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_aaaa_rule:
  ai_description: >-
    ### General Description

    Creates a Response Policy Zone (RPZ) AAAA substitute rule in Infoblox NIOS. This
    action maps a domain name or an IPv6 address to a specific substitute IPv6 address,
    which is typically used for DNS redirection or blocking purposes within a managed
    network.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Object Type | DDL | Yes | Determines the type of record to create. Options are
    'Domain Name' or 'IP Address'. |

    | Name | String | Yes | The name of the rule (e.g., the FQDN or IP segment). |

    | RP Zone | String | Yes | The target Response Policy Zone where the rule will
    be assigned. |

    | IPv6 Address | String | Yes | The substitute IPv6 address that will be returned
    by the DNS server for this rule. |

    | Comment | String | No | An optional description or note for the rule. |

    | Additional Parameters | String | No | A JSON-formatted string containing additional
    Infoblox API fields to include in the creation request. |


    ### Additional Notes

    - This action does not operate on SOAR entities; it relies entirely on the provided
    input parameters.

    - The 'IPv6 Address' parameter is strictly validated for correct IPv6 syntax before
    the request is sent.

    - 'Additional Parameters' must be a valid JSON object string if provided.


    ### Flow Description

    1. **Initialization:** Extracts and validates input parameters, ensuring that
    required strings are non-empty and the IPv6 address is valid.

    2. **Type Selection:** Determines the correct Infoblox API endpoint and record
    type (record:rpz:aaaa or record:rpz:aaaa:ipaddress) based on the 'Object Type'
    selection.

    3. **API Interaction:** Constructs the payload (including name, zone, address,
    and optional comments/additional parameters) and sends a POST request to the Infoblox
    NIOS WAPI.

    4. **Result Processing:** If successful, it parses the response into a JSON object
    and generates a data table named 'RPZ AAAA Rule' for visibility in the SOAR UI.

    5. **Completion:** Returns a success or failure message based on the API response
    status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new RPZ AAAA record (substitute rule) in the external Infoblox NIOS
      system via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_cname_rule:
  ai_description: >-
    Adds a CNAME rule to an existing Response Policy Zone (RPZ) in Infoblox NIOS to
    override DNS behavior. This action allows for DNS firewalling capabilities such
    as blocking domains, passing through specific traffic, or redirecting (substituting)
    a domain to a different name. The action supports rules targeting Domain Names,
    IP Addresses, or Client IP Addresses.


    ### Flow Description:

    1. **Initialization:** Retrieves Infoblox connection details and action parameters
    including the rule name, zone, and rule logic.

    2. **Validation:** Ensures mandatory fields like 'Name' and 'RP Zone' are provided
    and validates that 'Additional Parameters' is a valid JSON object.

    3. **Logic Mapping:** Determines the target API endpoint based on the 'Object
    Type' and calculates the 'canonical' value based on the 'Rule Type' (e.g., setting
    '*' for 'Block (No data)' or the provided substitute domain for 'Substitute').

    4. **Execution:** Performs a POST request to Infoblox NIOS to create the CNAME
    record.

    5. **Output:** Formats the resulting rule data into a JSON result and a data table
    for the case wall.


    ### Parameters Description:


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Name | string | Yes | The rule name in FQDN format. |

    | RP Zone | string | Yes | The Response Policy Zone to assign the rule to. |

    | Rule Type | ddl | Yes | The type of rule logic: 'Passthru', 'Block (No such
    domain)', 'Substitute (Domain name)', or 'Block (No data)'. |

    | Object Type | ddl | Yes | Specifies if the rule applies to a 'Domain Name',
    'IP Address', or 'Client IP Address'. |

    | Substitute Name | string | No | The substitute domain name to assign. Mandatory
    only if Rule Type is 'Substitute (Domain name)'. |

    | Comment | string | No | A textual comment to associate with the rule. |

    | View | string | No | The DNS view in which the record is located (Default is
    'default'). |

    | Additional Parameters | string | No | A JSON object containing extra parameters
    supported by the Infoblox WAPI for RPZ rules. |


    ### Additional Notes:

    - If 'Rule Type' is set to 'Substitute (Domain name)', the 'Substitute Name' parameter
    must be populated.

    - The 'Substitute (Domain name)' rule type is only valid for 'Domain Name' objects,
    not for IP-based objects.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new CNAME rule within a Response Policy Zone (RPZ) on the Infoblox
      NIOS server via a POST request, which modifies the active DNS security policy.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_mx_rule:
  ai_description: >-
    ### General Description

    The **Create RPZ MX Rule** action creates a Mail Exchange (MX) override rule within
    a specified Response Policy Zone (RPZ) on an Infoblox NIOS server. This action
    allows security teams to redirect or manipulate mail traffic for specific domains
    at the DNS level, typically used for blocking malicious mail servers or redirecting
    traffic to security gateways.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Name** | String | Yes | The name of the rule (FQDN). If the zone name is not
    included, the action appends it automatically. |

    | **RP Zone** | String | Yes | The name of the Response Policy Zone where the
    rule should be added. |

    | **Mail Exchanger** | String | Yes | The domain name of the mail exchanger for
    this rule. |

    | **Preference** | String | Yes | An integer (0-65535) representing the priority
    of the mail exchanger. Lower values have higher priority. |

    | **Comment** | String | No | A descriptive comment to attach to the record in
    Infoblox. |

    | **Additional Parameters** | String | No | A JSON string containing additional
    valid Infoblox WAPI parameters to be included in the request body. |


    ### Flow Description

    1. **Initialization:** The action retrieves integration credentials and extracts
    all action parameters, including the MX rule details.

    2. **Validation:** It validates that mandatory strings are provided, checks that
    the `Preference` is a valid integer within the allowed range (0-65535), and ensures
    `Additional Parameters` is valid JSON.

    3. **Request Preparation:** The rule name is formatted (ensuring the zone suffix
    exists) and the API payload is constructed.

    4. **Execution:** A POST request is sent to the Infoblox WAPI (`/record:rpz:mx`
    endpoint).

    5. **Reporting:** Upon success, the action adds the raw JSON response to the result,
    generates a data table named 'RPZ MX Rule' containing the rule details, and provides
    a success message.


    ### Additional Notes

    - If the `Name` parameter does not end with the `RP Zone` string, the action will
    automatically append `. <RP Zone>` to ensure the record is correctly placed within
    the DNS hierarchy.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new MX (Mail Exchange) record within a Response Policy Zone on the
      Infoblox NIOS server using a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_naptr_rule:
  ai_description: "### General Description\nThis action adds a Naming Authority Pointer\
    \ (NAPTR) override rule in a Response Policy Zone (RPZ) within Infoblox NIOS.\
    \ NAPTR records are primarily used for DNS-based service discovery and to map\
    \ domain names to URIs or other domain names using regular expressions. This action\
    \ allows security administrators to control how these records are handled within\
    \ an RPZ, facilitating redirection or blocking of specific service discovery attempts.\n\
    \n### Parameters\n| Parameter | Type | Mandatory | Description |\n| :--- | :---\
    \ | :--- | :--- |\n| Name | string | Yes | The name of the rule to be created.\
    \ |\n| RP Zone | string | Yes | The FQDN of the Response Policy Zone where the\
    \ rule will be assigned. |\n| Order | string | Yes | An integer (0-65535) defining\
    \ the sequence of rule application. Lower values are processed first. |\n| Preference\
    \ | string | Yes | An integer (0-65535) defining the order of rules with the same\
    \ 'Order' value. |\n| Replacement | string | Yes | The replacement domain name\
    \ or URI for the NAPTR record. |\n| Comment | string | No | An optional description\
    \ for the rule. |\n| Additional Parameters | string | No | A JSON object string\
    \ containing extra Infoblox WAPI parameters for the record. |\n\n### Flow Description\n\
    1. **Initialization**: The action retrieves Infoblox configuration (API Root,\
    \ Username, Password) and action parameters.\n2. **Validation**: \n    - Ensures\
    \ mandatory strings (`Name`, `RP Zone`, `Replacement`) are non-empty.\n    - Validates\
    \ `Order` and `Preference` are valid non-negative integers between 0 and 65535.\n\
    \    - Validates `Additional Parameters` is a properly formatted JSON object if\
    \ provided.\n3. **API Interaction**: Calls the Infoblox WAPI to create a `record:rpz:naptr`\
    \ object via a POST request.\n4. **Data Processing**: Converts the API response\
    \ into a structured JSON result and creates a CSV-formatted data table for display.\n\
    5. **Completion**: Returns a success message if the rule is created; otherwise,\
    \ it reports a failure."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new NAPTR (Naming Authority Pointer) record within the specified Infoblox
      Response Policy Zone (RPZ).
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_ptr_rule:
  ai_description: "Adds a reverse DNS lookup override (PTR record) in a specific Response\
    \ Policy Zone (RPZ) within Infoblox NIOS. This action allows security teams to\
    \ redirect or block reverse DNS queries by creating substitute PTR records.\n\n\
    ### Parameters\n| Parameter | Type | Mandatory | Description |\n| :--- | :---\
    \ | :--- | :--- |\n| PTR DName | String | Yes | The domain name of the RPZ substitute\
    \ rule object of the PTR record. |\n| RP Zone | String | Yes | The zone to assign\
    \ the rule to (e.g., 'rpz.local'). |\n| Name | String | No | The name of the RPZ\
    \ Substitute rule object of the PTR record. |\n| Comment | String | No | A descriptive\
    \ comment for the rule. |\n| IPv4 Address | String | No | The IPv4 address of\
    \ the substitute rule. |\n| IPv6 Address | String | No | The IPv6 address of the\
    \ substitute rule. |\n| Additional Parameters | String | No | A JSON object containing\
    \ additional parameters for the Infoblox WAPI request. |\n\n### Additional Notes\n\
    - **Mandatory Requirements**: While 'Name', 'IPv4 Address', and 'IPv6 Address'\
    \ are marked as non-mandatory in the configuration, the logic requires that **at\
    \ least one** of these three parameters must be provided to create the rule.\n\
    - **Address Validation**: The action performs strict validation on provided IPv4\
    \ and IPv6 addresses to ensure they are correctly formatted before sending the\
    \ request to Infoblox.\n\n### Flow Description\n1. **Initialization**: Retrieves\
    \ Infoblox connection parameters (API Root, Username, Password) and extracts action-specific\
    \ parameters.\n2. **Validation**: \n    - Ensures 'PTR DName' and 'RP Zone' are\
    \ provided.\n    - Validates that at least one identifying field (Name, IPv4,\
    \ or IPv6) is present.\n    - Checks the format of 'IPv4 Address' and 'IPv6 Address'\
    \ if provided.\n    - Parses 'Additional Parameters' if provided as a JSON string.\n\
    3. **API Interaction**: Uses the `APIManager` to perform a POST request to the\
    \ Infoblox `record:rpz:ptr` endpoint with the constructed payload.\n4. **Reporting**:\
    \ \n    - Adds the raw API response to the action's JSON results.\n    - Generates\
    \ a data table containing the Reference ID, Object Type, Name, and PTR DName of\
    \ the newly created rule for visibility in the case wall.\n    - Returns a success\
    \ message if the rule is created successfully."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      This action performs a POST request to the Infoblox NIOS WAPI to create a new
      'record:rpz:ptr' object, which modifies the DNS configuration within the specified
      Response Policy Zone.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_srv_rule:
  ai_description: "Adds an SRV (Service) record override in a Response Policy Zone\
    \ (RPZ) within Infoblox NIOS. This action is used for service-based DNS lookups,\
    \ allowing security teams to redirect or block specific service discovery traffic\
    \ at the DNS level.\n\n### Parameters\n| Parameter | Type | Mandatory | Description\
    \ |\n| :--- | :--- | :--- | :--- |\n| Name | String | Yes | The name of the SRV\
    \ rule. |\n| Priority | String | Yes | The priority of the Substitute (SRV Record)\
    \ Rule. Must be an integer between 0 and 65535. |\n| RP Zone | String | Yes |\
    \ The name of the response policy zone where the record will reside. |\n| Port\
    \ | String | Yes | The port associated with the SRV Rule. Must be an integer between\
    \ 0 and 65535. |\n| Target | String | Yes | The hostname of the machine providing\
    \ the service (Target). |\n| Weight | String | Yes | The weight of the Substitute\
    \ (SRV Record) Rule. Must be an integer between 0 and 65535. |\n| Comment | String\
    \ | No | A descriptive comment for the record. |\n| Additional Parameters | String\
    \ | No | A JSON object containing advanced/optional WAPI parameters for the creation\
    \ request. |\n\n### Additional Notes\n- The **Priority**, **Port**, and **Weight**\
    \ parameters are provided as strings but must represent valid integers within\
    \ the standard port/priority range (0-65535).\n- The action automatically appends\
    \ the `RP Zone` to the `Name` if it is not already present to form the full FQDN\
    \ required by Infoblox.\n\n### Flow Description\n1. **Initialization**: Collects\
    \ Infoblox integration credentials and retrieves action parameters.\n2. **Validation**:\
    \ \n   - Validates that mandatory string fields (Name, RP Zone, Target) are non-empty.\n\
    \   - Converts and validates Priority, Port, and Weight as non-negative integers\
    \ up to 65535.\n   - Parses `Additional Parameters` JSON if provided.\n3. **API\
    \ Execution**: Sends a POST request to the Infoblox WAPI (`/record:rpz:srv`) to\
    \ create the new SRV record.\n4. **Result Processing**: If successful, it constructs\
    \ a data table summarizing the new rule's details (Reference ID, Object Type,\
    \ Name, Target, Port, Priority, Weight) and attaches the full JSON response."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new 'record:rpz:srv' entry in the specified Infoblox Response Policy
      Zone, effectively altering DNS response behavior for the target service.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
create_rpz_txt_rule:
  ai_description: >-
    Adds a TXT record rule in a Response Policy Zone (RPZ) within Infoblox NIOS. This
    action allows security administrators to associate specific text data with DNS
    responses, often used for providing descriptive information or policy triggers
    in response to DNS queries.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | RP Zone | string | Yes | The specific Response Policy Zone to assign the rule
    to. |

    | Name | string | Yes | The name of the rule record. The action automatically
    appends the RP Zone name to this value. |

    | Text | string | Yes | The actual text data to be associated with the TXT record.
    |

    | Comment | string | No | A descriptive comment for the rule record. |

    | Additional Parameters | string | No | A JSON-formatted string containing additional
    Infoblox WAPI parameters for advanced configuration. |


    ### Flow Description

    1. **Validation**: The action validates that the 'RP Zone', 'Name', and 'Text'
    parameters are provided and non-empty. It also validates that 'Additional Parameters',
    if provided, is a valid JSON object.

    2. **Name Construction**: It formats the record name by ensuring the 'Name' parameter
    ends with the 'RP Zone' suffix.

    3. **API Interaction**: It initiates a POST request to the Infoblox WAPI endpoint
    `/record:rpz:txt` with the record details.

    4. **Result Processing**: If successful, it returns the raw JSON response from
    Infoblox and constructs a data table (CSV) containing the Reference ID, Object
    Type, Name, RP Zone, and the Text content of the newly created rule.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new TXT record rule within the Infoblox NIOS Response Policy Zone
      (RPZ) configuration via the WAPI.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
delete_response_policy_zone:
  ai_description: >-
    Deletes a specific Response Policy Zone (RPZ) from an Infoblox NIOS instance using
    its unique reference ID. This action is primarily used for containment cleanup
    or policy management, allowing security administrators to programmatically remove
    DNS policy zones that are no longer required.


    ### General Description

    This action performs a hard deletion of a Response Policy Zone in Infoblox NIOS.
    It requires the internal Infoblox reference ID (Object Reference) of the zone
    to execute the deletion request via the Infoblox WAPI.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Reference ID | String | Yes | The unique object reference of the response policy
    zone to be deleted (e.g., `zone_rp/ZG5zLnpvbmUkLl9kZWZhdWx0LnJwei5jb20:rpz.com/default`).
    |


    ### Additional Notes

    - Either this action or similar management actions should be used with caution,
    as deleting a zone is irreversible through the API.

    - The action will fail with a specific error message if the provided Reference
    ID does not exist in the Infoblox system.


    ### Flow Description

    1. **Initialization**: The action initializes the Siemplify context and retrieves
    Infoblox integration parameters (API Root, Credentials).

    2. **Parameter Extraction**: It extracts and validates the mandatory `Reference
    ID` from the action inputs.

    3. **API Interaction**: It utilizes the `APIManager` to send a `DELETE` request
    to the Infoblox WAPI endpoint associated with the specific reference ID.

    4. **Error Handling**: The script catches `ItemNotFoundException` if the ID is
    invalid and provides a descriptive error. It also handles general `InfobloxException`
    or connection issues.

    5. **Completion**: The action terminates by reporting a success message if the
    deletion was confirmed by the external system or a failure message detailing the
    error.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes an existing Response Policy Zone (RPZ) from the Infoblox NIOS server
      using a DELETE request to the WAPI.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
delete_rpz_rule:
  ai_description: >-
    Deletes a rule from a specified Response Policy Zone (RPZ) in Infoblox NIOS using
    its unique reference ID. This action interacts with the Infoblox WAPI to perform
    a hard deletion of the DNS policy record, supporting all RPZ record types (A,
    AAAA, CNAME, MX, etc.) by targeting the specific object reference.


    ### Parameters

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Reference ID | string | Yes | The unique object reference (e.g., `record:rpz:cname/ZG5zLmJpbmRfY25hbWUkLl9kZWZhdWx0LmNvbS5leGFtcGxlLmFwcDphcHAtMS5leGFtcGxlLmNvbQ`)
    of the RPZ rule to be deleted. |


    ### Flow Description

    1. **Initialization**: Retrieves integration configuration (API Root, Username,
    Password) and extracts the mandatory 'Reference ID' parameter.

    2. **Validation**: Ensures the 'Reference ID' is a non-empty string.

    3. **API Execution**: Initializes the Infoblox API Manager and sends a `DELETE`
    request to the specific endpoint associated with the provided Reference ID.

    4. **Error Handling**: Specifically catches `ItemNotFoundException` if the rule
    does not exist, and general `InfobloxException` for API errors, returning a failure
    status if the deletion cannot be completed.

    5. **Completion**: Updates the action status and provides a success message upon
    successful removal of the record.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Performs a DELETE request to the Infoblox WAPI to permanently remove a DNS RPZ
      rule from the external system.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
dhcp_lease_lookup:
  ai_description: >-
    ### General Description

    Retrieves DHCP lease details from Infoblox NIOS based on various search criteria
    such as IP address, MAC address (Hardware), hostname, or associated username.
    This action allows security analysts to identify the owner or device history of
    a specific network address by querying the Infoblox DHCP database. It supports
    both IPv4 and IPv6 protocols and provides results in both raw JSON and a structured
    data table format.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | IP Address | string | No | The IPv4 or IPv6 address to look up in the lease
    database. |

    | Hardware | string | No | The MAC address for IPv4 leases. Supports exact or
    regex-based searches. |

    | Hostname | string | No | The hostname sent via DHCP option 12. Supports exact
    or regex-based searches. |

    | IPv6 DUID | string | No | The IPv6 DHCP Unique Identifier (DUID) for IPv6 leases.
    Supports exact or regex-based searches. |

    | Protocol | ddl | No | Restricts the search to a specific protocol: 'IPv4', 'IPv6',
    or 'Both' (default). |

    | Fingerprint | string | No | The DHCP client fingerprint. Supports case-insensitive
    or regex-based searches. |

    | Username | string | No | The username associated with the DHCP lease request.
    Supports case-insensitive or regex-based searches. |

    | Limit | string | No | The maximum number of objects to return. Defaults to 100
    if not specified. |


    ### Additional Notes

    - This action does not automatically run on entities from the context; it relies
    on the parameters provided in the action configuration.

    - Regex searches are supported by Infoblox for fields like Hardware, Hostname,
    Fingerprint, and Username using the '~' operator internally.


    ### Flow Description

    1. **Input Validation**: The action validates that the 'Limit' parameter is a
    positive integer and verifies that the 'IP Address' (if provided) follows a valid
    IPv4 or IPv6 format.

    2. **API Interaction**: It constructs a GET request to the Infoblox WAPI `/lease`
    endpoint, applying the provided filters (e.g., address, hardware, hostname).

    3. **Pagination**: If the number of results exceeds the internal page size, the
    action uses Infoblox pagination logic to retrieve up to the specified 'Limit'.

    4. **Data Formatting**: The retrieved lease records (containing fields like binding
    state, client hostname, and hardware address) are mapped to a flat data model.

    5. **Output Generation**: The action adds the full JSON response to the execution
    results and generates a data table (limited to 20 records) for display in the
    case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
get_response_policy_zone_details:
  ai_description: >-
    ### General Description  Retrieves configuration details for specified Response
    Policy Zones (RPZ) from Infoblox NIOS. This action allows users to filter results
    by FQDN, DNS view, and comments, providing both raw JSON data and a formatted
    table of the zone configurations.  ### Parameters Description  | Parameter | Type
    | Mandatory | Default | Description | | :--- | :--- | :--- | :--- | :--- | | FQDN
    | String | No | None | The name of the DNS zone in FQDN format. | | View | String
    | No | default | The name of the DNS view in which the zone resides (e.g., 'external').
    | | Comment | String | No | None | Comment used to filter the zones (supports
    partial match). | | Limit | String | No | 100 | Maximum number of objects to be
    returned. |  ### Additional Notes  - If no filters are provided, the action will
    return all available RP zones up to the specified limit. - The results table displays
    a maximum of 20 records (defined by MAX_TABLE_RECORDS) for performance reasons,
    while the JSON result contains the full set of retrieved objects. - The 'Limit'
    parameter must be a positive integer.  ### Flow Description  1. **Parameter Initialization**:
    The action extracts the FQDN, View, Comment, and Limit parameters from the input.
    2. **Validation**: Validates the 'Limit' parameter to ensure it is a positive
    integer greater than zero. 3. **API Query**: Connects to the Infoblox NIOS WAPI
    and performs a GET request to the 'zone_rp' endpoint with the specified filter
    criteria. 4. **Output Generation**: Parses the returned zone data into a JSON
    result and a human-readable data table, then completes the action with a summary
    message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
ip_lookup:
  ai_description: >-
    Performs IPAM (IP Address Management) lookups within Infoblox NIOS to retrieve
    detailed information about IP addresses, networks, or IP ranges. The action allows
    for granular searching based on status and extended attributes, providing visibility
    into lease information, MAC addresses, and network associations.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Limit | string | No | Maximum number of objects to be returned (Default is 100).
    |

    | IP Address | string | No | Specific IP address to retrieve information for.
    Cannot be used with Network or From/To IP. |

    | Network | string | No | Network in FQDN/CIDR format (e.g., 192.168.1.0/24).
    Cannot be used with IP Address or From/To IP. |

    | From IP | string | No | Starting IP of a range. Must be used with 'To IP'. |

    | To IP | string | No | Ending IP of a range. Must be used with 'From IP'. |

    | Status | ddl | No | Filters results by IP device status: All, Active, Used,
    or Unused. |

    | Extended Attributes | string | No | Comma-separated key/value filter for Infoblox
    extended attributes (e.g., 'Site=New York'). |


    ### Additional Notes

    - **Mutual Exclusivity:** Users must provide exactly one of the following: a specific
    'IP Address', a 'Network', or a range defined by 'From IP' and 'To IP'. Providing
    multiple or none will result in a failure.

    - **IPv4/IPv6 Support:** The action automatically detects and uses the appropriate
    Infoblox API endpoint based on the format of the input parameters.


    ### Flow Description

    1. **Parameter Initialization:** Retrieves integration configuration (API root,
    credentials) and action-specific search parameters.

    2. **Input Validation:** Ensures that the search criteria are valid and mutually
    exclusive (e.g., verifying CIDR format for networks or validating IP formats).

    3. **API Interaction:** Connects to the Infoblox NIOS instance and performs a
    paginated GET request using the `ip_lookup` method.

    4. **Data Processing:** Maps the raw API response to the `IPLookup` data model,
    extracting key fields such as MAC Address, DHCP details, and Usage status.

    5. **Output Generation:** Appends the full raw JSON to the action results and
    constructs a formatted data table for the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
list_host_info:
  ai_description: "### General Description\nThe **List Host Info** action retrieves\
    \ detailed host records from Infoblox NIOS. It allows users to search for host\
    \ objects based on various criteria such as hostname, IPv4 address, IPv6 address,\
    \ or specific extensible attributes. The action is primarily used for network\
    \ reconnaissance and asset identification, providing data such as DNS views, zones,\
    \ configuration status, and all associated IP records.\n\n### Parameters Description\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | **IPv4 Address** | String | No | Filters results by a specific IPv4 address\
    \ associated with the host record. |\n| **Name** | String | No | Filters results\
    \ by the hostname (FQDN) of the record. |\n| **IPv6 Address** | String | No |\
    \ Filters results by a specific IPv6 address associated with the host record.\
    \ |\n| **Extended Attributes** | String | No | A comma-separated string of key/value\
    \ pairs (e.g., \"Site=New York\") used to filter hosts based on custom Infoblox\
    \ attributes. |\n| **Limit** | String | No | Specifies the maximum number of objects\
    \ to return. Defaults to 100. |\n\n### Additional Notes\n- This action does not\
    \ automatically run on entities in the Google SecOps case scope; it relies strictly\
    \ on the provided input parameters.\n- If multiple filters are provided (e.g.,\
    \ Name and IPv4), the external system typically treats them as an AND condition.\n\
    - The results table displays up to a hardcoded maximum of 20 records for readability,\
    \ while the full JSON output contains all retrieved records up to the specified\
    \ limit.\n\n### Flow Description\n1. **Initialization**: The action extracts integration\
    \ configuration (API credentials) and action parameters (filters and limits).\n\
    2. **Validation**: It validates that the `Limit` is a positive integer and verifies\
    \ the format of provided IPv4/IPv6 addresses.\n3. **Request Construction**: The\
    \ `APIManager` builds a GET request to the `/record:host` endpoint, applying the\
    \ provided filters and pagination logic.\n4. **Data Retrieval**: The action fetches\
    \ host records, handling potential API rate limits with a retry mechanism.\n5.\
    \ **Output Generation**: \n    - The raw response is added as a JSON result.\n\
    \    - A formatted CSV data table is created containing key fields like Reference\
    \ ID, Name, DNS View, and associated IP addresses."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
list_network_info:
  ai_description: >-
    Lists defined IPv4/IPv6 networks and subnets within Infoblox IPAM. This action
    allows users to retrieve a list of network objects based on specific CIDR notation
    or custom filtering criteria via extended attributes.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Network | String | No | The network address in CIDR notation (e.g., "192.168.1.0/24").
    If provided, the action filters results to match this specific network. |

    | Limit | String | No | Maximum number of network objects to be returned. Default
    value is "100". |

    | Extended Attributes | String | No | A comma-separated key/value formatted filter
    for extended attributes (e.g., "Site=New York,Department=IT"). Used for advanced
    filtering of network objects. |


    ### Flow Description

    1. **Initialization**: The action initializes the Infoblox API manager and extracts
    configuration and action parameters.

    2. **Validation**: It validates that the 'Limit' is a positive integer and that
    the 'Network' parameter (if provided) follows a valid CIDR format.

    3. **Data Retrieval**: The action performs a GET request to the Infoblox NIOS
    WAPI `/network` endpoint, applying filters for the specific network and any provided
    extended attributes.

    4. **Processing**: It processes the API response, converting raw data into a structured
    format.

    5. **Output**: Results are added to the action's JSON results. If networks are
    found, a data table titled "Networks" is created containing the top 20 records
    (defined by MAX_TABLE_RECORDS), showing details such as Reference ID, Network,
    Network View, and Utilization.


    ### Additional Notes

    - This action does not interact with SOAR entities; it relies entirely on input
    parameters to perform lookups.

    - Pagination is handled internally by the API manager based on the provided limit.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility designed to verify the connectivity between Google
    SecOps and the Infoblox NIOS server. It ensures that the provided credentials
    and API root are correct and that the network path to the Infoblox WAPI (Web API)
    is open.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **API Root** | String | Yes | The base URL of the Infoblox NIOS server (e.g.,
    `https://192.168.1.10`). |

    | **Username** | String | Yes | The username used to authenticate with the Infoblox
    NIOS server. |

    | **Password** | String | Yes | The password used to authenticate with the Infoblox
    NIOS server. |

    | **Verify SSL** | Boolean | No | If enabled, the action will verify the SSL certificate
    of the Infoblox server. (Defaults to False in the script logic). |


    ### Additional Notes

    - This action does not interact with any entities in a case. It is typically used
    during initial setup or for troubleshooting integration health.

    - It specifically targets the `/?_schema` endpoint of the Infoblox WAPI to confirm
    a successful handshake.


    ### Flow Description

    1. **Parameter Initialization:** The script retrieves the integration configuration
    parameters including API Root, Username, and Password.

    2. **Manager Setup:** An instance of the `APIManager` is created using the provided
    connectivity details.

    3. **Connectivity Test:** The `test_connectivity` method is called, which performs
    a GET request to the Infoblox schema endpoint.

    4. **Result Handling:** If the request is successful, the action returns a success
    message and a boolean result of `True`. If an exception occurs (e.g., authentication
    failure or timeout), it catches the error and returns a failure message with a
    boolean result of `False`.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
search_rpz_rule:
  ai_description: "### General Description\nSearches for a specific Response Policy\
    \ Zone (RPZ) rule within Infoblox NIOS by its name and object type. This action\
    \ is used to retrieve detailed information about existing rules, such as CNAME,\
    \ A, AAAA, MX, and TXT records within an RPZ, allowing analysts to verify configuration\
    \ or identify existing policies.\n\n### Parameters Description\n\n| Parameter\
    \ | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| **Object\
    \ Type** | DDL | Yes | The Infoblox object type to search for (e.g., `record:rpz:cname`,\
    \ `record:rpz:a`). |\n| **Rule Name** | String | No | The full rule name to search\
    \ for (usually formatted as `name.zone`). |\n| **Output Fields** | String | No\
    \ | A comma-separated list of additional fields to include in the response (e.g.,\
    \ `address`, `comment`). Default fields like `name` and `view` are always included.\
    \ |\n| **Limit** | String | No | Maximum number of objects to be returned. Defaults\
    \ to 100. |\n\n### Additional Notes\n- The action uses a paginated search to retrieve\
    \ results from the Infoblox WAPI.\n- A maximum of 20 records will be displayed\
    \ in the SOAR UI data table for readability, though all results are included in\
    \ the raw JSON output.\n- Default fields `name` and `view` are automatically appended\
    \ to any custom fields provided in the `Output Fields` parameter.\n\n### Flow\
    \ Description\n1. **Parameter Initialization**: The action retrieves integration\
    \ credentials and extracts the user-provided search criteria (Object Type, Rule\
    \ Name, Output Fields, and Limit).\n2. **Validation**: The `Limit` parameter is\
    \ validated to ensure it is a positive integer. \n3. **API Interaction**: The\
    \ action sends a GET request to the Infoblox NIOS API targeting the specific `Object\
    \ Type` with the `Rule Name` filter.\n4. **Data Processing**: Retrieved results\
    \ are parsed into a standardized format. \n5. **Output Generation**: The raw JSON\
    \ results are added to the action result, and a summary data table titled \"RPZ\
    \ Rules\" is created for the case wall if any matches are found."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
update_rpz_cname_rule:
  ai_description: >-
    ### General Description

    Updates an existing Response Policy Zone (RPZ) CNAME rule in Infoblox NIOS. This
    action allows users to modify the configuration of established DNS rules, including
    changing the rule type (e.g., switching from blocking to passthrough), updating
    the rule name, or adding comments. It is primarily used to adjust DNS-level security
    policies dynamically based on evolving threat intelligence or administrative requirements.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Reference ID | String | Yes | The unique reference identifier of the existing
    RPZ rule to be updated. |

    | Rule Type | DDL | Yes | Specifies the new behavior for the rule. Options include:
    'Passthru', 'Block (No such Domain)', 'Block (No data)', and 'Substitute (Domain
    name)'. |

    | Name | String | Yes | The name of the rule in FQDN format. |

    | RP Zone | String | Yes | The name of the Response Policy Zone where the rule
    is located. |

    | Comment | String | No | An optional description or administrative note for the
    rule. |

    | Substitute Name | String | No | The domain name to substitute for the original
    query. **Mandatory** if 'Rule Type' is set to 'Substitute (Domain name)'. |

    | View | String | No | The DNS view in which the records are located. Defaults
    to 'default'. |

    | Additional Parameters | String | No | A JSON object string containing extra
    Infoblox WAPI parameters to include in the update request. |


    ### Additional Notes

    - If 'Rule Type' is set to 'Substitute (Domain name)', the action will fail if
    'Substitute Name' is not provided.

    - The action automatically formats the rule name using the 'Name' and 'RP Zone'
    parameters to ensure FQDN consistency.

    - This action uses a 'PUT' request, meaning it modifies state in the Infoblox
    NIOS environment.


    ### Flow Description

    1. **Initialization**: Extracts the API configuration and action parameters, validating
    that mandatory fields like 'Reference ID', 'Name', and 'RP Zone' are present.

    2. **Rule Logic Calculation**: Determines the 'canonical' value for the CNAME
    record based on the selected 'Rule Type'. For example, it sets canonical to '*'
    for 'Block (No data)' or uses the 'Substitute Name' for substitution rules.

    3. **API Execution**: Calls the Infoblox WAPI via a PUT request to the rule's
    specific reference URL with the updated parameters.

    4. **Result Processing**: If the update is successful, it converts the returned
    JSON data into a flat structure for a SOAR data table and populates the action
    result.

    5. **Completion**: Ends the action with a success message containing the Reference
    ID or logs an error if the rule update fails or the reference ID is not found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates an existing RPZ CNAME rule configuration in Infoblox NIOS via a PUT
      request, which modifies DNS resolution behavior for specific records.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
