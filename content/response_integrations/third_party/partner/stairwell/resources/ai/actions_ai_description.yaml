Enrich Hash:
  ai_description: "### General Description\nEnriches file hash entities with comprehensive\
    \ threat intelligence data from the Stairwell platform. This action retrieves\
    \ technical metadata, reputation scores, and behavioral indicators for file hashes\
    \ (MD5, SHA1, SHA256) to help analysts determine the nature and risk of a file\
    \ within their environment.\n\n### Parameters Description\n| Parameter Name |\
    \ Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| API Root\
    \ | String | Yes | The base URL of the Stairwell API instance. |\n| API Key |\
    \ String | Yes | The API key used for authentication with Stairwell. |\n| Organization\
    \ ID | String | No | The specific Stairwell Organization ID to query against.\
    \ |\n| User ID | String | No | The specific Stairwell User ID to associate with\
    \ the request. |\n\n### Flow Description\n1. **Initialization**: The action retrieves\
    \ configuration parameters (API Root, API Key, Org ID, User ID) and identifies\
    \ all `FILEHASH` entities in the current context.\n2. **Data Retrieval**: For\
    \ each file hash entity, the action queries the Stairwell API's enrichment endpoint\
    \ to fetch detailed file information.\n3. **Entity Enrichment**: \n    *   Updates\
    \ the entity's additional properties with Stairwell metadata (prefixed with 'SW').\n\
    \    *   Marks the entity as enriched.\n    *   Evaluates the file's suspiciousness\
    \ based on Stairwell's verdict and malicious probability scores.\n4. **Insight\
    \ & Visualization**: \n    *   If the file is determined to be suspicious, an\
    \ Entity Insight is created containing a summary of the findings.\n    *   A detailed\
    \ data table (CSV format) containing the full file report is added to the case\
    \ wall for each processed entity.\n5. **Finalization**: Updates the entities in\
    \ the Google SecOps platform and returns a summary message of successful and failed\
    \ enrichments."
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      The action updates entity attributes (additional properties), sets the 'is_enriched'
      and 'is_suspicious' flags, creates entity insights, and adds data tables to
      the case wall.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - FILEHASH
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich Hostname:
  ai_description: >-
    ### General Description

    The **Enrich Hostname** action retrieves comprehensive threat intelligence for
    Hostname entities from the **Stairwell** platform. It provides security analysts
    with critical context, including DNS records (A, AAAA, MX), community opinions,
    and automated verdicts to determine if a host is associated with malicious activity.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **API Root** | String | Yes | The base URL of the Stairwell API instance. |

    | **API Key** | String | Yes | The API key used for authentication with Stairwell.
    |

    | **Organization ID** | String | No | The specific Stairwell Organization ID to
    scope the request. |

    | **User ID** | String | No | The specific Stairwell User ID to associate with
    the request. |


    ### Flow Description

    1. **Initialization**: The action extracts configuration parameters and initializes
    the Stairwell API manager.

    2. **Entity Filtering**: It identifies all `HOSTNAME` entities within the current
    context.

    3. **Data Retrieval**: For each hostname, the action queries the Stairwell API
    to fetch enrichment data.

    4. **Entity Enrichment**:
        *   Updates the entity's additional properties with the retrieved data (prefixed
    with `SW`).
        *   Sets the entity as `enriched`.
        *   Evaluates the Stairwell verdict; if "MALICIOUS", the entity is marked
    as `suspicious`.
    5. **Insight & Reporting**:
        *   Generates an **Entity Insight** if the host is determined to be suspicious.
        *   Constructs and attaches a **Data Table** to the case wall containing a
    summary of the host report.
    6. **Finalization**: Updates the entities in the Google SecOps environment and
    returns a consolidated JSON result of all findings.


    ### Additional Notes

    *   The action respects the execution deadline and will gracefully timeout if
    the processing exceeds the allocated time.

    *   Enrichment data is mapped to the entity using the `SW` prefix to avoid collisions
    with other integrations.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - HOSTNAME
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich IP:
  ai_description: >-
    ### General Description

    Enriches IP Address entities with threat intelligence data from Stairwell. This
    action retrieves reputation data, including verdicts, opinions, and comments,
    to provide context for security investigations. It automatically identifies malicious
    entities based on Stairwell's analysis and updates the Google SecOps environment
    with detailed enrichment metadata.


    ### Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | API Root | String | Yes | The base URL of the Stairwell API instance. |

    | API Key | String | Yes | The API key used for authentication with Stairwell.
    |

    | Organization ID | String | No | The specific Stairwell Organization ID to scope
    the request. |

    | User ID | String | No | The specific Stairwell User ID to associate with the
    request. |


    ### Flow Description

    1. **Initialization**: The action retrieves configuration parameters (API Root,
    API Key, Org ID, User ID) and identifies all IP Address entities in the current
    context.

    2. **Data Retrieval**: For each IP entity, the action queries the Stairwell API's
    enrichment endpoint (`/labs/appapi/enrichment/v1/ip_event/{ip}`).

    3. **Entity Enrichment**: The retrieved data (verdicts, opinions, comments) is
    mapped to the entity's additional properties with the prefix 'SW'.

    4. **Risk Assessment**: The action evaluates the Stairwell verdict. If the verdict
    is 'MALICIOUS', the entity is marked as suspicious in Google SecOps.

    5. **Insight Generation**: For suspicious entities, a detailed HTML insight is
    created and added to the entity's profile.

    6. **Reporting**: A data table containing the enrichment summary is added to the
    case wall for each processed entity, and a raw JSON result is attached to the
    action output.

    7. **Final Update**: All successfully enriched entities are updated in the Google
    SecOps platform.


    ### Additional Notes

    - This action is read-only regarding the Stairwell platform; it does not modify
    any data in the external system.

    - The action includes a timeout check to ensure it completes within the allocated
    execution window.
  capabilities:
    can_create_case_comments: false
    can_create_insight: true
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates entity enrichment fields (additional_properties), sets the 'is_enriched'
      and 'is_suspicious' flags, and adds data tables and insights to the case.
  categories:
    enrichment: true
  entity_usage:
    entity_types:
    - ADDRESS
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: "### General Description\nThe **Ping** action is a diagnostic utility\
    \ used to verify the connectivity between Google SecOps and the Stairwell API.\
    \ Its primary purpose is to validate that the integration's configuration parameters\u2014\
    specifically the API Root and API Key\u2014are correct and that the environment\
    \ can successfully communicate with the Stairwell service.\n\n### Parameters Description\n\
    | Parameter Name | Type | Mandatory | Description |\n| :--- | :--- | :--- | :---\
    \ |\n| **API Root** | String | Yes | The base URL of the Stairwell API. |\n| **API\
    \ Key** | String | Yes | The API key used for authentication. |\n| **Organization\
    \ ID** | String | No | Optional identifier for the organization to be included\
    \ in request headers. |\n| **User ID** | String | No | Optional identifier for\
    \ the user to be included in request headers. |\n\n### Additional Notes\n- This\
    \ action does not process or require any entities from the Google SecOps environment.\n\
    - It performs a live API call using a hardcoded dummy hostname ('www.google.com')\
    \ to ensure the enrichment endpoint is reachable and responding.\n\n### Flow Description\n\
    1. **Parameter Extraction**: The action retrieves the API Root, API Key, Organization\
    \ ID, and User ID from the integration configuration.\n2. **Manager Initialization**:\
    \ It initializes the `StairwellManager` with the provided credentials and connection\
    \ settings.\n3. **Connectivity Test**: The action invokes the `test_connectivity`\
    \ method, which attempts to perform a GET request to the Stairwell enrichment\
    \ endpoint for a dummy hostname.\n4. **Execution Outcome**: \n    - If the request\
    \ is successful, the action returns a success state with the message 'Connection\
    \ Established'.\n    - If the request fails (e.g., due to invalid credentials\
    \ or network issues), the action catches the exception, logs the error, and returns\
    \ a failed execution state."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
