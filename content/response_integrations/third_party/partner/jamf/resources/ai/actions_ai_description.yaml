Assign to Group:
  ai_description: >-
    ### General Description

    The **Assign to Group** action allows security analysts to programmatically add
    computers to a specific computer group within Jamf Pro. This is typically used
    for containment or policy enforcement by moving compromised or suspicious devices
    into restricted groups. The action supports bulk operations using various identifiers
    such as computer IDs, names, or serial numbers.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Group ID** | String | Yes | The unique identifier of the Jamf computer group
    to be modified. |

    | **Computer IDs** | String | No | A comma-separated list of Jamf computer IDs
    (e.g., "123,456"). |

    | **Computer Names** | String | No | A comma-separated list of computer names.
    Note: Names may not be unique in Jamf; the API acts on the first matching record.
    |

    | **Computer Serial Numbers** | String | No | A comma-separated list of hardware
    serial numbers (e.g., "ABC123,DEF456"). |


    ### Additional Notes

    - **Requirement**: At least one of the following parameters must be provided:
    `Computer IDs`, `Computer Names`, or `Computer Serial Numbers`. If all are empty,
    the action will fail.

    - **Identification**: For reliable identification, it is recommended to use `Computer
    IDs` or `Computer Serial Numbers` over `Computer Names` due to potential duplicates
    in Jamf Pro.


    ### Flow Description

    1. **Initialization**: Authenticates with the Jamf Pro API using OAuth2 client
    credentials and establishes a session.

    2. **Validation**: Verifies that a `Group ID` is provided and that at least one
    list of computer identifiers is present.

    3. **Parsing**: Cleans and splits the comma-separated input strings into individual
    lists of IDs, names, and serial numbers.

    4. **API Execution**: Constructs an XML payload using the `<computer_additions>`
    schema and sends a `PUT` request to the Jamf Classic API endpoint (`/JSSResource/computergroups/id/{id}`).

    5. **Result Processing**: Parses the XML response to confirm the number of computers
    successfully processed and the name of the group, then returns the detailed result
    as a JSON object.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds computers to a computer group in Jamf Pro by sending a PUT request to the
      Classic API, which modifies the membership state of the specified group.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Computer Inventory:
  ai_description: >-
    Retrieves paginated Computer Inventory records from Jamf Pro with comprehensive
    filtering, sorting, and section options. This action allows users to query the
    Jamf Pro API for detailed information about managed computers, supporting specific
    filters like name, serial number, or email. It optimizes data retrieval by allowing
    the selection of specific data sections (e.g., Hardware, Security, Applications)
    and provides pagination to handle large datasets.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Page | String | No | The page number to retrieve. Defaults to 0. |

    | Page Size | String | No | The number of records to return per page. Defaults
    to 100 (Max 2000). |

    | Filter | DDL | Yes | The field used to filter the inventory (e.g., `general.name`,
    `udid`, `userAndLocation.email`). |

    | Filter Value | String | Yes | The specific value to search for in the selected
    filter field. |

    | Section | Multi-select | No | Specific data categories to include in the response
    (e.g., HARDWARE, SECURITY, APPLICATIONS). Defaults to ALL. |

    | Sort | Multi-select | No | The criteria and direction for sorting results (e.g.,
    `general.name:asc`). |


    ### Additional Notes

    - The action automatically ensures that the section required for the chosen filter
    field is included in the API request, even if not explicitly selected.

    - Page and Page Size must be valid integers.


    ### Flow Description

    1. **Authentication**: Connects to Jamf Pro using the configured Client API ID
    and Secret to obtain a bearer token.

    2. **Parameter Processing**: Validates pagination inputs and constructs the Jamf
    Pro API filter string (e.g., `field=="value"`) and sort criteria.

    3. **Section Optimization**: Determines which data sections are needed based on
    user input and the active filter field.

    4. **Data Retrieval**: Executes a GET request to the `/api/v1/computers-inventory`
    endpoint with the constructed query parameters.

    5. **Result Handling**: Parses the JSON response from Jamf Pro, calculates pagination
    metadata, and returns the inventory data to the SOAR platform.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Device Group Membership:
  ai_description: >-
    ### General Description\n\nThe **Get Device Group Membership** action retrieves
    detailed membership information for a specific computer group from Jamf Pro. This
    action is designed to help security analysts and IT administrators identify which
    devices are part of a particular group, supporting both static and smart computer
    groups. It provides a comprehensive list of member devices along with the total
    member count.\n\n### Parameters\n\n| Parameter | Type | Mandatory | Description
    |\n| :--- | :--- | :--- | :--- |\n| Group ID | String | Yes | The unique identifier
    of the computer group in Jamf Pro to retrieve membership for. |\n\n### Flow Description\n\n1.
    **Authentication**: The action authenticates with the Jamf Pro API using the provided
    Client ID and Secret to obtain a valid bearer token.\n2. **Data Retrieval**: It
    sends a GET request to the Jamf Pro Classic API endpoint (`/JSSResource/computergroups/id/{id}`)
    using the specified Group ID.\n3. **Processing**: The action parses the response
    to extract the list of member computers and calculates the total number of members
    in the group.\n4. **Output**: The membership data, including the group ID and
    member count, is returned as a JSON result for use in playbooks and investigations.\n\n###
    Additional Notes\n\n* This action is read-only and does not modify any data in
    Jamf Pro or Google SecOps.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Device Information:
  ai_description: >-
    ### General Description

    Retrieves comprehensive information for a specific computer from Jamf Pro using
    its unique ID. This action is designed to provide deep visibility into a managed
    device, fetching data points such as hardware specifications, operating system
    details, disk encryption status, and user/location information. It is primarily
    used for enrichment during incident response to verify the state and ownership
    of a device.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Computer ID | String | Yes | The unique identifier of the computer in Jamf Pro
    for which you want to retrieve detailed information. |


    ### Flow Description

    1. **Authentication**: The action authenticates with the Jamf Pro API using the
    provided Client ID and Secret to obtain a bearer token.

    2. **Data Retrieval**: It sends a GET request to the Jamf Pro API's computer inventory
    detail endpoint using the specified `Computer ID`.

    3. **Data Sanitization**: The retrieved JSON data is processed through a cleaning
    function that escapes special characters and fixes structural issues (like trailing
    commas) to ensure compatibility with Google SecOps UI widgets.

    4. **Result Output**: The sanitized device information is returned as a JSON object
    and the action completes with a success message if the device is found.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Mobile Device Inventory:
  ai_description: >-
    ### General Description

    The **Get Mobile Device Inventory** action retrieves detailed mobile device inventory
    data from Jamf Pro. It utilizes the Jamf Pro v2 API to fetch information about
    managed mobile devices based on specific filter criteria such as serial number,
    UDID, username, or email address. The action supports pagination, sorting, and
    the selection of specific data sections (e.g., Hardware, Security, Applications)
    to optimize the response.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Filter** | DDL | Yes | The field to filter by. Supported options: `serialNumber`,
    `udid`, `username`, and `emailAddress`. |

    | **Filter Value** | String | Yes | The specific value to search for in the selected
    filter field. |

    | **Page** | String | No | The page number to retrieve (starts at 0). Default
    is 0. |

    | **Page Size** | String | No | The number of records to return per page. Default
    is 100. |

    | **Section** | DDL | No | Specific data sections to include in the response (e.g.,
    `HARDWARE`, `SECURITY`, `APPLICATIONS`). Selecting `ALL` retrieves all available
    data. |

    | **Sort** | Multi-choice | No | Criteria for sorting the results (e.g., `displayName:asc`).
    Multiple fields can be selected. |


    ### Flow Description

    1. **Parameter Extraction:** The action retrieves and validates input parameters,
    ensuring `Page` and `Page Size` are valid integers.

    2. **Filter Construction:** It builds a Jamf Pro API-compatible filter string
    using the provided `Filter` and `Filter Value` (e.g., `username=="jdoe"`).

    3. **Section Optimization:** The action automatically determines if additional
    data sections are required based on the filter field (e.g., adding the `HARDWARE`
    section if filtering by serial number) to ensure the API returns the necessary
    data.

    4. **Authentication:** It connects to the Jamf Pro API using the configured credentials
    and retrieves an OAuth access token.

    5. **Data Retrieval:** The action sends a GET request to the `/api/v2/mobile-devices/detail`
    endpoint with the specified pagination, sorting, and filtering parameters.

    6. **Result Processing:** The retrieved inventory data is cleaned to ensure JSON
    validity and returned as a JSON result to the SOAR.


    ### Additional Notes

    - This action does not run on entities within the SOAR case; it is a standalone
    search action that retrieves data based on user-provided parameters.

    - The `Section` parameter allows for optimized data retrieval by only fetching
    the necessary categories of device information.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Computer Groups:
  ai_description: >-
    ### General Description

    This action retrieves a comprehensive list of all computer groups configured within
    a Jamf Pro instance. It fetches both static and smart computer groups, providing
    visibility into the organizational structure and device categorization managed
    in Jamf. The retrieved data is returned as a JSON object for use in downstream
    playbook logic.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | N/A | N/A | N/A | This action does not require any input parameters. |


    ### Additional Notes

    - This action does not operate on specific entities (e.g., IP addresses or Hostnames)
    but rather performs a global query against the Jamf Pro API.

    - The action relies on the integration's configuration (API Root, Client ID, and
    Secret) to authenticate and authorize the request.


    ### Flow Description

    1. **Authentication**: The action initializes the Jamf Manager and obtains a valid
    OAuth2 bearer token using the configured Client API ID and Secret.

    2. **API Request**: It executes a GET request to the Jamf Pro API endpoint `/api/v1/computer-groups`
    to fetch all defined computer groups.

    3. **Data Processing**: The action parses the API response, handling both direct
    list formats and unexpected response structures.

    4. **Result Delivery**: The list of computer groups is added to the action's JSON
    result. If no groups are found, an empty list is returned to ensure consistent
    output for playbooks.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a utility designed to verify the connectivity and authentication
    configuration between Google SecOps and the Jamf Pro and Jamf Protect platforms.
    It ensures that the provided API credentials (Client ID and Secret) are valid
    and that the SecOps environment can reach the specified API endpoints. This action
    is typically used during initial setup or for troubleshooting integration issues.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Jamf Pro API Root | String | Yes | The base URL of the Jamf Pro instance (e.g.,
    `https://yourserver.jamfcloud.com`). |

    | Jamf Pro Client API ID | String | Yes | The Client ID used for OAuth2 authentication
    with Jamf Pro. |

    | Jamf Pro Client API Secret | String | Yes | The Client Secret used for OAuth2
    authentication with Jamf Pro. |

    | Verify SSL | Boolean | No | If enabled, the action will verify the SSL certificate
    of the Jamf servers. Defaults to `True`. |

    | Jamf Protect API Root | String | No | The base URL of the Jamf Protect instance.
    |

    | Jamf Protect Client API ID | String | No | The Client ID used for authentication
    with Jamf Protect. |

    | Jamf Protect Client API Secret | String | No | The Client Secret used for authentication
    with Jamf Protect. |


    ### Additional Notes

    - Jamf Protect connectivity is only tested if all three Protect-related parameters
    (Root, Client ID, and Secret) are provided in the configuration.

    - This action does not process or require any entities to run.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves Jamf Pro configuration and optional
    Jamf Protect configuration from the integration settings.

    2. **Jamf Pro Authentication**: It attempts to obtain an OAuth2 access token from
    the Jamf Pro `/api/v1/oauth/token` endpoint using the provided Client ID and Secret.

    3. **Jamf Pro Connectivity Test**: It performs a GET request to the `/api/v1/jamf-pro-version`
    endpoint to confirm the API is responsive and retrieves the server version.

    4. **Jamf Protect Authentication (Optional)**: If Jamf Protect credentials are
    provided, it attempts to obtain an access token from the Jamf Protect token endpoint
    to verify connectivity to the Protect GraphQL API.

    5. **Result Reporting**: The action returns a success message if the configured
    connections are established, or fails with an error message detailing the specific
    connection or authentication issue encountered.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remote Lock Managed Device:
  ai_description: >-
    Remotely locks a managed computer using Jamf Pro MDM commands. This action is
    specifically designed for computer devices and initiates a 'DEVICE_LOCK' command
    through the Jamf Pro API. It requires a 6-digit PIN that will be needed to unlock
    the device and can optionally display a custom message and phone number on the
    lock screen.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | --- | --- | --- | --- |

    | Computer ID | String | Yes | The unique identifier of the computer in Jamf Pro
    to be locked. |

    | PIN | String | Yes | A 6-digit PIN code required to unlock the device once it
    is locked. |

    | Message | String | No | An optional custom message to display on the locked
    device screen. |

    | Phone Number | String | No | An optional phone number to display on the locked
    device screen for contact purposes. |


    ### Additional Notes

    - This action is intended for computers. For mobile devices (iOS/iPadOS), use
    the 'Remote Lock Mobile Device' action.

    - The PIN must be exactly 6 digits as per Jamf Pro requirements for computer locks.


    ### Flow Description

    1. **Authentication**: Connects to the Jamf Pro API using provided client credentials
    to obtain an OAuth access token.

    2. **Device Lookup**: Retrieves detailed device information for the specified
    Computer ID to obtain its 'managementId'.

    3. **Command Initiation**: Sends a POST request to the Jamf Pro MDM commands endpoint
    with the 'DEVICE_LOCK' command type, including the PIN and optional display information.

    4. **Result Processing**: Captures the API response and provides a summary of
    the command initiation status in the action results.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends a 'DEVICE_LOCK' MDM command to the Jamf Pro API, which changes the state
      of the physical managed device by locking its screen.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remote Lock Mobile Device:
  ai_description: >-
    ### General Description

    Remotely lock a managed mobile device using Jamf Pro MDM commands. This action
    sends a `device_lock` command to the specified device, which locks the screen
    and can optionally display a custom message and contact phone number. It is primarily
    used as a containment measure for lost, stolen, or compromised mobile devices.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Mobile Device ID | String | Yes | The unique identifier of the mobile device
    in Jamf Pro. |

    | Message | String | No | A custom message to be displayed on the device's lock
    screen. |

    | Phone Number | String | No | A contact phone number to be displayed on the device's
    lock screen. |


    ### Flow Description

    1. **Authentication**: The action authenticates with the Jamf Pro API using the
    provided Client ID and Secret to obtain a bearer token.

    2. **Management ID Retrieval**: It calls the Jamf Pro v2 Mobile Device Inventory
    API to retrieve the `managementId` associated with the provided `Mobile Device
    ID`. This ID is required for sending MDM commands.

    3. **Command Execution**: It constructs a `DEVICE_LOCK` MDM command payload, including
    the optional message and phone number if provided.

    4. **API Request**: The action sends a POST request to the Jamf Pro MDM commands
    endpoint (`/api/v2/mdm/commands`) to initiate the lock.

    5. **Result Processing**: The action captures the API response and reports whether
    the command was successfully initiated.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates a remote lock command on a mobile device via Jamf Pro MDM, which changes
      the physical device's state to a locked screen.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Extension Attribute:
  ai_description: >-
    ### General Description

    Updates a specific extension attribute for a computer in Jamf Pro using its ID.
    This action allows for the modification of custom device metadata, supporting
    both single and multiple values. It is primarily used for containment and management
    tasks where device state or metadata needs to be updated based on security findings.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Computer ID | string | Yes | The unique identifier of the computer in Jamf Pro
    to update. |

    | Extension Attribute Name | string | Yes | The name of the extension attribute
    to be updated (e.g., 'Department', 'Risk Level'). |

    | Values | string | Yes | A comma-separated list of values to set for the extension
    attribute (e.g., 'IT, Security' or 'High'). |


    ### Flow Description

    1. **Authentication**: The action authenticates with the Jamf Pro API using OAuth2
    client credentials.

    2. **Attribute Resolution**: It retrieves the full list of computer extension
    attributes from Jamf Pro to find the internal `definitionId` associated with the
    provided `Extension Attribute Name` (case-insensitive).

    3. **Value Parsing**: The `Values` parameter is parsed from a comma-separated
    string into a list of individual values.

    4. **API Update**: A PATCH request is sent to the Jamf Pro computer inventory
    detail endpoint with the resolved `definitionId` and the new values.

    5. **Output**: The action returns the updated computer's general information (name,
    serial number, platform) and the full API response as JSON.


    ### Additional Notes

    - The action will fail if the specified `Extension Attribute Name` does not exist
    in the Jamf Pro environment.

    - At least one value must be provided in the `Values` parameter.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the values of a specific extension attribute for a computer record in
      Jamf Pro via a PATCH request to the computer inventory detail endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Protect Prevent List:
  ai_description: >-
    Updates an existing prevent list in Jamf Protect to block specific indicators
    such as file hashes, Team IDs, Code Directory hashes, or Signing IDs. This action
    allows security teams to dynamically update blocklists by appending new indicators
    and tags to existing configurations.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Prevent List Name | string | Yes | The name of the existing prevent list in
    Jamf Protect that you want to update. |

    | Prevent List Description | string | No | An optional updated description for
    the prevent list. |

    | Prevent Type | ddl | Yes | The category of indicators being blocked. Options
    include: `File Hash`, `Signing Information - Team ID`, `Signing Information -
    Code Directory Hash`, and `Signing Information - Signing ID`. **Note:** This must
    match the type of the existing list. |

    | Prevent List Data | string | Yes | A comma-separated list of the actual indicators
    (e.g., SHA-256 hashes, Team IDs) to be added to the list. |

    | Prevent List Tags | string | No | A comma-separated list of tags to be associated
    with the prevent list. |


    ### Additional Notes

    - The action performs a merge: new data and tags are appended to the existing
    list, and duplicates are automatically removed.

    - The `Prevent Type` cannot be changed for an existing list; the action will fail
    if the provided type does not match the remote list's configuration.

    - Indicators are validated locally before submission (e.g., checking for valid
    SHA-1/SHA-256 formats for hashes).


    ### Flow Description

    1. **Initialization:** Retrieves API credentials and connection settings for Jamf
    Protect.

    2. **Discovery:** Fetches the current set of prevent lists from Jamf Protect to
    locate the target list by name.

    3. **Validation:** Verifies that the target list exists and that the provided
    `Prevent Type` matches the existing list's type. It also validates the format
    of the input data (e.g., hash length).

    4. **Merging:** Combines the existing indicators and tags with the new ones provided
    in the parameters, ensuring a unique set of values.

    5. **Mutation:** Executes a GraphQL mutation (`updatePreventList`) to update the
    remote list in Jamf Protect.

    6. **Reporting:** Returns a JSON summary of the updated list configuration.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates an existing prevent list in Jamf Protect by adding new indicators (hashes,
      IDs) and tags to the list via a GraphQL mutation.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Wipe Managed Device:
  ai_description: >-
    ### General Description

    Remotely erases or wipes a managed computer using the Jamf Pro `ERASE_DEVICE`
    MDM command. This action is specifically designed for macOS computers and allows
    for granular control over the wipe process, including obliteration behavior and
    'Return to Service' configurations. It is a containment action used to decommission
    devices or respond to security incidents.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Computer ID | String | Yes | The unique identifier of the computer in Jamf Pro
    to be erased. |

    | PIN | String | Yes | An optional 6-digit PIN for the erase command. While marked
    mandatory in the configuration, the code allows it to be empty if not needed by
    the hardware. |

    | Obliteration Behavior | DDL | Yes | Specifies how the device should be obliterated
    during the erase process. Options include: Default, DoNotObliterate, ObliterateWithWarning,
    Always. |

    | Return to Service | Boolean | Yes | Whether to enable the 'Return to Service'
    feature, which allows the device to automatically re-enroll after the wipe. |

    | MDM Profile Data | String | No | Base64-encoded MDM profile data required if
    'Return to Service' is enabled. |

    | WiFi Profile Data | String | No | Base64-encoded WiFi profile data required
    if 'Return to Service' is enabled. |


    ### Additional Notes

    - If **Return to Service** is set to `true`, the action requires at least one
    of **MDM Profile Data** or **WiFi Profile Data** to be provided; otherwise, the
    action will fail with a parameter error.

    - This action is intended for computers; for mobile devices, use the dedicated
    'Wipe Mobile Device' action.


    ### Flow Description

    1. **Authentication**: Connects to the Jamf Pro API using provided credentials
    to obtain an OAuth access token.

    2. **Device Identification**: Retrieves the specific `managementId` for the computer
    using the provided **Computer ID**.

    3. **Command Construction**: Builds the `ERASE_DEVICE` MDM command payload, incorporating
    the PIN, obliteration behavior, and Return to Service settings (including profile
    data if provided).

    4. **Execution**: Sends the MDM command to the Jamf Pro `/api/v2/mdm/commands`
    endpoint.

    5. **Reporting**: Returns the initiation status of the command and logs the details
    to the action results.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates an ERASE_DEVICE MDM command in Jamf Pro, which results in the remote
      wiping/erasure of the target managed computer's storage and operating system.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Wipe Mobile Device:
  ai_description: >-
    Remotely erase/wipe a managed mobile device using the Jamf Pro ERASE_DEVICE MDM
    command. This action is designed for containment and security purposes, allowing
    administrators to factory reset a device that has been lost, stolen, or is being
    decommissioned. It supports advanced options such as preserving eSIM data plans
    and configuring 'Return to Service' settings to automate re-enrollment after the
    wipe.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Mobile Device ID | string | Yes | The unique identifier of the mobile device
    in Jamf Pro to be erased. |

    | Preserve Data Plan | boolean | No | If enabled, preserves the eSIM data plan
    on devices running iOS 11 or later. |

    | Disallow Proximity Setup | boolean | No | If enabled, disables Proximity Setup
    on the next reboot and skips the pane in Setup Assistant (iOS 11+). |

    | Return to Service | boolean | Yes | If enabled, the device will attempt to automatically
    re-enroll using the provided profile data after the wipe. |

    | MDM Profile Data | string | No | Base64-encoded MDM profile data required if
    'Return to Service' is enabled. |

    | WiFi Profile Data | string | No | Base64-encoded WiFi profile data required
    if 'Return to Service' is enabled. |

    | Bootstrap Token | string | No | Base64-encoded bootstrap token for the device,
    used if 'Return to Service' is enabled. |


    ### Additional Notes

    - The action requires the `managementId` of the device, which it retrieves automatically
    using the provided `Mobile Device ID` before sending the wipe command.

    - 'Return to Service' functionality requires valid MDM and/or WiFi profile data
    to be effective.


    ### Flow Description

    1. **Initialization**: Retrieves Jamf Pro API configuration and action parameters.

    2. **Device Lookup**: Calls the Jamf Pro API to retrieve detailed information
    for the specified `Mobile Device ID` to obtain its `managementId`.

    3. **Command Construction**: Builds the `ERASE_DEVICE` MDM command payload, incorporating
    optional flags for data plan preservation, proximity setup, and Return to Service
    configurations.

    4. **Execution**: Sends a POST request to the Jamf Pro MDM commands endpoint to
    initiate the remote wipe.

    5. **Result Handling**: Captures the API response and provides a summary of the
    command status and parameters used.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends an ERASE_DEVICE MDM command to Jamf Pro, which triggers a remote factory
      reset/wipe of the target mobile device.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
