Assign to Group:
  ai_description: >-
    ### General Description

    This action adds specific computers to a designated computer group within Jamf
    Pro. It facilitates bulk management of computer group memberships by allowing
    users to identify target computers through various identifiers like system IDs,
    names, or serial numbers.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Group ID** | string | Yes | The unique ID of the Jamf computer group to modify.
    |

    | **Computer IDs** | string | No | A comma-separated list of Jamf internal computer
    IDs (e.g., "12, 14"). |

    | **Computer Names** | string | No | A comma-separated list of computer names
    (e.g., "Marketing-Mac-01"). Note: Names may not be unique in Jamf; the API will
    act on the first match. |

    | **Computer Serial Numbers** | string | No | A comma-separated list of hardware
    serial numbers (e.g., "C02ABC123"). |


    ### Flow Description

    1.  **Authentication**: The action authenticates with the Jamf Pro API using Client
    Credentials to obtain a Bearer token.

    2.  **Input Parsing**: It extracts the Group ID and computer identifiers (IDs,
    Names, or Serials) from the action parameters, splitting comma-separated strings
    into lists.

    3.  **Validation**: It verifies that at least one of the computer identifier parameters
    has been populated. If all are empty, the action fails.

    4.  **Payload Construction**: It constructs a Classic API XML payload containing
    the `<computer_additions>` block with the provided identifiers.

    5.  **Execution**: It sends a PUT request to the Jamf Pro Classic API endpoint
    (`/JSSResource/computergroups/id/{id}`) to update the group membership.

    6.  **Reporting**: It returns a JSON summary of the operation, including the number
    of computers processed and the group name if retrieved.


    ### Additional Notes

    *   At least one set of computer identifiers (IDs, Names, or Serial Numbers) must
    be configured for the action to run successfully.

    *   This action uses the Jamf Classic API for group membership updates.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Modifies computer group memberships in Jamf Pro by adding specified computers
      to a group.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Computer Inventory:
  ai_description: >-
    ### General Description

    This action retrieves paginated Computer Inventory records from Jamf Pro. It allows
    users to search for specific computers using filters, sort the results, and select
    specific data sections (like Hardware, Software, or Security) to include in the
    output. This is useful for asset management and identifying the configuration
    or status of devices managed by Jamf.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Page** | String | No | The page number to retrieve. Defaults to 0. |

    | **Page Size** | String | No | The number of computer records to return per page.
    Defaults to 100. |

    | **Filter** | DDL | Yes | The criteria field used to filter the inventory (e.g.,
    `general.name`, `hardware.serialNumber`, `udid`). |

    | **Filter Value** | String | Yes | The specific value to look for within the
    selected filter field. |

    | **Section** | Multi-choice | No | Determines which data categories to retrieve
    for each computer. Selecting specific sections (e.g., `HARDWARE`, `SECURITY`)
    optimizes performance. Defaults to `ALL`. |

    | **Sort** | Multi-choice | No | Defines the field and direction (asc/desc) to
    sort the returned list. |


    ### Additional Notes

    - If a **Filter** is provided, the action automatically ensures the corresponding
    data **Section** required for that filter is included in the API request, even
    if not explicitly selected by the user.

    - The action performs data cleaning on the retrieved JSON to ensure compatibility
    with Google SecOps dashboards and widgets, handling potentially malformed characters
    or certificate data.


    ### Flow Description

    1. **Initialization**: The action connects to Jamf Pro using the provided API
    credentials and verifies connectivity.

    2. **Parameter Parsing**: It validates the `Page` and `Page Size` inputs to ensure
    they are positive integers and processes the `Sort` and `Section` selections.

    3. **Filter Construction**: It builds a Jamf Pro API compatible filter string
    (e.g., `field=="value"`) using the provided **Filter** and **Filter Value**.

    4. **Data Retrieval**: It calls the Jamf Pro API (`/api/v1/computers-inventory`)
    with the calculated pagination, sorting, and section parameters.

    5. **Processing and Cleaning**: The received inventory data is cleaned (to fix
    unescaped characters or structural issues) to ensure valid JSON output.

    6. **Final Output**: The results are returned as a JSON object, and a summary
    message is posted to the case detailing how many records were found and whether
    more pages are available.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Device Group Membership:
  ai_description: >-
    ### General Description

    This action retrieves detailed membership information for a specific Computer
    Group (either static or smart) from Jamf Pro. It provides a list of all devices
    belonging to the group along with basic device metadata, which is useful for audit,
    compliance, and scope verification tasks.


    ### Parameters Description


    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **Group ID** | The unique identifier (ID) of the computer group in Jamf Pro
    for which you want to retrieve membership. | string | Yes |


    ### Flow Description

    1.  **Authentication:** The action initializes the Jamf Manager and retrieves
    an OAuth access token using the provided API credentials.

    2.  **API Call:** It makes a GET request to the Jamf Classic API endpoint `/JSSResource/computergroups/id/{id}`
    using the specified Group ID.

    3.  **Data Extraction:** The action parses the XML/JSON response to extract the
    list of computers and the total member count.

    4.  **Results:** It outputs a JSON result containing the membership list and logs
    the successful retrieval to the action output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Device Information:
  ai_description: >-
    ### General Description

    The **Get Device Information** action retrieves comprehensive details for a specific
    computer managed within Jamf Pro. This includes general metadata, disk encryption
    status, hardware specifications, operating system details, user/location information,
    and installed applications. It is designed to provide high-fidelity context for
    incident response and asset management.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Computer ID | The unique numeric or string identifier of the computer in Jamf
    Pro for which details are requested. | String | Yes |


    ### Additional Notes

    This action is execution-based and does not automatically iterate over entities.
    The Computer ID must be provided as a direct input parameter. The action includes
    a specific cleaning logic to ensure that complex data returned by Jamf (like certificate
    strings or extension attributes) is correctly escaped for use in JSON widgets.


    ### Flow Description

    1. **Authentication**: Connects to the Jamf Pro API Root and retrieves an OAuth2
    access token using the Client API ID and Secret.

    2. **Data Retrieval**: Performs a GET request to the Computer Inventory Detail
    endpoint using the provided Computer ID.

    3. **Data Cleaning**: Recursively sanitizes the response data to handle unescaped
    quotes, control characters, and certificate formatting that might otherwise break
    JSON parsing.

    4. **Result Output**: Adds the cleaned device information to the action results
    and provides a success message with the device context.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Mobile Device Inventory:
  ai_description: "### General Description\nThis action retrieves mobile device inventory\
    \ data from Jamf Pro using the v2 API. It is designed to fetch detailed device\
    \ records with support for pagination, custom sorting, and specific data section\
    \ filtering (e.g., HARDWARE, SECURITY, APPLICATIONS) to optimize performance and\
    \ data relevance. The action allows for precise searches using filters like serial\
    \ number, UDID, username, or email address.\n\n### Parameters Description\n\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | **Filter** | DDL | Yes | The criteria field to filter the inventory by. Options\
    \ include `serialNumber`, `udid`, `username`, and `emailAddress`. |\n| **Filter\
    \ Value** | String | Yes | The specific value to search for associated with the\
    \ selected Filter field. |\n| **Page** | String | No | The page number to retrieve\
    \ for paginated results. Defaults to 0. |\n| **Page Size** | String | No | The\
    \ number of records to return per page. Defaults to 100. |\n| **Section** | DDL\
    \ | No | Specific data sections to include in the response (e.g., HARDWARE, NETWORK).\
    \ Selecting specific sections optimizes data retrieval. Defaults to 'ALL'. |\n\
    | **Sort** | Multi-choice | No | Criteria for sorting the results, including field\
    \ name and direction (e.g., `displayName:asc`). |\n\n### Additional Notes\n- **Automatic\
    \ Section Selection**: The action logic automatically ensures that the required\
    \ data section is requested based on the 'Filter' parameter selected (e.g., if\
    \ filtering by 'udid', the 'HARDWARE' section is automatically added if not already\
    \ requested) to ensure the API can process the filter correctly.\n- **Pagination**:\
    \ Useful for environments with a large number of mobile devices to prevent timeout\
    \ or memory issues.\n\n### Flow Description\n1. **Initialization**: Retrieves\
    \ Jamf Pro API configuration (Root URL, Client ID, and Secret) and validates the\
    \ SSL settings.\n2. **Parameter Processing**: Parses input parameters and validates\
    \ that 'Page' and 'Page Size' are valid integers. \n3. **Dynamic Logic**: Evaluates\
    \ the 'Filter' field and 'Section' selection. If a specific filter is used, it\
    \ automatically includes the corresponding Jamf data section required to resolve\
    \ that filter.\n4. **Authentication**: Establishes a session with Jamf Pro and\
    \ retrieves a Bearer token.\n5. **API Request**: Executes a GET request to the\
    \ Jamf Pro v2 mobile device detail endpoint with the constructed query parameters\
    \ (page, sort, filter, and sections).\n6. **Data Handling**: Cleans the resulting\
    \ JSON data (fixing common unescaped character issues) and attaches the full inventory\
    \ results to the action output."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Computer Groups:
  ai_description: >-
    ### General Description

    The **List Computer Groups** action retrieves a comprehensive list of all computer
    groups configured within a Jamf Pro instance. This includes both static groups
    (manually managed) and smart groups (dynamically updated based on criteria). The
    action is primarily used for administrative visibility and to provide context
    for further automation steps involving group-based management or reporting.


    ### Parameters Description

    This action does not require any specific input parameters. It relies solely on
    the integration's configuration (API Root, Client ID, and Client Secret) to authenticate
    and communicate with the Jamf Pro environment.


    ### Additional Notes

    - This action does not process or depend on any entities (e.g., specific Hostnames
    or IP Addresses) within a case.

    - The output is provided as a JSON result containing a list of computer group
    objects, which typically include properties like the group ID and name.


    ### Flow Description

    1. **Initialization**: The action initializes the Jamf API manager using the provided
    integration configuration (API URL and credentials).

    2. **Authentication**: It checks for a valid OAuth access token and performs a
    login request to the Jamf Pro `/api/v1/oauth/token` endpoint if a new token is
    required.

    3. **Data Retrieval**: It makes a GET request to the `/api/v1/computer-groups`
    endpoint to fetch all defined computer groups.

    4. **Data Processing**: The API response is parsed and formatted into a structured
    JSON object.

    5. **Completion**: The action returns the JSON results to the Google SecOps platform
    and provides a summary message indicating the number of groups found.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    Verifies connectivity and authentication with both Jamf Pro and Jamf Protect APIs.
    This action serves as a health check for the integration configuration, ensuring
    the provided credentials and endpoints are valid and accessible.


    ### Parameters

    | Parameter | Mandatory | Type | Description |

    | :--- | :--- | :--- | :--- |

    | Jamf Pro API Root | Yes | String | The base URL for the Jamf Pro server (e.g.,
    https://yourserver.jamfcloud.com). |

    | Jamf Pro Client API ID | Yes | String | The API Client ID used for Jamf Pro
    authentication. |

    | Jamf Pro Client API Secret | Yes | String | The API Client Secret used for Jamf
    Pro authentication. |

    | Verify SSL | No | Boolean | Determines if SSL certificate validation is performed.
    Defaults to True. |

    | Jamf Protect API Root | No | String | The base URL for the Jamf Protect server.
    Required only if testing Jamf Protect connectivity. |

    | Jamf Protect Client API ID | No | String | The API Client ID for Jamf Protect.
    Required only if testing Jamf Protect connectivity. |

    | Jamf Protect Client API Secret | No | String | The API Client Secret for Jamf
    Protect. Required only if testing Jamf Protect connectivity. |


    ### Additional Notes

    - Jamf Pro credentials must always be provided for the action to succeed.

    - Jamf Protect connectivity is tested only if all three Protect-related parameters
    (Root, ID, and Secret) are supplied.


    ### Flow Description

    1. **Initialization**: The action extracts configuration parameters for Jamf Pro
    and optionally Jamf Protect.

    2. **Jamf Pro Connectivity Test**: It initializes the `JamfManager` and attempts
    to retrieve an OAuth token and the Jamf Pro version from the server.

    3. **Jamf Protect Connectivity Test (Optional)**: If Jamf Protect parameters are
    provided, it initializes `JamfProtectManager` and attempts to retrieve an access
    token via the GraphQL authentication endpoint.

    4. **Outcome**: If connections are successful, it returns a completion status
    with a success message; otherwise, it reports a failure with specific error details.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remote Lock Managed Device:
  ai_description: "### General Description\nRemotely locks a managed computer using\
    \ Jamf Pro MDM (Mobile Device Management) commands. This action is specifically\
    \ designed for computers (macOS) and allows an administrator to secure a device\
    \ by locking its screen. To regain access, a user must enter a 6-digit PIN code\
    \ provided during the action execution. Optionally, the administrator can display\
    \ a custom message and a contact phone number on the locked screen.\n\n### Parameters\
    \ Description\n\n| Parameter | Type | Mandatory | Description |\n| :--- | :---\
    \ | :--- | :--- |\n| Computer ID | String | Yes | The unique ID of the managed\
    \ computer in Jamf Pro. |\n| PIN | String | Yes | A 6-digit numeric PIN code required\
    \ to unlock the device screen. |\n| Message | String | No | A custom message to\
    \ display to the user on the locked device screen. |\n| Phone Number | String\
    \ | No | A contact phone number to display on the locked device screen. |\n\n\
    ### Additional Notes\n* **PIN Requirement:** While the configuration metadata\
    \ may suggest the PIN is optional, the underlying Python logic and the Jamf Pro\
    \ MDM specification require a valid 6-digit numeric PIN to execute the lock command.\
    \ \n* **Target Audience:** This action is intended for managed computers. For\
    \ mobile devices (iOS/iPadOS), use the dedicated 'Remote Lock Mobile Device' action.\n\
    \n### Flow Description\n1. **Initialization:** Retrieves Jamf Pro API credentials\
    \ and validates the input parameters, ensuring the Computer ID and PIN are provided.\n\
    2. **Authentication:** Establishes a session with the Jamf Pro API using OAuth2\
    \ client credentials.\n3. **ID Resolution:** Fetches detailed device inventory\
    \ for the provided `Computer ID` to retrieve the `managementId`, which is a requirement\
    \ for sending MDM commands in Jamf Pro API v2.\n4. **Command Execution:** Dispatches\
    \ a `DEVICE_LOCK` MDM command to the Jamf Pro API targeting the resolved `managementId`.\
    \ The command includes the PIN and any optional display text (Message/Phone Number).\n\
    5. **Completion:** Returns a JSON result containing the command status and execution\
    \ details, confirming the lock request was successfully initiated."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Issues a 'DEVICE_LOCK' MDM command via the Jamf Pro API, which changes the physical
      state of the managed computer by locking its screen and requiring a PIN for
      access.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remote Lock Mobile Device:
  ai_description: >-
    ### General Description

    Remotely lock a managed mobile device using Jamf Pro MDM commands. This action
    allows an administrator to trigger the device's native lock screen functionality,
    effectively preventing unauthorized access. It can also display a custom message
    and a callback phone number on the locked screen for recovery or instruction purposes.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Mobile Device ID | String | Yes | The unique identifier of the mobile device
    within the Jamf Pro inventory. |

    | Message | String | No | A custom text message to be displayed on the device's
    screen once it is locked. |

    | Phone Number | String | No | A contact phone number to be displayed on the locked
    device screen. |


    ### Additional Notes

    This action requires the Jamf Pro MDM profile to be active on the target mobile
    device and the API user to have permissions to send MDM commands.


    ### Flow Description

    1. **Initialization**: The action extracts the Jamf Pro API configuration (root
    URL, credentials, and SSL settings) and the action parameters (Device ID, Message,
    Phone Number).

    2. **Device Discovery**: It communicates with the Jamf Pro API to retrieve the
    `managementId` for the specified Mobile Device ID, which is a prerequisite for
    sending MDM commands.

    3. **MDM Command Dispatch**: It sends a POST request to the Jamf MDM commands
    endpoint (`/api/v2/mdm/commands`) with the `device_lock` command type, the retrieved
    management ID, and the optional message/phone data.

    4. **Completion**: The action captures the API response, logs the initiation of
    the lock command, and returns the result as a JSON object to the SOAR case.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends a 'device_lock' MDM command to the specified mobile device through Jamf
      Pro, which changes the physical state of the device to 'Locked'.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Extension Attribute:
  ai_description: >-
    ### General Description

    The **Update Extension Attribute** action allows users to update a specific extension
    attribute for a computer managed in Jamf Pro. Unlike standard inventory updates,
    this action specifically targets extension attributes, which are custom fields
    used to store metadata such as department, asset tags, or location. It resolves
    attribute names to their internal IDs automatically and supports updating an attribute
    with multiple values if they are provided as a comma-separated list.


    ### Parameters Description


    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Computer ID | The unique identifier (ID) of the computer in Jamf Pro that needs
    its attribute updated. | string | Yes |

    | Extension Attribute Name | The display name of the extension attribute to update
    (e.g., 'Department'). The action will look up the corresponding internal ID. |
    string | Yes |

    | Values | A comma-separated list of values to assign to the extension attribute.
    For single values, just provide the text; for multiple values, use a comma (e.g.,
    'Value1, Value2'). | string | Yes |


    ### Flow Description

    1. **Authentication:** The action authenticates with the Jamf Pro API using the
    configured Client ID and Client Secret to obtain a bearer token.

    2. **Attribute Resolution:** It fetches the full list of available computer extension
    attributes from Jamf Pro to match the provided 'Extension Attribute Name' to its
    internal 'definitionId'.

    3. **Value Parsing:** It splits the 'Values' input parameter by commas, trims
    whitespace, and prepares a list of values for the update.

    4. **API Request:** It constructs a PATCH request targeting the computer's inventory
    detail endpoint (`/api/v1/computers-inventory-detail/{id}`). The payload includes
    the attribute's `definitionId` and the list of new values.

    5. **Completion:** Upon a successful response (HTTP 200), the action extracts
    computer details (Name, Serial Number, Platform) and returns a success message
    along with the full raw JSON result from Jamf Pro.


    ### Additional Notes

    - If the provided 'Extension Attribute Name' does not exist in the Jamf environment,
    the action will fail and list the available attributes in the output message.

    - This action uses the Jamf Pro v1 API for the update and the Classic API for
    attribute listing.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the value of a specific computer extension attribute in Jamf Pro via
      a PATCH request to the computer inventory detail endpoint.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Protect Prevent List:
  ai_description: >-
    ### General Description

    This action updates an existing 'Prevent List' in Jamf Protect by adding new security
    indicators such as File Hashes, Team IDs, Code Directory Hashes, or Signing IDs.
    It is designed for containment purposes, allowing security teams to dynamically
    expand blocklists based on incoming threat intelligence. The action ensures that
    new data and tags are merged with existing ones without duplication.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Prevent List Name | string | Yes | The name of the existing prevent list in
    Jamf Protect to be updated. |

    | Prevent List Description | string | No | An optional updated description for
    the prevent list. If left blank, the existing description is preserved. |

    | Prevent Type | ddl | Yes | The category of indicators being added. Options include:
    `File Hash`, `Signing Information - Team ID`, `Signing Information - Code Directory
    Hash`, and `Signing Information - Signing ID`. **Note:** This must match the type
    of the existing list; the action will fail if you attempt to change the type of
    a list. |

    | Prevent List Data | string | Yes | A comma-separated list of indicators (e.g.,
    SHA-256 hashes or Team IDs) to add to the list. |

    | Prevent List Tags | string | No | A comma-separated list of tags to append to
    the existing tags of the prevent list. |


    ### Additional Notes

    - This action performs a 'merge' operation. It retrieves current list values and
    tags, combines them with the new input, and removes any duplicates before updating
    the external system.

    - Indicator validation is performed locally before the API call; for example,
    `File Hash` entries must be valid SHA-1 or SHA-256 strings.


    ### Flow Description

    1. **Initialization**: Retrieves Jamf Protect API credentials and action parameters.

    2. **Discovery**: Fetches all available prevent lists from Jamf Protect to locate
    the list matching the provided `Prevent List Name`.

    3. **Validation**: Confirms the list exists and verifies that the `Prevent Type`
    provided in the parameters matches the actual type of the existing list in Jamf
    Protect.

    4. **Data Preparation**: Parses the comma-separated input for data and tags. Validates
    the format of the data (e.g., regex checks for hashes). Merges these new values
    with the existing ones retrieved from Jamf.

    5. **Execution**: Performs a GraphQL mutation (`updatePreventList`) to Jamf Protect
    with the updated data set.

    6. **Finalization**: Returns the updated prevent list object as a JSON result
    and provides a summary message of the changes.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates an existing prevent list (blocklist) in Jamf Protect by adding new indicators
      and tags via a GraphQL mutation.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Wipe Managed Device:
  ai_description: >-
    ### General Description

    Remotely erases or wipes a managed computer using the Jamf Pro `ERASE_DEVICE`
    MDM command. This action is designed specifically for computers managed within
    a Jamf Pro environment. It allows security teams to perform a full factory reset
    of a compromised or lost device to prevent data leakage. Note that for mobile
    devices (iOS/iPadOS), the "Wipe Mobile Device" action should be used instead.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Computer ID | String | Yes | The unique identifier of the computer in Jamf Pro
    to be erased. |

    | PIN | String | Yes | A 6-digit PIN required for the erase command. Although
    marked mandatory in metadata, if not needed by the device configuration, it may
    be left empty in some contexts, though the code validates it must be 6 digits
    if provided. |

    | Obliteration Behavior | DDL | Yes | Defines the obliteration level during the
    erase process. Options include: `Default`, `DoNotObliterate`, `ObliterateWithWarning`,
    and `Always`. |

    | Return to Service | Boolean | Yes | If enabled, the device will attempt to re-enroll
    and return to service automatically after the wipe is complete. |

    | MDM Profile Data | String | No | Base64-encoded MDM profile data. This is required
    if 'Return to Service' is enabled. |

    | WiFi Profile Data | String | No | Base64-encoded WiFi profile data. This is
    required if 'Return to Service' is enabled to provide network connectivity for
    re-enrollment. |


    ### Additional Notes

    - **Return to Service Requirements**: If "Return to Service" is set to `true`,
    the action requires at least one of the profile data parameters (MDM or WiFi)
    to be provided; otherwise, the action will fail with a parameter error.

    - **PIN Validation**: The action strictly validates that the PIN, if provided,
    consists of exactly 6 numeric digits.


    ### Flow Description

    1.  **Authentication**: Connects to the Jamf Pro API using Client ID and Secret
    to obtain a bearer token.

    2.  **Parameter Validation**: Validates input parameters, ensuring the Computer
    ID exists and the PIN format is correct.

    3.  **Management ID Resolution**: Performs a GET request to retrieve the specific
    computer's inventory details to obtain its `managementId`, which is required for
    MDM command execution.

    4.  **Command Submission**: Sends a POST request to the Jamf Pro MDM commands
    endpoint (`/api/v2/mdm/commands`) with the `ERASE_DEVICE` command type and specified
    configuration (PIN, obliteration behavior, and return to service profiles).

    5.  **Completion**: Reports the successful initiation of the wipe command and
    provides the execution details in the action output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends a remote wipe command (ERASE_DEVICE) to a managed computer via Jamf Pro,
      which results in the full erasure of the target device's data.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Wipe Mobile Device:
  ai_description: >-
    ### General Description

    Remotely initiates an `ERASE_DEVICE` MDM command via Jamf Pro to wipe a managed
    mobile device. This action is primarily used for containment during security incidents
    involving lost, stolen, or compromised mobile assets. It allows for detailed control
    over the wipe process, including options to preserve cellular data plans and automate
    the re-enrollment process through 'Return to Service' functionality.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Mobile Device ID | string | Yes | The unique identifier of the mobile device
    within Jamf Pro to be erased. |

    | Preserve Data Plan | boolean | No | If enabled, preserves the eSIM data plan
    on devices running iOS 11 or later. |

    | Disallow Proximity Setup | boolean | No | If enabled, disables Proximity Setup
    on the next reboot and skips the pane in Setup Assistant (iOS 11+). |

    | Return to Service | boolean | Yes | Whether to automatically re-enroll the device
    after the erase is complete (requires MDM profile data). |

    | MDM Profile Data | string | No | Base64-encoded MDM profile data required for
    the 'Return to Service' feature. |

    | WiFi Profile Data | string | No | Base64-encoded WiFi profile data to allow
    the device to connect to a network for 'Return to Service'. |

    | Bootstrap Token | string | No | Base64-encoded bootstrap token for the device,
    used if 'Return to Service' is enabled. |


    ### Additional Notes

    If 'Return to Service' is enabled, the action typically requires at least one
    of the profile parameters (MDM or WiFi) to be provided for the device to successfully
    re-establish management after the wipe. Prior to iOS 14, the 'Disallow Proximity
    Setup' option should not be used in conjunction with other setup options.


    ### Flow Description

    1.  **Authentication**: Authenticates with the Jamf Pro API using Client ID and
    Secret to obtain an OAuth token.

    2.  **Device Identification**: Retrieves the management ID for the specified `Mobile
    Device ID` to ensure the target is managed and reachable via MDM.

    3.  **Command Construction**: Builds a JSON payload containing the `ERASE_DEVICE`
    command and specified configuration options (Data Plan, Return to Service, etc.).

    4.  **Execution**: Sends a POST request to the Jamf Pro MDM commands endpoint
    (`/api/v2/mdm/commands`) to trigger the wipe.

    5.  **Reporting**: Logs the initiation timestamp and command details to the action
    results for tracking.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Sends an MDM command (ERASE_DEVICE) to Jamf Pro, which triggers a factory reset/wipe
      of the physical mobile device associated with the provided ID.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
