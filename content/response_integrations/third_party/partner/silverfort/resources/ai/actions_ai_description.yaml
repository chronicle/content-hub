change_policy_state:
  ai_description: >-
    ### General Description Enables or disables a specific authentication policy within
    the Silverfort platform. This action provides a quick mechanism to toggle the
    active state of a policy without altering its underlying configuration, allowing
    security teams to dynamically manage security controls during incident response.
    ### Parameters Description | Parameter Name | Type | Mandatory | Description |
    | :--- | :--- | :--- | :--- | | Policy ID | String | Yes | The unique identifier
    of the Silverfort policy to be updated. | | Enable Policy | Boolean | Yes | Specifies
    the target state: true to enable the policy, false to disable it. | ### Flow Description
    1. **Parameter Extraction**: The action retrieves the mandatory Policy ID and
    the target Enable Policy boolean state from the user input. 2. **API Client Setup**:
    Initializes the Silverfort Policy API client using the integration configuration.
    3. **State Modification**: Sends a POST request to the Silverfort changePolicyState
    endpoint to update the policy's status. 4. **Result Processing**: Captures the
    success or failure of the operation and updates the action's result JSON and output
    message. ### Additional Notes This action is a direct management operation and
    does not process or rely on entities within the SOAR case environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Modifies the 'enabled' state of an authentication policy in the Silverfort platform
      via a POST request to the management API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
get_entity_risk:
  ai_description: >-
    ### General Description

    The **Get Entity Risk** action retrieves real-time risk intelligence for a specific
    user or resource from the Silverfort platform. It allows security analysts to
    fetch critical risk metrics, including numerical risk scores, severity classifications
    (Low, Medium, High, Critical), and specific risk factors contributing to the score.
    This data helps in making informed decisions during incident response, such as
    determining if an identity should be subjected to stricter authentication policies.


    ### Parameters Description


    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | User Principal Name | string | No* | The unique identity of the user (e.g.,
    `user@domain.com`). |

    | Resource Name | string | No* | The name of the non-user resource/asset to investigate.
    |


    ### Additional Notes

    *   **Conditional Mandatary:** While both parameters are marked as optional in
    the configuration, the action logic requires that **either** the `User Principal
    Name` or the `Resource Name` must be provided. If both are empty, the action will
    fail with a validation error.

    *   This action is read-only and does not modify any risk levels or settings within
    Silverfort.


    ### Flow Description

    1.  **Parameter Extraction:** The action retrieves the `User Principal Name` and
    `Resource Name` from the input settings.

    2.  **Validation:** It verifies that at least one identifier has been provided;
    otherwise, it raises a `SilverfortInvalidParameterError`.

    3.  **API Client Initialization:** The script initializes the `RiskApiClient`
    using the integration's API root and credentials (JWT-based authentication).

    4.  **Data Retrieval:** A GET request is sent to the Silverfort `/v1/public/getEntityRisk`
    endpoint with the provided entity identifiers.

    5.  **Output Generation:** The retrieved risk details (score, severity, risk factors)
    are parsed into a structured JSON object and returned as the action result.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
get_policy:
  ai_description: >-
    ### General Description

    The **Get Policy** action retrieves comprehensive information about a specific
    authentication policy from Silverfort. This includes configuration details such
    as associated users, groups, network sources, destinations, and action settings
    (e.g., allow, block, or MFA). This action is useful for auditing existing policies
    or verifying configurations as part of an investigation.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Policy ID | String | Yes | The unique identifier of the Silverfort policy to
    be retrieved. |


    ### Flow Description

    1. **Parameter Extraction**: The action extracts the `Policy ID` provided by the
    user from the input parameters.

    2. **Client Initialization**: It initializes a connection to the Silverfort Policies
    API using the configured integration credentials.

    3. **Data Retrieval**: It sends a GET request to the Silverfort API to fetch the
    detailed configuration of the specified policy.

    4. **Result Processing**: The action parses the retrieved policy data, populates
    the action's JSON results with the configuration details, and generates a success
    message containing the policy name and ID.


    ### Additional Notes

    This action is a read-only operation and does not perform any modifications to
    the Silverfort environment. It does not run on specific entities but rather on
    a provided Policy ID.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
get_service_account:
  ai_description: >-
    ### General Description

    The **Get Service Account** action retrieves detailed metadata and security attributes
    for a specific service account from the Silverfort Identity Security platform
    using its unique Global Unique Identifier (GUID). This action provides visibility
    into a service account's risk level, predictability, protection status, and other
    critical identity-related data points.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Service Account GUID | The unique identifier (GUID) of the service account you
    wish to retrieve information for. | string | True |


    ### Additional Notes

    This action is purely informational and does not perform any changes to the service
    account or the Silverfort environment. It requires the 'Service Accounts API'
    credentials to be configured within the Silverfort integration settings.


    ### Flow Description

    1. **Parameter Extraction**: The action extracts the provided `Service Account
    GUID` from the input.

    2. **Authentication**: It initializes an authenticated session specifically for
    the Silverfort Service Accounts API using JWT-based authentication.

    3. **API Request**: The action sends a GET request to the Silverfort backend using
    the service account's GUID.

    4. **Data Processing**: Upon a successful response, the action parses the service
    account attributes (e.g., UPN, risk, predictability, protection status).

    5. **Output Generation**: The detailed service account data is saved as a JSON
    result, and a success message containing the account's display name and GUID is
    returned.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
list_policies:
  ai_description: >-
    ### General Description

    The **List Policies** action retrieves a list of all authentication policies configured
    in Silverfort. It allows users to filter the returned data by specifying a list
    of desired fields, providing visibility into the security posture and access controls
    defined within the Silverfort platform.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Fields** | String | No | A comma-separated list of specific fields to include
    in the response. If left empty, all available fields are returned. Available fields
    include: `enabled`, `policyName`, `authType`, `protocols`, `policyType`, `allUsersAndGroups`,
    `usersAndGroups`, `allDevices`, `sources`, `allDestinations`, `destinations`,
    `action`, `MFAPrompt`, `all`, `bridgeType`. |


    ### Additional Notes

    - If invalid fields are provided in the `Fields` parameter, the action logs a
    warning and ignores the invalid entries while still attempting to fetch valid
    fields.

    - This action does not run on specific entities but retrieves global configuration
    data from the Silverfort environment.


    ### Flow Description

    1. **Initialization:** The action initializes the Silverfort Policy API client
    using the provided integration credentials.

    2. **Parameter Extraction:** It extracts the `Fields` parameter from the action
    configuration.

    3. **Validation:** If fields are specified, the action validates them against
    a known list of supported policy index fields.

    4. **API Call:** The action makes a request to the Silverfort `/v2/public/policies/index`
    endpoint to fetch the policy data.

    5. **Processing:** The retrieved policy list is converted into a structured JSON
    format.

    6. **Completion:** The action reports the total count of policies retrieved and
    attaches the full details to the JSON results.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
list_service_accounts:
  ai_description: >-
    ### General Description

    This action lists service accounts from Silverfort, providing details about their
    attributes, risk scores, and protection status. It is primarily used for auditing
    service accounts within the environment or for retrieving specific account identifiers
    (GUIDs) needed for subsequent management actions.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Page Size** | String | No | The number of results to return per page (1-100).
    Defaults to 50 if not specified. |

    | **Page Number** | String | No | The specific page number of results to retrieve.
    Defaults to 1. |

    | **Fields** | String | No | A comma-separated list of specific attributes to
    include in the response (e.g., `guid, display_name, risk`). If left empty, all
    available fields are returned. |


    ### Additional Notes

    - This action requires the **Service Accounts App User ID** and **Service Accounts
    App User Secret** to be configured in the Silverfort integration settings.

    - The action automatically validates the provided `Fields` against the supported
    Silverfort API schema and will ignore any invalid field names while logging a
    warning.

    - This action does not target specific entities in a case; it performs a global
    query against the Silverfort platform.


    ### Flow Description

    1.  **Parameter Extraction**: The action parses the `Page Size`, `Page Number`,
    and `Fields` inputs.

    2.  **Field Validation**: It splits the `Fields` string into a list and compares
    it against the supported constants (`SA_INDEX_FIELDS`).

    3.  **Authentication**: A secure session is established using the JWT authenticator
    specifically for the Service Accounts API.

    4.  **API Request**: A POST request is sent to the `/v1/public/serviceAccounts/index`
    endpoint with the pagination and field filtering criteria.

    5.  **Result Processing**: The retrieved list of service accounts is converted
    to a JSON object and attached to the action results for use in downstream playbook
    tasks.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
ping:
  ai_description: >-
    ### General Description

    The **Ping** action is a diagnostic utility designed to verify connectivity between
    Google SecOps and the Silverfort Identity Security platform. It validates the
    configuration settings by testing the External API Key and individual credentials
    for the Risk, Service Accounts, and Policies API modules. This ensures that the
    integration is properly authenticated and capable of performing subsequent actions.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | N/A | N/A | N/A | This action does not have any input parameters. It relies
    solely on the integration's configuration settings (API Root, API Key, and module-specific
    credentials). |


    ### Additional Notes

    - The action identifies which Silverfort API modules (Risk, Service Accounts,
    Policies) have credentials configured in the integration settings and tests only
    those that are provided.

    - It requires at least one set of API credentials (Risk, Service Accounts, or
    Policies) to be configured; otherwise, it will return an error.

    - Connectivity is tested using lightweight, non-mutating API calls (e.g., listing
    a single service account or fetching policy names).


    ### Flow Description

    1.  **Initialization**: The action initializes the Silverfort base client and
    retrieves integration configuration parameters.

    2.  **Configuration Check**: It identifies which API types (Risk, Service Accounts,
    Policies) have valid credentials configured.

    3.  **Connectivity Testing**: For each configured API type, the action instantiates
    a specific client and executes a `test_connectivity` method:
        - **Risk API**: Attempts a GET request to the `getEntityRisk` endpoint.
        - **Service Accounts API**: Attempts a POST request to list service accounts
    with a page size of 1.
        - **Policies API**: Attempts a GET request to retrieve policy rule names and
    IDs.
    4.  **Result Aggregation**: The action tracks which connections succeeded and
    which failed.

    5.  **Output**: It returns a success message if all configured APIs connect successfully,
    or a partial success/failure message detailing the status of each module.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
update_entity_risk:
  ai_description: >-
    ### General Description

    Updates risk information for a specific user in Silverfort. This action allows
    security analysts to manually or programmatically set a risk level for a user
    based on external threat intelligence or internal security events. It targets
    a specific user via their User Principal Name (UPN) and applies a risk score with
    a defined severity and expiration timeframe.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | User Principal Name | string | Yes | The user principal name (e.g., user@domain.com)
    for which the risk will be updated. |

    | Risk Type | ddl | Yes | The specific category of risk to update. Options include:
    `activity_risk`, `malware_risk`, `data_breach_risk`, and `custom_risk`. |

    | Severity | ddl | Yes | The severity level of the risk being assigned. Options
    include: `low`, `medium`, `high`, and `critical`. |

    | Valid For Hours | string | Yes | Specifies how long (in hours) the risk indicator
    should remain valid in the Silverfort system. Must be a positive integer. |

    | Description | string | Yes | A descriptive note explaining the reason for the
    risk update. |


    ### Additional Notes

    - This action interacts with the Silverfort Risk API.

    - The 'Valid For Hours' parameter is passed as a string but is treated as a positive
    integer internally for the API request.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves all mandatory parameters from
    the user input, including the UPN, risk type, severity, validity duration, and
    description.

    2. **Validation**: It validates that the risk type and severity match allowed
    Silverfort values and ensures that the 'Valid For Hours' is a positive integer.

    3. **API Client Initialization**: It initializes an authenticated Silverfort Risk
    API client using the integration's credentials.

    4. **Data Modeling**: It constructs a `RiskUpdate` object containing the severity,
    duration, and description, mapping it to the specified risk type.

    5. **API Request**: It sends a POST request to the Silverfort `/v1/public/updateEntityRisk`
    endpoint for the specified UPN.

    6. **Result Handling**: Upon a successful update, the action generates a success
    message and populates the JSON result with the details of the updated risk profile.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the risk profile, severity, and expiration for a specific user within
      the Silverfort Identity Security platform via a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
update_policy:
  ai_description: >-
    ### General Description

    The **Update Policy** action allows users to modify existing authentication policies
    within the Silverfort platform. This action is primarily used for management and
    response scenarios, such as enabling/disabling a policy or dynamically adjusting
    its scope by adding or removing specific users, groups, network sources, and destination
    targets.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Policy ID** | String | Yes | The unique identifier of the Silverfort policy
    to be updated. |

    | **Enabled** | Boolean | No | If provided, toggles the policy state to enabled
    (True) or disabled (False). |

    | **Add Users and Groups** | String | No | A JSON array string representing users
    or groups to add to the policy. Expected format: `[{"identifierType": "upn", "identifier":
    "user@domain.com", "displayName": "User Name", "domain": "domain.com"}]`. |

    | **Remove Users and Groups** | String | No | A JSON array string representing
    users or groups to remove from the policy. Same format as 'Add Users and Groups'.
    |

    | **Add Sources** | String | No | A JSON array string representing network sources
    (IPs) to add to the policy. Expected format: `[{"identifierType": "ip", "identifier":
    "10.0.0.1", "displayName": "Server Name"}]`. |

    | **Remove Sources** | String | No | A JSON array string representing network
    sources to remove from the policy. Same format as 'Add Sources'. |

    | **Add Destinations** | String | No | A JSON array string representing destination
    targets to add to the policy. Expected format: `[{"identifierType": "hostname",
    "identifier": "server.domain.com", "displayName": "Server", "domain": "domain.com",
    "services": ["rdp"]}]`. |

    | **Remove Destinations** | String | No | A JSON array string representing destination
    targets to remove from the policy. Same format as 'Add Destinations'. |


    ### Additional Notes

    - All "Add" and "Remove" parameters expect a valid JSON array of objects. Failure
    to provide correctly formatted JSON will result in a validation error.

    - This action does not rely on SOAR entities and instead uses explicit parameter
    inputs for the Policy ID and modification details.


    ### Flow Description

    1. **Initialization**: The action extracts the mandatory Policy ID and any optional
    update parameters from the input.

    2. **Validation and Parsing**: The action validates and parses the JSON strings
    for users, groups, sources, and destinations into structured objects used by the
    Silverfort API.

    3. **API Execution**: A `PATCH` request is made to the Silverfort Policies API
    v2 to update the specified policy with the new configuration.

    4. **Output**: The action returns a success message and a JSON object containing
    the updated policy ID and status.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates authentication policy configurations in Silverfort, including changing
      the enabled state and modifying access control lists (users, groups, sources,
      and destinations).
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
update_sa_policy:
  ai_description: >-
    ### General Description

    Updates the protection policy for a specific Service Account within Silverfort.
    This action is used to manage security controls such as blocking violations, SIEM
    logging, and defining allowlists for sources, destinations, and protocols. It
    is primarily a management or containment action used to harden or adjust the security
    posture of service accounts based on identified risks.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Service Account GUID | string | Yes | The unique identifier (GUID) of the service
    account to update. |

    | Enabled | boolean | No | Toggle to enable or disable the policy. |

    | Block | boolean | No | Toggle to enable or disable blocking for policy violations.
    |

    | Send to SIEM | boolean | No | Toggle to enable or disable sending policy-related
    logs to a SIEM. |

    | Risk Level | ddl | No | The risk level threshold (low, medium, high). |

    | Allow All Sources | boolean | No | If true, all source points are allowed, ignoring
    the specific allowlist. |

    | Allow All Destinations | boolean | No | If true, all destination points are
    allowed, ignoring the specific allowlist. |

    | Protocols | string | No | Comma-separated list of protocols to allow (e.g.,
    'Kerberos, ldap, ntlm'). |

    | Add Allowed Sources | string | No | JSON array of source objects to add (e.g.,
    '[{"key": "1.1.1.1", "key_type": "ip"}]'). |

    | Remove Allowed Sources | string | No | JSON array of source objects to remove
    from the allowlist. |

    | Add Allowed Destinations | string | No | JSON array of destination objects to
    add to the allowlist. |

    | Remove Allowed Destinations | string | No | JSON array of destination objects
    to remove from the allowlist. |


    ### Flow Description

    1. **Extraction**: The action retrieves all parameters, including the mandatory
    Service Account GUID and optional policy configuration flags.

    2. **Validation**: Validates that the provided `Risk Level` and `Protocols` match
    the supported enums in Silverfort.

    3. **JSON Parsing**: Converts the string-based JSON arrays for 'Add/Remove Allowed
    Sources/Destinations' into structured endpoint objects.

    4. **API Interaction**: Initiates a POST request to the Silverfort Service Accounts
    API (`/v1/public/serviceAccounts/policy/{guid}`) with the new configuration payload.

    5. **Completion**: Returns a success message and a JSON result containing the
    updated GUID and status if the operation succeeds.


    ### Additional Notes

    - This action does not automatically identify service accounts from the alert
    context; it requires a specific `Service Account GUID` to be provided as an input.

    - The endpoint JSON parameters must strictly follow the format `[{"key": "value",
    "key_type": "type"}]` or the action will fail during the parsing stage.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the security policy configuration for a service account in Silverfort,
      modifying settings like blocking behavior, SIEM logging, and allowed network
      paths.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
