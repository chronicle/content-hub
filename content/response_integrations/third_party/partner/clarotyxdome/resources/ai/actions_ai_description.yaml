AddVulnerabilities:
  ai_description: >-
    ### General Description

    This action enriches entities within Google SecOps by fetching vulnerability information
    from a Claroty xDome instance. It identifies devices based on their IP address,
    MAC address, or unique xDome UID and retrieves a detailed list of associated vulnerabilities.
    The retrieved data includes vulnerability names, CVE IDs, risk scores, and remediation
    recommendations, which are then attached to the entities as additional properties.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | xdomeHost | String | True | The base URL for the Claroty xDome instance (e.g.,
    `https://example.xdome.claroty.com`). |

    | xdomeApiToken | String | True | The API token used for authenticating requests
    to the Claroty xDome API. |

    | Verify SSL | Boolean | False | Enables or disables SSL certificate validation
    for API connections. Default is true. |


    ### Flow Description

    1.  **Configuration Extraction:** The action retrieves the xDome host, API token,
    and SSL verification settings from the integration parameters.

    2.  **Identifier Identification:** For each target entity, the action determines
    if the identifier is a potential xDome UID, an IP address (v4 or v6), or a MAC
    address.

    3.  **Device Lookup:** If the identifier is an IP or MAC address, the action performs
    a search against the xDome `/api/v1/devices/` endpoint to find the corresponding
    device UID.

    4.  **Vulnerability Retrieval:** Once a device UID is obtained, the action queries
    the `/api/v1/device_vulnerability_relations/` endpoint to fetch all known vulnerabilities
    for that device.

    5.  **Entity Enrichment:** The vulnerability data, including counts and risk details,
    is mapped to the entity's `additional_properties`. The entity is marked as enriched.

    6.  **Internal Update:** The action updates the entities within Google SecOps
    to persist the new metadata and provides a summary of successful and failed enrichments
    in the action output.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates the entity's 'additional_properties' with vulnerability data and sets
      the 'is_enriched' flag to true.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    - MacAddress
    - GENERICENTITY
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichAlerts:
  ai_description: >-
    ### General Description

    Enriches a Google SecOps (Chronicle) alert with detailed metadata and MITRE ATT&CK
    information retrieved from Claroty xDome. The action uses a specific Claroty Alert
    ID to query the external system and maps the returned attributes directly to the
    alert context in Google SecOps.


    ### Parameters Description


    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | clarotyAlertId | The unique alert ID from Claroty xDome used to fetch specific
    alert details. | string | True |


    ### Flow Description

    1.  **Configuration Extraction**: Retrieves Claroty xDome connection details (Host
    and API Token) from the integration settings.

    2.  **External Query**: Executes a POST request to the Claroty xDome API `/api/v1/alerts/`
    using a filter to find the alert matching the provided `clarotyAlertId`.

    3.  **Data Extraction**: Parses the API response to extract fields such as alert
    name, type, category, status, and MITRE technique IDs/names (Enterprise or ICS).

    4.  **Internal Mutation (Enrichment)**:
        *   Maps Claroty fields to the Google SecOps alert's `additional_properties`
    with a `Claroty_` prefix.
        *   Updates the `security_result` field of the alert with MITRE Tactic and
    Technique names/IDs.
    5.  **Result Reporting**: Adds the raw JSON alert data to the action results and
    provides a summary of the enrichment status on the case wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates the current alert's 'additional_properties' and 'security_result' fields
      with enriched metadata and MITRE ATT&CK information retrieved from Claroty xDome.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichXDomeAssetInformation:
  ai_description: >-
    ### General Description

    This action enriches IP Address and MAC Address entities with comprehensive asset
    information retrieved from a Claroty xDome instance. It provides deep visibility
    into the device's technical specifications, risk posture, and associated vulnerabilities,
    enabling security analysts to better understand the context of an alert involving
    industrial or IoT assets.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | `xdomeHost` | String | Yes | The base URL of the Claroty xDome instance (e.g.,
    `https://example.xdome.claroty.com`). |

    | `xdomeApiToken` | String | Yes | The API token used for authenticating requests
    to the Claroty xDome API. |


    ### Flow Description

    1.  **Identify Entities:** The action iterates through the target entities, specifically
    looking for `ADDRESS` (IP) and `MacAddress` types.

    2.  **Filter Validation:** It uses regular expressions to determine if the identifier
    is a valid IPv4, IPv6, or MAC address.

    3.  **Asset Retrieval:** It queries the Claroty xDome `/api/v1/devices/` endpoint
    to find device records matching the entity's identifier.

    4.  **Vulnerability Retrieval:** For the first matching device found, it performs
    a secondary query to `/api/v1/device_vulnerability_relations/` using the device's
    unique ID (`uid`) to fetch all associated vulnerabilities.

    5.  **Data Processing:** The action aggregates asset details (such as risk score,
    manufacturer, and device category) and summarizes the top vulnerabilities and
    total vulnerability count.

    6.  **Enrichment:** The gathered information is added to the entity's `additional_properties`,
    and the entity is marked as enriched within Google SecOps.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
    - ADDRESS
    - MacAddress
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Test connectivity to Claroty xDome to ensure that the provided connection parameters
    (Host and API Token) are valid and the service is reachable. This action is typically
    used for troubleshooting or initial setup validation.


    ### Parameters description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | xdomeHost | String | Yes | The base URL/host of the Claroty xDome instance (e.g.,
    https://example.xdome.claroty.com). |

    | xdomeApiToken | String | Yes | The API Token used for Bearer authentication.
    |

    | Verify SSL | Boolean | No | If enabled, the action will verify the SSL certificate
    of the xDome host. |


    ### Additional notes

    This action is a utility for verifying integration configuration and does not
    require or process any entities.


    ### Flow description

    1. **Initialize Parameters**: The action extracts the `xdomeHost`, `xdomeApiToken`,
    and `Verify SSL` settings from the integration's configuration.

    2. **Connectivity Test**: It constructs a POST request to the Claroty xDome alerts
    endpoint (`/api/v1/alerts/`) with a limit of 1 result.

    3. **Validation**: The action attempts to execute the request with a 10-second
    timeout and checks if the response status is successful.

    4. **Result Reporting**: It returns an execution state of completed and a success
    message if the connection is established, or an execution state of failed with
    the error details if the connection fails.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
