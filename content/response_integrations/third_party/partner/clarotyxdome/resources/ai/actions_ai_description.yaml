Add vulnerabilities:
  ai_description: >-
    ### General Description This action enriches entities by adding vulnerability
    information retrieved from Claroty xDome. It identifies devices based on their
    IP address or MAC address and fetches associated vulnerability details, such as
    CVE IDs, risk scores, and descriptions, to provide a detailed view of the entity
    security posture. ### Parameters Description | Parameter | Type | Mandatory |
    Description | | :--- | :--- | :--- | :--- | | xdomeHost | string | Yes | The Base
    URL for the Claroty xDome instance (e.g., https://xdome.claroty.com). | | xdomeApiToken
    | string | Yes | API token for authenticating to the Claroty xDome instance. |
    | Verify SSL | string | No | Enable (true) or disable (false) SSL certificate
    validation for API connections. | ### Flow Description 1. **Configuration Extraction**:
    Retrieves the host URL, API token, and SSL verification settings from the action
    configuration. 2. **Entity Identification**: Iterates through target entities
    and evaluates the identifier. If it is not a direct UID, the action queries the
    xDome '/api/v1/devices/' endpoint using the IP or MAC address to retrieve the
    device UID. 3. **Vulnerability Retrieval**: Uses the device UID to query the '/api/v1/device_vulnerability_relations/'
    endpoint for all associated vulnerability details. 4. **Internal Data Update**:
    Populates the entity 'additional_properties' with vulnerability data, sets the
    'is_enriched' flag to true, and marks the entity as vulnerable if matches are
    found. 5. **Finalization**: Updates the entities in the case and returns a JSON
    summary of the enriched data. ### Additional Notes This action supports IPv4,
    IPv6, and MAC addresses. It identifies devices dynamically and filters out retired
    assets in the xDome environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates the 'additional_properties' attribute of entities with vulnerability
      data and sets the 'is_enriched' flag.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - ADDRESS
      - MacAddress
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Enrich xDome asset information:
  ai_description: >-
    ### General Description

    This action enriches IP Address and MAC Address entities using Claroty xDome.
    It queries the xDome API to retrieve detailed asset information, including device
    category, risk scores, manufacturer details, and vulnerability data. The retrieved
    information is then mapped to the entity's additional properties within Google
    SecOps, providing security analysts with contextual insights into the assets involved
    in an alert.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | xdomeHost | The base URL for the Claroty xDome instance (e.g., https://your-instance.claroty.com).
    | String | True |

    | xdomeApiToken | The API token used for authenticating requests to the Claroty
    xDome instance. | String | True |


    ### Flow Description

    1.  **Initialization**: The action extracts the Claroty xDome host and API token
    from the configuration parameters.

    2.  **Entity Filtering**: It iterates through the target entities in the case
    and filters for those of type `ADDRESS` or `MACADDRESS`.

    3.  **Identifier Validation**: For each valid entity, it performs a regex check
    to ensure the identifier is a valid IPv4, IPv6, or MAC address format.

    4.  **Asset Query**: It performs a POST request to the Claroty xDome `/api/v1/devices/`
    endpoint to find assets matching the entity's IP or MAC address.

    5.  **Vulnerability Retrieval**: If a matching asset is found, the action takes
    the unique ID (`uid`) and performs a second query to the `/api/v1/device_vulnerability_relations/`
    endpoint to fetch associated vulnerabilities.

    6.  **Data Processing**: The action processes the device details and vulnerability
    lists, calculating a total vulnerability count and generating a summary of the
    top CVEs.

    7.  **Enrichment**: The resulting data (e.g., `Claroty_device_type`, `Claroty_risk_score`,
    `vulnerability_count`) is added to the entity's `additional_properties`.

    8.  **Update**: The entities are updated in the Google SecOps platform with the
    new enrichment data.


    ### Additional Notes

    - The action only processes the first matching device found in xDome for a specific
    identifier.

    - Enrichment is marked as successful only if the entity type is supported and
    a matching device is found in the xDome database.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: true
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes:
      - ADDRESS
      - MacAddress
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: true
    filters_by_identifier: true
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
EnrichAlerts:
  ai_description: >-
    ### General Description

    This action enriches a Google SecOps alert using data retrieved from Claroty xDome.
    By providing a specific Claroty Alert ID, the action fetches comprehensive alert
    metadata, including status, description, and MITRE ATT&CK mapping, and attaches
    this information directly to the current alert in Google SecOps.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | clarotyAlertId | String | Yes | The unique identifier of the alert within the
    Claroty xDome platform used to retrieve specific alert details. |


    ### Flow Description

    1. **Authentication**: Connects to the Claroty xDome host using the configured
    host URL and API token.

    2. **Data Retrieval**: Performs a filtered POST request against the Claroty `/api/v1/alerts/`
    endpoint to fetch detailed metadata for the provided `clarotyAlertId`.

    3. **Property Enrichment**: Iterates through the Claroty alert fields (such as
    alert name, class, and status) and adds them to the Siemplify alert's `additional_properties`
    with a `Claroty_` prefix.

    4. **MITRE Mapping**: Specifically extracts MITRE ATT&CK enterprise or ICS tactics
    and techniques from the Claroty response and updates the Siemplify alert's `security_result`
    field to improve threat classification visibility.

    5. **Result Finalization**: Returns a success status and a JSON summary containing
    the full alert data from Claroty.


    ### Additional Notes

    This action operates on the current alert object rather than iterating over specific
    entities (like IP addresses or Hostnames) in the case scope.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: true
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: >-
      Updates the current alert's additional properties with Claroty alert metadata
      and populates MITRE ATT&CK tactics and techniques within the security result
      field.
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Tests connectivity to the Claroty xDome instance using the provided credentials.
    This action ensures that the Google SecOps platform can communicate with the Claroty
    xDome API by attempting an authenticated request to the alerts endpoint. It is
    primarily used during integration setup to verify that the Host and API Token
    are correctly configured.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | xdomeHost | String | Yes | The base URL of the Claroty xDome instance (e.g.,
    `https://instance.xdome.claroty.com`). This is extracted from the integration
    configuration. |

    | xdomeApiToken | String | Yes | The Bearer token used for authentication with
    the Claroty xDome API. This is extracted from the integration configuration. |

    | Verify SSL | Boolean | No | If enabled, the action will verify the SSL certificate
    of the host. Default is typically determined by the environment configuration.
    |


    ### Flow Description

    1. **Configuration Extraction**: The action retrieves the host URL, API token,
    and SSL verification preference from the integration's configuration parameters.

    2. **API Request**: Performs a POST request to the `/api/v1/alerts/` endpoint
    of Claroty xDome. The request includes a payload with a `limit` of 1 to minimize
    data transfer while verifying the validity of the credentials and the reachability
    of the service.

    3. **Connectivity Validation**: Analyzes the HTTP response status code. If the
    request returns a successful status (2xx), the action reports a successful connection.

    4. **Error Handling**: If an exception occurs (e.g., timeout, 401 Unauthorized,
    404 Not Found), the error is caught, logged, and a failure message is returned.


    ### Additional Notes

    - This action does not process any case entities and does not modify any data
    within Claroty xDome or Google SecOps.

    - It uses a POST method for querying alerts, which is a standard pattern for the
    Claroty xDome API search functionality.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: [ ]
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
