Advanced IOC Scan:
  ai_description: >-
    ### General Description

    Starts a new advanced Indicator of Compromise (IOC) scan (threat hunt) within
    Rubrik Security Cloud. This action allows security teams to search for specific
    file patterns, hashes, or YARA rules across snapshots of protected objects. It
    is highly configurable, allowing for filtering by date ranges, file sizes, and
    specific path inclusions or exclusions.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Object ID | String | Yes | Comma-separated list of Rubrik object IDs (FIDs)
    to perform the scan on. |

    | IOC Type | DDL | No | The category of indicator to scan for: `INDICATOR_OF_COMPROMISE_TYPE_PATH_OR_FILENAME`,
    `INDICATOR_OF_COMPROMISE_TYPE_HASH`, or `INDICATOR_OF_COMPROMISE_TYPE_YARA_RULE`.
    |

    | IOC Value | String | No | The specific value (e.g., a file hash or path pattern)
    to search for. |

    | Scan Name | String | No | Custom name for the threat hunt. If not provided,
    a name is auto-generated using the format `Google-SecOps-YYYY-MM-DD-HH:MM:SS`.
    |

    | Advanced IOC | String | No | A JSON-encoded object containing multiple indicators.
    Keys should represent the IOC type and values should be lists of indicators. |

    | Start Date | String | No | Filter snapshots starting from this date (Format:
    `yyyy-mm-dd` or `yyyy-mm-ddTHH:MM:SSZ`). |

    | End Date | String | No | Filter snapshots until this date (Format: `yyyy-mm-dd`
    or `yyyy-mm-ddTHH:MM:SSZ`). |

    | Max Snapshots Per Object | String | No | The maximum number of snapshots to
    scan for each specified object. |

    | Max Matches Per Snapshot | String | No | Terminates the scan for a snapshot
    once this number of matches is detected. |

    | Min File Size | String | No | Minimum file size in bytes to include in the scan.
    |

    | Max File Size | String | No | Maximum file size in bytes to include in the scan.
    |

    | Paths To Include | String | No | Comma-separated list of specific paths to include
    in the scan. |

    | Paths To Exclude | String | No | Comma-separated list of paths to exclude from
    the scan. |

    | Paths To Exempt | String | No | Comma-separated list of paths to exempt from
    the exclusion list. |


    ### Additional Notes

    To define the scan criteria, you must provide either the 'Advanced IOC' JSON parameter
    OR both the 'IOC Type' and 'IOC Value' parameters. If neither set is provided,
    the action will fail.


    ### Flow Description

    1. **Initialization**: Extracts integration configuration (Service Account JSON)
    and action parameters.

    2. **Validation**: Validates that the Object IDs are provided, parses the 'Advanced
    IOC' JSON (if provided), and ensures that date formats and integer parameters
    (like file sizes) are valid.

    3. **Authentication**: Establishes a session with Rubrik Security Cloud using
    OAuth2 token management.

    4. **Execution**: Sends a GraphQL mutation (`startBulkThreatHunt`) to the Rubrik
    API to initiate the scan with the specified filters and indicators.

    5. **Output**: Captures the resulting Hunt IDs and names from the API response,
    adds the full JSON response to the action results, and creates a data table summarizing
    the started hunts.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates a new threat hunt (Advanced IOC Scan) job within the Rubrik Security
      Cloud environment.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get CDM Cluster Connection State:
  ai_description: >-
    ### General Description

    Retrieves the connection state of a specific Cloud Data Management (CDM) cluster
    from Rubrik Security Cloud. This action is used to monitor the health and connectivity
    status of Rubrik clusters by querying node-level connection details.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Cluster ID | String | Yes | The unique identifier of the CDM cluster to query.
    |


    ### Additional Notes

    - This action performs a read-only GraphQL query and does not modify any data
    within the Rubrik Security Cloud environment.

    - The results are presented both as a raw JSON object and a formatted data table
    for easy review in the case wall.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves the mandatory `Cluster ID` from
    the input parameters.

    2. **Authentication**: Initializes the Rubrik API Manager using the provided service
    account credentials to establish a secure connection.

    3. **Data Retrieval**: Executes a GraphQL query (`GoogleSecOpsCDMClusterConnectionStateQuery`)
    specifically filtered by the provided Cluster ID to fetch connection state information.

    4. **Data Processing**: Parses the GraphQL response to extract the `connectedState`
    for each node within the cluster.

    5. **Output Generation**: Formats the retrieved data into a CSV-compatible structure
    for a data table and attaches the full raw response as a JSON result.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get CDM Cluster Location:
  ai_description: "### General Description\nThis action retrieves the geographical\
    \ location information for a specific Rubrik Cloud Data Management (CDM) cluster.\
    \ It interacts with the Rubrik Security Cloud API to fetch the physical address\
    \ associated with the cluster's nodes, providing visibility into where data management\
    \ resources are physically located.\n\n### Parameters Description\n\n| Parameter\
    \ | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| Cluster\
    \ ID | String | Yes | The unique identifier of the CDM cluster for which you want\
    \ to retrieve location data. |\n\n### Additional Notes\n- This action does not\
    \ operate on Google SecOps entities (like IP or Hostname). It requires the manual\
    \ or automated input of a specific Rubrik Cluster ID.\n- The results are presented\
    \ as a data table named 'CDM Cluster Location' and as a raw JSON object.\n\n###\
    \ Flow Description\n1. **Parameter Extraction**: The action starts by extracting\
    \ the mandatory `Cluster ID` from the action parameters.\n2. **Authentication**:\
    \ It initializes the Rubrik API Manager using the provided service account credentials\
    \ and handles OAuth token generation/refresh.\n3. **Data Retrieval**: It executes\
    \ a GraphQL query (`CDM_CLUSTER_LOCATION_QUERY`) against the Rubrik Security Cloud\
    \ to fetch the `geoLocation` (address) for the specified cluster ID.\n4. **Data\
    \ Processing**: The response is parsed to extract node-level location details.\n\
    5. **Output Generation**: \n    - A raw JSON result is added to the action output.\n\
    \    - A data table titled 'CDM Cluster Location' is created, mapping the Cluster\
    \ ID to its physical address.\n    - The action completes with a success message\
    \ if data is found, or fails if the cluster is not found or an API error occurs."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Sonar Sensitive Hits:
  ai_description: >-
    ### General Description

    Retrieves sensitive data classification hits for a specific Rubrik object from
    Rubrik Security Cloud (RSC). This action leverages Rubrik Sonar, a data classification
    engine, to identify sensitive data discovery results and policy violations within
    a configurable lookback period. It is primarily used to audit data exposure and
    identify objects containing sensitive information like PII or financial data.


    ### Parameters Description

    | Parameter | Type | Mandatory | Default | Description |

    | :--- | :--- | :--- | :--- | :--- |

    | Object Name | String | Yes | N/A | The name of the Rubrik object (e.g., a virtual
    machine, file share, or database) to check for sensitive hits. |

    | Lookback Days | String | No | 7 | The number of days in the past to retrieve
    scan results from. For example, a value of 7 will return results as of 7 days
    ago. |


    ### Additional Notes

    - The action performs a two-step GraphQL query: first to resolve the object name
    to a specific snappable and snapshot ID, and second to retrieve the detailed hit
    metrics.

    - Results are limited to the top 20 records in the visible data table for performance,
    while the full response is available in the JSON result.


    ### Flow Description

    1. **Parameter Initialization**: Extracts the 'Object Name' and 'Lookback Days'
    from the action input.

    2. **Validation**: Validates that the object name is provided and that the lookback
    period is a non-negative integer.

    3. **Date Calculation**: Calculates the target search date by subtracting the
    lookback days from the current system time.

    4. **API Authentication**: Initializes the Rubrik Security Cloud client using
    OAuth credentials from the integration configuration.

    5. **Object Resolution**: Queries the Rubrik GraphQL API to find the policy object
    matching the provided name for the calculated date.

    6. **Data Retrieval**: Fetches detailed sensitive hit information, including analyzer
    group names, specific analyzer results, and total hit counts.

    7. **Output Generation**: Formats the retrieved data into a JSON result and populates
    a SOAR data table named 'Sonar Sensitive Hits'.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
IOC Scan Results:
  ai_description: >-
    ### General Description

    Retrieves detailed results and metrics for a specific threat hunt (Turbo or Advanced)
    from Rubrik Security Cloud. This action is used to monitor the progress and outcome
    of scans, providing information on matched snapshots, scanned objects, and specific
    Indicators of Compromise (IOCs) found. It supports asynchronous execution, allowing
    the SOAR platform to poll for results until the scan is complete.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Hunt ID | String | Yes | The unique identifier of the threat hunt/IOC scan to
    retrieve results for. This ID is typically obtained from a previous scan initiation
    action. |


    ### Flow Description

    1. **Initialization**: Authenticates with Rubrik Security Cloud using service
    account credentials and initializes the API manager.

    2. **Data Retrieval**: Executes a GraphQL query (`threatHuntDetailsV2Query`) to
    fetch `threatHuntDetailV2` and `threatHuntObjectMetrics` for the specified Hunt
    ID.

    3. **Processing**: Parses the API response into a structured data model, extracting
    metrics such as total objects scanned, affected objects, matched snapshots, and
    scan timing.

    4. **Output Generation**: Generates a data table named 'IOC Scan Results' containing
    the summary metrics and attaches the full raw JSON response for detailed analysis.

    5. **Async Handling**: Evaluates the hunt status. If the status is 'PENDING' or
    'IN_PROGRESS', the action returns an 'IN_PROGRESS' state to allow for subsequent
    polling. If the hunt is finished, it returns a 'COMPLETED' state with the final
    results.


    ### Additional Notes

    This action does not operate on entities; it requires a specific Hunt ID as a
    manual input parameter. It is designed to be used in a loop or as a follow-up
    step to actions that start a threat hunt.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Events:
  ai_description: >-
    ### General Description

    Retrieves a list of events and activities from Rubrik Security Cloud (RSC). This
    action allows users to monitor system activities, backups, and security events
    by applying various filters such as status, severity, and time range. It supports
    pagination and custom sorting to handle large volumes of event data.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Activity Status | String | No | Filter events by status (e.g., 'Failure', 'Success').
    Supports comma-separated values. |

    | Activity Type | String | No | Filter events by type (e.g., 'Backup', 'Anomaly').
    Supports comma-separated values. |

    | Severity | String | No | Filter events by severity level (e.g., 'Critical',
    'Warning'). Supports comma-separated values. |

    | Object Name | String | No | Filter events associated with a specific object
    name. |

    | Object Type | String | No | Filter events by object type (e.g., 'VmwareVm').
    Supports comma-separated values. |

    | Cluster ID | String | No | Filter events by specific Rubrik Cluster IDs. Supports
    comma-separated values. |

    | Start Date | String | No | The start date for fetching events (Format: yyyy-mm-dd
    or ISO). |

    | End Date | String | No | The end date for fetching events (Format: yyyy-mm-dd
    or ISO). |

    | Sort By | DDL | No | The field used to sort the results (e.g., Last Updated,
    Severity). |

    | Sort Order | DDL | No | The direction of sorting (Ascending or Descending).
    |

    | Limit | String | No | The maximum number of results to retrieve (Default: 50,
    Max: 1000). |

    | Next Page Token | String | No | Cursor token used to retrieve the next page
    of results. |


    ### Additional Notes

    - The action validates that the 'Start Date' is before the 'End Date'.

    - If more results are available than the specified limit, a 'Next Page Token'
    is provided in the output message for subsequent calls.


    ### Flow Description

    1. **Parameter Extraction**: The action retrieves all user-provided filters, sorting
    options, and pagination tokens.

    2. **Validation**: It validates date formats and ensures the limit is a positive
    integer within the allowed range.

    3. **API Initialization**: Authenticates with Rubrik Security Cloud using service
    account credentials.

    4. **Data Retrieval**: Executes a GraphQL query (`activitySeriesConnection`) to
    fetch events matching the criteria.

    5. **Output Generation**: Formats the retrieved events into a data table for the
    SOAR interface and provides the raw JSON response for further processing.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Object Snapshots:
  ai_description: >-
    ### General Description

    The **List Object Snapshots** action retrieves a list of snapshots for a specific
    object from Rubrik Security Cloud (RSC) using its unique Object ID. This action
    is primarily used for auditing available recovery points or identifying specific
    snapshots for further investigation or restoration workflows. It supports filtering
    by date range and snapshot type, as well as pagination for large result sets.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Object ID** | String | Yes | The unique identifier (snappable ID) of the Rubrik
    object to retrieve snapshots for. |

    | **Limit** | String | No | The maximum number of snapshots to retrieve in a single
    request. Default is 50, with a maximum allowed value of 1000. |

    | **Next Page Token** | String | No | A cursor token used to retrieve the next
    page of results when more snapshots are available. |

    | **Sort Order** | DDL | No | Specifies the order to sort the snapshots by creation
    time. Options are **Asc** (Ascending) or **Desc** (Descending). Default is Asc.
    |

    | **Start Date** | String | No | Filters snapshots to include only those created
    on or after this date. Supported formats: `yyyy-mm-dd`, `yyyy-mm-ddTHH:MM:SSZ`.
    |

    | **End Date** | String | No | Filters snapshots to include only those created
    on or before this date. Supported formats: `yyyy-mm-dd`, `yyyy-mm-ddTHH:MM:SSZ`.
    |

    | **Snapshot Type** | String | No | A comma-separated list of snapshot types (e.g.,
    `OnDemand`, `Scheduled`) to filter the results. |


    ### Additional Notes

    - If both **Start Date** and **End Date** are provided, the Start Date must be
    chronologically before the End Date.

    - The action provides a summary table in the SOAR interface showing up to 20 records,
    while the full dataset is available in the JSON result for automated processing.


    ### Flow Description

    1. **Parameter Extraction and Validation**: The action extracts user inputs and
    validates that the **Object ID** is provided, the **Limit** is a valid integer
    within bounds, and the date formats are correct.

    2. **Authentication**: It initializes a connection to Rubrik Security Cloud using
    the configured Service Account credentials and manages OAuth token lifecycles.

    3. **API Execution**: It performs a GraphQL POST request to the Rubrik API using
    the `snapshotOfASnappableConnection` query, applying the specified filters, sorting,
    and pagination parameters.

    4. **Data Processing**: The raw JSON response is captured, and the snapshot metadata
    (ID, Creation Date, Cluster Name, and SLA Domain) is parsed into a structured
    format.

    5. **Output Generation**: The action populates the JSON result with the full API
    response and creates a data table for the case wall. If more results exist beyond
    the current limit, a pagination token is included in the final status message.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
List Sonar File Contexts:
  ai_description: >-
    ### General Description

    Retrieves the context of files, folders, or file shares detected by Rubrik Sonar
    for a specific object snapshot. This action allows security analysts to inspect
    sensitive data findings (hits), file metadata, and access types within protected
    backups stored in Rubrik Security Cloud.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Object ID** | String | Yes | The unique identifier (Snappable ID) of the object
    in Rubrik. |

    | **Snapshot ID** | String | Yes | The unique identifier of the specific snapshot
    to query. |

    | **File Name** | String | No | Filter results by a specific file name. |

    | **File Path** | String | No | Filter results by a standard file path. |

    | **User ID** | String | No | Filter results by a specific user ID. |

    | **Include Whitelisted Results** | DDL | No | Boolean indicating whether to include
    results that have been whitelisted. |

    | **Limit** | String | No | Maximum number of results to retrieve in the response
    (default: 50). |

    | **Next Page Token** | String | No | The next page cursor to retrieve the next
    set of results. |

    | **Sort By** | DDL | No | Field to use for sorting the response (e.g., HITS,
    LAST_MODIFIED). |

    | **Sort Order** | DDL | No | Specify the order to sort the data (Asc/Desc). |


    ### Flow Description

    1. **Parameter Extraction**: Retrieves mandatory `Object ID` and `Snapshot ID`
    along with optional filters, pagination, and sorting settings from the action
    input.

    2. **Validation**: Validates that mandatory IDs are non-empty strings and ensures
    the `Limit` parameter is a valid positive integer within allowed bounds.

    3. **API Interaction**: Initializes the Rubrik API manager and executes a GraphQL
    query (`SONAR_FILE_CONTEXTS_QUERY`) to fetch the requested file contexts from
    Rubrik Security Cloud.

    4. **Data Processing**: Parses the GraphQL response into a structured `SonarFileContextsDatamodel`,
    extracting key details such as file names, sizes, total sensitive hits, and access
    timestamps.

    5. **Output Generation**: Adds the full raw JSON response to the action results
    and generates a 'Sonar File Contexts' data table for display in the Google SecOps
    interface.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: "### General Description\nThis action tests the connectivity between\
    \ the Google SecOps SOAR server and the Rubrik Security Cloud instance. Its primary\
    \ purpose is to verify that the integration is correctly configured, the service\
    \ account credentials are valid, and the network path to the Rubrik API is open.\n\
    \n### Parameters Description\nThere are no parameters for this action. It relies\
    \ entirely on the integration's global configuration (Service Account JSON and\
    \ SSL verification settings).\n\n### Additional Notes\n- This action uses the\
    \ `deploymentVersion` GraphQL query as a lightweight health check.\n- It utilizes\
    \ an OAuth2 flow to authenticate, automatically handling token generation and\
    \ storage via the `APIManager`.\n\n### Flow Description\n1. **Initialization**:\
    \ The action initializes the Siemplify context and retrieves the global integration\
    \ parameters (Service Account JSON and SSL verification).\n2. **API Manager Setup**:\
    \ It instantiates the `APIManager`, which checks for a valid cached OAuth token\
    \ or generates a new one using the provided service account credentials.\n3. **Connectivity\
    \ Test**: The action calls the `test_connectivity` method, which sends a POST\
    \ request to the Rubrik GraphQL endpoint with a query for the `deploymentVersion`.\n\
    4. **Result Handling**: \n    - If the request is successful (200 OK and no GraphQL\
    \ errors), it returns a success message and sets the connectivity result to `True`.\n\
    \    - If an exception occurs (e.g., authentication failure, network timeout,\
    \ or server error), it catches the error, logs the details, and returns a failure\
    \ message with the connectivity result set to `False`."
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Turbo IOC Scan:
  ai_description: >-
    ### General Description

    The **Turbo IOC Scan** action initiates a high-speed threat hunting operation
    within Rubrik Security Cloud. It allows security teams to search for specific
    Indicators of Compromise (IOCs), such as file hashes, across protected snapshots
    in Rubrik clusters. This action is optimized for speed and provides rapid visibility
    into potential threats across the Rubrik infrastructure.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **IOC** | String | Yes | A comma-separated list of indicator values (e.g., MD5,
    SHA1, or SHA256 hashes) to scan for. |

    | **Scan Name** | String | No | A custom name for the threat hunt. If not provided,
    the action generates a name automatically using the format `Google-SecOps-YYYY-MM-DD-HH:MM:SS`.
    |

    | **Cluster ID** | String | No | A comma-separated list of Rubrik Cluster IDs
    to restrict the scan to. If omitted, the scan targets all available clusters.
    |

    | **Start Time** | String | No | Filters snapshots created on or after this date.
    Supported formats: `yyyy-mm-dd`, `yyyy-mm-ddTHH:MM:SSZ`, or `yyyy-mm-ddTHH:MM:SS.fffZ`.
    |

    | **End Time** | String | No | Filters snapshots created on or before this date.
    Supported formats: `yyyy-mm-dd`, `yyyy-mm-ddTHH:MM:SSZ`, or `yyyy-mm-ddTHH:MM:SS.fffZ`.
    |

    | **Max Snapshots Per Object** | String | No | The maximum number of snapshots
    to scan for each individual object. Must be a positive integer. |


    ### Additional Notes

    - This action does **not** iterate over entities in the Google SecOps case; it
    relies entirely on the provided `IOC` parameter to define the scope of the hunt.

    - The action returns a **Hunt ID**, which is required to track the progress or
    retrieve the results of the scan in subsequent steps.

    - Either a single IOC or a list of comma-separated IOCs must be provided for the
    action to execute.


    ### Flow Description

    1. **Parameter Extraction & Validation:** The action retrieves input parameters
    and validates date formats and integer constraints. It ensures that the `Start
    Time` is chronologically before the `End Time` if both are provided.

    2. **Authentication:** It establishes a connection with Rubrik Security Cloud
    using Service Account credentials and manages the OAuth token lifecycle via encrypted
    storage.

    3. **Scan Initiation:** The action sends a GraphQL mutation (`startTurboThreatHunt`)
    to the Rubrik API, passing the IOC list, cluster filters, and snapshot configurations.

    4. **Result Processing:** It captures the `huntId` from the API response and structures
    it into a data table titled "Turbo IOC Scan Results".

    5. **Completion:** The action outputs the Hunt ID and the full JSON response,
    marking the execution as completed or failed based on the API's success.
  capabilities:
    can_create_case_comments: false
    can_create_insight: false
    can_modify_alert_data: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Initiates a new Turbo Threat Hunt scan in Rubrik Security Cloud, which creates
      a new scan task and consumes system resources to perform the search.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_types: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
