Create Custom List:
  ai_description: "### General Description\nThe **Create Custom List** action creates\
    \ a new Custom List (also known as a Named List) within the Infoblox Threat Defense\
    \ platform. These lists are foundational components for security policies, allowing\
    \ administrators to group specific indicators like domains, IPv4 addresses, and\
    \ IPv6 addresses for allow-listing or block-listing purposes.\n\n### Parameters\
    \ Description\n| Parameter | Type | Mandatory | Description |\n| :--- | :--- |\
    \ :--- | :--- |\n| **Name** | string | Yes | The unique name of the Custom List\
    \ to be created. |\n| **Type** | string | Yes | The category of the Custom List\
    \ (e.g., 'custom_list'). Default is 'custom_list'. |\n| **Items** | string | No\
    \ | A comma-separated string of indicators (IPv4, IPv6, or domain names) to populate\
    \ the list upon creation. |\n| **Description** | string | No | A brief explanation\
    \ of the purpose or content of the Custom List. |\n| **Confidence Level** | ddl\
    \ | No | Defines the reliability of the indicators in the list. Options: High,\
    \ Medium, Low. Default is 'High'. |\n| **Threat Level** | ddl | No | Defines the\
    \ perceived risk level associated with indicators in the list. Options: High,\
    \ Medium, Low, Info. Default is 'Low'. |\n| **Tags** | string | No | A JSON-formatted\
    \ string representing key-value pairs to categorize and organize the list within\
    \ Infoblox. |\n\n### Additional Notes\n- The **Items** parameter must contain\
    \ valid network indicators. The action performs regex validation for IPv4, IPv6,\
    \ and standard domain formats.\n- The **Tags** parameter must be a valid JSON\
    \ object string (e.g., `{\"Department\": \"Security\", \"Priority\": \"1\"}`).\n\
    \n### Flow Description\n1. **Initialization:** Retrieves integration configuration\
    \ (API Root, Key) and extracts action parameters from the SOAR environment.\n\
    2. **Parsing & Validation:** \n    - Converts the comma-separated **Items** string\
    \ into a Python list.\n    - Parses the **Tags** JSON string into a dictionary.\n\
    \    - Validates that **Name** and **Type** are provided.\n    - Validates each\
    \ item in the **Items** list against expected formats (IP/Domain).\n3. **API Interaction:**\
    \ Constructs a payload including mandatory fields and optional metadata (Description,\
    \ Confidence, Threat Level, Tags). Sends a `POST` request to the Infoblox `/api/atcfw/v1/named_lists`\
    \ endpoint.\n4. **Result Processing:** \n    - Returns the full JSON response\
    \ from Infoblox to the action results.\n    - Populates a data table named \"\
    Custom List Details\" with the ID, Name, and item count of the newly created list."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new named/custom list in the Infoblox Threat Defense platform via
      a POST request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Network List:
  ai_description: >-
    ### General Description

    The **Create Network List** action allows users to create a new network list within
    Infoblox Threat Defense. Network lists are used to define groups of IP addresses
    or CIDRs where specific security policies should be applied. This action is primarily
    used for management and containment strategies, allowing security teams to dynamically
    define network boundaries and policy enforcement points directly from Google SecOps.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Name** | String | Yes | Specify the unique name for the network list. |

    | **Items** | String | Yes | Specify the comma-separated items to include in the
    network list (e.g., IP addresses or CIDR blocks). |

    | **Description** | String | No | Provide a brief description to help identify
    the purpose of the network list. |


    ### Flow Description

    1.  **Parameter Extraction**: The action retrieves the `Name`, `Items`, and optional
    `Description` from the input parameters.

    2.  **Validation**: It validates that the mandatory `Name` and `Items` fields
    are not empty.

    3.  **Data Transformation**: The comma-separated `Items` string is converted into
    a list of strings suitable for the API payload.

    4.  **API Interaction**: The action sends a POST request to the Infoblox API (`/api/atcfw/v1/network_lists`)
    to create the resource.

    5.  **Result Processing**: Upon success, it parses the response into a `NetworkList`
    data model and outputs the details as a JSON result and a formatted data table
    named "Network List Details".


    ### Additional Notes

    *   The `Items` parameter must contain valid network identifiers (IPv4, IPv6,
    or CIDR).

    *   The `Name` of the network list must be unique within the Infoblox environment.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new network list resource in the Infoblox Threat Defense system via
      a POST request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Create Security Policy:
  ai_description: "### General Description\nCreates a new security policy in the Infoblox\
    \ Threat Defense platform. This action allows for the comprehensive configuration\
    \ of security policies, including the definition of security rules, associations\
    \ with network lists, DNS Forwarding Proxies (DFPs), and roaming device groups.\
    \ It also provides options for enabling specific security features like DNS rebinding\
    \ protection and safe search filtering.\n\n### Parameters Description\n\n| Parameter\
    \ | Description | Type | Mandatory |\n| :--- | :--- | :--- | :--- |\n| Policy\
    \ Name | The unique name of the security policy to be created. | String | Yes\
    \ |\n| Description | A text description providing more context about the policy's\
    \ purpose. | String | No |\n| Rules | A JSON list of objects defining security\
    \ rules. Each object should include fields like 'action', 'type', 'data', 'policy_name',\
    \ and 'redirect_name'. | String (JSON) | No |\n| Network Lists | A comma-separated\
    \ list of network list IDs to associate with this policy. | String | No |\n| DFPS\
    \ | A comma-separated list of DNS Forwarding Proxy IDs to associate with this\
    \ policy. | String | No |\n| Roaming Device Groups | A comma-separated list of\
    \ Roaming Device Group IDs to associate with this policy. | String | No |\n| Block\
    \ DNS Rebinding | If set to true, enables protection against DNS rebinding attacks.\
    \ | Boolean | No |\n| Safe Search | If set to true, enables safe search filtering\
    \ on supported search engines. | Boolean | No |\n| Tags | A JSON object containing\
    \ key-value pairs used to categorize the policy. | String (JSON) | No |\n| Additional\
    \ Parameters | A JSON object containing advanced configuration fields such as\
    \ 'precedence', 'access_codes', 'doh_enabled', 'ecs', and 'dfp_services'. | String\
    \ (JSON) | No |\n\n### Additional Notes\n- Parameters like 'Rules', 'Tags', and\
    \ 'Additional Parameters' must be provided as valid JSON strings. \n- The 'Additional\
    \ Parameters' field only accepts specific keys: precedence, access_codes, doh_enabled,\
    \ doh_fqdn, ecs, onprem_resolve, dfp_services, net_address_dfps, user_groups,\
    \ and default_redirect_name.\n\n### Flow Description\n1. **Initialization**: Retrieves\
    \ integration configuration and extracts action parameters.\n2. **Validation**:\
    \ Ensures the 'Policy Name' is provided and validates that JSON-based parameters\
    \ ('Rules', 'Tags', 'Additional Parameters') are correctly formatted.\n3. **Payload\
    \ Preparation**: Transforms comma-separated strings (Network Lists, DFPS, Roaming\
    \ Device Groups) into lists of integers and constructs the final API request body.\n\
    4. **External Interaction**: Sends a POST request to the Infoblox security policies\
    \ API endpoint via the APIManager.\n5. **Results Processing**: On success, the\
    \ raw JSON response is added to the script results, and a summary of the created\
    \ policy is added to a data table for display in the case."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Creates a new security policy configuration record in the Infoblox Threat Defense
      system.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
DHCP Lease Lookup:
  ai_description: >-
    ### General Description

    This action retrieves DHCP lease information from Infoblox Threat Defense with
    DDI based on user-defined filter criteria. It is primarily used during incident
    response to map network identifiers like IP addresses or MAC addresses to specific
    hostnames, lease states, and hardware details at a given point in time.


    ### Parameters Description


    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | **DHCP Lease Filter** | A logical expression used to filter DHCP leases. For
    example: `address == '192.168.1.10'` or `hostname == 'workstation-01'`. | String
    | No |

    | **Offset** | The starting point (index) from which to begin retrieving results.
    Used for pagination. Defaults to 0. | String | No |

    | **Limit** | The maximum number of lease records to return in a single request.
    Defaults to 100. | String | No |

    | **Order By** | A comma-separated list of JSON fields to sort the results. Supports
    dot notation for nested fields and 'asc' or 'desc' suffixes for direction. | String
    | No |


    ### Additional Notes

    - This action does not target specific entities automatically; it relies on the
    provided filter string to find relevant data.

    - If the `DHCP Lease Filter` is left empty, the action will return the most recent
    leases based on the provided limit and offset.

    - Results are presented as both a raw JSON object and a formatted data table within
    the Google SecOps platform.


    ### Flow Description

    1. **Initialization:** The script initializes the Infoblox API manager using the
    integration's API Root and Key.

    2. **Parameter Processing:** It extracts the filter, pagination (offset/limit),
    and sorting parameters from the action configuration.

    3. **Validation:** It ensures that the `Offset` and `Limit` parameters are valid
    non-negative integers.

    4. **Data Retrieval:** It performs a GET request to the Infoblox `/api/ddi/v1/dhcp/lease`
    endpoint applying the filter and pagination logic.

    5. **Results Formatting:** The retrieved lease objects (containing address, hostname,
    hardware, state, and timestamps) are processed and converted into a flat CSV-compatible
    format for display.

    6. **Final Output:** The action populates the result JSON with the complete API
    response and generates a data table named 'DHCP Leases' for the user.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
DNS Record Lookup:
  ai_description: >-
    ### General Description

    Performs a DNS record query to retrieve associated IPs or domains from Infoblox
    DDI. This action allows users to search for specific DNS entries using flexible
    filtering criteria, pagination, and sorting. It is primarily used for visibility
    and inventory management of DNS records within the Infoblox environment.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | DNS Record Filter | String | No | Logical expression string for filtering DNS
    records (e.g., `type=="PTR" and absolute_zone_name == "Test"`). |

    | Tag Filter | String | No | Logical expression string for filtering by metadata
    tags (e.g., `'nios/federation_enabled'==true`). |

    | Offset | String | No | The pagination starting point. Defaults to "0". |

    | Limit | String | No | The maximum number of results to return per request. Defaults
    to "100". |

    | Order By | String | No | Comma-separated fields used to sort the results, supporting
    dot notation and ascending/descending directions. |


    ### Additional Notes

    - There are no mandatory parameters; providing no filters will result in a list
    of the first 100 records.

    - The action includes a table view showing up to 20 records for quick inspection.


    ### Flow Description

    1. **Initialization**: Retrieves integration configuration (API Root, Key) and
    extracts action parameters.

    2. **Validation**: Validates that `Offset` and `Limit` are non-negative integers.

    3. **API Request**: Connects to the Infoblox DDI API and performs a GET request
    to the DNS record endpoint with the defined filters and pagination logic.

    4. **Data Modeling**: Parses the API response into `DNSRecord` objects for structured
    processing.

    5. **Output Generation**: Adds the full raw JSON response to the result and constructs
    a CSV-formatted data table containing key fields such as Name, Type, TTL, and
    Status for the SOAR interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Custom List:
  ai_description: >-
    Retrieves the contents and metadata of custom lists from Infoblox Threat Defense.
    This action allows security analysts to fetch detailed information about specific
    named lists, which are used in security policies to block or allow traffic based
    on domains, IPs, or CIDRs.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Custom List ID | string | No | The unique numerical identifier of the Custom
    List to retrieve. |

    | Name | string | No | The specific name of the custom list. Used in conjunction
    with 'Type'. |

    | Type | string | No | The type of the custom list (default is 'custom_list').
    Used in conjunction with 'Name'. |

    | Tag Filter | string | No | Filter security policy by specific tags using the
    format: '<tag_name>'='<tag_value>'. |

    | Tag Sort Filter | string | No | Sort results by specific tags (e.g., 'Test1').
    |

    | Offset | string | No | The starting point for pagination (default is 0). |

    | Limit | string | No | The maximum number of results to return (default is 100).
    |


    ### Flow Description

    1. **Parameter Validation**: Validates the 'Offset', 'Limit', and 'Custom List
    ID' parameters to ensure they are valid non-negative integers.

    2. **API Interaction**: Communicates with the Infoblox API using one of three
    logic paths:
        * If a **Custom List ID** is provided, it fetches that specific list's details.
        * If both **Name** and **Type** are provided, it queries for the specific
    list by name.
        * Otherwise, it fetches all available custom lists using the provided pagination
    and tag filters.
    3. **Data Transformation**: Parses the raw API response into a structured `CustomList`
    data model, extracting fields like ID, name, description, confidence level, threat
    level, and item count.

    4. **Output Generation**: Adds the full raw JSON response to the action results
    and constructs a UI data table for easy viewing of the retrieved list details.


    ### Additional Notes

    * If 'Custom List ID' is provided, it takes precedence over 'Name' and 'Type'
    filters.

    * The table view is limited to the first 20 records for performance.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Indicator Intel Lookup Result:
  ai_description: "### General Description\nRetrieves the results of a previously\
    \ initiated Infoblox Dossier lookup job. This action allows users to fetch comprehensive\
    \ threat intelligence for indicators (IP addresses, URLs, hostnames, emails, or\
    \ file hashes) once an asynchronous Dossier analysis task has been completed.\n\
    \n### Parameters Description\n| Parameter | Type | Mandatory | Description |\n\
    | :--- | :--- | :--- | :--- |\n| Job ID | string | Yes | The unique identifier\
    \ of the Dossier lookup job to retrieve the results for. |\n\n### Flow Description\n\
    1. **Extraction**: The action extracts the `Job ID` parameter and integration\
    \ configuration (API Key, Root URL).\n2. **Validation**: It validates that the\
    \ `Job ID` is a non-empty string.\n3. **API Call**: Connects to the Infoblox TIDE\
    \ API to perform a GET request for results associated with the specific Job ID.\n\
    4. **Data Modeling**: Parses the API response into `IndicatorIntelLookupResult`\
    \ objects, truncating large JSON data fields for clean display.\n5. **Output**:\
    \ \n    - Adds the full raw API response to the action's JSON results.\n    -\
    \ Populates a data table titled 'Dossier Lookup Results' with key fields like\
    \ Source, Status, and Data (up to a maximum of 20 records).\n    - Provides a\
    \ status message indicating the number of results retrieved."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Network List:
  ai_description: >-
    Retrieves the contents and metadata of network lists from Infoblox Threat Defense.
    This action allows users to fetch a specific network list by its ID or a collection
    of network lists based on a logical filter expression. The results include details
    such as list names, descriptions, and associated security policy IDs. The action
    supports pagination through offset and limit parameters and outputs the data both
    as a raw JSON result and a formatted data table for visibility in the case wall.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Security Network Filter | String | No | A logical expression string used to
    filter the network lists (e.g., "name == 'list_name'"). |

    | Offset | String | No | The numeric offset from which to start pagination. Defaults
    to 0. |

    | Limit | String | No | The maximum number of network lists to return. Defaults
    to 100. |

    | Network List ID | String | No | The specific identifier of a network list. If
    provided, the action retrieves only this specific list and ignores the filter
    parameter. |


    ### Flow Description

    1. **Initialization**: The action extracts the API configuration (Root, Key, SSL)
    and the action parameters (ID, Filter, Offset, Limit).

    2. **Validation**: It validates that the numeric parameters (ID, Offset, Limit)
    are non-negative integers.

    3. **API Call**: It interacts with the Infoblox APIManager to perform a GET request
    to the network lists endpoint. If a Network List ID is specified, it requests
    that specific resource; otherwise, it applies the filter, offset, and limit queries.

    4. **Data Processing**: The response is parsed into a standardized NetworkList
    data model.

    5. **Output**: The action attaches the full API response as JSON and creates a
    data table containing the list details (ID, Name, Description, and Policy ID)
    for display. It concludes by providing a success message with the count of retrieved
    items.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get SOC Insights Assets:
  ai_description: >-
    ### General Description

    This action retrieves a list of associated assets for a specific SOC Insight ID
    from Infoblox Threat Defense. It allows security analysts to understand which
    network assets (devices, users, etc.) are involved in a specific threat detection
    event by querying the Infoblox API.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Insight ID | String | Yes | The unique identifier of the SOC insight to retrieve
    assets for. |

    | Asset IP | String | No | Filter the returned assets by a specific IP address.
    |

    | MAC Address | String | No | Filter the returned assets by a specific MAC address.
    |

    | OS Version | String | No | Filter the returned assets by the operating system
    version. |

    | User | String | No | Filter the returned assets by the associated username.
    |

    | Limit | String | No | The maximum number of results to return (Default is 100).
    |

    | From | String | No | Filter by assets changed after this time (Format: YYYY-MM-DDTHH:mm:ss.SSS).
    |

    | To | String | No | Filter by assets changed before this time (Format: YYYY-MM-DDTHH:mm:ss.SSS).
    |


    ### Flow Description

    1. **Parameter Initialization**: The action extracts the Insight ID and optional
    filtering parameters (IP, MAC, OS, User, Time range, and Limit).

    2. **Validation**: It validates that the Insight ID is provided and that the 'Limit'
    is a valid positive integer.

    3. **API Interaction**: The action uses the Infoblox APIManager to perform a GET
    request to the SOC Insights endpoint specifically for assets related to the provided
    ID.

    4. **Data Processing**: If assets are found, they are mapped to the `SOCInsightAsset`
    data model. The action produces a raw JSON result and a structured data table.

    5. **Output**: A summary message is returned to the case wall indicating the number
    of assets retrieved, and the asset details are presented in the "Assets" data
    table.


    ### Additional Notes

    - If no assets match the provided criteria or the Insight ID, the action will
    return a successful result with an informative message stating no assets were
    found.

    - The data table displayed in the case wall is limited to a maximum of 20 records
    to maintain readability.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get SOC Insights Comments:
  ai_description: >-
    ### General Description

    The **Get SOC Insights Comments** action retrieves a list of comments associated
    with a specific Security Operations Center (SOC) Insight from Infoblox Threat
    Defense. This action is used to gather contextual information and history for
    a given threat insight, allowing analysts to see previous notes or status changes
    recorded within the Infoblox platform.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Insight ID** | String | Yes | The unique identifier of the Infoblox SOC Insight
    from which comments should be retrieved. |

    | **From** | String | No | Filter to retrieve comments changed after this specific
    time. Format: `YYYY-MM-DDTHH:mm:ss.SSS`. |

    | **To** | String | No | Filter to retrieve comments changed before this specific
    time. Format: `YYYY-MM-DDTHH:mm:ss.SSS`. |


    ### Additional Notes

    - If no comments are found for the provided ID, the action will complete successfully
    with an informative message.

    - The action displays a maximum of 20 comments in the data table for readability,
    though the full response is available in the JSON result.


    ### Flow Description

    1. **Initialization**: The action initializes connection parameters (API Root,
    API Key) and extracts user-provided inputs including the Insight ID and optional
    time filters.

    2. **Validation**: It ensures the mandatory `Insight ID` parameter is provided
    and not empty.

    3. **API Request**: The action calls the Infoblox API GET endpoint for insight
    comments using the provided ID and filters.

    4. **Data Processing**: The response is parsed. If comments exist, they are mapped
    to a structured format including fields like 'Comment Changer', 'Date Changed',
    'New Comment', and 'Status'.

    5. **Output**: The action populates a UI data table named 'SOC Insight Comments'
    with the retrieved notes and attaches the full JSON response to the action results.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get SOC Insights Events:
  ai_description: "### General Description\nThis action retrieves a list of events\
    \ associated with a specific SOC Insight ID from Infoblox Threat Defense. It allows\
    \ users to gain granular visibility into the individual security events that triggered\
    \ or are related to a broader SOC insight. The action supports extensive filtering\
    \ capabilities, including device IP, DNS query types, threat intelligence sources,\
    \ indicators, and severity/confidence levels.\n\n### Parameters Description\n\
    | Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n\
    | Insight ID | String | Yes | The unique identifier of the SOC insight to retrieve\
    \ events for. |\n| Device IP | String | No | Filter events by the IP address of\
    \ the device involved. |\n| Query | String | No | Filter by a specific query string.\
    \ |\n| Query Type | String | No | Filter by DNS query type (e.g., TXT, A, MX).\
    \ |\n| Source | String | No | Filter by the threat intelligence source or feed\
    \ (e.g., DFP). |\n| Indicator | String | No | Filter by a specific threat indicator\
    \ (domain, IP, or hash). |\n| Threat Level | DDL | No | Filter by threat level.\
    \ Options: All, Info, Low, Medium, High. Default is All. |\n| Confidence Level\
    \ | DDL | No | Filter by confidence level. Options: All, Low, Medium, High. Default\
    \ is All. |\n| Limit | String | No | The maximum number of results to return.\
    \ Default is 100. |\n| From | String | No | Filter events detected after this\
    \ time (YYYY-MM-DDTHH:mm:ss.SSS). |\n| To | String | No | Filter events detected\
    \ before this time (YYYY-MM-DDTHH:mm:ss.SSS). |\n\n### Additional Notes\n- The\
    \ `Limit` parameter is validated as a positive integer. \n- The action provides\
    \ a summary table on the Case Wall containing key details like Device Name, Action,\
    \ and Threat Family for the first 20 records retrieved.\n- This action does not\
    \ operate on entities; it is a utility action driven by the `Insight ID` parameter.\n\
    \n### Flow Description\n1. **Initialization**: The action extracts integration\
    \ configuration (API Root, Key) and all action parameters.\n2. **Validation**:\
    \ It ensures the `Insight ID` is present and validates the `Limit` parameter to\
    \ ensure it is a positive integer.\n3. **API Request**: The `APIManager` constructs\
    \ a GET request to the `/api/v1/insights/{insight_id}/events` endpoint, applying\
    \ all provided filters.\n4. **Data Processing**: The raw JSON response is parsed.\
    \ If events are found, they are mapped to the `SOCInsightEvent` data model.\n\
    5. **Output Generation**: \n   - A data table named \"SOC Insight Events\" is\
    \ created for the Case Wall.\n   - The full JSON payload is added to the action\
    \ results.\n   - A summary message indicating the number of events retrieved is\
    \ returned."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get SOC Insights Indicators:
  ai_description: >-
    ### General Description

    Retrieve the list of indicators available for a specific SOC insight in Infoblox
    Threat Defense. This action allows security analysts to examine the specific threat
    indicators (such as IP addresses or domains) that are associated with an insight,
    providing context on threat actors, confidence levels, and mitigation actions
    taken.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Insight ID** | String | Yes | The unique identifier of the SOC insight to
    retrieve indicators from. |

    | **Confidence** | String | No | Filter indicators by their confidence score.
    |

    | **Indicator** | String | No | Filter by a specific indicator value (e.g., a
    specific domain or IP). |

    | **Actor** | String | No | Filter results by a specific threat actor. |

    | **From** | String | No | Filter indicators seen after this time (Format: YYYY-MM-DDTHH:mm:ss.SSS).
    |

    | **To** | String | No | Filter indicators seen before this time (Format: YYYY-MM-DDTHH:mm:ss.SSS).
    |

    | **Action** | String | No | Filter by the specific action taken (e.g., blocked,
    allowed). |

    | **Limit** | String | No | Specify the maximum number of results to return. Default
    is 100. |


    ### Flow Description

    1. **Parameter Setup:** The action initializes by extracting the mandatory Insight
    ID and optional filtering parameters like Confidence, Actor, and Time ranges.

    2. **Validation:** It validates that the Insight ID is a non-empty string and
    ensures the 'Limit' parameter is a valid positive integer.

    3. **API Interaction:** The script calls the Infoblox APIManager to execute a
    GET request against the insight indicators endpoint.

    4. **Data Processing:** The response is parsed, and individual indicators are
    mapped to the SOCInsightIndicator data model.

    5. **Output Generation:** The action creates a structured data table named 'SOC
    Insight Indicators' containing the flattened results and provides the full raw
    JSON response for downstream use.


    ### Additional Notes

    - The action will report a successful completion even if no indicators are found,
    provided the Insight ID is valid.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Get Security Policies:
  ai_description: >-
    # General Description

    Retrieves all configured security policies and their metadata from the Infoblox
    Threat Defense platform. This action allows for filtering and sorting of policies
    based on names, criteria, and tags, providing a structured overview of the current
    security posture.


    # Parameters Description

    | Parameter Name | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Security Policy Filter | String | No | A logical expression string to filter
    security policies (e.g., `name== 'sec_policy_a'`). |

    | Tag Filter | String | No | Filter security policy by specific tags in the format:
    `'<tag_name>'='<tag_value>'`. |

    | Tag Sort Filter | String | No | Sort security policy list by Tags. |

    | Offset | String | No | Specify the offset from where to start pagination. Default
    is "0". |

    | Limit | String | No | Specify the maximum number of results to return. Default
    is "100". |


    # Flow Description

    1. **Initialize**: Extracts integration configuration and action parameters.

    2. **Validate**: Ensures the Offset and Limit parameters are valid non-negative
    integers.

    3. **API Interaction**: Calls the Infoblox API to fetch security policies using
    the provided filters and pagination settings.

    4. **Data Modeling**: Parses the API response and maps raw data to a structured
    Security Policy data model.

    5. **Output Generation**:
        * Adds the complete JSON response to the action results.
        * Constructs a data table containing metadata (ID, Name, Description, Default
    Action) for up to the first 20 records.
    6. **Finalize**: Returns a success message with the count of retrieved policies.


    # Additional Notes

    * This action does not run on entities and is used for global configuration retrieval.

    * Only the first 20 records are displayed in the UI data table, but the full response
    is available in the JSON result.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Host Lookup:
  ai_description: >-
    ### General Description

    The **Host Lookup** action retrieves detailed host information from Infoblox IPAM
    (IP Address Management). It allows security analysts to search for host asset
    records based on specific filters such as hostnames, IP addresses, or associated
    tags. This action is primarily used for asset discovery and contextual enrichment
    during investigation phases.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Host Filter** | String | No | A logical expression used to filter hosts by
    specific criteria (e.g., `name=="webserver01"` or `ip_address=="192.168.1.100"`).
    |

    | **Tag Filter** | String | No | Filter hosts based on specific Infoblox tags
    (e.g., `'Tenable_scan'=='true'`). |

    | **Offset** | String | No | The starting point for pagination. Defaults to "0".
    |

    | **Limit** | String | No | The maximum number of results to retrieve in a single
    request. Defaults to "100". |

    | **Order By** | String | No | Comma-separated fields to sort the results. Supports
    `asc` or `desc` suffixes and dot notation for nested fields. |


    ### Additional Notes

    * This action does not require input entities to run; it operates based on the
    provided filter parameters.

    * Results are displayed in a formatted data table named "Hosts" (up to a maximum
    of 20 records for visibility) and provided as raw JSON for further automation
    steps.


    ### Flow Description

    1.  **Parameter Extraction**: The action extracts the search filters (Host/Tag)
    and pagination settings (Offset/Limit).

    2.  **Validation**: Validates that the Offset and Limit parameters are non-negative
    integers.

    3.  **API Request**: Executes a GET request to the Infoblox `/api/ddi/v1/ipam/host`
    endpoint using the provided filters.

    4.  **Data Processing**: Parses the host records returned by Infoblox.

    5.  **Output Generation**: Adds the full raw response to the action results and
    constructs a data table summarizing key host details like Name, IP Address, Space,
    and Tags.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
IP Lookup:
  ai_description: >-
    ### General Description

    This action retrieves detailed IP address information from the Infoblox DDI platform.
    It allows users to perform lookups and searches for IP records within the IP Address
    Management (IPAM) module using various filters such as IP state, tags, and specific
    scopes. The action is primarily used for investigative purposes to identify the
    status, ownership, and history of IP addresses managed within Infoblox.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | IP Filter | String | No | A logical expression used to filter IP addresses (e.g.,
    address=="192.168.1.100" or state=="USED"). |

    | Address State | DDL | No | Filters results by the current state of the IP address.
    Options include 'Any', 'Free', and 'Used'. Defaults to 'Used'. |

    | Scope | String | No | Limits the lookup to a specific scope within the Infoblox
    environment. |

    | Tag Filter | String | No | Filters IP addresses based on specific metadata tags
    assigned in Infoblox (e.g., 'Tenable_scan'=='true'). |

    | Offset | String | No | The starting point for pagination in the result set.
    Defaults to 0. |

    | Limit | String | No | The maximum number of records to return in a single execution.
    Defaults to 100. |

    | Order By | String | No | Determines the sorting order of the results. Supports
    dot notation and 'asc'/'desc' suffixes. |


    ### Additional Notes

    - This action does not run on specific case entities; it is a search-based lookup
    that retrieves data based on the provided input parameters.

    - Results are limited to a maximum of 20 records for the case wall data table
    representation, although the full JSON result will contain all retrieved records
    up to the specified limit.


    ### Flow Description

    1.  **Parameter Extraction:** The action extracts integration configuration (API
    root, API key) and user-provided search parameters.

    2.  **Validation:** It validates the 'Offset' and 'Limit' parameters to ensure
    they are non-negative integers.

    3.  **API Execution:** It initializes the Infoblox API Manager and performs a
    GET request to the IPAM address endpoint (`/api/ddi/v1/ipam/address`) using the
    constructed query parameters.

    4.  **Data Processing:** The raw API response is parsed, and each record is mapped
    to the `IPLookup` data model.

    5.  **Output Generation:** The action adds the full raw JSON to the execution
    results and constructs a CSV-formatted data table for the Siemplify case wall,
    displaying key fields like Address, Hostname, State, and Protocol.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: true
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Indicator Threat Lookup With TIDE:
  ai_description: >-
    ### General Description

    This action retrieves threat intelligence details for specific indicators from
    the Infoblox TIDE (Threat Intelligence Data Exchange) service. It allows users
    to query threat records based on indicator values (IP, Host, URL, Email, Hash)
    or broader criteria like domains, TLDs, and threat classes. The results include
    details such as threat levels, threat classes, profiles, and detection status,
    which are returned as a raw JSON object and a formatted data table.


    ### Parameters Description


    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | **Indicator Type** | Dropdown | No | Specifies the category of indicator to
    search for. Options include 'All', 'IP', 'Host', 'URL', 'Email', and 'Hash'. Default
    is 'All'. |

    | **Indicator Value** | String | No | The specific value (e.g., an IP address
    or domain) to search for if a specific 'Indicator Type' is selected. |

    | **Domain** | String | No | A comma-separated list of domains to search for within
    TIDE threat data. |

    | **Top-Level Domain** | String | No | A comma-separated list of Top-Level Domains
    (TLDs) to search for. |

    | **Threat Class** | String | No | A comma-separated list of threat classes (e.g.,
    'malware', 'phishing') to filter the results. |

    | **Target** | String | No | A comma-separated list of targets associated with
    the threat data. |

    | **Expiration** | String | No | Filters results by a specific period of time
    after which data is no longer considered active. |

    | **Limit** | String | No | The maximum number of threat records to return. Default
    is 1000. |


    ### Additional Notes

    - If **Indicator Type** is set to 'All', the **Indicator Value** parameter is
    ignored by the API logic.

    - The action creates a data table named 'TIDE Indicator Threat Lookup Results'
    containing up to 20 of the most relevant records for quick review.


    ### Flow Description

    1. **Extraction**: The action extracts the integration configuration (API root,
    key, SSL settings) and the user-provided action parameters.

    2. **Validation**: The 'Limit' parameter is validated to ensure it is a positive
    integer.

    3. **API Request**: The action constructs a GET request to the Infoblox TIDE `/tide/api/data/threats`
    endpoint using the provided filters and indicator details.

    4. **Processing**: The API response is parsed, and individual threat records are
    converted into flat data models for reporting.

    5. **Output**: The raw API response is attached to the action as a JSON result.
    If records are found, a CSV-formatted data table is added to the case context
    for visualization.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
"Initiate Indicator Intel Lookup With Dossier":
  ai_description: "### General Description\nThe **Initiate Indicator Intel Lookup\
    \ With Dossier** action initiates a threat intelligence investigation for a specific\
    \ indicator (IP, URL, Host, Email, or Hash) using the Infoblox Dossier service.\
    \ It allows users to query specific threat intelligence sources and can either\
    \ return a Job ID for an asynchronous lookup or wait to retrieve the full dossier\
    \ results immediately.\n\n### Parameters Description\n\n| Parameter | Type | Mandatory\
    \ | Description |\n| :--- | :--- | :--- | :--- |\n| **Indicator Type** | ddl |\
    \ Yes | Specifies the type of indicator to search for. Options: Host, IP, URL,\
    \ Email, Hash. |\n| **Indicator Value** | string | Yes | The actual value of the\
    \ indicator (e.g., an IP address or domain name) to be investigated. |\n| **Source**\
    \ | string | No | A comma-separated list of specific Infoblox sources to query.\
    \ If left empty, all default sources are used. |\n| **Wait for Results** | boolean\
    \ | No | If set to `true`, the action will wait for the Dossier lookup to finish\
    \ and return the full results. If `false` (default), it returns a Job ID and status\
    \ immediately. |\n\n### Flow Description\n1. **Initialization:** The action retrieves\
    \ integration configuration (API Root, Key) and extracts the user-provided parameters:\
    \ Indicator Type, Value, Source, and the Wait flag.\n2. **Validation:** It ensures\
    \ the `Indicator Value` is a non-empty string and cleans the `Source` parameter\
    \ if provided.\n3. **API Interaction:** The script calls the Infoblox APIManager\
    \ to perform a `GET` request to the Dossier lookup endpoint. It passes the indicator\
    \ type in the URL and the value/sources as query parameters. If `Wait for Results`\
    \ is enabled, a `wait=true` parameter is added to the API call.\n4. **Processing\
    \ Results:** \n    * If **Wait for Results** is `true`: The script parses the\
    \ list of dossier records, truncates the JSON data for display purposes, and prepares\
    \ a detailed data table containing the source, status, data, time, and version\
    \ for each result.\n    * If **Wait for Results** is `false`: The script retrieves\
    \ the `job_id` and current status from the API response and prepares a summary\
    \ data table.\n5. **Output:** The action adds the raw API response as a JSON result\
    \ to the action and creates a data table titled \"Dossier Lookup Results\" in\
    \ the Google SecOps interface.\n\n### Additional Notes\n* This action does not\
    \ automatically run on case entities; it requires the user to provide the indicator\
    \ value manually as a parameter.\n* If the lookup returns no results, the action\
    \ completes with a message stating \"No dossier data found.\""
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: true
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Ping:
  ai_description: >-
    ### General Description

    Tests the connectivity between the Google SecOps platform and the Infoblox Threat
    Defense with DDI instance. It verifies that the provided API credentials and Root
    URL are correct and that the network connection is functional.


    ### Parameters Description

    There are no parameters for this action.


    ### Additional Notes

    This action is primarily used for validating integration setup and troubleshooting
    network or authentication issues. It performs a basic authenticated GET request
    to the Infoblox account management endpoint.


    ### Flow Description

    1. **Initialization**: The action retrieves global integration configuration parameters
    including the API Root, API Key, and SSL verification settings.

    2. **Manager Setup**: It initializes the Infoblox `APIManager`, which configures
    a session with the required authorization tokens.

    3. **Connectivity Test**: It executes the `test_connectivity` method, making a
    GET request to the account endpoint (`/api/authn/v1/account`).

    4. **Result Handling**: If the request is successful, it returns a confirmation
    message and a success status. If an exception occurs (e.g., 401 Unauthorized or
    404 Not Found), it logs the error and returns a failure message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: false
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: null
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Custom List:
  ai_description: >-
    Deletes a specific custom list from the Infoblox Threat Defense system using its
    unique identifier. This action allows administrators to programmatically remove
    named lists that are no longer required for security policies or threat intelligence
    tracking.


    ### Parameters

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Custom List ID | string | Yes | The unique numerical identifier of the custom
    list to be removed. The action validates that this is a positive non-zero integer.
    |


    ### Flow Description

    1. **Initialization**: Retrieves Infoblox API configuration (Root URL, API Key)
    and the mandatory `Custom List ID` parameter.

    2. **Validation**: Checks if the provided ID is a valid positive integer.

    3. **Execution**: Sends a DELETE request to the Infoblox API endpoint (`/api/atcfw/v1/named_lists/{custom_list_id}`).

    4. **Handling Results**: If the API returns a success status, the action completes
    successfully. If the ID is not found or a server error occurs, it catches the
    exception and fails with a descriptive error message.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Permanently deletes a custom list resource from the external Infoblox Threat
      Defense system using a REST DELETE request.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Network List:
  ai_description: >-
    ### General Description

    Removes an existing network list from the Infoblox Threat Defense with DDI environment.
    This action is used to clean up or manage network configurations by deleting specific
    lists identified by their unique IDs.


    ### Parameters Description

    | Parameter | Description | Type | Mandatory |

    | :--- | :--- | :--- | :--- |

    | Network List ID | The unique numerical identifier of the network list that needs
    to be deleted from the system. | String | Yes |


    ### Flow Description

    1. **Initialization**: The action initializes the connection using the provided
    Infoblox API Root and API Key.

    2. **Parameter Extraction**: It retrieves the 'Network List ID' provided by the
    user.

    3. **Validation**: The script validates that the 'Network List ID' is a valid
    positive integer. If the ID is invalid (e.g., negative or zero), the action fails
    with a descriptive error.

    4. **Execution**: The action sends a DELETE request to the Infoblox API targeting
    the specific network list resource.

    5. **Completion**: If the deletion is successful, the action returns a completion
    status and a success message. If the API returns an error (e.g., the list is in
    use or doesn't exist), it logs the error and fails.


    ### Additional Notes

    - This action is destructive and cannot be undone via the SOAR platform.

    - The 'Network List ID' must be a positive integer; strings or symbols will result
    in a validation error.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Performs a DELETE request to the Infoblox API to remove a network list resource
      from the external environment.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Remove Security Policy:
  ai_description: "Deletes a specified security policy from Infoblox Threat Defense.\
    \ This action is primarily used to unblock indicators or clean up outdated security\
    \ configurations by removing the policy associated with a specific ID. \n\n###\
    \ General Description\nThis action interacts with the Infoblox Threat Defense\
    \ API to permanently remove a security policy. It requires a specific Policy ID\
    \ as input and performs a DELETE operation on the external system. This is a management/remediation\
    \ action and does not perform data enrichment on entities within the SOAR platform.\n\
    \n### Parameters Description\n\n| Parameter Name | Description | Type | Mandatory\
    \ |\n| :--- | :--- | :--- | :--- |\n| Security Policy ID | The unique identifier\
    \ of the security policy to be deleted. The value must be a positive integer.\
    \ | String | Yes |\n\n### Flow Description\n1. **Param Init**: The action retrieves\
    \ integration configuration (API Root, API Key) and the mandatory 'Security Policy\
    \ ID' parameter.\n2. **Validation**: The script validates that the Security Policy\
    \ ID is a non-empty string and converts it to a positive integer. If validation\
    \ fails, the action terminates with an error.\n3. **API Execution**: An APIManager\
    \ instance is created to send a DELETE request to the Infoblox security policies\
    \ endpoint using the provided ID.\n4. **Finalization**: If the API call is successful,\
    \ the action returns a success message and sets the result value to true. If an\
    \ error occurs (e.g., policy not found or network error), it captures the exception\
    \ and reports failure.\n\n### Additional Notes\n- This action does not operate\
    \ on SOAR entities; it works exclusively based on the provided parameter ID.\n\
    - Deletion is permanent and cannot be undone through this action."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Removes a security policy configuration from Infoblox Threat Defense via a DELETE
      request to the /api/atcfw/v1/security_policies/ endpoint.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Custom List:
  ai_description: >-
    ### General Description

    Modifies the metadata and configuration of an existing custom list in Infoblox
    Threat Defense. This action is used to update parameters like the list name, description,
    confidence level, threat level, and associated tags. It ensures that any fields
    not provided in the update request are preserved by first fetching the current
    state of the custom list.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Custom List ID | string | Yes | Specify the unique ID of the custom list to
    update. This must be a positive integer. |

    | Name | string | No | Specify the new name for the custom list. If omitted, the
    existing name is kept. |

    | Description | string | No | Specify the new description. Use the keyword `empty`
    to remove the existing description. |

    | Confidence Level | ddl | No | Specify the confidence level (High, Medium, Low).
    |

    | Threat Level | ddl | No | Specify the threat level (High, Medium, Low, Info).
    |

    | Tags | string | No | Add tags as a JSON object string (e.g., `{"key": "value"}`).
    Use the keyword `empty` to remove existing tags. |


    ### Additional Notes

    - This action performs a stateful update (PUT) on the Infoblox platform.

    - It first performs a GET request to retrieve the current object so that fields
    not specified in the action parameters are not overwritten with null values.


    ### Flow Description

    1. **Initialization**: Retrieves integration configuration (API Key, Root, SSL)
    and validates the mandatory `Custom List ID` parameter.

    2. **Context Retrieval**: Calls the Infoblox API to fetch the current configuration
    of the specified custom list.

    3. **Payload Construction**: Merges the provided input parameters with the existing
    data. It handles the `empty` keyword for nullable fields like Description and
    Tags.

    4. **Update Execution**: Sends a PUT request to the Infoblox endpoint with the
    merged payload to apply changes.

    5. **Output**: Returns the full updated list object as a JSON result and populates
    a data table named 'Custom List Details' for display in the Google SecOps case
    wall.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the configuration of an existing custom list in the Infoblox Threat
      Defense platform, including metadata such as name, threat level, and tags.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Custom List Items:
  ai_description: "### General Description\nThe 'Update Custom List Items' action\
    \ modifies the contents of an existing custom list within the Infoblox Threat\
    \ Defense platform. It allows security analysts to dynamically add or remove indicators,\
    \ such as IPv4 addresses, IPv6 addresses, and domain names, from specified lists.\
    \ This is particularly useful for automated blocking or allowlisting workflows\
    \ where indicators are identified during an investigation and need to be operationalized\
    \ in the security infrastructure.\n\n### Parameters Description\n| Parameter |\
    \ Type | Mandatory | Description |\n| :--- | :--- | :--- | :--- |\n| **Custom\
    \ List ID** | string | Yes | The unique identifier of the Infoblox Custom List\
    \ you want to modify. The value must be a positive integer. |\n| **Action** |\
    \ ddl | Yes | Defines the operation to perform on the list. Options are 'Add'\
    \ to insert new indicators or 'Remove' to delete existing ones. |\n| **Items**\
    \ | string | Yes | A comma-separated list of indicators (IPv4, IPv6, or domains)\
    \ to be updated in the list. |\n\n### Flow Description\n1. **Parameter Initialization:**\
    \ The action retrieves configuration details (API Root, API Key) and user-provided\
    \ parameters (Custom List ID, Action, and Items).\n2. **Validation:** \n    -\
    \ Validates that 'Custom List ID' is a positive integer.\n    - Parses the 'Items'\
    \ string into a list and ensures it is not empty.\n    - Runs a regex validation\
    \ on each item to ensure it is a valid IPv4, IPv6, or domain name.\n3. **API Request:**\
    \ Constructs a `PATCH` request to the Infoblox `/api/atcfw/v1/named_lists/{custom_list_id}/items`\
    \ endpoint. The body of the request includes either `inserted_items_described`\
    \ or `deleted_items_described` based on the selected 'Action'.\n4. **Result Processing:**\
    \ The action parses the API response to determine how many items were successfully\
    \ added, removed, or updated.\n5. **Output:** Provides a summary message to the\
    \ Google SecOps case wall and attaches the raw JSON response from Infoblox to\
    \ the action results.\n\n### Additional Notes\n- This action does not interact\
    \ with SOAR entities directly; it operates solely based on the provided input\
    \ parameters.\n- If the provided indicators are already present (when adding)\
    \ or missing (when removing), the Infoblox API will return a successful response\
    \ with zero changes, which the action reports as 'No items were added, removed,\
    \ or updated'."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Adds or removes indicators (IPs/domains) from an existing Infoblox custom list
      using a PATCH request to the Infoblox API.
    fetches_data: false
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Network List:
  ai_description: "Updates the properties of an existing Network List in Infoblox\
    \ Threat Defense. This action allows for modifying the name, items (such as IP\
    \ addresses or CIDRs), and the description of a specific list identified by its\
    \ ID. It intelligently merges new inputs with existing data to ensure fields not\
    \ provided in the action parameters remain unchanged. \n\n### Parameters Description:\n\
    \n| Parameter | Type | Mandatory | Description |\n| :--- | :--- | :--- | :---\
    \ |\n| Network List ID | string | Yes | The unique identifier of the network list\
    \ to be updated. Must be a positive integer. |\n| Name | string | No | The new\
    \ name for the network list. If left blank, the existing name is preserved. |\n\
    | Items | string | No | A comma-separated list of items (e.g., IP addresses, CIDR\
    \ blocks) to be included in the network list. If left blank, the existing items\
    \ are preserved. |\n| Description | string | No | The new description for the\
    \ network list. If left blank, the existing description is preserved. Use the\
    \ keyword `empty` to explicitly clear the current description. |\n\n### Additional\
    \ Notes:\n- The action first performs a fetch operation to retrieve the current\
    \ state of the Network List before applying updates. This ensures that only the\
    \ fields specified by the user are modified.\n- If a parameter is not provided,\
    \ the action defaults to the current value stored in Infoblox.\n\n### Flow Description:\n\
    1. **Initialization**: The action initializes the Infoblox API manager and extracts\
    \ the user-provided parameters.\n2. **Validation**: Validates that the 'Network\
    \ List ID' is a valid positive integer.\n3. **Data Retrieval**: Fetches the current\
    \ configuration of the specified Network List from Infoblox to identify existing\
    \ values.\n4. **Payload Construction**: Builds the update payload by merging the\
    \ provided parameters with existing data. If the 'Description' is set to `empty`,\
    \ it is converted to an empty string.\n5. **API Update**: Sends a PUT request\
    \ to the Infoblox API to update the Network List.\n6. **Results**: Returns the\
    \ updated Network List details as a JSON object and populates a 'Network List\
    \ Details' data table in the Google SecOps case."
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the configuration (name, items, or description) of a Network List on
      the Infoblox Threat Defense platform via a PUT request.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
Update Security Policy:
  ai_description: >-
    ### General Description

    Updates an existing security policy's configurations or linked lists in Infoblox
    Threat Defense. This action allows for comprehensive modification of policy settings
    including basic metadata, network associations, security rules, and advanced parameters
    like DNS rebinding protection and safe search.


    ### Parameters Description

    | Parameter | Type | Mandatory | Description |

    | :--- | :--- | :--- | :--- |

    | Security Policy ID | string | True | The unique identifier of the security policy
    to update. Must be a positive integer. |

    | Policy Name | string | False | Updated name for the security policy. |

    | Description | string | False | Updated description. Use the keyword `empty`
    to clear the description. |

    | Network Lists | string | False | Comma-separated list of network IDs to associate
    with the policy. Use `empty` to remove associations. |

    | DFPS | string | False | Comma-separated list of Default Forwarding Policies
    (DFPs) to update. Use `empty` to remove. |

    | Roaming Device Groups | string | False | Comma-separated list of Roaming Device
    Group IDs. Use `empty` to remove. |

    | Rules | string | False | A JSON array of rule objects. Each object should include
    action, type, and data. Use `empty` to clear all rules. |

    | Safe Search | ddl | False | Enable (True) or disable (False) safe search filtering.
    |

    | Block DNS Rebinding | ddl | False | Enable (True) or disable (False) DNS rebinding
    attack protection. |

    | Tags | string | False | A JSON object string containing tags to categorize the
    policy. |

    | Additional Parameters | string | False | A JSON object for advanced parameters
    such as `precedence`, `access_codes`, `doh_enabled`, etc. |


    ### Additional Notes

    - The action performs a "merge" update: it first fetches the current state of
    the policy and only overrides fields provided in the action parameters. Fields
    not provided will retain their existing values.

    - The keyword `empty` is specifically handled for `Description`, `Network Lists`,
    `DFPS`, `Roaming Device Groups`, and `Rules` to allow explicit clearing of these
    fields.


    ### Flow Description

    1. **Initialization:** Retrieves API configuration and validates the mandatory
    `Security Policy ID` as a valid integer.

    2. **State Retrieval:** Fetches the current configuration of the security policy
    from Infoblox to ensure that fields not being updated are preserved.

    3. **Payload Construction:** Merges the user-provided parameters with the existing
    policy data. It handles keyword-based clearing (`empty`) and parses JSON structures
    for rules, tags, and additional parameters.

    4. **API Execution:** Sends a PUT request to the Infoblox API to apply the updates.

    5. **Reporting:** Returns the updated policy data in JSON format and populates
    a data table named "Security Policy Details" in the Google SecOps interface.
  capabilities:
    can_create_case_comments: false
    can_create_case_wall_logs: false
    can_create_insight: false
    can_mutate_external_data: true
    can_mutate_internal_data: false
    can_update_entities: false
    external_data_mutation_explanation: >-
      Updates the configuration of a security policy in Infoblox Threat Defense, which
      may change network access controls, DNS filtering rules, and device group associations.
    fetches_data: true
    internal_data_mutation_explanation: null
  categories:
    enrichment: false
  entity_usage:
    entity_scopes: []
    filters_by_additional_properties: false
    filters_by_alert_identifier: false
    filters_by_case_identifier: false
    filters_by_creation_time: false
    filters_by_entity_type: false
    filters_by_identifier: false
    filters_by_is_artifact: false
    filters_by_is_enriched: false
    filters_by_is_internal: false
    filters_by_is_pivot: false
    filters_by_is_suspicious: false
    filters_by_is_vulnerable: false
    filters_by_modification_time: false
