name: Execute Custom Search
description: Execute custom search in Darktrace.
integration_identifier: Darktrace
parameters:
-   name: Query
    default_value: ''
    type: string
    description: Specify the query that needs to be executed.
    is_mandatory: true
-   name: Time Frame
    default_value: Last Hour
    type: ddl
    optional_values:
    - Last Hour
    - Last 6 Hours
    - Last 24 Hours
    - Last Week
    - Last Month
    - Alert Time Till Now
    - 5 Minutes Around Alert Time
    - 30 Minutes Around Alert Time
    - 1 Hour Around Alert Time
    - Custom
    description: Specify a time frame for the results. If "Custom" is selected, you
        also need to provide "Start Time". If "Alert Time Till Now" is selected, action
        will use start time of the alert as start time for the search and end time
        will be current time. If "30 Minutes Around Alert Time" is selected, action
        will search the alerts 30 minutes before the alert happened till the 30 minutes
        after the alert has happened. Same idea applies to "1 Hour Around Alert Time"
        and "5 Minutes Around Alert Time"
    is_mandatory: false
-   name: Start Time
    default_value: ''
    type: string
    description: 'Specify the start time for the results. This parameter is mandatory,
        if "Custom" is selected for the "Time Frame" parameter. Format: ISO 8601'
    is_mandatory: false
-   name: End Time
    default_value: ''
    type: string
    description: 'Specify the end time for the results. Format: ISO 8601. If nothing
        is provided and "Custom" is selected for the "Time Frame" parameter then this
        parameter will use current time.'
    is_mandatory: false
-   name: Max Results To Return
    default_value: 50
    type: string
    description: 'Specify how many results to return. Default: 50.'
    is_mandatory: false
dynamic_results_metadata:
-   result_example_path: resources/execute_custom_search_JsonResult_example.json
    result_name: JsonResult
    show_result: true
creator: admin
