{
  "CategoryName": "Blocks Enrichment",
  "OverviewTemplatesDetails": [],
  "WidgetTemplates": [],
  "Definition": {
    "Identifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
    "IsEnable": true,
    "Version": 0.0,
    "IsArchived": false,
    "IsAutomatic": false,
    "Name": "AWS Enrichment",
    "Category": 7,
    "Description": "An embedded workflow that can receive inputs and return an output.",
    "Priority": 2,
    "Creator": "e22b1df1-d620-4af5-ba42-d29e1b73bfe9",
    "VersionCreator": null,
    "VersionComment": null,
    "OriginalWorkflowIdentifier": "8456e86c-2a38-45a0-900a-f5fdada8a4b5",
    "TemplateName": null,
    "PlaybookType": 1,
    "IsDebugMode": false,
    "DebugBaseAlertIdentifier": null,
    "DebugAlertIdentifier": null,
    "SimulationClone": false,
    "DefaultAccessLevel": 2,
    "CreationSource": 1,
    "Steps": [
      {
        "Identifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
        "OriginalStepIdentifier": "a3a0c51e-4512-4b9a-bdce-f9bab0d0fa15",
        "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
        "ParentStepIdentifiers": [],
        "ParentStepIdentifier": "",
        "PreviousResultCondition": "{}",
        "InstanceName": "AWS EC2 Filter",
        "IsAutomatic": true,
        "Name": "Entity Selection",
        "IsSkippable": false,
        "Description": "Creates a group of entities that can be used in other actions. Use conditions to fine tune the group.",
        "ActionProvider": "Flow",
        "ActionName": "EntitySelection",
        "Type": 0,
        "Integration": "Flow",
        "Parameters": [
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "ConditionOperator",
            "Value": "0"
          },
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "Conditions",
            "Value": "[{\"FieldName\":\"Entity.Identifier\",\"Operator\":1,\"Value\":\"ARN:AWS:EC2\",\"Type\":2}]"
          },
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": false,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "2397d158-0beb-457b-99e8-a0cedd1c26d1",
        "OriginalStepIdentifier": "84804d50-d1f7-4069-bb3b-84c735a221a3",
        "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
        "ParentStepIdentifiers": [
          "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d"
        ],
        "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
        "PreviousResultCondition": "{}",
        "InstanceName": "Output_1",
        "IsAutomatic": true,
        "Name": "Output",
        "IsSkippable": false,
        "Description": "",
        "ActionProvider": "Flow",
        "ActionName": "OutputAction",
        "Type": 6,
        "Integration": "Flow",
        "Parameters": [
          {
            "ParentStepIdentifier": "2397d158-0beb-457b-99e8-a0cedd1c26d1",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "NestedWorkflowOutput",
            "Value": null
          }
        ],
        "AutoSkipOnFailure": false,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
        "OriginalStepIdentifier": "26e94be2-0a29-469c-9464-33de457a2a28",
        "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
        "ParentStepIdentifiers": [
          "33a29541-4d4b-4f55-bf6e-72c27c359066"
        ],
        "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
        "PreviousResultCondition": "{}",
        "InstanceName": "List Instances - EC2",
        "IsAutomatic": true,
        "Name": "AWSEC2_List Instances",
        "IsSkippable": false,
        "Description": "Describes the specified instances or all instances.",
        "ActionProvider": "Scripts",
        "ActionName": "AWSEC2_List Instances",
        "Type": 0,
        "Integration": "AWSEC2",
        "Parameters": [
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": ""
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "FetchInstanceByName",
            "Value": "false"
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "ScriptName",
            "Value": "AWSEC2_List Instances"
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "ScriptParametersEntityFields",
            "Value": "{\"Instance IDs\":\"[Instance Ids.ScriptResult]\",\"Tag Filters\":\"\",\"Max Results\":\"50\"}"
          },
          {
            "ParentStepIdentifier": "291ddf9d-f7fc-4a4b-a702-1b0f0bf6b22d",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": true,
        "StepDebugData": {
          "CreationTimeUnixTimeInMs": 0,
          "ModificationTimeUnixTimeInMs": 0,
          "OriginalWorkflowIdentifier": "8456e86c-2a38-45a0-900a-f5fdada8a4b5",
          "OriginalStepIdentifier": "26e94be2-0a29-469c-9464-33de457a2a28",
          "ResultValue": "true",
          "ResultJson": "{\n  \"EC2_Instances\": [\n    {\n      \"AmiLaunchIndex\": 0,\n      \"ImageId\": \"ami-x\",\n      \"InstanceId\": \"i-x\",\n      \"InstanceType\": \"t2.micro\",\n      \"KeyName\": \"CBdefense\",\n      \"LaunchTime\": \"2021-02-17 14:22:59+00:00\",\n      \"Monitoring\": {\n        \"State\": \"disabled\"\n      },\n      \"Placement\": {\n        \"AvailabilityZone\": \"us-east-1d\",\n        \"GroupName\": \"\",\n        \"Tenancy\": \"default\"\n      },\n      \"PrivateDnsName\": \"ip-x-x-x-x.ec2.internal\",\n      \"PrivateIpAddress\": \"x.x.x.x\",\n      \"ProductCodes\": [],\n      \"PublicDnsName\": \"\",\n      \"State\": {\n        \"Code\": 1,\n        \"Name\": \"stopped\"\n      },\n      \"StateTransitionReason\": \"User initiated (2021-02-17 14:57:06 GMT)\",\n      \"SubnetId\": \"subnet-x\",\n      \"VpcId\": \"vpc-x\",\n      \"Architecture\": \"x86_64\",\n      \"BlockDeviceMappings\": [\n        {\n          \"DeviceName\": \"/x/x\",\n          \"Ebs\": {\n            \"AttachTime\": \"2020-05-18 13:05:25+00:00\",\n            \"DeleteOnTermination\": true,\n            \"Status\": \"attached\",\n            \"VolumeId\": \"vol-x\"\n          }\n        }\n      ],\n      \"ClientToken\": \"\",\n      \"EbsOptimized\": false,\n      \"EnaSupport\": true,\n      \"Hypervisor\": \"xen\",\n      \"NetworkInterfaces\": [\n        {\n          \"Attachment\": {\n            \"AttachTime\": \"2020-05-18 13:05:24+00:00\",\n            \"AttachmentId\": \"eni-attach-x\",\n            \"DeleteOnTermination\": true,\n            \"DeviceIndex\": 0,\n            \"Status\": \"attached\"\n          },\n          \"Description\": \"\",\n          \"Groups\": [\n            {\n              \"GroupName\": \"EC2-demo-instance\",\n              \"GroupId\": \"sg-x\"\n            }\n          ],\n          \"Ipv6Addresses\": [],\n          \"MacAddress\": \"x:x:x:x:x:x\",\n          \"NetworkInterfaceId\": \"eni-x\",\n          \"OwnerId\": \"x\",\n          \"PrivateDnsName\": \"ip-x-x-x-x.ec2.internal\",\n          \"PrivateIpAddress\": \"x.x.x.x\",\n          \"PrivateIpAddresses\": [\n            {\n              \"Primary\": true,\n              \"PrivateDnsName\": \"ip-x-x-x-x.ec2.internal\",\n              \"PrivateIpAddress\": \"x.x.x.x\"\n            }\n          ],\n          \"SourceDestCheck\": true,\n          \"Status\": \"in-use\",\n          \"SubnetId\": \"subnet-x\",\n          \"VpcId\": \"vpc-x\",\n          \"InterfaceType\": \"interface\"\n        }\n      ],\n      \"RootDeviceName\": \"/x/x\",\n      \"RootDeviceType\": \"ebs\",\n      \"SecurityGroups\": [\n        {\n          \"GroupName\": \"EC2-demo-instance\",\n          \"GroupId\": \"sg-x\"\n        }\n      ],\n      \"SourceDestCheck\": true,\n      \"StateReason\": {\n        \"Code\": \"Client.UserInitiatedShutdown\",\n        \"Message\": \"Client.UserInitiatedShutdown: User initiated shutdown\"\n      },\n      \"Tags\": [\n        {\n          \"Key\": \"Name\",\n          \"Value\": \"CB-defense-agent\"\n        },\n        {\n          \"Key\": \"Owner\",\n          \"Value\": \"x;x\"\n        }\n      ],\n      \"VirtualizationType\": \"hvm\",\n      \"CpuOptions\": {\n        \"CoreCount\": 1,\n        \"ThreadsPerCore\": 1\n      },\n      \"CapacityReservationSpecification\": {\n        \"CapacityReservationPreference\": \"open\"\n      },\n      \"HibernationOptions\": {\n        \"Configured\": false\n      },\n      \"MetadataOptions\": {\n        \"State\": \"applied\",\n        \"HttpTokens\": \"optional\",\n        \"HttpPutResponseHopLimit\": 1,\n        \"HttpEndpoint\": \"enabled\"\n      }\n    }\n  ]\n}",
          "ScopeEntitiesEnrichmentData": [],
          "ScopeEntitiesEnrichmentDataJson": "[]"
        },
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
        "OriginalStepIdentifier": "3f9385aa-6541-40f7-bbbb-a46984fd3150",
        "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
        "ParentStepIdentifiers": [
          "08912eca-8d4e-4a1e-9d5d-1f52521394bb"
        ],
        "ParentStepIdentifier": "08912eca-8d4e-4a1e-9d5d-1f52521394bb",
        "PreviousResultCondition": "{}",
        "InstanceName": "Instance Ids",
        "IsAutomatic": true,
        "Name": "Functions_String Functions",
        "IsSkippable": false,
        "Description": "This action includes basic Pythonic string functions as mentioned below - \nLower: Converts the input string to lowercase.\nUpper: Converts the input string to uppercase (duplicated case in the script).\nStrip: Removes leading and trailing whitespaces from the input string.\nTitle: Converts the first character of each word in the input string to uppercase.\nCount: Counts the occurrences of `param_1` in the input string.\nReplace: Replaces occurrences of `param_1` with `param_2` in the input string.\nFind: Finds the first occurrence of `param_1` in the input string and returns its index.\nIsAlpha: Checks if all characters in the input string are alphanumeric.\nIsDigit: Checks if all characters in the input string are digits.\nRegex Replace: Performs a regex-based replacement of `param_1` with `param_2` in the input string.\nJSON Serialize: Converts the input string to a JSON formatted string.\nRegex: Finds all occurrences of the pattern `param_1` in the input string, joins them using `param_2` (defaulting to \", \"), and returns the result.\nDecodeBase64: Decodes the input string from base64 using `param_1` as the encoding type. Default to utf-8\nEncodeBase64: Encodes the input string in base64 using `param_1` as the encoding type. Default to utf-8\nRemoveNewLines: Removes new lines from the input string, replacing them with spaces.\nSplit: Splits the input string using `param_1` (or \",\" if not provided) and adds the result to the Siemplify result.",
        "ActionProvider": "Scripts",
        "ActionName": "Functions_String Functions",
        "Type": 0,
        "Integration": "Functions",
        "Parameters": [
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": ""
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "FetchInstanceByName",
            "Value": "false"
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "ScriptName",
            "Value": "Functions_String Functions"
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "ScriptParametersEntityFields",
            "Value": "{\"Param 2\":\" \",\"Param 1\":\"i-[a-f0-9]+\",\"Input\":\"[AWS EC2 Filter.SelectedEntities]\",\"Function\":\"Regex\"}"
          },
          {
            "ParentStepIdentifier": "33a29541-4d4b-4f55-bf6e-72c27c359066",
            "ParentWorkflowIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": false,
        "IsDebugMockData": false,
        "StepDebugData": {
          "CreationTimeUnixTimeInMs": 0,
          "ModificationTimeUnixTimeInMs": 0,
          "OriginalWorkflowIdentifier": "8456e86c-2a38-45a0-900a-f5fdada8a4b5",
          "OriginalStepIdentifier": "3f9385aa-6541-40f7-bbbb-a46984fd3150",
          "ResultValue": "",
          "ResultJson": "",
          "ScopeEntitiesEnrichmentData": [],
          "ScopeEntitiesEnrichmentDataJson": "[]"
        },
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      }
    ],
    "Triggers": [
      {
        "Identifier": "3467a050-89f5-4fe9-9783-49497211aebc",
        "IsEnabled": true,
        "DefinitionIdentifier": "e1469bc1-1fbb-4ccd-8eeb-81edba6a381e",
        "Type": 11,
        "WorkflowName": null,
        "LogicalOperator": 0,
        "Conditions": [],
        "Environments": [
          "*"
        ]
      }
    ],
    "OverviewTemplates": [],
    "Permissions": [],
    "Environments": [
      "*"
    ]
  }
}