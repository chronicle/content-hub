{
  "CategoryName": "_Approved",
  "OverviewTemplatesDetails": [],
  "WidgetTemplates": [],
  "Definition": {
    "Identifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
    "IsEnable": true,
    "Version": 1.0,
    "IsArchived": false,
    "IsAutomatic": true,
    "Name": "Microsoft Defender For Endpoint Enrichment",
    "Category": 18,
    "Description": "An embedded workflow that can receive inputs and return an output.",
    "Priority": 2,
    "Creator": "1f3e75a0-77cb-45aa-b3d4-0f814c2cf78e",
    "VersionCreator": null,
    "VersionComment": null,
    "OriginalWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
    "TemplateName": null,
    "PlaybookType": 1,
    "IsDebugMode": false,
    "DebugBaseAlertIdentifier": null,
    "DebugAlertIdentifier": null,
    "SimulationClone": false,
    "DefaultAccessLevel": 2,
    "CreationSource": 1,
    "Steps": [
      {
        "Identifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
        "OriginalStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
        "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
        "ParentStepIdentifiers": [],
        "ParentStepIdentifier": "",
        "PreviousResultCondition": null,
        "InstanceName": "Microsoft Defender Enrich Entities",
        "IsAutomatic": true,
        "Name": "MicrosoftDefenderATP_Enrich Entities",
        "IsSkippable": false,
        "Description": "This action allows a user to enrich Microsoft Defender ATP hosts, ips and file hashes. Note: File hash can be in sha1 or sha256 format.",
        "ActionProvider": "Scripts",
        "ActionName": "MicrosoftDefenderATP_Enrich Entities",
        "Type": 0,
        "Integration": "MicrosoftDefenderATP",
        "Parameters": [
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": ""
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FetchInstanceByName",
            "Value": "false"
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptName",
            "Value": "MicrosoftDefenderATP_Enrich Entities"
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptParametersEntityFields",
            "Value": "{}"
          },
          {
            "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
        "OriginalStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
        "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
        "ParentStepIdentifiers": [
          "116982f6-95bf-42a0-9c20-20cbc1e4874c"
        ],
        "ParentStepIdentifier": "116982f6-95bf-42a0-9c20-20cbc1e4874c",
        "PreviousResultCondition": "{}",
        "InstanceName": "Machine Logon Users",
        "IsAutomatic": true,
        "Name": "MicrosoftDefenderATP_Get Machine Logon Users",
        "IsSkippable": false,
        "Description": "Get Machine Log on users",
        "ActionProvider": "Scripts",
        "ActionName": "MicrosoftDefenderATP_Get Machine Logon Users",
        "Type": 0,
        "Integration": "MicrosoftDefenderATP",
        "Parameters": [
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": ""
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FetchInstanceByName",
            "Value": "false"
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptName",
            "Value": "MicrosoftDefenderATP_Get Machine Logon Users"
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptParametersEntityFields",
            "Value": "{}"
          },
          {
            "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "54325ff2-ea6a-4306-a992-0e3b416d3ab1",
        "OriginalStepIdentifier": "54325ff2-ea6a-4306-a992-0e3b416d3ab1",
        "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
        "ParentStepIdentifiers": [
          "a20764ea-3027-42db-b675-b9c07e194d25"
        ],
        "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
        "PreviousResultCondition": "{}",
        "InstanceName": "Output_1",
        "IsAutomatic": true,
        "Name": "Output",
        "IsSkippable": false,
        "Description": "",
        "ActionProvider": "Flow",
        "ActionName": "OutputAction",
        "Type": 6,
        "Integration": "Flow",
        "Parameters": [
          {
            "ParentStepIdentifier": "54325ff2-ea6a-4306-a992-0e3b416d3ab1",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "NestedWorkflowOutput",
            "Value": null
          }
        ],
        "AutoSkipOnFailure": false,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "a20764ea-3027-42db-b675-b9c07e194d25",
        "OriginalStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
        "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
        "ParentStepIdentifiers": [
          "a6052575-b094-49fd-93ca-26b4cbd981cd"
        ],
        "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
        "PreviousResultCondition": "{}",
        "InstanceName": "MicrosoftDefender Related Alerts",
        "IsAutomatic": true,
        "Name": "MicrosoftDefenderATP_Get Machine Related Alerts",
        "IsSkippable": false,
        "Description": "Get Machine Related Alerts",
        "ActionProvider": "Scripts",
        "ActionName": "MicrosoftDefenderATP_Get Machine Related Alerts",
        "Type": 0,
        "Integration": "MicrosoftDefenderATP",
        "Parameters": [
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": ""
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FetchInstanceByName",
            "Value": "false"
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptName",
            "Value": "MicrosoftDefenderATP_Get Machine Related Alerts"
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptParametersEntityFields",
            "Value": "{\"Status\":\"Unknown, New, InProgress, Resolved\",\"Severity\":\"UnSpecified, Informational, Low, Medium, High\",\"Category\":\"\",\"Incident ID\":\"\"}"
          },
          {
            "ParentStepIdentifier": "a20764ea-3027-42db-b675-b9c07e194d25",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      },
      {
        "Identifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
        "OriginalStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
        "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
        "ParentStepIdentifiers": [
          "1a9dedcb-df14-436e-b936-c04ab3733345"
        ],
        "ParentStepIdentifier": "1a9dedcb-df14-436e-b936-c04ab3733345",
        "PreviousResultCondition": "{}",
        "InstanceName": "MicrosoftDefender File Related Alerts",
        "IsAutomatic": true,
        "Name": "MicrosoftDefenderATP_Get File Related Alerts",
        "IsSkippable": false,
        "Description": "Get File Related Alerts. Note: For this action only SHA1 is supported",
        "ActionProvider": "Scripts",
        "ActionName": "MicrosoftDefenderATP_Get File Related Alerts",
        "Type": 0,
        "Integration": "MicrosoftDefenderATP",
        "Parameters": [
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "AssignedUsers",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "DynamicInjectionInstancePlaceholder",
            "Value": ""
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FallbackIntegrationInstance",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "FetchInstanceByName",
            "Value": "false"
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "HasApprovalLink",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "IntegrationInstance",
            "Value": "AutomaticEnvironment"
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "MessageToAssignee",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "PendingActionTimeout",
            "Value": null
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptName",
            "Value": "MicrosoftDefenderATP_Get File Related Alerts"
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "ScriptParametersEntityFields",
            "Value": "{\"Status\":\"Unknown, New, InProgress, Resolved\",\"Severity\":\"UnSpecified, Informational, Low, Medium, High\",\"Category\":\"\",\"Incident ID\":\"\"}"
          },
          {
            "ParentStepIdentifier": "a6052575-b094-49fd-93ca-26b4cbd981cd",
            "ParentWorkflowIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
            "Name": "SelectedScopeName",
            "Value": "All entities"
          }
        ],
        "AutoSkipOnFailure": true,
        "IsDebugMockData": false,
        "StepDebugData": null,
        "ParentStepContainerId": null,
        "IsTouchedByAi": false,
        "StartLoopStepIdentifier": null,
        "ParallelActions": []
      }
    ],
    "Triggers": [
      {
        "Identifier": "8e381d9e-1985-49c7-b67d-30cb935922e6",
        "IsEnabled": true,
        "DefinitionIdentifier": "ec8ecd2c-4c8a-40d0-83a9-00b159a26b8e",
        "Type": 11,
        "WorkflowName": null,
        "LogicalOperator": 0,
        "Conditions": [],
        "Environments": [
          "*"
        ]
      }
    ],
    "OverviewTemplates": [],
    "Permissions": [],
    "Environments": [
      "*"
    ]
  }
}